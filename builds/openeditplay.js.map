{"version":3,"file":"openeditplay.js","sources":["../src/util/assert.ts","../src/util/circularDependencyDetector.ts","../src/core/eventDispatcher.ts","../src/core/change.ts","../src/util/environment.ts","../src/core/serializable.ts","../src/core/property.ts","../src/core/propertyType.ts","../src/util/vector.ts","../src/util/color.ts","../src/core/dataTypes.ts","../src/core/propertyOwner.ts","../node_modules/redom/dist/redom.es.js","../src/util/popup.ts","../src/features/graphics.ts","../src/modules/backgroundGradient.ts","../src/core/game.ts","../src/features/physics.ts","../src/util/input.ts","../src/editor/editorEventDispatcher.ts","../src/util/performance.ts","../src/core/scene.ts","../src/core/component.ts","../src/core/componentData.ts","../src/core/serializableManager.ts","../src/core/entity.ts","../src/core/prototype.ts","../src/core/entityPrototype.ts","../src/core/prefab.ts","../src/core/level.ts","../src/components/Transform.ts","../src/components/TransformVariance.ts","../src/components/Shape.ts","../src/components/Sprite.ts","../src/components/Spawner.ts","../src/components/Trigger.ts","../src/components/Physics.ts","../src/components/Lifetime.ts","../src/components/Particles.ts","../src/util/algorithm.ts","../src/components/CharacterController.ts","../src/features/animation/animation.ts","../src/components/Animation.ts","../src/util/callLimiter.ts","../src/core/net.ts","../src/player/canvasResize.ts","../src/player/TouchControl.ts","../src/player/touchControlManager.ts","../src/player/main.ts"],"sourcesContent":["// @ifndef OPTIMIZE\nexport const changeGetter = {\n\tget: () => null // override this\n};\n// @endif\n\nexport default function assert(condition, ...messages) {\n\t// @ifndef OPTIMIZE\n\tif (!condition) {\n\t\tconsole.warn('Assert', ...messages, '\\norigin', changeGetter.get());\n\t\tconsole.log(new Error().stack); // In own log call so that browser console can map from from bundle files to .ts files.\n\n\t\tdebugger; // Check console for error messages\n\n\t\tif (!window['force'])\n\t\t\tthrow new Error(messages.join('; '));\n\t}\n\t// @endif\n}\n","import assert from \"./assert\";\n\nexport class CircularDependencyDetector {\n    currentType: string = null;\n    chain: any[] = [];\n    timeout: any = null;\n\n    enter(type, data = null) {\n        this.chain.push({\n            type,\n            data,\n            stack: (new Error()).stack\n        });\n        if (type !== this.currentType) {\n            if (this.chain.find((link, i) => link.type === type && i !== this.chain.length - 1)) {\n                console.warn('Change event circular dependency');\n                console.log('################################');\n                for (const part of this.chain) {\n                    console.warn(`%c${part.type}`, 'font-weight: bold; font-size: 16px');\n                    if (part.data && typeof part.data === 'object') {\n                        for (const key in part.data) {\n                            if (part.data[key] != null)\n                                console.warn(key + ':', part.data[key]);\n                        }\n                    } else {\n                        console.warn(part.data);\n                    }\n                    console.warn(part.stack);\n                    console.log('--------------------------------------');\n                }\n                assert(false, 'Change event circular dependency');\n            }\n            this.currentType = type;\n            if (!this.timeout) {\n                this.timeout = setTimeout(() => this.reset(), 0);\n            }\n        }\n    }\n    leave(type) {\n        if (this.chain.length > 0 && this.chain[this.chain.length - 1].type === type) {\n            this.chain.pop();\n            this.currentType = this.chain.length > 0 ? this.chain[this.chain.length - 1].type : null;\n        }\n    }\n    reset() {\n        this.currentType = null;\n        this.chain.length = 0;\n        this.timeout = null;\n    }\n}\n\nfunction test() {\n    let c = new CircularDependencyDetector();\n    c.enter('a');\n    c.enter('a');\n    c.enter('b');\n    c.enter('b');\n    c.leave('b');\n    c.leave('b');\n    c.enter('a');\n}\n\ntest();\n","import { CircularDependencyDetector } from \"../util/circularDependencyDetector\";\n\nexport enum GameEvent {\n    SCENE_START = 'scene start',\n    SCENE_PLAY = 'scene play',\n    SCENE_PAUSE = 'scene pause',\n    SCENE_RESET = 'scene reset',\n    SCENE_DRAW = 'scene draw', // parameters(scene: Scene)\n    SCENE_ZOOM_CHANGED = 'zoom changed',\n    GAME_LEVEL_COMPLETED = 'game level completed',\n    PROPERTY_VALUE_CHANGE = 'property change',\n    GLOBAL_CHANGE_OCCURED = 'change',\n    GLOBAL_SCENE_CREATED = 'scene created',\n    GLOBAL_GAME_CREATED = 'game created',\n    GLOBAL_ENTITY_CLICKED = 'global entity clicked', // parameters(entity, component)\n    ENTITY_CLICKED = 'entity clicked', // parameters(component)\n}\n\nexport type ListenerFunction = Function & { priority?: number };\n\nexport let eventDispatcherCallbacks = {\n    eventDispatchedCallback: null // (eventName, listenerCount) => void\n};\n\nconst globalCircularDependencyDetector = new CircularDependencyDetector();\n\nexport default class EventDispatcher {\n    _listeners: { [event in GameEvent]?: Array<ListenerFunction> } = {};\n\n    // priority should be a whole number between -100000 and 100000. a smaller priority number means that it will be executed first.\n    listen(event: GameEvent, callback: ListenerFunction, priority = 0) {\n        (callback as any).priority = priority + (listenerCounter++ / NUMBER_BIGGER_THAN_LISTENER_COUNT);\n        if (!this._listeners.hasOwnProperty(event)) {\n            this._listeners[event] = [];\n        }\n        let index = decideIndexOfListener(this._listeners[event], callback);\n        this._listeners[event].splice(index, 0, callback);\n        return () => {\n            let eventListeners = this._listeners[event];\n            if (!eventListeners) return; // listeners probably already deleted\n\n            let index = eventListeners.indexOf(callback);\n            if (index >= 0)\n                eventListeners.splice(index, 1);\n        };\n    }\n    dispatch(event: GameEvent, a?, b?, c?) {\n        let listeners = this._listeners[event];\n        if (!listeners)\n            return;\n\n        let circularDependencyEvent = (a && a.reference) ? (event + a.reference.id) : event;\n        globalCircularDependencyDetector.enter(circularDependencyEvent, {\n            this: this, a, b, c\n        });\n\n        if (eventDispatcherCallbacks.eventDispatchedCallback)\n            eventDispatcherCallbacks.eventDispatchedCallback(event, listeners.length);\n\n        for (let i = 0; i < listeners.length; i++) {\n            // @ifndef OPTIMIZE\n            try {\n                // @endif\n\n                listeners[i](a, b, c);\n\n                // @ifndef OPTIMIZE\n            } catch (e) {\n                console.error(`Event ${event} listener crashed.`, this._listeners[event][i], e);\n            }\n            // @endif\n        }\n\n        globalCircularDependencyDetector.leave(circularDependencyEvent);\n    }\n\n    /**\n     * This is separate function for optimization.\n     * Returns promise that has value array, containing all results from listeners.\n     * Promise can reject.\n     *\n     * Handler of this kind of events should return either a value or a Promise.\n     */\n    dispatchWithResults(event: GameEvent, a?, b?, c?) {\n        let listeners = this._listeners[event];\n        if (!listeners)\n            return Promise.all([]);\n\n        let results = [];\n\n        if (eventDispatcherCallbacks.eventDispatchedCallback)\n            eventDispatcherCallbacks.eventDispatchedCallback(event, listeners.length);\n\n        for (let i = 0; i < listeners.length; i++) {\n            // @ifndef OPTIMIZE\n            try {\n                // @endif\n\n                results.push(listeners[i](a, b, c));\n\n                // @ifndef OPTIMIZE\n            } catch (e) {\n                console.error(`Event ${event} listener crashed.`, this._listeners[event][i], e);\n            }\n            // @endif\n        }\n\n        let promises = results.map(res => res instanceof Promise ? res : Promise.resolve(res));\n        return Promise.all(promises);\n    }\n\n    delete() {\n        this._listeners = {};\n    }\n}\n\nexport let globalEventDispatcher = new EventDispatcher();\nglobalEventDispatcher['globalEventDispatcher'] = true; // for debugging\n\nlet listenerCounter = 0;\nconst NUMBER_BIGGER_THAN_LISTENER_COUNT = 10000000000;\n\nfunction decideIndexOfListener(array, callback) {\n    let low = 0,\n        high = array.length,\n        priority = callback.priority;\n\n    while (low < high) {\n        let mid = low + high >>> 1;\n        if (array[mid].priority < priority) low = mid + 1;\n        else high = mid;\n    }\n    return low;\n}\n","import assert, { changeGetter as assertChangeGetter } from '../util/assert';\nimport Serializable, { serializableCallbacks } from './serializable';\nimport Property from './property';\nimport EventDispatcher, { GameEvent, globalEventDispatcher } from './eventDispatcher';\nimport { CircularDependencyDetector } from '../util/circularDependencyDetector';\n\nlet DEBUG_CHANGES = 0;\nlet CHECK_FOR_INVALID_ORIGINS = 1; // TODO: Do stuff in editor with this set to true to find nasty bugs.\n\nexport type Change = {\n\ttype: string;\n\treference: Serializable;\n\tid: string;\n\texternal: boolean; // caused by network\n\torigin?: any; // exists in editor, but not in optimized release\n\tvalue?: any;\n\tparent?: Serializable;\n}\n\n// reference parameters are not sent over net. they are helpers in local game instance\nexport let changeType = {\n\taddSerializableToTree: 'a', // parentId, reference\n\tsetPropertyValue: 's', // id, value\n\tdeleteSerializable: 'd', // id\n\tmove: 'm', // id, parentId\n\tdeleteAllChildren: 'c', // id\n};\n\nlet circularDependencyDetector = new CircularDependencyDetector();\nlet origin;\n\n// @ifndef OPTIMIZE\nlet previousVisualOrigin;\nfunction resetOrigin() {\n\torigin = null;\n}\nexport function getChangeOrigin() {\n\treturn origin;\n}\nassertChangeGetter.get = getChangeOrigin;\n// @endif\nexport function setChangeOrigin(_origin) {\n\t// @ifndef OPTIMIZE\n\tif (_origin !== origin) {\n\t\torigin = _origin;\n\t\tif (DEBUG_CHANGES && _origin && _origin !== previousVisualOrigin) {\n\t\t\tconsole.log('origin', previousVisualOrigin);\n\t\t\tpreviousVisualOrigin = _origin;\n\t\t}\n\n\t\tif (CHECK_FOR_INVALID_ORIGINS)\n\t\t\tsetTimeout(resetOrigin, 0);\n\t}\n\t// @endif\n}\n\nlet externalChange = false;\n\n// addChange needs to be called if editor, server or net game needs to share changes\nexport function addChange(type: string, reference: Serializable) {\n\t// @ifndef OPTIMIZE\n\tassert(origin, 'Change without origin!');\n\tcircularDependencyDetector.enter(type + (reference && reference.threeLetterType));\n\t// @endif\n\n\tif (!reference.id) return;\n\n\tlet change: Change = {\n\t\ttype,\n\t\treference,\n\t\tid: reference.id,\n\t\texternal: externalChange,\n\t\torigin // exists in editor, but not in optimized release\n\t};\n\tif (type === changeType.setPropertyValue) {\n\t\tchange.value = (reference as Property)._value;\n\t} else if (type === changeType.move) {\n\t\tchange.parent = reference._parent;\n\t} else if (type === changeType.addSerializableToTree) {\n\t\tchange.parent = reference._parent;\n\t\tdelete change.id;\n\t}\n\n\t// @ifndef OPTIMIZE\n\tif (DEBUG_CHANGES)\n\t\tconsole.log('change', change);\n\n\tlet previousOrigin = origin;\n\t// @endif\n\n\tglobalEventDispatcher.dispatch(GameEvent.GLOBAL_CHANGE_OCCURED, change);\n\n\t// @ifndef OPTIMIZE\n\tif (origin !== previousOrigin) {\n\t\tif (DEBUG_CHANGES)\n\t\t\tconsole.log('origin changed from', previousOrigin, 'to', origin && origin.constructor || origin);\n\t\torigin = previousOrigin;\n\t}\n\t// @endif\n}\n\nexport function executeExternal(callback) {\n\texecuteWithOrigin('external', () => {\n\t\tif (externalChange) return callback();\n\t\texternalChange = true;\n\t\tcallback();\n\t\texternalChange = false;\n\t});\n}\n\nexport function executeWithOrigin(origin, task) {\n\tconst oldOrigin = origin;\n\tsetChangeOrigin(origin);\n\ttask();\n\tsetChangeOrigin(oldOrigin);\n}\n","let isClient = typeof window !== 'undefined';\nlet isServer = typeof module !== 'undefined';\n\nif (isClient && isServer)\n\tthrow new Error('Can not be client and server at the same time.');\n\nexport { isClient, isServer };\n","import assert from '../util/assert';\nimport { changeType, addChange } from './change';\nimport { isClient } from '../util/environment';\nimport EventDispatcher from './eventDispatcher';\n\nexport const serializableCallbacks = {\n\taddSerializable: (serializable: Serializable) => { },\n\tremoveSerializable: (serializableId: string) => { },\n};\n\nconst CHARACTERS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'; // 62 chars\nconst CHAR_COUNT = CHARACTERS.length;\n\nconst random = Math.random;\nexport function createStringId(threeLetterPrefix = '???', characters = 16) {\n\tlet id = threeLetterPrefix;\n\tfor (let i = characters - 1; i >= 0; --i)\n\t\tid += CHARACTERS[random() * CHAR_COUNT | 0];\n\treturn id;\n}\n\nlet serializableClasses = new Map();\n\nexport default class Serializable extends EventDispatcher {\n\tid: string;\n\tthreeLetterType: string;\n\tisRoot: boolean;\n\t_children: Map<string, Array<Serializable>> = new Map();\n\t_rootType: string;\n\t_parent: Serializable;\n\t_alive: boolean;\n\t_state: number;\n\n\tconstructor(predefinedId: string = '', skipSerializableRegistering = false) {\n\t\tsuper();\n\t\t// @ifndef OPTIMIZE\n\t\tassert(this.threeLetterType, 'Forgot to Serializable.registerSerializable your class?');\n\t\t// @endif\n\t\tthis._rootType = this.isRoot ? this.threeLetterType : null;\n\t\tif (skipSerializableRegistering)\n\t\t\treturn;\n\t\tif (predefinedId) {\n\t\t\tthis.id = predefinedId;\n\t\t} else {\n\t\t\tthis.id = createStringId(this.threeLetterType);\n\t\t}\n\t\t/*\n\t\tif (this.id.startsWith('?'))\n\t\t\tthrow new Error('?');\n\t\t\t*/\n\t\tserializableCallbacks.addSerializable(this);\n\t}\n\tmakeUpAName() {\n\t\treturn 'Serializable';\n\t}\n\tdelete() {\n\t\tsuper.delete();\n\t\tif (this._parent) {\n\t\t\tthis._parent.deleteChild(this);\n\t\t\treturn false;\n\t\t}\n\t\tthis.deleteChildren();\n\t\tthis._alive = false;\n\t\tthis._rootType = null;\n\t\tserializableCallbacks.removeSerializable(this.id);\n\t\tthis._state |= Serializable.STATE_DESTROY;\n\t\treturn true;\n\t}\n\tdeleteChildren() {\n\t\tif (this._children.size) {\n\t\t\tthis._children.forEach(array => {\n\t\t\t\tarray.forEach(child => {\n\t\t\t\t\tchild._parent = null;\n\t\t\t\t\tchild.delete();\n\t\t\t\t});\n\t\t\t});\n\t\t\tthis._children.clear();\n\n\t\t\tif (this._parent) {\n\t\t\t\taddChange(changeType.deleteAllChildren, this);\n\t\t\t}\n\t\t}\n\t}\n\t// this is called right after constructor\n\tinitWithChildren(children: Array<Serializable> = []) {\n\t\tassert(!(this._state & Serializable.STATE_INIT), 'init already done');\n\t\tthis._state |= Serializable.STATE_INIT;\n\t\tif (children.length > 0)\n\t\t\tthis.addChildren(children);\n\t\treturn this;\n\t}\n\taddChildren(children) {\n\t\tfor (let i = 0; i < children.length; i++)\n\t\t\tthis.addChild(children[i]);\n\t\treturn this;\n\t}\n\taddChild(child: Serializable): Serializable {\n\t\tthis._addChild(child);\n\n\t\tthis._state |= Serializable.STATE_ADDCHILD;\n\n\t\tif (this._rootType)\n\t\t\taddChange(changeType.addSerializableToTree, child);\n\t\treturn this;\n\t}\n\t_addChild(child: Serializable) {\n\t\tassert(child._parent === null);\n\n\t\tlet array = this._children.get(child.threeLetterType);\n\t\tif (array === undefined) {\n\t\t\tarray = [];\n\t\t\tthis._children.set(child.threeLetterType, array);\n\t\t}\n\t\tarray.push(child);\n\t\tchild._parent = this;\n\t\tchild._state |= Serializable.STATE_ADDPARENT;\n\n\t\tif (child._rootType !== this._rootType) // tiny optimization\n\t\t\tchild.setRootType(this._rootType);\n\n\t\treturn this;\n\t}\n\tfindChild(threeLetterType: string, filterFunction: (s: Serializable) => boolean, deep: boolean = false) {\n\t\tlet array = this._children.get(threeLetterType);\n\t\tif (!array) return null;\n\t\tif (filterFunction) {\n\t\t\tlet foundChild = array.find(filterFunction);\n\t\t\tif (foundChild) {\n\t\t\t\treturn foundChild;\n\t\t\t} else if (deep) {\n\t\t\t\tfor (let i = 0; i < array.length; ++i) {\n\t\t\t\t\tlet child = array[i];\n\t\t\t\t\tlet foundChild = child.findChild(threeLetterType, filterFunction, true);\n\t\t\t\t\tif (foundChild)\n\t\t\t\t\t\treturn foundChild;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t} else {\n\t\t\treturn array[0];\n\t\t}\n\t}\n\tfindParent(threeLetterType: string, filterFunction: (Serializable) => boolean = null) {\n\t\tlet serializable: Serializable = this;\n\t\twhile (serializable) {\n\t\t\tif (serializable.threeLetterType === threeLetterType && (!filterFunction || filterFunction(serializable)))\n\t\t\t\treturn serializable;\n\t\t\tserializable = serializable._parent;\n\t\t}\n\t\treturn null;\n\t}\n\tgetRoot() {\n\t\tlet serializable: Serializable = this;\n\t\twhile (serializable._parent) {\n\t\t\tserializable = serializable._parent;\n\t\t}\n\t\treturn serializable;\n\t}\n\t// idx is optional\n\tdeleteChild(child: Serializable, idx?: number) {\n\t\taddChange(changeType.deleteSerializable, child);\n\t\tthis._detachChild(child, idx);\n\t\tchild.delete();\n\t\treturn this;\n\t}\n\t// idx is optional\n\t_detachChild(child: Serializable, idx: number = 0) {\n\t\tlet array = this._children.get(child.threeLetterType);\n\t\tassert(array, 'child not found');\n\t\tif (array[idx] !== child)\n\t\t\tidx = array.indexOf(child);\n\t\tassert(idx >= 0, 'child not found');\n\t\tarray.splice(idx, 1);\n\t\tif (array.length === 0)\n\t\t\tthis._children.delete(child.threeLetterType);\n\t\tchild._parent = null;\n\t\tchild.setRootType(null);\n\n\t\treturn this;\n\t}\n\tforEachChild(threeLetterType: string = null, callback: (s: Serializable) => void, deep: boolean = false) {\n\t\tfunction processArray(array) {\n\t\t\tarray.forEach(child => {\n\t\t\t\tcallback(child);\n\t\t\t\tdeep && child.forEachChild(threeLetterType, callback, true);\n\t\t\t});\n\t\t}\n\t\tif (threeLetterType) {\n\t\t\tprocessArray(this._children.get(threeLetterType) || []);\n\t\t} else {\n\t\t\tthis._children.forEach(processArray);\n\t\t}\n\t\treturn this;\n\t}\n\tmove(newParent: Serializable) {\n\n\t\tnewParent._addChild(this._detach());\n\t\taddChange(changeType.move, this);\n\n\t\treturn this;\n\t}\n\t_detach() {\n\t\tthis._parent && this._parent._detachChild(this);\n\t\treturn this;\n\t}\n\tgetParent() {\n\t\treturn this._parent || null;\n\t}\n\tgetChildren(threeLetterType: string) {\n\t\treturn this._children.get(threeLetterType) || [];\n\t}\n\ttoJSON() {\n\t\tlet json: any = {\n\t\t\tid: this.id\n\t\t};\n\t\tif (this._children.size > 0) {\n\t\t\tlet arrays = [];\n\t\t\t// prototypes must come before a level\n\t\t\tArray.from(this._children.keys()).sort((a, b) => a === 'prt' ? -1 : 1)\n\t\t\t\t.forEach(key => arrays.push(this._children.get(key)));\n\t\t\tjson.c = [].concat(...arrays).map(child => child.toJSON());\n\t\t}\n\t\treturn json;\n\t}\n\ttoString() {\n\t\treturn JSON.stringify(this.toJSON(), null, 4);\n\t}\n\tclone() {\n\t\tlet obj: Serializable = new (this.constructor as any)();\n\t\tlet children = [];\n\t\tthis.forEachChild(null, child => {\n\t\t\tchildren.push(child.clone());\n\t\t});\n\t\tobj.initWithChildren(children);\n\t\tthis._state |= Serializable.STATE_CLONE;\n\t\treturn obj;\n\t}\n\thasDescendant(child: Serializable) {\n\t\tif (!child) return false;\n\t\tlet parent = child._parent;\n\t\twhile (parent) {\n\t\t\tif (parent === this) return true;\n\t\t\tparent = parent._parent;\n\t\t}\n\t\treturn false;\n\t}\n\tsetRootType(rootType: string) {\n\t\tif (this._rootType === rootType)\n\t\t\treturn;\n\t\tthis._rootType = rootType;\n\n\t\t// Optimized\n\t\tlet i;\n\t\tthis._children.forEach(childArray => {\n\t\t\tfor (i = 0; i < childArray.length; ++i) {\n\t\t\t\tchildArray[i].setRootType(rootType);\n\t\t\t}\n\t\t});\n\t}\n\tisInTree() {\n\t\treturn !!this._rootType;\n\t}\n\tstatic fromJSON(json: any) {\n\t\tassert(typeof json.id === 'string' && json.id.length > 5, 'Invalid id.');\n\t\tlet fromJSON = serializableClasses.get(json.id.substring(0, 3));\n\t\tassert(fromJSON);\n\t\tlet obj;\n\t\ttry {\n\t\t\tobj = fromJSON(json);\n\t\t} catch (e) {\n\t\t\tif (isClient) {\n\t\t\t\tconsole.error(e);\n\t\t\t\tif (!window['force'])\n\t\t\t\t\tdebugger; // Type 'force = true' in console to ignore failed imports.\n\n\t\t\t\tif (!window['force'])\n\t\t\t\t\tthrow new Error();\n\t\t\t} else {\n\t\t\t\tconsole.log('Error fromJSON', e);\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t\tlet children = json.c ? json.c.map(child => Serializable.fromJSON(child)).filter(Boolean) : [];\n\t\tif (obj._state & Serializable.STATE_INIT)\n\t\t\tobj.addChildren(children);\n\t\telse\n\t\t\tobj.initWithChildren(children);\n\t\tobj._state |= Serializable.STATE_FROMJSON;\n\t\treturn obj;\n\t}\n\tstatic registerSerializable(Class: { new(...args): Serializable }, threeLetterType: string, fromJSON: (string) => void = null) {\n\t\tClass.prototype.threeLetterType = threeLetterType;\n\t\tassert(typeof threeLetterType === 'string' && threeLetterType.length === 3);\n\t\tif (!fromJSON)\n\t\t\tfromJSON = json => new Class(json.id);\n\t\tserializableClasses.set(threeLetterType, fromJSON);\n\t}\n\n\tstatic STATE_INIT: number = 2;\n\tstatic STATE_ADDCHILD: number = 4;\n\tstatic STATE_ADDPARENT: number = 8;\n\tstatic STATE_CLONE: number = 16;\n\tstatic STATE_DESTROY: number = 32;\n\tstatic STATE_FROMJSON: number = 64;\n}\n\nSerializable.prototype._parent = null;\nSerializable.prototype._alive = true;\nSerializable.prototype._state = 0;\nSerializable.prototype._rootType = null;\n\nSerializable.prototype.isRoot = false; // If this should be a root node\nObject.defineProperty(Serializable.prototype, 'debug', {\n\tget() {\n\t\tlet info = this.threeLetterType;\n\n\t\tif (this.threeLetterType === 'cda')\n\t\t\tinfo += '|' + this.name;\n\n\t\tthis._children.forEach((value, key) => {\n\t\t\tinfo += '|';\n\t\t\tif (key === 'prp')\n\t\t\t\tinfo += this.getChildren('prp').map(p => `${p.name}=${p._value}`).join(', ');\n\t\t\telse\n\t\t\t\tinfo += `${key}(${value.length})`;\n\t\t});\n\n\t\tinfo += '|state: ';\n\n\t\tlet states = [];\n\t\tlet logState = (state, stateString) => {\n\t\t\tif (this._state & state)\n\t\t\t\tstates.push(stateString);\n\t\t};\n\n\t\tlogState(Serializable.STATE_INIT, 'init');\n\t\tlogState(Serializable.STATE_ADDCHILD, 'add child');\n\t\tlogState(Serializable.STATE_ADDPARENT, 'add parent');\n\t\tlogState(Serializable.STATE_CLONE, 'clone');\n\t\tlogState(Serializable.STATE_DESTROY, 'destroy');\n\t\tlogState(Serializable.STATE_FROMJSON, 'from json');\n\n\t\tinfo += states.join(', ');\n\n\t\treturn info;\n\t}\n});\nObject.defineProperty(Serializable.prototype, 'debugChildren', {\n\tget() {\n\t\tlet c = [];\n\t\tthis._children.forEach((value, key) => {\n\t\t\tc = c.concat(value);\n\t\t});\n\n\t\tlet children = [];\n\n\t\tfunction createDebugObject(type) {\n\t\t\tif (type === 'gam') return new function Game() { };\n\t\t\tif (type === 'sce') return new function Scene() { };\n\t\t\tif (type === 'prt') return new function Prototype() { };\n\t\t\tif (type === 'prp') return new function Property() { };\n\t\t\tif (type === 'cda') return new function ComponentData() { };\n\t\t\tif (type === 'com') return new function Component() { };\n\t\t\tif (type === 'epr') return new function EntityPrototype() { };\n\t\t\tif (type === 'ent') return new function Entity() { };\n\t\t\tif (type === 'lvl') return new function Level() { };\n\t\t\tif (type === 'pfa') return new function Prefab() { };\n\t\t\treturn new function Other() { };\n\t\t}\n\n\t\tc.forEach(child => {\n\t\t\tlet obj = createDebugObject(child.threeLetterType);\n\n\t\t\tobj.debug = child.debug;\n\t\t\tobj.ref = child;\n\t\t\tobj.debugChildren = child.debugChildren;\n\t\t\tlet c = child.debugChildArray;\n\t\t\tif (c && c.length > 0)\n\t\t\t\tobj.children = c;\n\t\t\tchildren.push(obj);\n\t\t});\n\n\t\treturn children;\n\t}\n});\n\n/**\n * If a serializable is a ancestor of another serializable, it is filtered out from the list\n */\nexport function filterChildren(serializables: Array<Serializable>) {\n\tlet idSet = new Set(serializables.map(s => s.id));\n\treturn serializables.filter(serializable => {\n\t\tlet parent = serializable.getParent();\n\t\twhile (parent) {\n\t\t\tif (idSet.has(parent.id))\n\t\t\t\treturn false;\n\t\t\tparent = parent.getParent();\n\t\t}\n\t\treturn true;\n\t});\n}\n","import Serializable from './serializable';\nimport { addChange, changeType, setChangeOrigin } from './change';\nimport assert from '../util/assert';\nimport * as performanceTool from '../util/performance';\nimport { PropertyType } from './propertyType';\nimport { GameEvent } from './eventDispatcher';\n\nlet changesEnabled = true;\nlet scenePropertyFilter = null;\n// true / false to enable / disable property value change sharing.\n// if object is passed, changes are only sent\nexport function filterSceneChanges(_scenePropertyFilter) {\n\tscenePropertyFilter = _scenePropertyFilter;\n\tchangesEnabled = true;\n}\n\nexport function disableAllChanges() {\n\tchangesEnabled = false;\n}\n\nexport function enableAllChanges() {\n\tchangesEnabled = true;\n}\n\nexport function executeWithoutEntityPropertyChangeCreation(task) {\n\tlet oldChangesEnabled = changesEnabled;\n\tchangesEnabled = false;\n\ttask();\n\tchangesEnabled = oldChangesEnabled;\n}\n\n// Object of a property\nexport default class Property extends Serializable {\n\t_value: any;\n\t_initialValue: any;\n\tname: any;\n\tpropertyType: PropertyType;\n\t_initialValueIsJSON: boolean = false;\n\n\t// set skipSerializableRegistering=true if you are not planning to add this property to the hierarchy\n\t// if you give propertyType, value in real value form\n\t// if you don't give propertyType (give it later), value as JSON form\n\tconstructor({ value, predefinedId = '', name, propertyType = null, skipSerializableRegistering = false }) {\n\t\tsuper(predefinedId, skipSerializableRegistering);\n\t\tassert(name, 'Property without a name can not exist');\n\t\tthis._initialValue = value;\n\t\tif (propertyType)\n\t\t\tthis.setPropertyType(propertyType);\n\t\telse {\n\t\t\tthis.name = name;\n\t\t\tthis._initialValueIsJSON = true;\n\t\t}\n\t}\n\tmakeUpAName() {\n\t\treturn this.name;\n\t}\n\tsetPropertyType(propertyType) {\n\t\tthis.propertyType = propertyType;\n\t\ttry {\n\t\t\tif (this._initialValue !== undefined)\n\t\t\t\tthis.value = this._initialValueIsJSON ? propertyType.type.fromJSON(this._initialValue) : this._initialValue;\n\t\t\telse\n\t\t\t\tthis.value = propertyType.initialValue;\n\t\t} catch(e) {\n\t\t\tconsole.log('Invalid value', e, propertyType, this);\n\t\t\tthis.value = propertyType.initialValue;\n\t\t}\n\t\tthis.name = propertyType.name;\n\t}\n\tclone(skipSerializableRegistering = false) {\n\t\treturn new Property({\n\t\t\tvalue: this.propertyType.type.clone(this.value),\n\t\t\tname: this.name,\n\t\t\tpropertyType: this.propertyType,\n\t\t\tskipSerializableRegistering\n\t\t});\n\t}\n\ttoJSON() {\n\t\treturn Object.assign(super.toJSON(), {\n\t\t\tv: this.type.toJSON(this.value),\n\t\t\tn: this.propertyType.name\n\t\t});\n\t}\n\n\tvalueEquals(otherValue) {\n\t\treturn this.propertyType.type.equal(this._value,otherValue);\n\t}\n\n\tget type() {\n\t\treturn this.propertyType.type;\n\t}\n\n\tset value(newValue) {\n\t\tlet oldValue = this._value;\n\t\tthis._value = this.propertyType.validator.validate(newValue);\n\n\t\tthis.dispatch(GameEvent.PROPERTY_VALUE_CHANGE, this._value, oldValue);\n\t\tif (changesEnabled && this._rootType) { // not scene or empty\n\t\t\tif (scenePropertyFilter === null\n\t\t\t\t|| this._rootType !== 'sce'\n\t\t\t\t|| scenePropertyFilter(this)\n\t\t\t) {\n\t\t\t\taddChange(changeType.setPropertyValue, this);\n\t\t\t}\n\t\t}\n\t}\n\tget value() {\n\t\treturn this._value;\n\t}\n}\nProperty.prototype.propertyType = null;\n\nSerializable.registerSerializable(Property, 'prp', json => {\n\treturn new Property({\n\t\tvalue: json.v,\n\t\tpredefinedId: json.id,\n\t\tname: json.n\n\t});\n});\n\nObject.defineProperty(Property.prototype, 'debug', {\n\tget() {\n\t\treturn `prp ${this.name}=${this.value}`;\n\t}\n});\n","import assert from '../util/assert';\nimport Property from './property';\nimport { DataTypeContainer } from './dataTypes';\n// info about type, validator, validatorParameters, initialValue\n\nexport class PropertyType {\n\tflags: any;\n\tconstructor(\n\t\tpublic name: string,\n\t\tpublic type: DataType,\n\t\tpublic validator,\n\t\tpublic initialValue,\n\t\tpublic description: string,\n\t\tflags: Array<any> = [],\n\t\tpublic visibleIf\n\t) {\n\t\tassert(name[0] >= 'a' && name[0] <= 'z', 'Name of a property must start with lower case letter.');\n\t\tassert(type && typeof type.name === 'string');\n\t\tassert(validator && typeof validator.validate === 'function');\n\n\t\tthis.name = name;\n\t\tthis.type = type;\n\t\tthis.validator = validator;\n\t\tthis.initialValue = initialValue;\n\t\tthis.description = description;\n\t\tthis.visibleIf = visibleIf;\n\t\tthis.flags = {};\n\t\tflags.forEach(f => this.flags[f.type] = f);\n\t}\n\tgetFlag(flag: Flag) {\n\t\treturn this.flags[flag.type];\n\t}\n\tcreateProperty({\n\t\tvalue,\n\t\tpredefinedId,\n\t\tskipSerializableRegistering = false\n\t}: CreatePropertyParameters = {}) {\n\t\treturn new Property({\n\t\t\tpropertyType: this,\n\t\t\tvalue,\n\t\t\tpredefinedId,\n\t\t\tname: this.name,\n\t\t\tskipSerializableRegistering\n\t\t});\n\t}\n}\n\ntype CreatePropertyParameters = {\n\tvalue?: any;\n\tpredefinedId?: string;\n\tskipSerializableRegistering?: boolean;\n}\n\nexport interface PropType extends Function, DataTypeContainer {\n\tvisibleIf?: (propertyName: string, value: any) => any;\n}\n\n/*\n\tBeautiful way of creating property types\n\n\toptionalParameters:\n\t\tdescription: 'Example',\n\t\tvalidator: PropertyType.\n */\n/**\n *\n * @param propertyName - name of property. name will be converted propertyName -> Property Name in editor.\n * @param defaultValue - initial value of property\n * @param type - Prop.<type>, for example Prop.int, Prop.bool, prop.float\n * @param optionalParameters - \"description\", validator Prop.float.range(0, 1)\n */\nconst Prop: PropType = function Prop(propertyName: string, defaultValue: any, type: DataTypeDefinition, ...optionalParameters) {\n\tlet dataType = type();\n\tlet validator = dataType.validators.default();\n\tlet description = '';\n\tlet flags = [];\n\tlet visibleIf = null;\n\toptionalParameters.forEach((p, idx) => {\n\t\tif (typeof p === 'string')\n\t\t\tdescription = p;\n\t\telse if (p && p.validate)\n\t\t\tvalidator = p;\n\t\telse if (p && p.isFlag)\n\t\t\tflags.push(p);\n\t\telse if (p && p.visibleIf)\n\t\t\tvisibleIf = p;\n\t\telse\n\t\t\tassert(false, 'invalid parameter ' + p + ' idx ' + idx);\n\t});\n\treturn new PropertyType(propertyName, dataType, validator, defaultValue, description, flags, visibleIf);\n};\n\nexport default Prop;\n\n// if value is string, property must be value\n// if value is an array, property must be one of the values\nProp.visibleIf = function (propertyName: string, value: any) {\n\tassert(typeof propertyName === 'string' && propertyName.length);\n\tassert(typeof value !== 'undefined');\n\treturn {\n\t\tvisibleIf: true,\n\t\tpropertyName,\n\t\tvalues: Array.isArray(value) ? value : [value]\n\t};\n};\n\ntype Flag = {\n\ttype: string;\n\tisFlag: boolean;\n};\nfunction createFlag(type: string, func: any = {}): Flag {\n\tfunc.isFlag = true;\n\tfunc.type = type;\n\treturn func;\n}\n\nexport interface PropType {\n\tflagDegreesInEditor?: Flag;\n}\nProp.flagDegreesInEditor = createFlag('degreesInEditor');\n\ntype DataType = {\n\tname: string;\n\tvalidators?: { [s: string]: Function };\n\ttoJSON?: Function;\n\tfromJSON?: Function;\n\tclone?: Function;\n\tequal?: (a, b) => boolean\n};\nexport type DataTypeDefinition = Function;\n\nexport function createDataType({\n\tname = '',\n\tvalidators = { default: x => x }, // default must exist. if value is a reference(object), validator should copy the value.\n\ttoJSON = x => x,\n\tfromJSON = x => x,\n\tclone = x => x,\n\tequal = (a, b) => a === b\n}: DataType): DataTypeDefinition {\n\tassert(name, 'name missing from property type');\n\tassert(typeof validators.default === 'function', 'default validator missing from property type: ' + name);\n\tassert(typeof toJSON === 'function', 'invalid toJSON for property type: ' + name);\n\tassert(typeof fromJSON === 'function', 'invalid fromJSON for property type: ' + name);\n\n\tlet type: DataType = {\n\t\tname,\n\t\tvalidators,\n\t\ttoJSON,\n\t\tfromJSON,\n\t\tclone,\n\t\tequal\n\t};\n\tlet createType = () => type;\n\n\tObject.keys(validators).forEach(validatorName => {\n\t\tcreateType[validatorName] = createValidator(validatorName, validators[validatorName]);\n\t\tvalidators[validatorName] = createType[validatorName];\n\t});\n\treturn createType;\n}\n\ntype Validator = {\n\tvalidate?: Function,\n\tvalidatorName?: string,\n\tparameters?: Array<any>\n};\n\nfunction createValidator(name: string, validatorFunction: Function): Validator {\n\tlet validator: any = function (...args): Validator {\n\t\tlet parameters = args;\n\t\tlet validatorArgs = [null, ...args];\n\t\treturn {\n\t\t\tvalidatorName: name,\n\t\t\tvalidate: function (x) {\n\t\t\t\tvalidatorArgs[0] = x;\n\t\t\t\treturn validatorFunction.apply(null, validatorArgs);\n\t\t\t},\n\t\t\tparameters\n\t\t};\n\t};\n\tvalidator.validatorName = name;\n\tvalidator.validate = validatorFunction;\n\treturn validator;\n}\n","export default class Vector {\n\tx: number;\n\ty: number;\n\tconstructor(x: number, y: number) {\n\t\tthis.x = x || 0;\n\t\tthis.y = y || 0;\n\t}\n\tadd(vec: Vector) {\n\t\tthis.x += vec.x;\n\t\tthis.y += vec.y;\n\t\treturn this;\n\t}\n\taddScalars(x: number, y: number) {\n\t\tthis.x += x;\n\t\tthis.y += y;\n\t\treturn this;\n\t}\n\tsubtract(vec: Vector) {\n\t\tthis.x -= vec.x;\n\t\tthis.y -= vec.y;\n\t\treturn this;\n\t}\n\tsubtractScalars(x: number, y: number) {\n\t\tthis.x -= x;\n\t\tthis.y -= y;\n\t\treturn this;\n\t}\n\tmultiply(vec: Vector) {\n\t\tthis.x *= vec.x;\n\t\tthis.y *= vec.y;\n\t\treturn this;\n\t}\n\tmultiplyScalar(scalar: number) {\n\t\tthis.x *= scalar;\n\t\tthis.y *= scalar;\n\t\treturn this;\n\t}\n\tdivide(vec: Vector) {\n\t\tthis.x /= vec.x;\n\t\tthis.y /= vec.y;\n\t\treturn this;\n\t}\n\tdivideScalar(scalar: number) {\n\t\tthis.x /= scalar;\n\t\tthis.y /= scalar;\n\t\treturn this;\n\t}\n\tdot(vec: Vector) {\n\t\treturn this.x * vec.x + this.y * vec.y;\n\t}\n\tlength(): number {\n\t\treturn Math.sqrt(this.x * this.x + this.y * this.y);\n\t}\n\tlengthSq(): number {\n\t\treturn this.x * this.x + this.y * this.y;\n\t}\n\tsetLength(newLength: number) {\n\t\tlet oldLength = this.length();\n\n\t\tif (oldLength === 0) {\n\t\t\tthis.x = newLength;\n\t\t\tthis.y = 0;\n\t\t} else {\n\t\t\tthis.multiplyScalar(newLength / oldLength);\n\t\t}\n\t\treturn this;\n\t}\n\tgetProjectionOn(vec: Vector) {\n\t\tlet length = vec.length();\n\t\tif (length === 0)\n\t\t\treturn this.clone();\n\t\telse\n\t\t\treturn vec.clone().multiplyScalar(this.dot(vec) / (length * length));\n\t}\n\tdistance(vec: Vector) {\n\t\tlet dx = this.x - vec.x,\n\t\t\tdy = this.y - vec.y;\n\t\treturn Math.sqrt(dx * dx + dy * dy);\n\t}\n\tdistanceSq(vec: Vector) {\n\t\tlet dx = this.x - vec.x,\n\t\t\tdy = this.y - vec.y;\n\t\treturn dx * dx + dy * dy;\n\t}\n\t// returns 0 .. pi\n\tangleTo(vec: Vector) {\n\t\tlet lengthPart = this.length() * vec.length();\n\t\tif (lengthPart > 0) {\n\t\t\treturn Math.acos(this.dot(vec) / lengthPart);\n\t\t} else {\n\t\t\treturn 0;\n\t\t}\n\t}\n\t// returns 0 .. pi / 2\n\tclosestAngleTo(vec: Vector) {\n\t\tlet angle = Math.abs(this.angleTo(vec));\n\t\tif (angle > Math.PI * 0.5) {\n\t\t\treturn Math.abs(Math.PI - angle);\n\t\t} else {\n\t\t\treturn angle;\n\t\t}\n\t}\n\tnormalize() {\n\t\treturn this.setLength(1);\n\t}\n\thorizontalAngle() {\n\t\treturn Math.atan2(this.y, this.x);\n\t}\n\tverticalAngle() {\n\t\treturn Math.atan2(this.x, this.y);\n\t}\n\trotate(angle: number) {\n\t\tlet x = this.x * Math.cos(angle) - this.y * Math.sin(angle);\n\t\tthis.y = this.x * Math.sin(angle) + this.y * Math.cos(angle);\n\t\tthis.x = x;\n\n\t\treturn this;\n\t}\n\trotateTo(angle: number) {\n\t\treturn this.rotate(angle - this.verticalAngle());\n\t}\n\tisEqualTo(vec: Vector) {\n\t\treturn this.x === vec.x && this.y === vec.y;\n\t}\n\tisZero(): boolean {\n\t\treturn !this.x && !this.y;\n\t}\n\tclone(): Vector {\n\t\treturn new Vector(this.x, this.y);\n\t}\n\tset(vec: Vector) {\n\t\tthis.x = vec.x;\n\t\tthis.y = vec.y;\n\t\treturn this;\n\t}\n\tsetScalars(x: number, y: number) {\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\treturn this;\n\t}\n\ttoString(): string {\n\t\treturn `[${this.x}, ${this.y}]`;\n\t}\n\ttoArray(): Array<number> {\n\t\treturn [this.x, this.y];\n\t}\n\tinterpolateLinear(other: Vector, t: number): Vector {\n\t\treturn new Vector(this.x + (other.x - this.x) * t, this.y + (other.y - this.y) * t);\n\t}\n\tinterpolateCubic(other: Vector, control1: Vector, control2: Vector, t: number): Vector {\n\t\tlet t2 = 1 - t;\n\t\treturn new Vector(\n\t\t\tt2 ** 3 * this.x +\n\t\t\t3 * t2 * t2 * t * control1.x +\n\t\t\t3 * t2 * t * t * control2.x +\n\t\t\tt ** 3 * other.x,\n\t\t\tt2 ** 3 * this.y +\n\t\t\t3 * t2 * t2 * t * control1.y +\n\t\t\t3 * t2 * t * t * control2.y +\n\t\t\tt ** 3 * other.y);\n\t}\n\n\tstatic fromObject(obj: { x: number, y: number }) {\n\t\treturn new Vector(obj.x, obj.y);\n\t};\n\tstatic fromArray(obj) {\n\t\treturn new Vector(obj[0], obj[1]);\n\t};\n}\n","import assert from './assert'\n\nfunction isColor(color) {\n\n}\n\nexport class Color {\n\tr: number;\n\tg: number;\n\tb: number;\n\tconstructor(r: number | Color | string, g?: number, b?: number) {\n\t\tif (r instanceof Color) {\n\t\t\tthis.r = r.r;\n\t\t\tthis.g = r.g;\n\t\t\tthis.b = r.b;\n\t\t} else if (typeof r === 'number') {\n\t\t\tthis.r = Math.round(r);\n\t\t\tthis.g = Math.round(g);\n\t\t\tthis.b = Math.round(b);\n\t\t} else if (typeof r === 'string') {\n\t\t\tlet rgb = hexToRgb(r);\n\t\t\tthis.r = rgb.r;\n\t\t\tthis.g = rgb.g;\n\t\t\tthis.b = rgb.b;\n\t\t} else {\n\t\t\tassert(false, 'Invalid Color parameters');\n\t\t}\n\t}\n\ttoHexString() {\n\t\treturn rgbToHex(this.r, this.g, this.b);\n\t}\n\ttoHexNumber() {\n\t\treturn this.r * 256 * 256 + this.g * 256 + this.b;\n\t}\n\ttoString() {\n\t\treturn `[${this.r},${this.g},${this.b}]`;\n\t}\n\t/**\n\t *\n\t * @param color Color to interpolate to\n\t * @param t 0 .. 1\n\t */\n\tinterpolateLinear(color: Color, t: number) {\n\t\treturn new Color(\n\t\t\tthis.r + (color.r - this.r) * t,\n\t\t\tthis.g + (color.g - this.g) * t,\n\t\t\tthis.b + (color.b - this.b) * t\n\t\t);\n\t}\n\tinterpolateCubic(color: Color, control1: Color, control2: Color, t: number) {\n\t\tlet t2 = 1 - t;\n\t\treturn new Color(\n\t\t\tt2 ** 3 * this.r +\n\t\t\t\t3 * t2 * t2 * t * control1.r +\n\t\t\t\t3 * t2 * t * t * control2.r +\n\t\t\t\tt ** 3 * color.r,\n\t\t\tt2 ** 3 * this.g +\n\t\t\t\t3 * t2 * t2 * t * control1.g +\n\t\t\t\t3 * t2 * t * t * control2.g +\n\t\t\t\tt ** 3 * color.g,\n\t\t\tt2 ** 3 * this.b +\n\t\t\t\t3 * t2 * t2 * t * control1.b +\n\t\t\t\t3 * t2 * t * t * control2.b +\n\t\t\t\tt ** 3 * color.b\n\t\t);\n\t}\n\tisEqualTo(other: Color) {\n\t\treturn this.r === other.r && this.g === other.g && this.b === other.b;\n\t}\n\tstatic fromHexString(hexString: string) {\n\t\tlet rgb = hexToRgb(hexString);\n\t\treturn new Color(rgb.r, rgb.g, rgb.b);\n\t}\n}\n\nexport function hexToRgb(hex) {\n\tvar result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n\treturn result ? {\n\t\tr: parseInt(result[1], 16),\n\t\tg: parseInt(result[2], 16),\n\t\tb: parseInt(result[3], 16)\n\t} : null;\n}\n\nexport function componentToHex(c: number) {\n\tvar hex = c.toString(16);\n\treturn hex.length == 1 ? \"0\" + hex : hex;\n}\n\nexport function rgbToHex(r: number, g: number, b: number) {\n\treturn \"#\" + componentToHex(r) + componentToHex(g) + componentToHex(b);\n}\n\nexport function isHexString(hex: string) {\n\treturn hex && hex.match(/^#[0-9a-f]{6}$/i) ? true : false;\n}\n","import assert from '../util/assert';\nimport Prop, { createDataType, PropType, DataTypeDefinition } from './propertyType';\nimport Vector from '../util/vector';\nimport { isHexString, Color } from '../util/color';\n\nfunction validateFloat(val) {\n\tif (isNaN(val) || val === Infinity || val === -Infinity)\n\t\tthrow new Error('Invalid float: ' + val);\n}\n\nconst FLOAT_JSON_PRECISION = 4;\nconst FLOAT_JSON_PRECISION_MULTIPLIER = Math.pow(10, FLOAT_JSON_PRECISION);\nconst FLOAT_DELTA = 0.0000001;\n\nexport interface DataTypeContainer {\n\tfloat?: Function & {\n\t\trange?: (min: number, max: number) => number,\n\t\tmodulo?: (min: number, max: number) => number\n\t};\n}\nProp.float = createDataType({\n\tname: 'float',\n\tvalidators: {\n\t\tdefault(x) {\n\t\t\tx = parseFloat(x);\n\t\t\t// @ifndef OPTIMIZE\n\t\t\tvalidateFloat(x);\n\t\t\t// @endif\n\t\t\treturn x;\n\t\t},\n\t\t// PropertyType.float.range(min, max)\n\t\trange(x: number, min: number, max: number): number {\n\t\t\tx = Number(x);\n\t\t\tvalidateFloat(x);\n\t\t\treturn Math.min(max, Math.max(min, x));\n\t\t},\n\t\tmodulo(x, min, max) {\n\t\t\tx = Number(x);\n\t\t\tvalidateFloat(x);\n\n\t\t\tlet range = max - min;\n\n\t\t\tif (x < min) {\n\t\t\t\tx += (((min - x) / range | 0) + 1) * range;\n\t\t\t} else if (x > max - FLOAT_DELTA) {\n\t\t\t\tx -= (((x - max) / range | 0) + 1) * range;\n\t\t\t}\n\n\t\t\treturn x;\n\t\t}\n\t},\n\ttoJSON: x => Math.round(x * FLOAT_JSON_PRECISION_MULTIPLIER) / FLOAT_JSON_PRECISION_MULTIPLIER,\n\tfromJSON: x => x\n});\n\nexport interface DataTypeContainer {\n\tint?: Function & {\n\t\trange?: (min: number, max: number) => number\n\t};\n}\nProp.int = createDataType({\n\tname: 'int',\n\tvalidators: {\n\t\tdefault(x) {\n\t\t\tx = parseInt(x);\n\t\t\t// @ifndef OPTIMIZE\n\t\t\tvalidateFloat(x);\n\t\t\t// @endif\n\t\t\treturn x;\n\t\t},\n\t\t// PropertyType.float.range(min, max)\n\t\trange(x, min, max) {\n\t\t\tx = parseInt(x);\n\t\t\tvalidateFloat(x);\n\t\t\treturn Math.min(max, Math.max(min, x));\n\t\t}\n\t},\n\ttoJSON: x => x,\n\tfromJSON: x => x\n});\n\nexport interface DataTypeContainer { vector?: DataTypeDefinition; }\nProp.vector = createDataType({\n\tname: 'vector',\n\tvalidators: {\n\t\tdefault(vec) {\n\t\t\t// @ifndef OPTIMIZE\n\t\t\tif (!(vec instanceof Vector))\n\t\t\t\tthrow new Error();\n\t\t\t// @endif\n\t\t\tvec = vec.clone();\n\t\t\t// @ifndef OPTIMIZE\n\t\t\tvec.x = parseFloat(vec.x);\n\t\t\tvec.y = parseFloat(vec.y);\n\t\t\tvalidateFloat(vec.x);\n\t\t\tvalidateFloat(vec.y);\n\t\t\t// @endif\n\t\t\treturn vec;\n\t\t}\n\t},\n\ttoJSON: vec => ({\n\t\tx: Math.round(vec.x * FLOAT_JSON_PRECISION_MULTIPLIER) / FLOAT_JSON_PRECISION_MULTIPLIER,\n\t\ty: Math.round(vec.y * FLOAT_JSON_PRECISION_MULTIPLIER) / FLOAT_JSON_PRECISION_MULTIPLIER\n\t}),\n\tfromJSON: vec => Vector.fromObject(vec),\n\tclone: vec => vec.clone(),\n\tequal: (a: Vector, b: Vector) => a.isEqualTo(b)\n});\n\nexport interface DataTypeContainer { string?: DataTypeDefinition; }\nProp.string = createDataType({\n\tname: 'string',\n\tvalidators: {\n\t\tdefault: x => x ? String(x) : ''\n\t},\n\ttoJSON: x => x,\n\tfromJSON: x => x\n});\n\n// longString can have longer length in editor input\nexport interface DataTypeContainer { longString?: DataTypeDefinition; }\nProp.longString = createDataType({\n\tname: 'longString',\n\tvalidators: {\n\t\tdefault: x => x ? String(x) : ''\n\t},\n\ttoJSON: x => x,\n\tfromJSON: x => x\n});\n\nexport interface DataTypeContainer { bool?: DataTypeDefinition; }\nProp.bool = createDataType({\n\tname: 'bool',\n\tvalidators: {\n\t\tdefault(x) {\n\t\t\tif (typeof x !== 'boolean')\n\t\t\t\tthrow new Error();\n\t\t\treturn x;\n\t\t}\n\t},\n\ttoJSON: x => x ? 1 : 0,\n\tfromJSON: x => !!x\n});\n\nexport interface DataTypeContainer {\n\tenum?: Function & {\n\t\tvalues?: (...values: Array<string>) => string\n\t};\n}\nProp.enum = createDataType({\n\tname: 'enum',\n\tvalidators: {\n\t\tdefault() {\n\t\t\tassert(false, `also specify enum values with Prop.enum.values('value1', 'value2', ...)`);\n\t\t},\n\t\tvalues(x, ...values) {\n\t\t\tif (!Array.isArray(values))\n\t\t\t\tthrow new Error();\n\t\t\tif (typeof x !== 'string')\n\t\t\t\tthrow new Error('val should be string');\n\t\t\tif (values.indexOf(x) < 0)\n\t\t\t\tthrow new Error(`value ${x} not in enum: [${values}]`);\n\t\t\treturn x;\n\t\t}\n\t},\n\ttoJSON: x => x,\n\tfromJSON: x => x\n});\n\nexport interface DataTypeContainer { color?: DataTypeDefinition; }\nProp.color = createDataType({\n\tname: 'color',\n\tvalidators: {\n\t\tdefault(color) {\n\t\t\tlet newColor = new Color(color);\n\t\t\t// @ifndef OPTIMIZE\n\t\t\tassert(newColor.r >= 0 && newColor.r < 256);\n\t\t\tassert(newColor.g >= 0 && newColor.g < 256);\n\t\t\tassert(newColor.b >= 0 && newColor.b < 256);\n\t\t\t// @endif\n\t\t\treturn newColor;\n\t\t}\n\t},\n\ttoJSON: x => x.toHexString(),\n\tfromJSON: x => new Color(x),\n\tequal: (a: Color, b: Color) => a.isEqualTo(b)\n});\n","import Serializable from './serializable';\nimport assert from '../util/assert';\nimport { getSerializable } from './serializableManager';\nimport { PropertyType } from './propertyType';\nexport { default as Prop } from './propertyType';\nimport Property from './property';\n\nexport interface PropertyOwnerClass {\n\t_propertyTypes: Array<PropertyType>;\n\t_propertyTypesByName: { [s: string]: PropertyType };\n}\n\nexport default class PropertyOwner extends Serializable {\n\t_properties: { [name: string]: Property } = {};\n\t_propertyOwnerClass: PropertyOwnerClass; // use prototype's value\n\n\tconstructor(predefinedId?: string) {\n\t\tsuper(predefinedId);\n\t\tassert(Array.isArray(this._propertyOwnerClass._propertyTypes), 'call PropertyOwner.defineProperties after class definition');\n\t}\n\tmakeUpAName() {\n\t\treturn (this as any).name || 'PropertyOwner';\n\t}\n\t// Just a helper\n\tinitWithPropertyValues(values: { [key: string]: any } = {}) {\n\t\tlet children = [];\n\n\t\tObject.keys(values).forEach(propName => {\n\t\t\tlet propertyType = this._propertyOwnerClass._propertyTypesByName[propName];\n\t\t\tassert(propertyType, 'Invalid property ' + propName);\n\t\t\tchildren.push(propertyType.createProperty({\n\t\t\t\tvalue: values[propName]\n\t\t\t}));\n\t\t});\n\t\tthis.initWithChildren(children);\n\t\treturn this;\n\t}\n\tinitWithChildren(children: Array<Serializable> = []) {\n\t\tassert(!(this._state & Serializable.STATE_INIT), 'init already done');\n\t\tthis._state |= Serializable.STATE_INIT;\n\n\t\tlet propChildren: Array<Property> = [];\n\t\tlet otherChildren: Array<Serializable> = [];\n\t\t// Separate Property children and other children\n\t\tchildren.forEach(child => {\n\t\t\tif (child.threeLetterType === 'prp') {\n\t\t\t\tpropChildren.push(child as Property);\n\t\t\t} else {\n\t\t\t\totherChildren.push(child);\n\t\t\t}\n\t\t});\n\t\tsuper.addChildren(otherChildren);\n\n\t\tlet invalidPropertiesCount = 0;\n\n\t\tlet propertyIdToInvalid = {};\n\n\t\t// Make sure Properties have a PropertyType. They don't work without it.\n\t\tpropChildren.filter(prop => !prop.propertyType).forEach(prop => {\n\t\t\tlet propertyType = (this.constructor as any as PropertyOwnerClass)._propertyTypesByName[prop.name];\n\t\t\tif (!propertyType) {\n\t\t\t\tconsole.log('Property of that name not defined', this.id, prop.name, this);\n\t\t\t\tinvalidPropertiesCount++;\n\t\t\t\tpropertyIdToInvalid[prop.id] = true;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tprop.setPropertyType(propertyType);\n\t\t});\n\t\tif (invalidPropertiesCount)\n\t\t\tpropChildren = propChildren.filter(p => !propertyIdToInvalid[p.id]);\n\n\t\t// Make sure all PropertyTypes have a matching Property\n\t\tlet nameToProp = {};\n\t\tpropChildren.forEach(c => nameToProp[c.name] = c);\n\t\tthis._propertyOwnerClass._propertyTypes.forEach(propertyType => {\n\t\t\tif (!nameToProp[propertyType.name])\n\t\t\t\tpropChildren.push(propertyType.createProperty());\n\t\t});\n\n\t\tsuper.addChildren(propChildren);\n\t\treturn this;\n\t}\n\taddChild(child: Serializable): PropertyOwner {\n\t\tassert(this._state & Serializable.STATE_INIT, this.constructor + ' requires that initWithChildren will be called before addChild');\n\t\tsuper.addChild(child);\n\t\tif (child.threeLetterType === 'prp') {\n\t\t\tif (!(child as Property).propertyType) {\n\t\t\t\tif (!this._propertyOwnerClass._propertyTypesByName[(child as Property).name]) {\n\t\t\t\t\tconsole.log('Property of that name not defined', this.id, child, this);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t(child as Property).setPropertyType(this._propertyOwnerClass._propertyTypesByName[(child as Property).name]);\n\t\t\t}\n\t\t\tassert(this._properties[(child as Property).propertyType.name] === undefined, 'Property already added');\n\t\t\tthis._properties[(child as Property).propertyType.name] = (child as Property);\n\t\t}\n\t\treturn this;\n\t}\n\tcreatePropertyHash() {\n\t\treturn this.getChildren('prp').map(property => '' + (property as Property)._value).join(',');\n\t}\n\tdelete() {\n\t\tif (!super.delete()) return false;\n\t\tthis._properties = {};\n\t\treturn true;\n\t}\n\t// idx is optional\n\tdeleteChild(child: Serializable, idx?: number) {\n\t\tassert(child.threeLetterType !== 'prp', 'Can not delete just one Property child.');\n\t\tsuper.deleteChild(child, idx);\n\t\treturn this;\n\t}\n\n\tstatic defineProperties(Class: { new(...args): Serializable }, propertyTypes: Array<PropertyType>) {\n\t\tClass.prototype._propertyOwnerClass = Class;\n\t\tlet ClassAsTypeHolder = Class as any as PropertyOwnerClass;\n\t\t// debugger;\n\t\tif (!ClassAsTypeHolder._propertyTypes) {\n\t\t\tClassAsTypeHolder._propertyTypes = [];\n\t\t}\n\t\tClassAsTypeHolder._propertyTypes.push(...propertyTypes);\n\t\tClassAsTypeHolder._propertyTypesByName = {};\n\n\t\tClassAsTypeHolder._propertyTypes.forEach(propertyType => {\n\t\t\tconst propertyTypeName = propertyType.name;\n\t\t\tassert(!Class.prototype.hasOwnProperty(propertyTypeName), 'Property name ' + propertyTypeName + ' clashes');\n\t\t\tClassAsTypeHolder._propertyTypesByName[propertyTypeName] = propertyType;\n\t\t\tObject.defineProperty(Class.prototype, propertyTypeName, {\n\t\t\t\tget() {\n\t\t\t\t\tif (!this._properties[propertyTypeName])\n\t\t\t\t\t\tdebugger;\n\t\t\t\t\treturn this._properties[propertyTypeName].value;\n\t\t\t\t},\n\t\t\t\tset(value) {\n\t\t\t\t\tthis._properties[propertyTypeName].value = value;\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t};\n}\n","var HASH = '#'.charCodeAt(0);\nvar DOT = '.'.charCodeAt(0);\n\nvar TAG_NAME = 0;\nvar ID = 1;\nvar CLASS_NAME = 2;\n\nvar parseQuery = function (query) {\n  var tag = null;\n  var id = null;\n  var className = null;\n  var mode = TAG_NAME;\n  var offset = 0;\n\n  for (var i = 0; i <= query.length; i++) {\n    var char = query.charCodeAt(i);\n    var isHash = char === HASH;\n    var isDot = char === DOT;\n    var isEnd = !char;\n\n    if (isHash || isDot || isEnd) {\n      if (mode === TAG_NAME) {\n        if (i === 0) {\n          tag = 'div';\n        } else {\n          tag = query.substring(offset, i);\n        }\n      } else if (mode === ID) {\n        id = query.substring(offset, i);\n      } else {\n        if (className) {\n          className += ' ' + query.substring(offset, i);\n        } else {\n          className = query.substring(offset, i);\n        }\n      }\n\n      if (isHash) {\n        mode = ID;\n      } else if (isDot) {\n        mode = CLASS_NAME;\n      }\n\n      offset = i + 1;\n    }\n  }\n\n  return { tag: tag, id: id, className: className };\n};\n\nvar createElement = function (query, ns) {\n  var ref = parseQuery(query);\n  var tag = ref.tag;\n  var id = ref.id;\n  var className = ref.className;\n  var element = ns ? document.createElementNS(ns, tag) : document.createElement(tag);\n\n  if (id) {\n    element.id = id;\n  }\n\n  if (className) {\n    if (ns) {\n      element.setAttribute('class', className);\n    } else {\n      element.className = className;\n    }\n  }\n\n  return element;\n};\n\nvar unmount = function (parent, child) {\n  var parentEl = getEl(parent);\n  var childEl = getEl(child);\n\n  if (child === childEl && childEl.__redom_view) {\n    // try to look up the view if not provided\n    child = childEl.__redom_view;\n  }\n\n  if (childEl.parentNode) {\n    doUnmount(child, childEl, parentEl);\n\n    parentEl.removeChild(childEl);\n  }\n\n  return child;\n};\n\nvar doUnmount = function (child, childEl, parentEl) {\n  var hooks = childEl.__redom_lifecycle;\n\n  if (hooksAreEmpty(hooks)) {\n    childEl.__redom_mounted = false;\n    return;\n  }\n\n  var traverse = parentEl;\n\n  if (childEl.__redom_mounted) {\n    trigger(childEl, 'onunmount');\n  }\n\n  while (traverse) {\n    var parentHooks = traverse.__redom_lifecycle || {};\n\n    for (var hook in hooks) {\n      if (parentHooks[hook]) {\n        parentHooks[hook] -= hooks[hook];\n      }\n    }\n\n    if (hooksAreEmpty(parentHooks)) {\n      traverse.__redom_lifecycle = null;\n    }\n\n    traverse = traverse.parentNode;\n  }\n};\n\nvar hooksAreEmpty = function (hooks) {\n  if (hooks == null) {\n    return true;\n  }\n  for (var key in hooks) {\n    if (hooks[key]) {\n      return false;\n    }\n  }\n  return true;\n};\n\nvar hookNames = ['onmount', 'onunmount'];\nvar shadowRootAvailable = typeof window !== 'undefined' && 'ShadowRoot' in window;\n\nvar mount = function (parent, child, before) {\n  var parentEl = getEl(parent);\n  var childEl = getEl(child);\n\n  if (child === childEl && childEl.__redom_view) {\n    // try to look up the view if not provided\n    child = childEl.__redom_view;\n  }\n\n  if (child !== childEl) {\n    childEl.__redom_view = child;\n  }\n\n  var wasMounted = childEl.__redom_mounted;\n  var oldParent = childEl.parentNode;\n\n  if (wasMounted && (oldParent !== parentEl)) {\n    doUnmount(child, childEl, oldParent);\n  }\n\n  if (before != null) {\n    parentEl.insertBefore(childEl, getEl(before));\n  } else {\n    parentEl.appendChild(childEl);\n  }\n\n  doMount(child, childEl, parentEl, oldParent);\n\n  return child;\n};\n\nvar doMount = function (child, childEl, parentEl, oldParent) {\n  var hooks = childEl.__redom_lifecycle || (childEl.__redom_lifecycle = {});\n  var remount = (parentEl === oldParent);\n  var hooksFound = false;\n\n  for (var i = 0; i < hookNames.length; i++) {\n    var hookName = hookNames[i];\n\n    if (!remount && (child !== childEl) && (hookName in child)) {\n      hooks[hookName] = (hooks[hookName] || 0) + 1;\n    }\n    if (hooks[hookName]) {\n      hooksFound = true;\n    }\n  }\n\n  if (!hooksFound) {\n    childEl.__redom_mounted = true;\n    return;\n  }\n\n  var traverse = parentEl;\n  var triggered = false;\n\n  if (remount || (!triggered && (traverse && traverse.__redom_mounted))) {\n    trigger(childEl, remount ? 'onremount' : 'onmount');\n    triggered = true;\n  }\n\n  if (remount) {\n    return;\n  }\n\n  while (traverse) {\n    var parent = traverse.parentNode;\n    var parentHooks = traverse.__redom_lifecycle || (traverse.__redom_lifecycle = {});\n\n    for (var hook in hooks) {\n      parentHooks[hook] = (parentHooks[hook] || 0) + hooks[hook];\n    }\n\n    if (!triggered && (traverse === document || (shadowRootAvailable && (traverse instanceof window.ShadowRoot)) || (parent && parent.__redom_mounted))) {\n      trigger(traverse, remount ? 'onremount' : 'onmount');\n      triggered = true;\n    }\n\n    traverse = parent;\n  }\n};\n\nvar trigger = function (el, eventName) {\n  if (eventName === 'onmount') {\n    el.__redom_mounted = true;\n  } else if (eventName === 'onunmount') {\n    el.__redom_mounted = false;\n  }\n\n  var hooks = el.__redom_lifecycle;\n\n  if (!hooks) {\n    return;\n  }\n\n  var view = el.__redom_view;\n  var hookCount = 0;\n\n  view && view[eventName] && view[eventName]();\n\n  for (var hook in hooks) {\n    if (hook) {\n      hookCount++;\n    }\n  }\n\n  if (hookCount) {\n    var traverse = el.firstChild;\n\n    while (traverse) {\n      var next = traverse.nextSibling;\n\n      trigger(traverse, eventName);\n\n      traverse = next;\n    }\n  }\n};\n\nvar setStyle = function (view, arg1, arg2) {\n  var el = getEl(view);\n\n  if (arg2 !== undefined) {\n    el.style[arg1] = arg2;\n  } else if (isString(arg1)) {\n    el.setAttribute('style', arg1);\n  } else {\n    for (var key in arg1) {\n      setStyle(el, key, arg1[key]);\n    }\n  }\n};\n\n/* global SVGElement */\n\nvar xlinkns = 'http://www.w3.org/1999/xlink';\n\nvar setAttr = function (view, arg1, arg2) {\n  var el = getEl(view);\n  var isSVG = el instanceof SVGElement;\n\n  if (arg2 !== undefined) {\n    if (arg1 === 'style') {\n      setStyle(el, arg2);\n    } else if (isSVG && isFunction(arg2)) {\n      el[arg1] = arg2;\n    } else if (arg1 === 'dataset') {\n      setData(el, arg2);\n    } else if (!isSVG && (arg1 in el || isFunction(arg2))) {\n      el[arg1] = arg2;\n    } else {\n      if (isSVG && (arg1 === 'xlink')) {\n        setXlink(el, arg2);\n        return;\n      }\n      el.setAttribute(arg1, arg2);\n    }\n  } else {\n    for (var key in arg1) {\n      setAttr(el, key, arg1[key]);\n    }\n  }\n};\n\nfunction setXlink (el, obj) {\n  for (var key in obj) {\n    el.setAttributeNS(xlinkns, key, obj[key]);\n  }\n}\n\nfunction setData (el, obj) {\n  for (var key in obj) {\n    el.dataset[key] = obj[key];\n  }\n}\n\nvar text = function (str) { return document.createTextNode((str != null) ? str : ''); };\n\nvar parseArguments = function (element, args) {\n  for (var i = 0; i < args.length; i++) {\n    var arg = args[i];\n\n    if (arg !== 0 && !arg) {\n      continue;\n    }\n\n    // support middleware\n    if (typeof arg === 'function') {\n      arg(element);\n    } else if (isString(arg) || isNumber(arg)) {\n      element.appendChild(text(arg));\n    } else if (isNode(getEl(arg))) {\n      mount(element, arg);\n    } else if (arg.length) {\n      parseArguments(element, arg);\n    } else if (typeof arg === 'object') {\n      setAttr(element, arg);\n    }\n  }\n};\n\nvar ensureEl = function (parent) { return isString(parent) ? html(parent) : getEl(parent); };\nvar getEl = function (parent) { return (parent.nodeType && parent) || (!parent.el && parent) || getEl(parent.el); };\n\nvar isString = function (a) { return typeof a === 'string'; };\nvar isNumber = function (a) { return typeof a === 'number'; };\nvar isFunction = function (a) { return typeof a === 'function'; };\n\nvar isNode = function (a) { return a && a.nodeType; };\n\nvar htmlCache = {};\n\nvar memoizeHTML = function (query) { return htmlCache[query] || (htmlCache[query] = createElement(query)); };\n\nvar html = function (query) {\n  var args = [], len = arguments.length - 1;\n  while ( len-- > 0 ) args[ len ] = arguments[ len + 1 ];\n\n  var element;\n\n  if (isString(query)) {\n    element = memoizeHTML(query).cloneNode(false);\n  } else if (isNode(query)) {\n    element = query.cloneNode(false);\n  } else if (isFunction(query)) {\n    var Query = query;\n    element = new (Function.prototype.bind.apply( Query, [ null ].concat( args) ));\n  } else {\n    throw new Error('At least one argument required');\n  }\n\n  parseArguments(getEl(element), args);\n\n  return element;\n};\n\nhtml.extend = function (query) {\n  var args = [], len = arguments.length - 1;\n  while ( len-- > 0 ) args[ len ] = arguments[ len + 1 ];\n\n  var clone = memoizeHTML(query);\n\n  return html.bind.apply(html, [ this, clone ].concat( args ));\n};\n\nvar el = html;\nvar h = html;\n\nvar setChildren = function (parent) {\n  var children = [], len = arguments.length - 1;\n  while ( len-- > 0 ) children[ len ] = arguments[ len + 1 ];\n\n  var parentEl = getEl(parent);\n  var current = traverse(parent, children, parentEl.firstChild);\n\n  while (current) {\n    var next = current.nextSibling;\n\n    unmount(parent, current);\n\n    current = next;\n  }\n};\n\nfunction traverse (parent, children, _current) {\n  var current = _current;\n\n  for (var i = 0; i < children.length; i++) {\n    var child = children[i];\n\n    if (!child) {\n      continue;\n    }\n\n    var childEl = getEl(child);\n\n    if (childEl === current) {\n      current = current.nextSibling;\n      continue;\n    }\n\n    if (isNode(childEl)) {\n      mount(parent, child, current);\n      continue;\n    }\n\n    if (child.length != null) {\n      current = traverse(parent, child, current);\n    }\n  }\n\n  return current;\n}\n\nvar propKey = function (key) { return function (item) { return item[key]; }; };\n\nvar listPool = function (View, key, initData) {\n  return new ListPool(View, key, initData);\n};\n\nvar ListPool = function ListPool (View, key, initData) {\n  this.View = View;\n  this.initData = initData;\n  this.oldLookup = {};\n  this.lookup = {};\n  this.oldViews = [];\n  this.views = [];\n\n  if (key != null) {\n    this.lookup = {};\n    this.key = isFunction(key) ? key : propKey(key);\n  }\n};\nListPool.prototype.update = function update (data, context) {\n  var ref = this;\n    var View = ref.View;\n    var key = ref.key;\n    var initData = ref.initData;\n  var keySet = key != null;\n\n  var oldLookup = this.lookup;\n  var newLookup = {};\n\n  var newViews = new Array(data.length);\n  var oldViews = this.views;\n\n  for (var i = 0; i < data.length; i++) {\n    var item = data[i];\n    var view = (void 0);\n\n    if (keySet) {\n      var id = key(item);\n      view = oldLookup[id] || new View(initData, item, i, data);\n      newLookup[id] = view;\n      view.__redom_id = id;\n    } else {\n      view = oldViews[i] || new View(initData, item, i, data);\n    }\n    view.update && view.update(item, i, data, context);\n\n    var el = getEl(view.el);\n    el.__redom_view = view;\n    newViews[i] = view;\n  }\n\n  this.oldViews = oldViews;\n  this.views = newViews;\n\n  this.oldLookup = oldLookup;\n  this.lookup = newLookup;\n};\n\nvar list = function (parent, View, key, initData) {\n  return new List(parent, View, key, initData);\n};\n\nvar List = function List (parent, View, key, initData) {\n  this.__redom_list = true;\n  this.View = View;\n  this.initData = initData;\n  this.views = [];\n  this.pool = new ListPool(View, key, initData);\n  this.el = ensureEl(parent);\n  this.keySet = key != null;\n};\nList.prototype.update = function update (data, context) {\n    var this$1 = this;\n    if ( data === void 0 ) data = [];\n\n  var ref = this;\n    var keySet = ref.keySet;\n  var oldViews = this.views;\n  var oldLookup = keySet && this.lookup;\n\n  this.pool.update(data, context);\n  var ref$1 = this.pool;\n    var views = ref$1.views;\n    var lookup = ref$1.lookup;\n\n  if (keySet) {\n    for (var i = 0; i < oldViews.length; i++) {\n      var id = oldViews[i].__redom_id;\n      if (!(id in lookup)) {\n        unmount(this$1, oldLookup[id]);\n      }\n    }\n  }\n\n  setChildren(this, views);\n\n  if (keySet) {\n    this.lookup = lookup;\n  }\n  this.views = views;\n};\n\nList.extend = function (parent, View, key, initData) {\n  return List.bind(List, parent, View, key, initData);\n};\n\nlist.extend = List.extend;\n\n/* global Node */\n\nvar place = function (View, initData) {\n  return new Place(View, initData);\n};\n\nvar Place = function Place (View, initData) {\n  this.el = text('');\n  this.visible = false;\n  this.view = null;\n  this._placeholder = this.el;\n  if (View instanceof Node) {\n    this._el = View;\n  } else {\n    this._View = View;\n  }\n  this._initData = initData;\n};\nPlace.prototype.update = function update (visible, data) {\n  var placeholder = this._placeholder;\n  var parentNode = this.el.parentNode;\n\n  if (visible) {\n    if (!this.visible) {\n      if (this._el) {\n        mount(parentNode, this._el, placeholder);\n        unmount(parentNode, placeholder);\n        this.el = this._el;\n        this.visible = visible;\n        return;\n      }\n      var View = this._View;\n      var view = new View(this._initData);\n\n      this.el = getEl(view);\n      this.view = view;\n\n      mount(parentNode, view, placeholder);\n      unmount(parentNode, placeholder);\n    }\n    this.view && this.view.update && this.view.update(data);\n  } else {\n    if (this.visible) {\n      if (this._el) {\n        mount(parentNode, placeholder, this._el);\n        unmount(parentNode, this._el);\n        this.el = placeholder;\n        this.visible = visible;\n        return;\n      }\n      mount(parentNode, placeholder, this.view);\n      unmount(parentNode, this.view);\n\n      this.el = placeholder;\n      this.view = null;\n    }\n  }\n  this.visible = visible;\n};\n\nvar router = function (parent, Views, initData) {\n  return new Router(parent, Views, initData);\n};\n\nvar Router = function Router (parent, Views, initData) {\n  this.el = ensureEl(parent);\n  this.Views = Views;\n  this.initData = initData;\n};\nRouter.prototype.update = function update (route, data) {\n  if (route !== this.route) {\n    var Views = this.Views;\n    var View = Views[route];\n\n    this.route = route;\n    this.view = View && new View(this.initData, data);\n\n    setChildren(this.el, [ this.view ]);\n  }\n  this.view && this.view.update && this.view.update(data, route);\n};\n\nvar ns = 'http://www.w3.org/2000/svg';\n\nvar svgCache = {};\n\nvar memoizeSVG = function (query) { return svgCache[query] || (svgCache[query] = createElement(query, ns)); };\n\nvar svg = function (query) {\n  var args = [], len = arguments.length - 1;\n  while ( len-- > 0 ) args[ len ] = arguments[ len + 1 ];\n\n  var element;\n\n  if (isString(query)) {\n    element = memoizeSVG(query).cloneNode(false);\n  } else if (isNode(query)) {\n    element = query.cloneNode(false);\n  } else if (isFunction(query)) {\n    var Query = query;\n    element = new (Function.prototype.bind.apply( Query, [ null ].concat( args) ));\n  } else {\n    throw new Error('At least one argument required');\n  }\n\n  parseArguments(getEl(element), args);\n\n  return element;\n};\n\nsvg.extend = function (query) {\n  var clone = memoizeSVG(query);\n\n  return svg.bind(this, clone);\n};\n\nsvg.ns = ns;\n\nvar s = svg;\n\nexport { el, h, html, list, List, listPool, ListPool, mount, unmount, place, Place, router, Router, setAttr, setStyle, setChildren, s, svg, text };\n","import {el, mount} from 'redom';\n\nexport function stickyNonModalErrorPopup(text) {\n\tdocument.body.style.filter = 'contrast(70%) brightness(130%) saturate(200%) sepia(40%) hue-rotate(300deg)';\n\n\tlet popup = el('div', text, {\n\t\tstyle: {\n\t\t\t'position': 'fixed',\n\t\t\t'display': 'inline-block',\n\t\t\t'max-width': '600%',\n\t\t\t'top': '20%',\n\t\t\t'width': '100%',\n\t\t\t'padding': '40px 10%',\n\t\t\t'font-size': '20px',\n\t\t\t'z-index': '100000',\n\t\t\t'color': 'white',\n\t\t\t'background': '#0c0c0c',\n\t\t\t'text-align': 'center',\n\t\t\t'user-select': 'auto !important',\n\t\t\t'box-sizing': 'border-box'\n\t\t}\n\t});\n\n\tmount(document.body, popup);\n}\n\nwindow.sticky = stickyNonModalErrorPopup;\n","import { isClient } from '../util/environment';\n\nlet PIXI;\n\nif (isClient) {\n\tPIXI = window['PIXI'];\n\tPIXI.ticker.shared.stop();\n}\n\nexport default PIXI;\n\nlet renderer = null; // Only one PIXI renderer supported for now\n\nexport function getRenderer(canvas: HTMLCanvasElement) {\n\t/*\n\treturn {\n\t\trender: () => {},\n\t\tresize: () => {}\n\t};\n\t*/\n\n\tif (!renderer) {\n\t\trenderer = PIXI.autoDetectRenderer({\n\t\t\tview: canvas,\n\t\t\tautoResize: true,\n\t\t\tantialias: true\n\t\t});\n\n\t\t// Interaction plugin uses ticker that runs in the background. Destroy it to save CPU.\n\t\t// if (renderer.plugins.interaction) // if interaction is left out from pixi build, interaction is no defined\n\t\t// renderer.plugins.interaction.destroy();\n\t}\n\n\treturn renderer;\n}\n\nexport function sortDisplayObjects(container) {\n\tcontainer.children.sort(sortFunc);\n}\nfunction sortFunc(a, b) {\n\tif (a.y < b.y)\n\t\treturn -1;\n\telse if (a.y > b.y)\n\t\treturn 1;\n\telse\n\t\treturn 0;\n}\n\nlet texturesAndAnchors: { [hash: string]: { texture: any, anchor: any, graphicsObject, containsPoint: Function } } = {};\nexport function resetTexturesAndAnchors() {\n\tfor (let i in texturesAndAnchors) {\n\t\ttexturesAndAnchors[i].texture.destroy();\n\t\ttexturesAndAnchors[i].graphicsObject.destroy();\n\t}\n\ttexturesAndAnchors = {};\n}\nexport function getHashedTextureAndAnchor(hash) {\n\treturn texturesAndAnchors[hash];\n}\n/**\n *\n * @param graphicsObject You should not destroy this object after generating texture. It is used for collision testing\n * @param hash\n */\nexport function generateTextureAndAnchor(graphicsObject, hash) {\n\tif (!texturesAndAnchors[hash]) {\n\t\tlet bounds = graphicsObject.getLocalBounds();\n\t\tlet anchor = {\n\t\t\tx: -bounds.x / bounds.width,\n\t\t\ty: -bounds.y / bounds.height\n\t\t};\n\t\ttexturesAndAnchors[hash] = {\n\t\t\ttexture: renderer.generateTexture(graphicsObject, PIXI.SCALE_MODES.LINEAR, 2),\n\t\t\tanchor,\n\t\t\tgraphicsObject,\n\t\t\tcontainsPoint: (point) => {\n\t\t\t\t// Code copied from PIXI.js http://pixijs.download/release/docs/core_graphics_Graphics.js.html#line29\n\n\t\t\t\tfor (let i = 0; i < graphicsObject.graphicsData.length; ++i) {\n\t\t\t\t\tconst data = graphicsObject.graphicsData[i];\n\t\t\t\t\tif (!data.fill) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif (data.shape) {\n\t\t\t\t\t\tif (data.shape.contains(point.x, point.y)) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t};\n\t}\n\treturn texturesAndAnchors[hash];\n}\n\nconst hitTestCanvas = document.createElement('canvas');\nhitTestCanvas.width = 1;\nhitTestCanvas.height = 1;\nconst hitTestContext = hitTestCanvas.getContext('2d');\nexport function hitTest(sprite, pointerDownEvent, stage) {\n\tlet localBounds = sprite.getLocalBounds();\n\tlet textureSource = sprite.texture.baseTexture.source;\n\n\tlet localMousePoint = sprite.toLocal(pointerDownEvent.data.global, stage);\n\tlet xPart = (localMousePoint.x - localBounds.x) / (localBounds.width);\n\tlet yPart = (localMousePoint.y - localBounds.y) / (localBounds.height);\n\n\thitTestCanvas.width = hitTestCanvas.width; // A way to reset contents of the canvas\n\thitTestContext.drawImage(textureSource, textureSource.width * xPart | 0, textureSource.height * yPart | 0, 1, 1, 0, 0, 1, 1);\n\tlet imageData = hitTestContext.getImageData(0, 0, 1, 1);\n\n\t/*\n\tPosition debugging\n\tconst c = document.createElement('canvas');\n\tc.setAttribute('style', 'position: fixed;top:0px;left:0px;');\n\tc.width = src.width;\n\tc.height = src.height;\n\tconst co = c.getContext('2d');\n\tco.drawImage(src, 0, 0);\n\tco.fillStyle = `rgb(${imageData.data[0]},${imageData.data[1]},${imageData.data[2]})`; ['red', 'green', 'blue', 'purple', 'white', 'yellow'][Math.random() * 6 | 0];\n\tco.strokeStyle = 'purple';\n\n\tco.fillRect((src.width * xPart | 0) - 10, (src.width * yPart | 0) - 10, 20, 20);\n\tco.strokeRect(xPart * c.width - 10, yPart * c.height - 10, 20, 20);\n\tdocument.body.appendChild(c);\n\t*/\n\n\treturn imageData.data[3] > 30;\n}\n","import PIXI from '../features/graphics';\nimport Scene from '../core/scene';\nimport { globalEventDispatcher } from '../core/eventDispatcher';\n\nfunction createCanvas() {\n\tconst RESOLUTION = 10;\n\tvar canvas = document.createElement('canvas');\n\tcanvas.width  = 1;\n\tcanvas.height = RESOLUTION;\n\tvar ctx = canvas.getContext('2d');\n\tvar gradient = ctx.createLinearGradient(0, 0, 0, RESOLUTION * 0.8);\n\t// gradient.addColorStop(0, \"#5886c8\");\n\t// gradient.addColorStop(1, \"#9eb6d5\");\n\tgradient.addColorStop(0, \"#5c77ff\");\n\tgradient.addColorStop(1, \"#90c9f6\");\n\tctx.fillStyle = gradient;\n\tctx.fillRect(0, 0, 1, RESOLUTION);\n\treturn canvas;\n}\n\nglobalEventDispatcher.listen('scene load level', (scene: Scene) => {\n\tlet gradientCanvas = createCanvas();\n\tlet sprite = new PIXI.Sprite(PIXI.Texture.fromCanvas(gradientCanvas));\n\tscene['backgroundGradient'] = sprite;\n\tupdateSceneBackgroundGradient(scene);\n\tscene.layers.static.addChild(sprite);\n});\n\nglobalEventDispatcher.listen('scene unload level', (scene: Scene) => {\n\tdelete scene['backgroundGradient'];\n});\n\nglobalEventDispatcher.listen('canvas resize', (scene: Scene) => {\n\tupdateSceneBackgroundGradient(scene);\n});\n\nfunction updateSceneBackgroundGradient(scene: Scene) {\n\tif (!scene.canvas || !scene['backgroundGradient'])\n\t\treturn;\n\n\tscene['backgroundGradient'].width = scene.canvas.width;\n\tscene['backgroundGradient'].height = scene.canvas.height;\n};\n","// @flow\n\nimport Serializable from './serializable'\nimport { addChange, changeType, setChangeOrigin } from './change';\nimport Prototype from './prototype'\nimport assert from '../util/assert'\nimport PropertyOwner, { Prop, PropertyOwnerClass } from './propertyOwner';\nimport { Component } from './component';\nimport {stickyNonModalErrorPopup} from '../util/popup'\nimport '../modules';\nimport { globalEventDispatcher, GameEvent } from './eventDispatcher';\n\nconsole.log('%cOpen Edit Play', 'color: #666; font-size: 16px; text-shadow: 0px 0px 1px #777;');\n\nlet propertyTypes = [\n\tProp('name', 'No name', Prop.string)\n];\n\nlet game: Game = null; // only one game at the time\nexport { game };\n\nlet isClient = typeof window !== 'undefined';\n\nexport default class Game extends PropertyOwner {\n\tconstructor(predefinedId?: string) {\n\t\tif (game)\n\t\t\tconsole.error('Only one game allowed.');\n\n\t\t/*\n\t\tif (isClient) {\n\t\t\tif (game) {\n\t\t\t\ttry {\n\t\t\t\t\tgame.delete();\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.warn('Deleting old game failed', e);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t*/\n\n\t\tsuper(predefinedId);\n\n\t\tif (isClient) {\n\t\t\tgame = this;\n\t\t}\n\n\t\tsetTimeout(() => {\n\t\t\tglobalEventDispatcher.dispatch(GameEvent.GLOBAL_GAME_CREATED, this);\n\t\t}, 1);\n\t}\n\tinitWithChildren(children: Array<Serializable> = []) {\n\t\tlet val = super.initWithChildren(children);\n\t\taddChange(changeType.addSerializableToTree, this);\n\t\treturn val;\n\t}\n\tdelete() {\n\t\taddChange(changeType.deleteSerializable, this);\n\t\tif (!super.delete()) return false;\n\n\t\tif (game === this)\n\t\t\tgame = null;\n\n\t\tstickyNonModalErrorPopup('Game deleted');\n\n\t\treturn true;\n\t}\n}\nPropertyOwner.defineProperties(Game, propertyTypes);\n\nGame.prototype.isRoot = true;\n\n/*\n// Export so that other components can have this component as parent\nComponent.register({\n\tname: 'GameProperties',\n\tdescription: 'Contains all game specific settings',\n\tcategory: 'MainProperties',\n\tallowMultiple: false,\n\tproperties: [\n\t\tProp('gameProperty1', 3, Prop.float, Prop.float.range(0.01, 1000))\n\t]\n});\n*/\n\nSerializable.registerSerializable(Game, 'gam', json => {\n\tif (json.c) {\n\t\tjson.c.sort((a, b) => {\n\t\t\tif (a.id.startsWith('prt') || a.id.startsWith('pfa'))\n\t\t\t\treturn -1;\n\t\t\telse\n\t\t\t\treturn 1;\n\t\t});\n\t}\n\treturn new Game(json.id);\n});\n\nlet gameCreateListeners = [];\nexport function forEachGame(listener: (game: Game) => void) {\n\tglobalEventDispatcher.listen(GameEvent.GLOBAL_GAME_CREATED, listener);\n\n\tif (game)\n\t\tlistener(game);\n}\n","import assert from '../util/assert';\nimport { isClient } from '../util/environment';\n\nlet p2;\nif (isClient)\n\tp2 = window.p2;\nelse\n\tp2 = require('../src/external/p2');\n\nexport default p2;\n\nexport function createWorld(owner, options) {\n\tassert(!owner._p2World);\n\towner._p2World = new p2.World({\n\t\tgravity: [0, 9.81]\n\t\t// gravity: [0, 0]\n\t});\n\n\t// Stress test says that Body sleeping performs better than Island sleeping when idling.\n\towner._p2World.sleepMode = p2.World.BODY_SLEEPING;\n}\n// const MAX_PHYSICS_DT = 0.2;\nconst PHYSICS_DT = 1 / 60;\nexport function updateWorld(owner, dt) {\n\towner._p2World.step(PHYSICS_DT, dt, 5);\n\t// owner._p2World.step(dt, dt, 10);\n}\nexport function deleteWorld(owner) {\n\tif (owner._p2World)\n\t\towner._p2World.clear()\n\tdelete owner._p2World;\n\tdelete owner._p2Materials;\n}\nexport function getWorld(owner) {\n\treturn owner._p2World;\n}\nexport function addBody(owner, body) {\n\towner._p2World.addBody(body);\n}\nexport function deleteBody(owner, body) {\n\towner._p2World.removeBody(body);\n}\n\n// export function addContactMaterial(owner, A, B, options) {\n// \towner._p2World.addContactMaterial(new p2.ContactMaterial(A, B, options));\n// }\n\nconst defaultMaterialOptions = {\n\tfriction: 0.3,\n\trestitution: 0,\n\tstiffness: 1e6, // Hardness of the contact. Less stiffness will make the objects penetrate more, and will make the contact act more like a spring than a contact force.\n\trelaxation: 4, // Original: 3. Small number makes bounce. Big number makes object stay inside another object.\n\tfrictionStiffness: 1e6, // Stiffness of the resulting friction force. For most cases, the value of this property should be a large number. I cannot think of any case where you would want less frictionStiffness.\n\tfrictionRelaxation: 4, // Relaxation of the resulting friction force. The default value should be good for most simulations.\n\tsurfaceVelocity: 0 // Will add surface velocity to this material. If bodyA rests on top if bodyB, and the surface velocity is positive, bodyA will slide to the right.\n};\n\nexport function createMaterial(owner, options) {\n\tif (!owner._p2Materials)\n\t\towner._p2Materials = {};\n\tlet materials = owner._p2Materials;\n\toptions = Object.assign({}, defaultMaterialOptions, options);\n\tlet hash = [\n\t\toptions.friction,\n\t\toptions.restitution,\n\t\toptions.stiffness,\n\t\toptions.relaxation,\n\t\toptions.frictionStiffness,\n\t\toptions.frictionRelaxation,\n\t\toptions.surfaceVelocity\n\t].join(';');\n\n\tif (materials[hash])\n\t\treturn materials[hash];\n\n\tlet material = new p2.Material();\n\tmaterial.options = options;\n\tmaterials[hash] = material;\n\n\t// TODO: When physics entities are edited, new materials are created.\n\t// Should somehow remove old unused materials and contact materials.\n\n\tfor (var h in materials) {\n\t\tlet m = materials[h];\n\t\tlet o1 = material.options;\n\t\tlet o2 = m.options;\n\t\tlet contactMaterial = new p2.ContactMaterial(material, m, {\n\t\t\tfriction:\t\t\t\tMath.min(o1.friction, o2.friction),\n\t\t\trestitution:\t\t\tMath.max(o1.restitution, o2.restitution), // If one is bouncy and other is not, collision is bouncy.\n\t\t\tstiffness:\t\t\t\tMath.min(o1.stiffness, o2.stiffness),\n\t\t\trelaxation:\t\t\t\t(o1.relaxation + o2.relaxation) / 2,\n\t\t\tfrictionStiffness:\t\tMath.min(o1.frictionStiffness, o2.frictionStiffness),\n\t\t\tfrictionRelaxation:\t\t(o1.frictionRelaxation + o2.frictionRelaxation) / 2,\n\t\t\tsurfaceVelocity:\t\tMath.max(o1.surfaceVelocity, o2.surfaceVelocity)\n\t\t});\n\t\towner._p2World.addContactMaterial(contactMaterial);\n\t}\n\n\treturn material;\n}\n","import Vector from './vector';\n\nexport function keyPressed(key) {\n\treturn keys[key] || false;\n}\n\nexport function listenKeyDown(handler) {\n\tkeyDownListeners.push(handler);\n\treturn () => keyDownListeners.splice(keyDownListeners.indexOf(handler), 1);\n}\nexport function listenKeyUp(handler) {\n\tkeyUpListeners.push(handler);\n\treturn () => keyUpListeners.splice(keyUpListeners.indexOf(handler), 1);\n}\n\nexport const key = {\n\tleft: 37,\n\tright: 39,\n\tup: 38,\n\tdown: 40,\n\tctrl: 17,\n\tappleLeft: 91,\n\tappleRight: 93,\n\talt: 18,\n\tshift: 16,\n\tspace: 32,\n\ta: 65,\n\tb: 66,\n\tc: 67,\n\td: 68,\n\te: 69,\n\tf: 70,\n\tg: 71,\n\th: 72,\n\ti: 73,\n\tj: 74,\n\tk: 75,\n\tl: 76,\n\tm: 77,\n\tn: 78,\n\to: 79,\n\tp: 80,\n\tq: 81,\n\tr: 82,\n\ts: 83,\n\tt: 84,\n\tu: 85,\n\tv: 86,\n\tw: 87,\n\tx: 88,\n\ty: 89,\n\tz: 90,\n\t'0': 48,\n\t'1': 49,\n\t'2': 50,\n\t'3': 51,\n\t'4': 52,\n\t'5': 53,\n\t'6': 54,\n\t'7': 55,\n\t'8': 56,\n\t'9': 57,\n\tbackspace: 8,\n\tenter: 13,\n\tesc: 27,\n\tplus: 187,\n\tminus: 189,\n\tquestionMark: 191\n};\n\nlet mouseDown = false;\nexport function isMouseButtonDown() {\n\treturn mouseDown;\n}\n\n\ndocument.addEventListener('mousedown', event => event.button === 0 && (mouseDown = true));\ndocument.addEventListener('mouseup', event => event.button === 0 && (mouseDown = false));\n\nexport function listenMouseMove(element: HTMLElement, handler: (vec: Vector, event?) => void): () => void {\n\tlet domHandler = event => {\n\t\tlet x = event.pageX;\n\t\tlet y = event.pageY;\n\t\tlet el = element;\n\t\twhile (el != null) {\n\t\t\tx -= el.offsetLeft;\n\t\t\ty -= el.offsetTop;\n\t\t\tel = <HTMLElement>el.offsetParent;\n\t\t}\n\n\t\telement['_mx'] = x;\n\t\telement['_my'] = y;\n\n\t\thandler && handler(new Vector(x, y), event);\n\t};\n\telement.addEventListener('mousemove', domHandler);\n\treturn () => element.removeEventListener('mousemove', domHandler);\n}\n// Requires listenMouseMove on the same element to get the mouse position\nexport function listenMouseDown(element: HTMLElement, handler: (vec?: Vector, event?) => void) {\n\tlet domHandler = event => {\n\t\tif (event.button !== 0)\n\t\t\treturn;\n\n\t\tif (typeof element['_mx'] === 'number')\n\t\t\thandler(new Vector(element['_mx'], element['_my']), event);\n\t\telse\n\t\t\thandler(null, event);\n\t};\n\telement.addEventListener('mousedown', domHandler);\n\treturn () => element.removeEventListener('mousedown', domHandler);\n}\n// Requires listenMouseMove on the same element to get the mouse position\nexport function listenMouseUp(element: HTMLElement, handler: (vec?: Vector, event?) => void) {\n\t// listen document body because many times mouse is accidentally dragged outside of element\n\tlet domHandler = event => {\n\t\tif (typeof element['_mx'] === 'number')\n\t\t\thandler(new Vector(element['_mx'], element['_my']), event);\n\t\telse\n\t\t\thandler(null, event);\n\t};\n\tdocument.body.addEventListener('mouseup', domHandler);\n\treturn () => document.body.removeEventListener('mouseup', domHandler);\n}\n\n////////////////////////////////////\n\n\nlet keys = {};\nlet keyDownListeners = [];\nlet keyUpListeners = [];\n\n\nif (typeof window !== 'undefined') {\n\n\twindow.onkeydown = event => {\n\t\tlet keyCode = event.which || event.keyCode;\n\n\t\tif (document.activeElement.nodeName.toLowerCase() == \"input\" && keyCode !== key.esc)\n\t\t\treturn;\n\n\t\tif (!keys[keyCode]) {\n\t\t\tkeys[keyCode] = true;\n\t\t\tkeyDownListeners.forEach(l => l(keyCode));\n\t\t}\n\n\t\t// console.log(keyCode);\n\t};\n\twindow.onkeyup = event => {\n\t\tlet key = event.which || event.keyCode;\n\t\tkeys[key] = false;\n\t\tkeyUpListeners.forEach(l => l(key));\n\t};\n}\n\nexport function simulateKeyEvent(eventName: 'keydown' | 'keyup', keyCode: number) {\n\tif (eventName === 'keydown') {\n\t\twindow.onkeydown({\n\t\t\tkeyCode\n\t\t} as any);\n\t} else if (eventName === 'keyup') {\n\t\twindow.onkeyup({\n\t\t\tkeyCode\n\t\t} as any);\n\t}\n}\n","import EventDispatcher, { GameEvent, ListenerFunction } from \"../core/eventDispatcher\";\n\nexport enum EditorEvent {\n    EDITOR_CHANGE = 'editor change',\n    EDITOR_REGISTER_MODULES = 'registerModules', // parameters(editor)\n    EDITOR_SCENE_TOOL_CHANGED = 'scene tool changed', // parameters(editor)\n    EDITOR_REGISTER_HELP_VARIABLE = 'define help variable', // parameters(name, value)\n    EDITOR_DELETE_CONFIRMATION = 'delete confirmation', // handlerCallback return true|false|Promise wether deletion should succeed.\n    EDITOR_PRE_DELETE_SELECTION = 'pre delete selection',\n    EDITOR_LOADED = 'editor loaded',\n    EDITOR_RESET = 'reset',\n    EDITOR_FORCE_UPDATE = 'editor force update',\n    EDITOR_UNFOCUS = 'editor unfocus',\n    EDITOR_PLAY = 'play',\n    EDITOR_PAUSE = 'pause',\n    EDITOR_CLONE = 'clone',\n    EDITOR_DELETE = 'delete',\n    EDITOR_SCENE_MODE_CHANGED = 'scene mode change' // mode just turned on. get state from editorGlobals.recording\n};\n\n// Wrapper that takes only EditorEvents\nclass EditorEventDispatcher {\n    dispatcher: EventDispatcher = new EventDispatcher();\n\n    // priority should be a whole number between -100000 and 100000. a smaller priority number means that it will be executed first.\n    listen(event: EditorEvent | string, callback: ListenerFunction, priority = 0) {\n        return this.dispatcher.listen(event as any as GameEvent, callback, priority);\n    }\n    dispatch(event: EditorEvent | string, a?, b?, c?) {\n        this.dispatcher.dispatch(event as any as GameEvent, a, b, c);\n    }\n    dispatchWithResults(event: EditorEvent | string, a?, b?, c?) {\n        return this.dispatcher.dispatchWithResults(event as any as GameEvent, a, b, c);\n    }\n    getEventPromise(event: EditorEvent | string) {\n\t\treturn new Promise(function(res) {\n\t\t\teditorEventDispacher.listen(event, res);\n\t\t});\n\t}\n}\n\nexport let editorEventDispacher = new EditorEventDispatcher();\neditorEventDispacher.dispatcher['editorEventDispatcher'] = true; // for debugging\n","import { isClient } from './environment';\nimport { editorEventDispacher } from \"../editor/editorEventDispatcher\";\nimport { eventDispatcherCallbacks } from '../core/eventDispatcher';\n\nconst UPDATE_INTERVAL = 1000; //ms\n\nlet performance;\nperformance = isClient ? window.performance : { now: Date.now };\n\nlet snapshotPerformance = []; // is static data for UPDATE_INTERVAL. then it changes.\nlet cumulativePerformance = {}; // will be reseted every UPDATE_INTERVAL\nlet currentPerformanceMeters = {}; // very short term\n\nlet perSecondSnapshot = [];\nlet currentPerSecondMeters = {};\nexport function eventHappened(name, count = 1) {\n\t// @ifndef OPTIMIZE\n\tif (['Event performance snapshot', 'Event perSecond snapshot'].includes(name)) return;\n\tcurrentPerSecondMeters[name] = (currentPerSecondMeters[name] || 0) + count;\n\t// @endif\n}\neventDispatcherCallbacks.eventDispatchedCallback = (eventName, count) => eventHappened(`Event ${eventName}`, count);\n\nexport function start(name) {\n\t// @ifndef OPTIMIZE\n\tcurrentPerformanceMeters[name] = performance.now();\n\t// @endif\n}\n\nexport function stop(name) {\n\t// @ifndef OPTIMIZE\n\tlet millis = performance.now() - currentPerformanceMeters[name];\n\tif (cumulativePerformance[name])\n\t\tcumulativePerformance[name] += millis;\n\telse\n\t\tcumulativePerformance[name] = millis;\n\t// @endif\n}\n\nlet performanceInterval = null;\nexport function startPerformanceUpdates() {\n\tperformanceInterval = setInterval(() => {\n\t\tprintPrivatePerformance(cumulativePerformance);\n\n\t\tsnapshotPerformance = performanceObjectToPublicArray(cumulativePerformance);\n\t\tcumulativePerformance = {};\n\t\teditorEventDispacher.dispatch('performance snapshot', snapshotPerformance);\n\n\t\tperSecondSnapshot = perSecondObjectToPublicArray(currentPerSecondMeters);\n\t\tcurrentPerSecondMeters = {};\n\t\teditorEventDispacher.dispatch('perSecond snapshot', perSecondSnapshot);\n\t}, UPDATE_INTERVAL);\n}\n\nfunction printPrivatePerformance(object) {\n\tlet msg = '';\n\tObject.keys(object).filter(key => key.startsWith('#')).map(key => ({\n\t\tname: key,\n\t\tvalue: object[key] / UPDATE_INTERVAL\n\t})).sort((a, b) => {\n\t\treturn a.value < b.value ? 1 : -1;\n\t}).forEach(perf => {\n\t\tmsg += `\\n   ${perf.name.substring(1)}: ${perf.value * 100}`;\n\t});\n\tif (msg)\n\t\tconsole.log('#Performance:' + msg);\n}\n\nfunction performanceObjectToPublicArray(object) {\n\treturn Object.keys(object).filter(key => !key.startsWith('#')).map(key => ({\n\t\tname: key,\n\t\tvalue: object[key] / UPDATE_INTERVAL\n\t})).sort((a, b) => {\n\t\treturn a.value < b.value ? 1 : -1;\n\t});\n}\nfunction perSecondObjectToPublicArray(object) {\n\treturn Object.keys(object).map(key => ({\n\t\tname: key,\n\t\tcount: object[key]\n\t})).sort((a, b) => a.name.localeCompare(b.name));\n}\n\nexport let FRAME_MEMORY_LENGTH = 60 * 8;\nlet frameTimes = [];\nfor (let i = 0; i < FRAME_MEMORY_LENGTH; ++i) {\n\tframeTimes.push(0);\n}\nexport function setFrameTime(seconds) {\n\t// @ifndef OPTIMIZE\n\tframeTimes.shift();\n\tframeTimes.push(seconds);\n\t// @endif\n}\nexport function getFrameTimes() {\n\treturn frameTimes;\n}\n","import Serializable from './serializable';\nimport assert from '../util/assert';\nimport { game } from './game';\nimport { addChange, changeType, setChangeOrigin } from './change';\nimport { createWorld, deleteWorld, updateWorld } from '../features/physics';\nimport { listenMouseMove, listenMouseDown, listenMouseUp, listenKeyDown, key, keyPressed } from '../util/input';\nimport { default as PIXI, getRenderer, sortDisplayObjects } from '../features/graphics';\nimport * as performanceTool from '../util/performance';\nimport Vector from '../util/vector';\n\nimport Level from './level';\nimport { Component } from './component';\nimport EntityPrototype from './entityPrototype';\nimport { GameEvent, globalEventDispatcher } from './eventDispatcher';\n\nlet scene: Scene = null;\nexport { scene };\n\nconst physicsOptions = {\n\tenableSleeping: true\n};\n\nexport default class Scene extends Serializable {\n\tcanvas: HTMLCanvasElement;\n\trenderer: any;\n\tmouseListeners: Array<() => void>;\n\tlevel: Level;\n\tstage: PIXI.Container;\n\tcameraPosition: Vector;\n\tcameraZoom: number;\n\tlayers: { [s: string]: PIXI.Container } = {};\n\tcomponents: Map<string, Set<Component>>;\n\tanimationFrameId: any;\n\tplaying: boolean;\n\ttime: number;\n\twon: boolean;\n\t_prevUpdate: number;\n\tresetting: boolean = false;\n\tpixelDensity: Vector = new Vector(1, 1);\n\n\tconstructor(predefinedId?) {\n\t\tsuper(predefinedId);\n\n\t\tif (scene) {\n\t\t\ttry {\n\t\t\t\tscene.delete();\n\t\t\t} catch (e) {\n\t\t\t\tconsole.warn('Deleting old scene failed', e);\n\t\t\t}\n\t\t}\n\t\tscene = this;\n\n\t\tthis.canvas = document.querySelector('canvas.openEditPlayCanvas');\n\t\tthis.renderer = getRenderer(this.canvas);\n\n\t\tthis.mouseListeners = [\n\t\t\tlistenMouseMove(this.canvas, mousePosition => this.dispatch('onMouseMove', mousePosition)),\n\t\t\tlistenMouseDown(this.canvas, mousePosition => this.dispatch('onMouseDown', mousePosition)),\n\t\t\tlistenMouseUp(this.canvas, mousePosition => this.dispatch('onMouseUp', mousePosition))\n\t\t];\n\n\t\taddChange(changeType.addSerializableToTree, this);\n\n\t\tglobalEventDispatcher.dispatch(GameEvent.GLOBAL_SCENE_CREATED, this);\n\t}\n\tmakeUpAName() {\n\t\tif (this.level)\n\t\t\treturn this.level.makeUpAName();\n\t\telse\n\t\t\treturn 'Scene';\n\t}\n\n\tloadLevel(level: Level) {\n\t\tthis.level = level;\n\n\t\tthis.stage = new PIXI.Container();\n\t\tthis.cameraPosition = new Vector(0, 0);\n\t\tthis.cameraZoom = 1;\n\n\t\tlet self = this;\n\t\tfunction createLayer(parent = self.stage): PIXI.Container {\n\t\t\tlet layer = new PIXI.Container();\n\t\t\tparent.addChild(layer);\n\t\t\treturn layer;\n\t\t}\n\t\tthis.layers = {\n\t\t\tstatic: createLayer(), // doesn't move when camera does\n\t\t\tbackground: createLayer(), // moves a little when camera does\n\t\t\tmove: createLayer(), // moves with camera\n\t\t\tui: createLayer() // doesn't move, is on front\n\t\t};\n\t\tthis.layers.behind = createLayer(this.layers.move);\n\t\tthis.layers.main = createLayer(this.layers.move);\n\t\tthis.layers.front = createLayer(this.layers.move);\n\n\t\t// this.bloom = new PIXI.filters.AdvancedBloomFilter();\n\t\t// this.layers.move.filters = [this.bloom];\n\n\t\t// To make component based entity search fast:\n\t\tthis.components = new Map(); // componentName -> Set of components\n\n\t\tthis.animationFrameId = null;\n\t\tthis.playing = false;\n\t\tthis.time = 0;\n\t\tthis.won = false;\n\n\t\tcreateWorld(this, physicsOptions);\n\n\t\tglobalEventDispatcher.dispatch('scene load level before entities', scene, level);\n\n\t\tthis.level.getChildren('epr').map((epr: EntityPrototype) => epr.createEntity(this));\n\n\t\tglobalEventDispatcher.dispatch('scene load level', scene, level);\n\n\t\t// this.draw();\n\t}\n\tunloadLevel() {\n\t\tlet level = this.level;\n\t\tthis.level = null;\n\n\t\tthis.pause();\n\n\t\tthis.deleteChildren();\n\n\t\tif (this.stage)\n\t\t\tthis.stage.destroy();\n\t\tthis.stage = null;\n\n\t\tthis.layers = {};\n\n\t\tthis.components.clear();\n\n\t\tdeleteWorld(this);\n\n\t\tglobalEventDispatcher.dispatch('scene unload level', scene, level);\n\t}\n\n\tsetCameraPositionToPlayer() {\n\t\tlet pos = new Vector(0, 0);\n\t\tlet count = 0;\n\t\tthis.getComponents('CharacterController').forEach(characterController => {\n\t\t\tif (characterController._rootType) {\n\t\t\t\tpos.add(characterController.Transform.getGlobalPosition());\n\t\t\t\tcount++;\n\t\t\t}\n\t\t});\n\t\tif (count > 0) {\n\t\t\tthis.cameraPosition.set(pos.divideScalar(count));\n\t\t}\n\t}\n\n\tupdateCamera() {\n\t\tif (this.playing) {\n\t\t\tthis.setCameraPositionToPlayer();\n\t\t}\n\t\t// pivot is camera top left corner position\n\t\tthis.layers.move.pivot.set(this.cameraPosition.x - this.canvas.width / 2 / this.cameraZoom, this.cameraPosition.y - this.canvas.height / 2 / this.cameraZoom);\n\t\tthis.layers.move.scale.set(this.cameraZoom, this.cameraZoom);\n\t}\n\n\twin() {\n\t\tthis.won = true;\n\t}\n\n\tanimFrame() {\n\t\tthis.animationFrameId = null;\n\t\tif (!this._alive || !this.playing) return;\n\n\t\tlet timeInMilliseconds = performance.now();\n\t\tlet t = 0.001 * timeInMilliseconds;\n\t\tlet dt = t - this._prevUpdate;\n\n\t\tperformanceTool.setFrameTime(dt);\n\n\t\tif (dt > 0.05)\n\t\t\tdt = 0.05;\n\t\tthis._prevUpdate = t;\n\t\tthis.time += dt;\n\n\t\tsetChangeOrigin(this);\n\n\t\t// Update logic\n\t\tperformanceTool.start('Component updates');\n\t\tthis.dispatch('onUpdate', dt, this.time);\n\t\tperformanceTool.stop('Component updates');\n\n\t\t// performanceTool.start('Component up2');\n\t\t// let set = this.getComponents('Spawner');\n\t\t// let sceneTime = this.time;\n\t\t// set.forEach(comp => {\n\t\t// \tif (sceneTime > comp.lastSpawn + comp.interval)\n\t\t// \t\tcomp.spawn();\n\t\t// });\n\t\t// performanceTool.stop('Component up2');\n\n\t\t// Update physics\n\t\tperformanceTool.start('Physics');\n\t\tupdateWorld(this, dt);\n\t\tperformanceTool.stop('Physics');\n\n\t\t// // Update logic\n\t\t// performanceTool.start('Component post updates');\n\t\t// this.dispatch('onPostPhysicsUpdate', dt, this.time);\n\t\t// performanceTool.stop('Component post updates');\n\n\t\t// Update graphics\n\t\tperformanceTool.start('Draw');\n\t\tthis.draw();\n\t\tperformanceTool.stop('Draw');\n\n\t\tif (this.won) {\n\t\t\tthis.pause();\n\t\t\tthis.time = 0;\n\t\t\tgame.dispatch(GameEvent.GAME_LEVEL_COMPLETED);\n\t\t\tthis.reset();\n\t\t}\n\n\t\tthis.requestAnimFrame();\n\t}\n\n\trequestAnimFrame() {\n\t\tlet callback = () => this.animFrame();\n\t\tif (window.requestAnimationFrame)\n\t\t\tthis.animationFrameId = window.requestAnimationFrame(callback);\n\t\telse\n\t\t\tthis.animationFrameId = setTimeout(callback, 16);\n\t}\n\n\tdraw() {\n\t\tthis.updateCamera();\n\n\t\t[this.layers.behind, this.layers.main, this.layers.front].forEach(sortDisplayObjects);\n\n\t\tthis.renderer.render(this.stage, null, false);\n\n\t\tthis.dispatch(GameEvent.SCENE_DRAW, scene);\n\t\tperformanceTool.eventHappened('Draws');\n\t}\n\n\tisInInitialState() {\n\t\treturn !this.playing && this.time === 0;\n\t}\n\n\treset() {\n\t\tif (!this._alive)\n\t\t\treturn; // scene has been replaced by another one\n\n\t\tthis.resetting = true;\n\n\t\tlet level = this.level;\n\t\tthis.unloadLevel();\n\n\t\tif (level)\n\t\t\tthis.loadLevel(level);\n\n\t\t// this.draw(); // we might be doing ok even without draw.\n\t\t// player mode starts mainloop and editor may want to control the drawing more.\n\n\t\tdelete this.resetting;\n\n\t\tthis.dispatch(GameEvent.SCENE_RESET);\n\t}\n\n\tpause() {\n\t\tif (!this.playing) return;\n\n\t\tthis.playing = false;\n\t\tif (this.animationFrameId) {\n\t\t\tif (window.requestAnimationFrame)\n\t\t\t\twindow.cancelAnimationFrame(this.animationFrameId);\n\t\t\telse\n\t\t\t\tclearTimeout(this.animationFrameId);\n\t\t}\n\t\tthis.animationFrameId = null;\n\n\t\tthis.dispatch(GameEvent.SCENE_PAUSE);\n\t}\n\n\tplay() {\n\t\tif (this.playing) return;\n\n\t\tthis._prevUpdate = 0.001 * performance.now();\n\t\tthis.playing = true;\n\n\t\tthis.requestAnimFrame();\n\n\t\tif (this.time === 0)\n\t\t\tthis.dispatch(GameEvent.SCENE_START);\n\n\t\tthis.dispatch(GameEvent.SCENE_PLAY);\n\t}\n\n\tdelete() {\n\t\tif (!super.delete()) return false;\n\n\t\tthis.unloadLevel();\n\n\t\tif (scene === this)\n\t\t\tscene = null;\n\n\t\tif (this.mouseListeners) {\n\t\t\tthis.mouseListeners.forEach(listener => listener());\n\t\t\tthis.mouseListeners = null;\n\t\t}\n\n\t\tthis.renderer = null; // Do not call renderer.destroy(). Same renderer is used by all scenes for now.\n\n\t\treturn true;\n\t}\n\n\t// To make component based entity search fast:\n\taddComponent(component: Component) {\n\t\tlet set = this.components.get(component.componentClass.componentName);\n\t\tif (!set) {\n\t\t\tset = new Set();\n\t\t\tthis.components.set(component.componentClass.componentName, set);\n\t\t}\n\t\tset.add(component);\n\t}\n\n\tremoveComponent(component: Component) {\n\t\tlet set = this.components.get(component.componentClass.componentName);\n\t\tassert(set);\n\t\tassert(set.delete(component));\n\t}\n\n\tgetComponents(componentName) {\n\t\treturn this.components.get(componentName) || new Set;\n\t}\n\n\tmouseToWorld(mousePosition: Vector) {\n\t\treturn new Vector(\n\t\t\tthis.layers.move.pivot.x + mousePosition.x / this.cameraZoom * this.pixelDensity.x,\n\t\t\tthis.layers.move.pivot.y + mousePosition.y / this.cameraZoom * this.pixelDensity.y\n\t\t);\n\t}\n\tworldToMouse(worldPosition: Vector) {\n\t\treturn new Vector(\n\t\t\t(worldPosition.x - this.layers.move.pivot.x) * this.cameraZoom / this.pixelDensity.x,\n\t\t\t(worldPosition.y - this.layers.move.pivot.y) * this.cameraZoom / this.pixelDensity.y\n\t\t);\n\t}\n\tscreenPixelsToWorldPixels(screenPixels: number) {\n\t\treturn screenPixels / this.cameraZoom * this.pixelDensity.x;\n\t}\n\tgetEntitiesAtScreenPoint(screenPoint: Vector) {\n\t\tfor (const child of this.stage.children) {\n\n\t\t}\n\t}\n\n\tsetZoom(zoomLevel) {\n\t\tif (zoomLevel)\n\t\t\tthis.cameraZoom = zoomLevel;\n\t\tthis.dispatch(GameEvent.SCENE_ZOOM_CHANGED, this.cameraZoom);\n\t}\n\n\tresizeCanvas(gameResolution: Vector, screenResolution?: Vector) {\n\t\tthis.renderer.resize(gameResolution.x, gameResolution.y);\n\n\t\tif (screenResolution) {\n\t\t\tthis.pixelDensity.setScalars(gameResolution.x / screenResolution.x, gameResolution.y / screenResolution.y);\n\t\t} else {\n\t\t\tthis.pixelDensity.setScalars(1, 1);\n\t\t}\n\t}\n}\nScene.prototype.isRoot = true;\n\nSerializable.registerSerializable(Scene, 'sce');\n\nexport function forEachScene(listener) {\n\tglobalEventDispatcher.listen(GameEvent.GLOBAL_SCENE_CREATED, listener);\n\n\tif (scene)\n\t\tlistener(scene);\n}\n","import Serializable from './serializable';\nimport Entity from './entity';\nimport assert from '../util/assert';\nimport PropertyOwner from './propertyOwner';\nimport Scene, { scene } from './scene';\nimport Game, { game } from './game';\nexport { default as Prop } from './propertyType';\nexport let componentClasses: Map<string, typeof Component> = new Map();\nimport * as performance from '../util/performance';\nimport { PropertyType } from './propertyType';\nimport { GameEvent } from './eventDispatcher';\n\nconst automaticSceneEventListeners = {\n\tonUpdate: 'onUpdate',\n\tonStart: GameEvent.SCENE_START\n};\n\n// Object of a component, see _componentExample.js\nexport class Component extends PropertyOwner {\n\t_componentId: string;\n\tscene: Scene;\n\tgame: Game;\n\t_listenRemoveFunctions: Array<() => void>;\n\tentity: Entity;\n\tcomponentClass: typeof Component;\n\tcomponentName: string;\n\tTransform: Component;\n\t[s: string]: any; // Suppress all errors. Components will have many custom parameters.\n\n\tstatic componentName: string;\n\tstatic category: string;\n\tstatic requirements: Array<string>;\n\tstatic children: Array<any>;\n\tstatic description: string;\n\tstatic allowMultiple: boolean;\n\tstatic icon: string;\n\tstatic color: string;\n\n\tstatic _propertyTypes: Array<PropertyType>;\n\tstatic _propertyTypesByName: { [s: string]: PropertyType };\n\n\tconstructor(predefinedId?: string) {\n\t\tsuper(predefinedId);\n\t\tthis._componentId = null; // Creator will fill this\n\t\tthis.scene = scene;\n\t\tthis.game = game;\n\t\tthis._listenRemoveFunctions = [];\n\t\tthis.entity = null;\n\t}\n\tmakeUpAName() {\n\t\treturn this.componentClass.componentName;\n\t}\n\tclone() {\n\t\tlet component = super.clone() as any as Component;\n\t\tcomponent._componentId = this._componentId;\n\t\treturn component;\n\t}\n\tdelete() {\n\t\t// Component.delete never returns false because entity doesn't have components as children\n\t\tthis._parent = null;\n\t\tthis.entity = null;\n\t\tsuper.delete();\n\t\treturn true;\n\t}\n\t_addEventListener(functionName: string, eventName?: GameEvent) {\n\t\tif (!eventName)\n\t\t\teventName = functionName as GameEvent;\n\n\t\tlet func = this[functionName];\n\t\tlet self = this;\n\t\tlet performanceName = 'Component: ' + this.componentClass.componentName;\n\t\tthis._listenRemoveFunctions.push(this.scene.listen(eventName, function () {\n\t\t\t// @ifndef OPTIMIZE\n\t\t\tperformance.start(performanceName);\n\t\t\t// @endif\n\n\t\t\tfunc.apply(self, arguments);\n\n\t\t\t// @ifndef OPTIMIZE\n\t\t\tperformance.stop(performanceName);\n\t\t\t// @endif\n\t\t}));\n\t}\n\t// In preInit you can init the component with stuff that other components might want to use in init function\n\t// In preInit you can not trust that other components have been inited in any way\n\t_preInit() {\n\t\tthis.componentClass.requirements.forEach(r => {\n\t\t\tthis[r] = this.entity.getComponent(r);\n\t\t\tassert(this[r], this.componentClass.componentName + ` requires component ` + r + ` but it is not found`);\n\t\t});\n\n\t\tthis.forEachChild('com', (c: Component) => c._preInit());\n\n\t\tfor (let key in automaticSceneEventListeners) {\n\t\t\tif (typeof this[key] === 'function') {\n\t\t\t\tthis._addEventListener(key, automaticSceneEventListeners[key]);\n\t\t\t}\n\t\t}\n\t\t/*\n\t\tfor (let i = 0; i < Object.keys(automaticSceneEventListeners).length; ++i) {\n\t\t\tif (typeof this[automaticSceneEventListeners[i]] === 'function') {\n\t\t\t\tthis._addEventListener(automaticSceneEventListeners[i]);\n\t\t\t}\n\t\t}\n\t\t*/\n\n\t\tif (this.componentClass.componentName !== 'Transform' && this.scene)\n\t\t\tthis.scene.addComponent(this);\n\n\t\ttry {\n\t\t\tif (typeof (this as ComponentRegisterPrototype).preInit === 'function')\n\t\t\t\t(this as ComponentRegisterPrototype).preInit();\n\t\t} catch (e) {\n\t\t\tconsole.error(this.entity, this.componentClass.componentName, 'preInit', e);\n\t\t}\n\t}\n\t// In preInit you can access other components and know that their preInit is done.\n\t_init() {\n\t\tthis.forEachChild('com', (c: Component) => c._init());\n\t\ttry {\n\t\t\tif (typeof (this as ComponentRegisterPrototype).init === 'function')\n\t\t\t\t(this as ComponentRegisterPrototype).init();\n\t\t} catch (e) {\n\t\t\tconsole.error(this.entity, this.componentClass.componentName, 'init', e);\n\t\t}\n\t}\n\t_sleep() {\n\t\ttry {\n\t\t\tif (typeof (this as ComponentRegisterPrototype).sleep === 'function')\n\t\t\t\t(this as ComponentRegisterPrototype).sleep();\n\t\t} catch (e) {\n\t\t\tconsole.error(this.entity, this.componentClass.componentName, 'sleep', e);\n\t\t}\n\n\t\tif (this.componentClass.componentName !== 'Transform' && this.scene)\n\t\t\tthis.scene.removeComponent(this);\n\n\t\tthis.forEachChild('com', (c: Component) => c._sleep());\n\n\t\tthis._listenRemoveFunctions.forEach(f => f());\n\t\tthis._listenRemoveFunctions.length = 0;\n\t}\n\tlistenProperty(component: Component, propertyName: string, callback: Function) {\n\t\t// @ifndef OPTIMIZE\n\t\tassert(component, 'listenProperty called without a component');\n\t\t// @endif\n\t\tthis._listenRemoveFunctions.push(component._properties[propertyName].listen(GameEvent.PROPERTY_VALUE_CHANGE, callback));\n\t}\n\tremoveListenerOnSleep(listenerFunction: () => void) {\n\t\tassert(!this.entity.sleeping, 'Cannot call removeListenerOnSleep in sleep mode.');\n\t\tthis._listenRemoveFunctions.push(listenerFunction);\n\t}\n\ttoJSON() {\n\t\treturn Object.assign(super.toJSON(), {\n\t\t\tn: this.componentClass.componentName,\n\t\t\tcid: this._componentId\n\t\t});\n\t}\n\n\tstatic create(name: string, values = {}) {\n\t\tlet componentClass = componentClasses.get(name);\n\t\tassert(componentClass);\n\t\tlet component = new componentClass();\n\t\tcomponent.initWithPropertyValues(values);\n\t\treturn component;\n\t};\n\tstatic createWithInheritedComponentData(inheritedComponentData) {\n\t\tlet component = new inheritedComponentData.componentClass as Component;\n\t\tcomponent._componentId = inheritedComponentData.componentId;\n\t\tlet properties = inheritedComponentData.properties.map(p => p.clone());\n\t\tcomponent.initWithChildren(properties);\n\t\treturn component;\n\t};\n\n\tstatic reservedPropertyNames = new Set(['id', 'constructor', 'delete', 'children', 'entity', 'env', 'init', 'preInit', 'sleep', 'toJSON', 'fromJSON']);\n\tstatic reservedPrototypeMembers = new Set(['id', 'children', 'entity', 'env', '_preInit', '_init', '_sleep', '_forEachChildComponent', '_properties', '_componentData', 'toJSON', 'fromJSON']);\n\tstatic register({\n\t\tname = '', // required\n\t\tdescription = '',\n\t\tcategory = 'Other',\n\t\ticon = 'fa-puzzle-piece', // in editor\n\t\tcolor = '', // in editor\n\t\tproperties = [],\n\t\trequirements = ['Transform'],\n\t\tchildren = [],\n\t\tparentClass = Component,\n\t\tprototype = {},\n\t\tallowMultiple = true,\n\t\trequiresInitWhenEntityIsEdited = false\n\t}: ComponentRegisterOptions = {}) {\n\t\tassert(name, 'Component must have a name.');\n\t\tassert(name[0] >= 'A' && name[0] <= 'Z', 'Component name must start with capital letter.');\n\t\tassert(!componentClasses.has(name), 'Duplicate component class ' + name);\n\t\tObject.keys(prototype).forEach(k => {\n\t\t\tif (Component.reservedPrototypeMembers.has(k))\n\t\t\t\tassert(false, 'Component prototype can not have a reserved member: ' + k);\n\t\t});\n\n\t\tif (requirements.indexOf('Transform') < 0) requirements.push('Transform');\n\t\tlet colorNum = name.split('').reduce((prev, curr) => prev + curr.charCodeAt(0), 0);\n\n\t\tlet constructorFunction = prototype.constructor;\n\t\tlet deleteFunction = prototype.delete;\n\t\tdelete prototype.constructor;\n\t\tdelete prototype.delete;\n\t\tclass Com extends parentClass {\n\t\t\tconstructor(...args) {\n\t\t\t\tsuper(...args);\n\t\t\t\tif (constructorFunction)\n\t\t\t\t\tconstructorFunction.call(this);\n\t\t\t}\n\t\t\tdelete() {\n\t\t\t\tif (!super.delete()) return false;\n\n\t\t\t\tif (deleteFunction)\n\t\t\t\t\tdeleteFunction.call(this);\n\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tstatic componentName = name;\n\t\t\tstatic category = category;\n\t\t\tstatic requirements = requirements;\n\t\t\tstatic children = children;\n\t\t\tstatic description = description;\n\t\t\tstatic allowMultiple = allowMultiple;\n\t\t\tstatic icon = icon;\n\t\t\tstatic color = color || `hsla(${colorNum % 360}, 40%, 60%, 1)`;\n\t\t\tcomponentClass: typeof Component;\n\t\t}\n\t\tproperties.forEach(p => {\n\t\t\tassert(!Component.reservedPropertyNames.has(p.name), 'Can not have property called ' + p.name);\n\t\t});\n\t\tPropertyOwner.defineProperties(Com, properties); // properties means propertyTypes here\n\n\t\tprototype._name = name;\n\t\tCom.prototype.componentClass = Com;\n\t\tObject.assign(Com.prototype, prototype);\n\t\tcomponentClasses.set(Com.componentName, Com);\n\t\treturn Com;\n\t};\n}\n\ninterface ComponentRegisterPrototype {\n\tconstructor?: Function,\n\tdelete?: () => void,\n\t_name?: string,\n\tpreInit?: () => void,\n\tinit?: () => void,\n\tsleep?: () => void,\n\t[others: string]: any\n};\n\ntype ComponentRegisterOptions = {\n\tname?: string,\n\tdescription?: string,\n\tcategory?: string,\n\ticon?: string,\n\tcolor?: string,\n\tproperties?: Array<any>,\n\trequirements?: Array<string>,\n\tchildren?: Array<any>,\n\tparentClass?: typeof Component,\n\tprototype?: ComponentRegisterPrototype,\n\tallowMultiple?: boolean,\n\trequiresInitWhenEntityIsEdited?: boolean\n};\n\nSerializable.registerSerializable(Component, 'com', json => {\n\tlet component = <Component>new (componentClasses.get(json.n))(json.id);\n\tcomponent._componentId = json.cid || null;\n\treturn component;\n});\n","import Serializable, { createStringId } from './serializable';\nimport assert from '../util/assert';\nimport { componentClasses, Component } from './component';\nimport { isClient } from '../util/environment';\nimport Property from './property';\nimport { PropertyOwnerClass } from './propertyOwner';\nimport Prototype from './prototype';\n\nexport default class ComponentData extends Serializable {\n\tname: string;\n\tcomponentClass: typeof Component & PropertyOwnerClass;\n\tcomponentId: string;\n\n\tconstructor(componentClassName, predefinedId?, predefinedComponentId: string = '') {\n\t\tsuper(predefinedId);\n\t\tthis.name = componentClassName;\n\t\tthis.componentClass = componentClasses.get(this.name);\n\t\tassert(this.componentClass, 'Component class not defined: ' + componentClassName);\n\t\tif (!this.componentClass.allowMultiple)\n\t\t\tpredefinedComponentId = '_' + componentClassName;\n\t\tthis.componentId = predefinedComponentId || createStringId('cid', 10); // what will be the id of component created from this componentData\n\t}\n\tmakeUpAName() {\n\t\treturn this.name;\n\t}\n\taddChild(child) {\n\t\tif (child.threeLetterType === 'prp') {\n\t\t\tif (!child.propertyType) {\n\t\t\t\tif (!this.componentClass._propertyTypesByName[child.name]) {\n\t\t\t\t\tif (isClient)\n\t\t\t\t\t\tconsole.log('Property of that name not defined', this.id, child, this);\n\t\t\t\t\telse\n\t\t\t\t\t\tconsole.log('Property of that name not defined', this.id, this.name, child.name);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tchild.setPropertyType(this.componentClass._propertyTypesByName[child.name]);\n\t\t\t}\n\t\t}\n\t\tsuper.addChild(child);\n\t\treturn this as Serializable;\n\t}\n\tclone(options?) {\n\t\tlet newComponentId = (options && options.cloneComponentId) ? this.componentId : '';\n\t\tlet obj = new ComponentData(this.name, false, newComponentId);\n\t\tlet children = [];\n\t\tthis.forEachChild(null, child => {\n\t\t\tchildren.push(child.clone());\n\t\t});\n\t\tobj.initWithChildren(children);\n\t\tthis._state |= Serializable.STATE_CLONE;\n\t\treturn obj as Serializable;\n\t}\n\ttoJSON() {\n\t\treturn Object.assign(super.toJSON(), {\n\t\t\tcid: this.componentId,\n\t\t\tn: this.name\n\t\t});\n\t}\n\t/*\n\tReturns a list of Properties.\n\tThose which don't have an id are temporary properties generated from parents.\n\tDon't set _depth.\n\t */\n\tgetInheritedProperties(_depth = 0) {\n\t\tlet properties = {};\n\n\t\t// properties from parent\n\t\tlet parentComponentData = this.getParentComponentData();\n\t\tif (parentComponentData)\n\t\t\tparentComponentData.getInheritedProperties(_depth + 1).forEach(prop => properties[prop.name] = prop);\n\n\t\t// properties from this. override properties of parents\n\t\tthis.getChildren('prp').forEach((prop: Property) => {\n\t\t\tif (_depth === 0)\n\t\t\t\tproperties[prop.name] = prop;\n\t\t\telse\n\t\t\t\tproperties[prop.name] = prop.clone(true);\n\t\t});\n\n\t\t// fill from propertyType\n\t\tif (_depth === 0) {\n\t\t\treturn this.componentClass._propertyTypes.map(propertyType => {\n\t\t\t\treturn properties[propertyType.name] || propertyType.createProperty({\n\t\t\t\t\tskipSerializableRegistering: true\n\t\t\t\t});\n\t\t\t});\n\t\t} else {\n\t\t\treturn Object.keys(properties).map(key => properties[key]);\n\t\t}\n\t}\n\tgetParentComponentData() {\n\t\tif (!this._parent) return null;\n\t\tlet parentPrototype = (this._parent as Prototype).getParentPrototype() as Prototype;\n\t\twhile (parentPrototype) {\n\t\t\tlet parentComponentData = parentPrototype.findChild('cda', (componentData: ComponentData) => componentData.componentId === this.componentId);\n\t\t\tif (parentComponentData)\n\t\t\t\treturn parentComponentData;\n\t\t\telse\n\t\t\t\tparentPrototype = parentPrototype.getParentPrototype() as Prototype;\n\t\t}\n\t\treturn null;\n\t}\n\tgetPropertyOrCreate(name) {\n\t\tlet property = this.findChild('prp', (prp: Property) => prp.name === name);\n\t\tif (!property) {\n\t\t\tproperty = this.componentClass._propertyTypesByName[name].createProperty();\n\t\t\tthis.addChild(property);\n\t\t}\n\t\treturn property;\n\t}\n\tgetProperty(name) {\n\t\treturn this.findChild('prp', prp => (prp as Property).name === name);\n\t}\n\tsetValue(propertyName, value) {\n\t\tthis.getPropertyOrCreate(propertyName).value = value;\n\t\treturn this;\n\t}\n\tgetValue(name) {\n\t\tlet property = this.getProperty(name);\n\t\tif (property)\n\t\t\treturn property.value;\n\t\tlet parent = this.getParentComponentData();\n\n\t\tif (parent)\n\t\t\treturn parent.getValue(name);\n\n\t\treturn this.componentClass._propertyTypesByName[name].initialValue;\n\t}\n\tcreateComponent() {\n\t\tlet properties = this.getInheritedProperties();\n\t\tlet values = {};\n\t\tproperties.forEach(prop => {\n\t\t\tvalues[prop.name] = prop.value;\n\t\t});\n\t\tlet component = Component.create(this.name, values);\n\t\tcomponent._componentId = this.componentId;\n\t\treturn component;\n\t}\n}\nSerializable.registerSerializable(ComponentData, 'cda', json => {\n\treturn new ComponentData(json.n, json.id, json.cid);\n});\n\n\n/*\n\nFrom Component? Is this needed?\n\n\tcreateComponentData() {\n\t\tlet componentName = this.componentClass.componentName;\n\t\tlet propertyTypes = this.class._propertyTypes;\n\t\tlet componentData = new ComponentData(componentName);\n\t\tlet children = [];\n\t\tpropertyTypes.forEach(pt => {\n\t\t\tchildren.push(pt.createProperty({\n\t\t\t\tvalue: this[pt.name]\n\t\t\t}));\n\t\t});\n\t\tcomponentData.initWithChildren(children);\n\t\treturn componentData;\n\t}\n\n*/\n","import assert, { changeGetter as assertChangeGetter } from '../util/assert';\nimport Serializable, { serializableCallbacks } from './serializable';\n\nexport let serializables = {};\n\nexport function addSerializable(serializable: Serializable) {\n// @ifndef OPTIMIZE\n\tif (serializables[serializable.id] !== undefined)\n\t\tassert(false, (\"Serializable id clash \" + (serializable.id)));\n// @endif\n\tserializables[serializable.id] = serializable;\n}\nserializableCallbacks.addSerializable = addSerializable;\n\nexport function getSerializable(id: string) {\n\treturn serializables[id] || null;\n}\n\nexport function hasSerializable(id: string) {\n\treturn Boolean(serializables[id]);\n}\n\nexport function removeSerializable(id: string) {\n\t/* When deleting a scene, this function is called a lot of times\n\tif (!serializables[id])\n\t\tthrow new Error('Serializable not found!');\n\t*/\n\tdelete serializables[id];\n}\nserializableCallbacks.removeSerializable = removeSerializable;\n","import Serializable from './serializable';\nimport assert from '../util/assert';\nimport * as performanceTool from '../util/performance';\nimport Prototype, { InheritedComponentData } from './prototype';\nimport { Component } from './component';\nimport { getSerializable } from './serializableManager';\nimport Property from './property';\n\nconst ALIVE_ERROR = 'entity is already dead';\n\nexport default class Entity extends Serializable {\n\tcomponents: Map<string, Array<Component>>;\n\tsleeping: boolean;\n\tprototype: Prototype;\n\tlocalMaster: boolean;\n\n\tstatic ENTITY_CREATION_DEBUGGING = false;\n\n\tconstructor(predefinedId?) {\n\t\tsuper(predefinedId);\n\t\tthis.components = new Map(); // name -> array\n\t\tthis.sleeping = false;\n\t\tthis.prototype = null; // should be set immediately after constructor\n\t\tthis.localMaster = true; // set false if entity is controlled over the net\n\n\t\tperformanceTool.eventHappened('Create object');\n\t}\n\n\tmakeUpAName() {\n\t\tif (this.prototype) {\n\t\t\treturn this.prototype.makeUpAName();\n\t\t} else {\n\t\t\treturn 'Entity';\n\t\t}\n\t}\n\n\t// Get the first component of given name\n\tgetComponent(name) {\n\t\tassert(this._alive, ALIVE_ERROR);\n\t\tlet components = this.components.get(name);\n\t\tif (components !== undefined)\n\t\t\treturn components[0];\n\t\telse\n\t\t\treturn null;\n\t}\n\n\t// Get all components with given name\n\tgetComponents(name) {\n\t\tassert(this._alive, ALIVE_ERROR);\n\t\treturn this.components.get(name) || [];\n\t}\n\n\tgetListOfAllComponents() {\n\t\tlet components = [];\n\t\tthis.components.forEach((value, key) => {\n\t\t\tcomponents.push(...value);\n\t\t});\n\t\treturn components;\n\t}\n\n\tclone(parent: Serializable = null) {\n\t\tlet entity = new Entity();\n\t\tentity.prototype = this.prototype.clone() as Prototype;\n\t\tentity.sleeping = this.sleeping;\n\n\t\tlet components = [];\n\t\tthis.components.forEach((value, key) => {\n\t\t\tcomponents.push(...value.map(c => c.clone()));\n\t\t});\n\t\tentity.addComponents(components, { fullInit: false });\n\n\t\tif (parent) {\n\t\t\tparent.addChild(entity);\n\t\t}\n\n\t\tlet children = [];\n\t\tthis.forEachChild('ent', (ent: Entity) => {\n\t\t\tchildren.push(ent.clone(entity));\n\t\t});\n\t\tif (!entity.sleeping) {\n\t\t\tEntity.initComponents(components);\n\t\t}\n\t\treturn entity;\n\t}\n\n\t/*\n\tAdds multiple components as an array to this Entity.\n\tInitializes components after all components are added.\n\t*/\n\taddComponents(components, { fullInit = true } = {}) {\n\t\tassert(this._alive, ALIVE_ERROR);\n\t\tassert(Array.isArray(components), 'Parameter is not an array.');\n\n\t\tif (Entity.ENTITY_CREATION_DEBUGGING) console.log('add components for', this.makeUpAName());\n\n\t\tfor (let i = 0; i < components.length; i++) {\n\t\t\tlet component = components[i];\n\t\t\tlet componentList = this.components.get(component._name) || this.components.set(component._name, []).get(component._name);\n\t\t\tcomponentList.push(component);\n\t\t\tcomponent.entity = this;\n\t\t\tcomponent._parent = this;\n\t\t\tcomponent.setRootType(this._rootType);\n\t\t}\n\n\t\tif (!this.sleeping) {\n\t\t\tEntity.preInitComponents(components);\n\t\t\tif (fullInit)\n\t\t\t\tEntity.initComponents(components);\n\t\t}\n\t\treturn this;\n\t}\n\n\tstatic preInitComponents(components) {\n\t\tif (Entity.ENTITY_CREATION_DEBUGGING) console.log('preInit components for', components[0].entity.makeUpAName());\n\t\tfor (let i = 0; i < components.length; i++) {\n\t\t\tassert(!components[i].entity.sleeping, 'entity can not be sleeping when pre initing components');\n\t\t\tcomponents[i]._preInit();\n\t\t}\n\t}\n\n\tstatic initComponents(components) {\n\t\tif (Entity.ENTITY_CREATION_DEBUGGING) console.log(`init ${components.length} components for`, components[0].entity.makeUpAName());\n\t\tfor (let i = 0; i < components.length; i++) {\n\t\t\tassert(!components[i].entity.sleeping, 'entity can not be sleeping when initing components');\n\t\t\tcomponents[i]._init();\n\t\t}\n\t}\n\n\tstatic makeComponentsSleep(components) {\n\t\tfor (let i = 0; i < components.length; i++)\n\t\t\tcomponents[i]._sleep();\n\t}\n\n\tstatic deleteComponents(components) {\n\t\tfor (let i = 0; i < components.length; i++)\n\t\t\tcomponents[i].delete();\n\t}\n\n\tsleep() {\n\t\tassert(this._alive, ALIVE_ERROR);\n\t\tif (this.sleeping) return false;\n\n\t\tthis.components.forEach((value, key) => Entity.makeComponentsSleep(value));\n\n\t\tthis.forEachChild('ent', (entity: Entity) => entity.sleep());\n\n\t\tthis.sleeping = true;\n\t\treturn true;\n\t}\n\n\twakeUp() {\n\t\tassert(this._alive, ALIVE_ERROR);\n\t\tif (!this.sleeping) return false;\n\t\tthis.sleeping = false;\n\n\t\tthis.components.forEach((value, key) => Entity.preInitComponents(value));\n\t\tthis.components.forEach((value, key) => Entity.initComponents(value));\n\n\t\tthis.forEachChild('ent', (entity: Entity) => entity.wakeUp());\n\n\t\treturn true;\n\t}\n\n\tresetComponents() {\n\t\t// TODO: Reset all values of all components of this entity and subentities.\n\n\t\tlet inheritedComponentDatas = this.prototype.getInheritedComponentDatas();\n\n\t\tinheritedComponentDatas.forEach((icd: InheritedComponentData) => {\n\t\t\tlet component = this.getComponents(icd.componentClass.componentName).find((comp: Component) => comp._componentId === icd.componentId);\n\t\t\ticd.properties.forEach((prop: Property) => {\n\t\t\t\tif (!component._properties[prop.name].valueEquals(prop.value)) {\n\t\t\t\t\tcomponent[prop.name] = prop.value;\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\t// debugger; // TODO: do stuff with inheritedComponentDatas\n\n\t\tthis.forEachChild('ent', (ent: Entity) => ent.resetComponents());\n\t}\n\n\tdelete() {\n\t\tassert(this._alive, ALIVE_ERROR);\n\t\tthis.sleep();\n\t\tif (!super.delete()) return false;\n\n\t\tthis.components.forEach((value, key) => Entity.deleteComponents(value));\n\t\tthis.components.clear();\n\n\t\tperformanceTool.eventHappened('Destroy object');\n\n\t\treturn true;\n\t}\n\n\tdeleteComponent(component) {\n\t\tlet array = this.getComponents(component.constructor.componentName);\n\t\tlet idx = array.indexOf(component);\n\t\tassert(idx >= 0);\n\t\tif (!this.sleeping)\n\t\t\tcomponent._sleep();\n\t\tcomponent.delete();\n\t\tarray.splice(idx, 1);\n\t\treturn this;\n\t}\n\n\tsetRootType(rootType) {\n\t\tif (this._rootType === rootType)\n\t\t\treturn;\n\n\t\tif (Entity.ENTITY_CREATION_DEBUGGING) console.log('entity added to tree', this.makeUpAName());\n\n\t\tsuper.setRootType(rootType);\n\n\t\tlet i;\n\t\tthis.components.forEach((value, key) => {\n\t\t\tfor (i = 0; i < value.length; ++i) {\n\t\t\t\tvalue[i].setRootType(rootType);\n\t\t\t}\n\t\t});\n\t}\n\n\ttoJSON() {\n\t\tassert(this._alive, ALIVE_ERROR);\n\n\t\tlet components = [];\n\t\tthis.components.forEach(compArray => {\n\t\t\tcompArray.forEach(comp => {\n\t\t\t\tcomponents.push(comp.toJSON());\n\t\t\t});\n\t\t});\n\n\t\treturn Object.assign(super.toJSON(), {\n\t\t\tc: components, // overwrite children. earlier this was named 'comp'\n\t\t\tproto: this.prototype.id\n\t\t});\n\t}\n\tget position() {\n\t\treturn this.getComponent('Transform').position;\n\t}\n\tset position(position) {\n\t\tthis.getComponent('Transform').position = position;\n\t}\n\tget Transform() {\n\t\treturn this.getComponent('Transform');\n\t}\n}\n\nSerializable.registerSerializable(Entity, 'ent', json => {\n\tif (Entity.ENTITY_CREATION_DEBUGGING) console.log('creating entity from json', json);\n\tlet entity = new Entity(json.id);\n\tentity.prototype = getSerializable(json.proto);\n\tif (Entity.ENTITY_CREATION_DEBUGGING) console.log('created entity from json', entity);\n\tif (json.comp) {\n\t\tentity.addComponents((json.c || json.comp).map(Serializable.fromJSON));\n\t}\n\treturn entity;\n});\n\n","import Serializable from './serializable';\nimport assert from '../util/assert';\nimport { getSerializable } from './serializableManager';\nimport Prop, { PropertyType } from './propertyType';\nimport PropertyOwner from './propertyOwner';\nimport ComponentData from './componentData';\nimport Entity from './entity';\nimport { game } from './game';\nimport { Component } from './component';\nimport EntityPrototype from './entityPrototype';\nimport Level from './level';\nimport { globalEventDispatcher } from './eventDispatcher';\nimport Property from './property';\n\nlet propertyTypes = [\n\tProp('name', 'No name', Prop.string)\n];\n\nexport default class Prototype extends PropertyOwner {\n\tpreviouslyCreatedEntity: Entity;\n\tname: string; // Hack to reveal PropertyOwner property\n\n\tstatic _propertyTypes: Array<PropertyType>;\n\tstatic _propertyTypesByName: { [s: string]: PropertyType };\n\n\tconstructor(predefinedId?: string) {\n\t\tsuper(predefinedId);\n\n\t\tthis.previouslyCreatedEntity = null;\n\t}\n\n\tmakeUpAName() {\n\t\treturn this.name || 'Prototype';\n\t}\n\n\taddChild(child: Serializable): Prototype {\n\t\t// if (child.threeLetterType === 'cda' && !child.componentClass.allowMultiple)\n\t\tif (child instanceof ComponentData && !(child as ComponentData).componentClass.allowMultiple)\n\t\t\tassert(this.findChild('cda', (cda: ComponentData) => cda.componentId === child.componentId) === null, `Can't have multiple ${child.name} components. See Component.allowMultiple`);\n\t\tsuper.addChild(child);\n\t\treturn this;\n\t}\n\tgetParentPrototype(): Prototype {\n\t\treturn this._parent && this._parent.threeLetterType === 'prt' ? this._parent as Prototype : null;\n\t}\n\n\t/*\n\tfilter filters component datas\n\n\tReturns JSON:\n\t[\n\t\t{\n\t\t\townComponent: false, // component of a parent prototype\n\t\t\tcomponentClass: [object Object],\n\t\t\tcomponentId: <componentId>,\n\t\t\tthreeLetterType: 'icd',\n\t \t\tgeneratedForPrototype: <this>,\n\t\t\tproperties: [\n\t\t\t\t{ id missing }\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t ownComponentData: <ComponentData> || null, // null if this prototype has 0 properties defined\n\t\t\t componentClass: [object Object],\n\t\t\t componentId: <componentId>,\n\t\t\t threeLetterType: 'icd',\n\t\t\t generatedForPrototype: <this>,\n\t\t\t properties: [\n\t\t\t \t{ id found if own property } // some properties might be from parent prototypes and thus missing id\n\t\t\t ]\n\t\t }\n\t]\n\t */\n\tgetInheritedComponentDatas(filter: (cda: ComponentData) => boolean = null) {\n\t\tlet data = getDataFromPrototype(this, this, filter);\n\t\tlet array = Object.keys(data).map(key => data[key]);\n\t\tlet inheritedComponentData: InheritedComponentData = null;\n\t\tfor (let i = 0; i < array.length; ++i) {\n\t\t\tinheritedComponentData = array[i];\n\t\t\tinheritedComponentData.properties = inheritedComponentData.componentClass._propertyTypes.map(propertyType => {\n\t\t\t\treturn inheritedComponentData.propertyHash[propertyType.name]\n\t\t\t\t\t|| propertyType.createProperty({ skipSerializableRegistering: true });\n\t\t\t});\n\t\t\tdelete inheritedComponentData.propertyHash;\n\t\t}\n\n\t\treturn array.sort(sortInheritedComponentDatas);\n\t}\n\n\thasComponentData(componentName) {\n\t\tlet componentData = this.findChild('cda', (cda: ComponentData) => cda.name === componentName);\n\t\tif (componentData) {\n\t\t\treturn true;\n\t\t}\n\t\tlet parentPrototype = this.getParentPrototype();\n\t\tif (parentPrototype) {\n\t\t\treturn parentPrototype.hasComponentData(componentName);\n\t\t}\n\t\treturn false;\n\t}\n\n\tcreateAndAddPropertyForComponentData(inheritedComponentData, propertyName, propertyValue) {\n\t\tlet propertyType = inheritedComponentData.componentClass._propertyTypesByName[propertyName] as PropertyType;\n\t\tassert(propertyType, 'Invalid propertyName', propertyName, inheritedComponentData);\n\t\tlet componentData = this.findChild('cda', (componentData: ComponentData) => componentData.componentId === inheritedComponentData.componentId);\n\t\tlet componentDataIsNew = false;\n\t\tif (!componentData) {\n\t\t\tconsole.log('no component data. create one', this, inheritedComponentData);\n\t\t\tcomponentData = new ComponentData(inheritedComponentData.componentClass.componentName, false, inheritedComponentData.componentId);\n\t\t\tcomponentDataIsNew = true;\n\t\t}\n\t\tlet property = componentData.findChild('prp', property => property.name === propertyName);\n\t\tif (property) {\n\t\t\tproperty.value = propertyValue;\n\t\t\treturn property;\n\t\t}\n\n\t\tproperty = propertyType.createProperty({\n\t\t\tvalue: propertyValue,\n\t\t});\n\t\tcomponentData.addChild(property);\n\n\t\tif (componentDataIsNew)\n\t\t\tthis.addChild(componentData);\n\n\t\treturn property;\n\t}\n\n\tfindComponentDataByComponentId(componentId: string, alsoFindFromParents = false): ComponentData {\n\t\tlet child = this.findChild('cda', (componentData: ComponentData) => componentData.componentId === componentId) as ComponentData;\n\t\tif (child)\n\t\t\treturn child;\n\t\tif (alsoFindFromParents) {\n\t\t\tlet parent = this.getParentPrototype();\n\t\t\tif (parent)\n\t\t\t\treturn parent.findComponentDataByComponentId(componentId, alsoFindFromParents);\n\t\t}\n\t\treturn null;\n\t}\n\n\tgetOwnComponentDataOrInherit(componentId: string) {\n\t\tlet componentData = this.findComponentDataByComponentId(componentId, false);\n\t\tif (!componentData) {\n\t\t\tlet inheritedComponentData = this.findComponentDataByComponentId(componentId, true);\n\t\t\tif (!inheritedComponentData)\n\t\t\t\treturn null;\n\n\t\t\tcomponentData = new ComponentData(inheritedComponentData.name, false, componentId);\n\t\t\tthis.addChild(componentData);\n\t\t}\n\t\treturn componentData;\n\t}\n\n\tfindOwnProperty(componentId, propertyName) {\n\t\tlet componentData = this.findComponentDataByComponentId(componentId);\n\t\tif (componentData) {\n\t\t\treturn componentData.getProperty(propertyName);\n\t\t}\n\t\treturn null;\n\t}\n\n\t// Parent is needed so that we can init children knowing who is the parent\n\tcreateEntity(parent?: Serializable, _skipNewEntityEvent = false) {\n\t\tlet entity = new Entity();\n\n\t\tlet inheritedComponentDatas = this.getInheritedComponentDatas();\n\t\tlet components = inheritedComponentDatas.map(Component.createWithInheritedComponentData);\n\t\tentity.addComponents(components, { fullInit: false }); // Only do preInit\n\n\t\tentity.prototype = this;\n\n\t\tif (parent)\n\t\t\tparent.addChild(entity);\n\n\t\tif (Entity.ENTITY_CREATION_DEBUGGING) console.log('create entity', this.makeUpAName());\n\n\t\tthis.forEachChild('epr', (epr: EntityPrototype) => epr.createEntity(entity, true));\n\t\t// let childEntityPrototypes = this.getChildren('epr');\n\t\t// childEntityPrototypes.forEach(epr => epr.createEntity(entity));\n\n\t\tthis.previouslyCreatedEntity = entity;\n\n\t\t// Components have only been preinited. Lets call the init now.\n\t\tEntity.initComponents(components);\n\n\t\tif (!_skipNewEntityEvent)\n\t\t\tglobalEventDispatcher.dispatch('new entity created', entity);\n\n\t\treturn entity;\n\t}\n\n\tgetValue(componentId, propertyName) {\n\t\tlet componentData = this.findComponentDataByComponentId(componentId, true);\n\t\tif (componentData)\n\t\t\treturn componentData.getValue(propertyName);\n\t\telse\n\t\t\treturn undefined;\n\t}\n\n\tcountEntityPrototypes(findChildren = false) {\n\t\tlet entityPrototypeCount = 0;\n\t\tlet levelIds = new Set();\n\n\t\tif (this.threeLetterType !== 'prt') {\n\t\t\treturn {\n\t\t\t\tentityPrototypeCount,\n\t\t\t\tlevelIds\n\t\t\t};\n\t\t}\n\n\t\tlet levels = game.getChildren('lvl');\n\t\tfor (let i = levels.length - 1; i >= 0; i--) {\n\t\t\tlet entityPrototypes = levels[i].getChildren('epr') as Array<EntityPrototype>;\n\t\t\tlet foundInThisLevel = false;\n\t\t\tfor (let j = entityPrototypes.length - 1; j >= 0; j--) {\n\t\t\t\tif (entityPrototypes[j].prototype === this) {\n\t\t\t\t\tentityPrototypeCount++;\n\t\t\t\t\tfoundInThisLevel = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (foundInThisLevel) {\n\t\t\t\tlevelIds.add(levels[i].id);\n\t\t\t}\n\t\t}\n\n\t\tif (findChildren)\n\t\t\tthis.forEachChild('prt', (prt: Prototype) => {\n\t\t\t\tlet results = prt.countEntityPrototypes(true);\n\t\t\t\tentityPrototypeCount += results.entityPrototypeCount;\n\t\t\t\tresults.levelIds.forEach(levelId => levelIds.add(levelId));\n\t\t\t});\n\n\t\treturn {\n\t\t\tentityPrototypeCount,\n\t\t\tlevelIds\n\t\t};\n\t}\n\n\t/**\n\t * Only works for Prefabs and Prototypes. Not for EntityPrototypes.\n\t */\n\tgetEntityPrototypesThatUseThisPrototype() {\n\t\tlet entityPrototypes: EntityPrototype[] = [];\n\t\tlet levels: Set<Level> = new Set();\n\n\t\tif (this.threeLetterType !== 'prt' && this.threeLetterType !== 'pfa') {\n\t\t\treturn {\n\t\t\t\tentityPrototypes,\n\t\t\t\tlevels\n\t\t\t};\n\t\t}\n\n\t\tlet levelArray = game.getChildren('lvl') as Level[];\n\t\tfor (let i = levelArray.length - 1; i >= 0; i--) {\n\t\t\tlet foundInThisLevel = false;\n\n\t\t\tlevelArray[i].forEachChild('epr', (epr: EntityPrototype) => {\n\t\t\t\tif (epr.prototype === this) {\n\t\t\t\t\tentityPrototypes.push(epr);\n\t\t\t\t\tfoundInThisLevel = true;\n\t\t\t\t}\n\t\t\t}, true);\n\n\t\t\tif (foundInThisLevel) {\n\t\t\t\tlevels.add(levelArray[i]);\n\t\t\t}\n\t\t}\n\n\t\tthis.forEachChild(this.threeLetterType, (prt: Prototype) => {\n\t\t\tlet results = prt.getEntityPrototypesThatUseThisPrototype();\n\t\t\tentityPrototypes.push(...entityPrototypes);\n\t\t\tresults.levels.forEach((level: Level) => levels.add(level));\n\t\t});\n\n\t\treturn {\n\t\t\tentityPrototypes,\n\t\t\tlevels\n\t\t};\n\t}\n\n\tdelete() {\n\t\tlet _gameRoot = this.getRoot();\n\t\tif (!super.delete()) return false;\n\t\tif (this.threeLetterType === 'prt' && _gameRoot.threeLetterType === 'gam') {\n\t\t\t_gameRoot.forEachChild('lvl', (lvl: Level) => {\n\t\t\t\tlet items = lvl.getChildren('epr') as Array<EntityPrototype>;\n\t\t\t\tfor (let i = items.length - 1; i >= 0; i--) {\n\t\t\t\t\tif (items[i].prototype === this) {\n\t\t\t\t\t\tlvl.deleteChild(items[i], i);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tthis.previouslyCreatedEntity = null;\n\t\treturn true;\n\t}\n\tstatic create(name: string) {\n\t\treturn new Prototype().initWithPropertyValues({ name });\n\t};\n}\nPropertyOwner.defineProperties(Prototype, propertyTypes);\n\nSerializable.registerSerializable(Prototype, 'prt');\n\nexport type InheritedComponentData = {\n\townComponentData: ComponentData;\n\tcomponentClass: typeof Component;\n\tcomponentId: string,\n\tpropertyHash?: { [propName: string]: Property }; // First this exists but will be deleted at the end.\n\tproperties?: Property[]; // In the end, this exists.\n\tthreeLetterType: 'icd';\n\tgeneratedForPrototype: Prototype;\n};\n\nfunction getDataFromPrototype(prototype: Prototype, originalPrototype: Prototype, filter?: (cda: ComponentData) => boolean, _depth = 0): { [componentId: string]: InheritedComponentData } {\n\tlet data: { [componentId: string]: InheritedComponentData } = null;\n\n\tlet parentPrototype = prototype.getParentPrototype() as Prototype;\n\tif (parentPrototype)\n\t\tdata = getDataFromPrototype(parentPrototype, originalPrototype, filter, _depth + 1);\n\telse\n\t\tdata = {}; // Top level\n\n\tlet componentDatas = prototype.getChildren('cda') as any as Array<ComponentData>;\n\tif (filter)\n\t\tcomponentDatas = componentDatas.filter(filter);\n\tlet componentData: ComponentData = null;\n\tfor (let i = 0; i < componentDatas.length; ++i) {\n\t\tcomponentData = componentDatas[i];\n\n\t\tif (!data[componentData.componentId]) {\n\t\t\t// Most parent version of this componentId\n\t\t\tdata[componentData.componentId] = {\n\t\t\t\t// ownComponent = true if the original prototype is the first one introducing this componentId\n\t\t\t\townComponentData: null, // will be given value if the original prototype has this componentId\n\t\t\t\tcomponentClass: componentData.componentClass,\n\t\t\t\tcomponentId: componentData.componentId,\n\t\t\t\tpropertyHash: {},\n\t\t\t\tthreeLetterType: 'icd',\n\t\t\t\tgeneratedForPrototype: originalPrototype,\n\t\t\t};\n\t\t}\n\n\t\tif (_depth === 0) {\n\t\t\tdata[componentData.componentId].ownComponentData = componentData;\n\t\t}\n\n\t\tlet propertyHash = data[componentData.componentId].propertyHash;\n\n\t\tlet properties = componentData.getChildren('prp') as Property[];\n\t\tlet property: Property = null;\n\t\tfor (let j = 0; j < properties.length; ++j) {\n\t\t\tproperty = properties[j];\n\t\t\t// Newest version of a property always overrides old property\n\t\t\tpropertyHash[property.name] = _depth === 0 ? property : property.clone(true);\n\t\t}\n\t};\n\n\treturn data;\n}\n\nfunction sortInheritedComponentDatas(a: InheritedComponentData, b: InheritedComponentData) {\n\treturn a.componentClass.componentName.localeCompare(b.componentClass.componentName);\n}\n","import Prototype from './prototype';\nimport Property from './property';\nimport Serializable from './serializable';\nimport { getSerializable } from './serializableManager';\nimport { Prop, componentClasses } from './component';\nimport ComponentData from './componentData';\nimport assert from '../util/assert';\nimport Vector from '../util/vector';\nimport Prefab from './prefab';\nimport PropertyOwner from './propertyOwner';\nimport { PropertyType } from './propertyType';\nimport { selectInEditor } from '../editor/editorSelection';\n\nlet propertyTypes = [\n\t// Prop('name2', 'No name', Prop.string)\n];\n\n// EntityPrototype is a prototype that always has one Transform ComponentData and optionally other ComponentDatas also.\n// Entities are created based on EntityPrototypes\nexport default class EntityPrototype extends Prototype {\n\n\t// this._parent is level or another entityPrototype, not prototype as in type or prefab. We need a link to parent-prototype. That's why we have prototype property\n\t/**\n\t * prototype stays the same whole EntityPrototype lifetime. It can not change. It is not and will be not supported by server communication.\n\t */\n\tprototype: Prototype = null;\n\n\tconstructor(predefinedId?) {\n\t\tsuper(predefinedId);\n\t}\n\n\tmakeUpAName(): string {\n\t\tlet nameProperty = this.findChild('prp', (property: Property) => property.name === 'name');\n\t\tif (nameProperty && nameProperty.value)\n\t\t\treturn nameProperty.value;\n\t\telse if (this.prototype)\n\t\t\treturn this.prototype.makeUpAName();\n\t\telse\n\t\t\treturn 'EntityPrototype';\n\t}\n\n\tgetTransform() {\n\t\treturn this.findChild('cda', (cda: ComponentData) => cda.name === 'Transform') as ComponentData;\n\t}\n\tgetParentPrototype(): Prototype {\n\t\treturn this.prototype || null;\n\t}\n\tclone() {\n\t\tlet obj = new EntityPrototype();\n\t\tobj.prototype = this.prototype;\n\t\tlet id = obj.id;\n\t\tlet children = [];\n\t\tthis.forEachChild(null, child => {\n\t\t\tif (child.threeLetterType === 'prp' && (child as Property).name === 'name') {\n\t\t\t\tlet property = new Property({\n\t\t\t\t\tvalue: (child as Property).propertyType.type.clone((child as Property).value),\n\t\t\t\t\tname: (child as Property).name,\n\t\t\t\t\tpropertyType: (child as Property).propertyType,\n\t\t\t\t\tpredefinedId: id + '_n'\n\t\t\t\t});\n\t\t\t\tchildren.push(property);\n\t\t\t} else if (child.threeLetterType === 'cda' && (child as ComponentData).name === 'Transform') {\n\t\t\t\tlet transform = new ComponentData('Transform', id + '_t');\n\n\t\t\t\t// Transform component data always has a position\n\t\t\t\tlet position = transform.componentClass._propertyTypesByName.position.createProperty({\n\t\t\t\t\tvalue: child.findChild('prp', (prp: Property) => prp.name === 'position').value,\n\t\t\t\t\tpredefinedId: id + '_p'\n\t\t\t\t});\n\t\t\t\ttransform.addChild(position);\n\n\t\t\t\tlet oldScaleProperty = child.findChild('prp', (prp: Property) => prp.name === 'scale');\n\t\t\t\tif (oldScaleProperty) {\n\t\t\t\t\tlet scale = transform.componentClass._propertyTypesByName.scale.createProperty({\n\t\t\t\t\t\tvalue: oldScaleProperty.value,\n\t\t\t\t\t\tpredefinedId: id + '_s'\n\t\t\t\t\t});\n\t\t\t\t\ttransform.addChild(scale);\n\t\t\t\t}\n\n\t\t\t\tlet oldAngleProperty = child.findChild('prp', (prp: Property) => prp.name === 'angle');\n\t\t\t\tif (oldAngleProperty) {\n\t\t\t\t\tlet angle = transform.componentClass._propertyTypesByName.angle.createProperty({\n\t\t\t\t\t\tvalue: oldAngleProperty.value,\n\t\t\t\t\t\tpredefinedId: id + '_a'\n\t\t\t\t\t});\n\t\t\t\t\ttransform.addChild(angle);\n\t\t\t\t}\n\n\t\t\t\tchildren.push(transform);\n\t\t\t} else if (child.threeLetterType === 'cda') {\n\t\t\t\tchildren.push((child as ComponentData).clone({ cloneComponentId: true }));\n\t\t\t} else {\n\t\t\t\tchildren.push(child.clone());\n\t\t\t}\n\t\t});\n\t\tobj.initWithChildren(children);\n\t\tthis._state |= Serializable.STATE_CLONE;\n\t\treturn obj;\n\t}\n\n\ttoJSON() {\n\t\t/*\n\t\tlet json = super.toJSON();\n\t\tjson.t = this.prototype.id;\n\t\treturn json;\n\t\t*/\n\n\t\t// Below optimization reduces size 88%. child id's have to be generated based on this.id\n\n\t\tlet Transform = this.getTransform();\n\t\tlet json: any = {\n\t\t\tid: this.id\n\t\t};\n\t\tif (this.prototype)\n\t\t\tjson.t = this.prototype.id; // might be prototype or prefab or may not exist. .t as in type\n\n\t\tlet childArrays = [];\n\t\tthis._children.forEach(child => {\n\t\t\tchildArrays.push(child);\n\t\t});\n\t\tlet children = [].concat(...childArrays).filter(child => {\n\t\t\treturn child !== Transform && child !== this._properties.name;\n\t\t});\n\t\tif (children.length > 0)\n\t\t\tjson.c = children.map(child => child.toJSON());\n\n\t\tlet floatToJSON = Prop.float().toJSON;\n\t\tlet handleProperty = prp => {\n\t\t\tif (prp.name === 'name') {\n\t\t\t\tif (prp.value)\n\t\t\t\t\tjson.n = prp.value;\n\t\t\t} else if (prp.name === 'position') {\n\t\t\t\tjson.p = prp.type.toJSON(prp.value);\n\t\t\t} else if (prp.name === 'scale') {\n\t\t\t\tif (!prp.value.isEqualTo(new Vector(1, 1))) {\n\t\t\t\t\tjson.s = prp.type.toJSON(prp.value);\n\t\t\t\t}\n\t\t\t} else if (prp.name === 'angle') {\n\t\t\t\tif (prp.value !== 0)\n\t\t\t\t\tjson.a = floatToJSON(prp.value);\n\t\t\t}\n\t\t};\n\t\thandleProperty(this._properties.name);\n\n\t\tTransform.getChildren('prp').forEach(handleProperty);\n\t\treturn json;\n\t}\n\tspawnEntityToScene(scene, position) {\n\t\tif (!scene)\n\t\t\treturn null;\n\n\t\tif (position) {\n\t\t\tthis.getTransform().getPropertyOrCreate('position').value = position;\n\t\t}\n\n\t\treturn this.createEntity(scene);\n\t}\n\n\t/**\n\t * This function creates a new EntityPrototype and this one will be deleted.\n\t */\n\treplaceWithVersionThatIsDetachedFromPrototype() {\n\t\tlet entityPrototype = new EntityPrototype();\n\t\t// Leave entityPrototype.prototype null to detach\n\n\t\tlet inheritedComponentDatas = this.getInheritedComponentDatas();\n\t\tlet componentDatas: ComponentData[] = inheritedComponentDatas.map(icd => {\n\t\t\treturn new ComponentData(icd.componentClass.componentName, null, icd.componentId)\n\t\t\t\t.initWithChildren(icd.properties.map(prp => prp.clone()));\n\t\t}) as ComponentData[];\n\n\t\tentityPrototype.initWithChildren(componentDatas);\n\t\tentityPrototype.name = this.makeUpAName();\n\n\t\tlet parent = this.getParent();\n\n\t\tthis.delete();\n\n\t\tif (parent) {\n\t\t\tparent.addChild(entityPrototype);\n\t\t}\n\n\t\treturn entityPrototype;\n\t}\n\n\t/**\n\t * WARNING! Only Transform and name are preserved. All other data is lost.\n\t * This should only be called with a prefab that has been created using:\n\t * Prefab.createFromPrototype(entityPrototype)\n\t * This function creates a new EntityPrototype and this one will be deleted\n\t * */\n\treplaceWithVersionThatIsAttachedToPrototype(prototype: Prototype) {\n\t\tlet newEntityPrototype = EntityPrototype.createFromPrototype(prototype);\n\t\tlet thisTransform = this.getTransform();\n\t\tlet Transform = newEntityPrototype.getTransform();\n\t\tTransform.componentClass._propertyTypes.forEach((propertyType: PropertyType) => {\n\t\t\tTransform.setValue(propertyType.name, thisTransform.getValue(propertyType.name));\n\t\t});\n\t\tnewEntityPrototype.name = this.name;\n\n\t\tlet parent = this.getParent();\n\n\t\tthis.delete();\n\n\t\tif (parent) {\n\t\t\tparent.addChild(newEntityPrototype);\n\t\t}\n\t\treturn newEntityPrototype;\n\t}\n\n\t// Optimize this away\n\tsetRootType(rootType) {\n\t\tif (this._rootType === rootType)\n\t\t\treturn;\n\t\tassert(this.getTransform(), 'EntityPrototype must have a Transform');\n\t\tsuper.setRootType(rootType);\n\t\treturn this;\n\t}\n\t/**\n\t * If Transform or Transform.position is missing, they are added.\n\t * prototype can also be Prefab which extends Prototype.\n\t */\n\tstatic createFromPrototype(prototype: Prototype) {\n\t\tif (prototype.threeLetterType === 'pfa') {\n\t\t\treturn (prototype as Prefab).createEntityPrototype();\n\t\t}\n\n\t\tlet entityPrototype = new EntityPrototype();\n\t\tentityPrototype.prototype = prototype;\n\t\tlet id = entityPrototype.id;\n\n\t\tlet prototypeTransform = prototype.findChild('cda', (cda: ComponentData) => cda.name === 'Transform');\n\n\t\tif (prototypeTransform)\n\t\t\tassert(false, 'Prototype (prt) can not have a Transform component');\n\n\t\tlet name = createEntityPrototypeNameProperty(id);\n\t\tlet transform = createEntityPrototypeTransform(id);\n\n\t\tentityPrototype.initWithChildren([name, transform]);\n\n\t\t// @ifndef OPTIMIZE\n\t\tassert(entityPrototype.getTransform(), 'EntityPrototype must have a Transform');\n\t\t// @endif\n\n\t\treturn entityPrototype;\n\t}\n\n\tstatic create(name = 'Empty', position = new Vector(0, 0)) {\n\t\tlet entityPrototype = new EntityPrototype();\n\t\tlet transform = createEntityPrototypeTransform(entityPrototype.id);\n\t\ttransform.setValue('position', position);\n\n\t\tlet nameProperty = createEntityPrototypeNameProperty(entityPrototype.id, name);\n\n\t\tentityPrototype.initWithChildren([nameProperty, transform]);\n\t\treturn entityPrototype;\n\t}\n\n\tget position() {\n\t\treturn this.getTransform().findChild('prp', (prp: Property) => prp.name === 'position').value;\n\t}\n\tset position(position) {\n\t\tthis.getTransform().findChild('prp', (prp: Property) => prp.name === 'position').value = position;\n\t}\n}\n\n// PropertyOwner.defineProperties(EntityPrototype, propertyTypes);\n\nexport function createEntityPrototypeNameProperty(entityPrototypeId, name = '') {\n\treturn EntityPrototype._propertyTypesByName.name.createProperty({\n\t\tvalue: name,\n\t\tpredefinedId: entityPrototypeId + '_n'\n\t});\n}\n\nexport function createEntityPrototypeTransform(entityPrototypeId) {\n\tlet transform = new ComponentData('Transform', entityPrototypeId + '_t');\n\n\tlet position = transform.componentClass._propertyTypesByName.position.createProperty({\n\t\tvalue: new Vector(0, 0),\n\t\tpredefinedId: entityPrototypeId + '_p'\n\t});\n\ttransform.addChild(position);\n\n\tlet scale = transform.componentClass._propertyTypesByName.scale.createProperty({\n\t\tvalue: new Vector(1, 1),\n\t\tpredefinedId: entityPrototypeId + '_s'\n\t});\n\ttransform.addChild(scale);\n\n\tlet angle = transform.componentClass._propertyTypesByName.angle.createProperty({\n\t\tvalue: 0,\n\t\tpredefinedId: entityPrototypeId + '_a'\n\t});\n\ttransform.addChild(angle);\n\n\treturn transform;\n}\n\nSerializable.registerSerializable(EntityPrototype, 'epr', json => {\n\tlet entityPrototype = new EntityPrototype(json.id);\n\tentityPrototype.prototype = json.t ? getSerializable(json.t) : null;\n\n\t// assert(!json.t || entityPrototype.prototype, `Prototype or Prefab ${json.t} not found`); // .t as in type\n\tif (json.t && !entityPrototype.prototype) {\n\t\tconsole.error(`EntityPrototype ${json.id} thought it had a prototype or prefab ${json.t} but it was not found.`);\n\t}\n\n\tlet nameId = json.id + '_n';\n\tlet transformId = json.id + '_t';\n\tlet positionId = json.id + '_p';\n\tlet scaleId = json.id + '_s';\n\tlet angleId = json.id + '_a';\n\n\tlet name = Prototype._propertyTypesByName.name.createProperty({\n\t\tvalue: json.n === undefined ? '' : json.n,\n\t\tpredefinedId: nameId\n\t});\n\n\tlet transformData = new ComponentData('Transform', transformId);\n\tlet transformClass = componentClasses.get('Transform');\n\n\tlet position = transformClass._propertyTypesByName.position.createProperty({\n\t\tvalue: Vector.fromObject(json.p), // in the future, everything will be using p instead of x and y.\n\t\tpredefinedId: positionId\n\t});\n\ttransformData.addChild(position);\n\n\tlet scale = transformClass._propertyTypesByName.scale.createProperty({\n\t\tvalue: json.s && Vector.fromObject(json.s) || new Vector(1, 1),\n\t\tpredefinedId: scaleId\n\t});\n\ttransformData.addChild(scale);\n\n\tlet angle = transformClass._propertyTypesByName.angle.createProperty({\n\t\tvalue: json.a || 0,\n\t\tpredefinedId: angleId\n\t});\n\ttransformData.addChild(angle);\n\n\tentityPrototype.initWithChildren([name, transformData]);\n\n\treturn entityPrototype;\n});\n","import Prototype from './prototype';\nimport Property from './property';\nimport Serializable from './serializable';\nimport { getSerializable } from './serializableManager';\nimport { Prop, componentClasses } from './component';\nimport ComponentData from './componentData';\nimport assert from '../util/assert';\nimport Vector from '../util/vector';\nimport EntityPrototype, { createEntityPrototypeNameProperty, createEntityPrototypeTransform } from \"./entityPrototype\";\n\n// Prefab is an EntityPrototype that has been saved to a prefab.\nexport default class Prefab extends Prototype {\n\tconstructor(predefinedId?: string) {\n\t\tsuper(predefinedId);\n\t}\n\n\tmakeUpAName() {\n\t\tlet nameProperty = this.findChild('prp', (property: Property) => property.name === 'name');\n\t\treturn nameProperty && nameProperty.value || 'Prefab';\n\t}\n\n\tcreateEntity() {\n\t\treturn this.createEntityPrototype().createEntity();\n\t}\n\n\tgetParentPrototype() {\n\t\treturn null;\n\t}\n\t// Meant for entityPrototypes, but works theoretically for prototypes\n\tstatic createFromPrototype(prototype: Prototype) {\n\t\tlet inheritedComponentDatas = prototype.getInheritedComponentDatas();\n\t\tlet children: Array<Serializable> = inheritedComponentDatas.map(icd => {\n\t\t\treturn new ComponentData(icd.componentClass.componentName, null, icd.componentId)\n\t\t\t\t.initWithChildren(icd.properties.map(prp => prp.clone()));\n\t\t}) as any as Array<Serializable>;\n\n\t\tchildren.push(prototype._properties.name.clone());\n\n\t\tprototype.forEachChild('epr', (childEntityPrototype: EntityPrototype) => {\n\t\t\tlet prefab = Prefab.createFromPrototype(childEntityPrototype);\n\t\t\tchildren.push(prefab);\n\t\t});\n\n\t\tlet prefab = new Prefab().initWithChildren(children);\n\n\t\t// Don't just prototype.makeUpAName() because it might give you \"Prototype\" or \"EntityPrototype\". Checking them would be a hack.\n\t\tprefab.name = prototype.name || prototype.prototype && prototype.prototype.makeUpAName() || 'Prefab';\n\n\t\treturn prefab;\n\t}\n\n\tcreateEntityPrototype() {\n\t\tlet entityPrototype = new EntityPrototype();\n\t\tentityPrototype.prototype = this;\n\t\tlet id = entityPrototype.id;\n\n\t\tlet prototypeTransform = this.findChild('cda', (cda: ComponentData) => cda.name === 'Transform');\n\n\t\tif (!prototypeTransform)\n\t\t\tassert(false, 'Prefab (pfa) must have a Transform component');\n\n\t\tlet name = createEntityPrototypeNameProperty(id);\n\t\tlet transform = createEntityPrototypeTransform(id);\n\n\t\ttransform.setValue('position', prototypeTransform.getValue('position'));\n\t\ttransform.setValue('scale', prototypeTransform.getValue('scale'));\n\t\ttransform.setValue('angle', prototypeTransform.getValue('angle'));\n\n\t\tlet children: Serializable[] = [name, transform];\n\n\t\tthis.forEachChild('pfa', (pfa: Prefab) => {\n\t\t\tlet childEntityPrototype = pfa.createEntityPrototype();\n\t\t\tchildren.push(childEntityPrototype);\n\t\t});\n\n\t\tentityPrototype.initWithChildren(children);\n\n\t\t/*\n\t\t\t\tlet inheritedComponentDatas = this.getInheritedComponentDatas();\n\t\t\t\tlet children: Array<Serializable> = inheritedComponentDatas.map(icd => {\n\t\t\t\t\treturn new ComponentData(icd.componentClass.componentName, null, icd.componentId)\n\t\t\t\t\t\t.initWithChildren(icd.properties.map(prp => prp.clone()));\n\t\t\t\t}) as any as Array<Serializable>;\n\t\t\t\tchildren.push(this._properties.name.clone());\n\n\t\t\t\tentityPrototype.initWithChildren(children);\n\t\t\t\t*/\n\n\t\t// @ifndef OPTIMIZE\n\t\tassert(entityPrototype.getTransform(), 'EntityPrototype must have a Transform');\n\t\t// @endif\n\n\t\treturn entityPrototype;\n\t}\n\n\t// Do not use EntityPrototype optimization\n\t// This is only needed if Prefab would extend EntityPrototype instead of Prototype\n\t// toJSON() {\n\t// \treturn Serializable.prototype.toJSON.apply(this, arguments);\n\t// }\n\n\t// This is only needed if Prefab would extend EntityPrototype instead of Prototype\n\t// clone() {\n\t// \treturn Serializable.prototype.clone.apply(this, arguments);\n\t// }\n}\n\n/*\nfilter filters component datas\n\nReturns JSON:\n[\n\t{\n\t\townComponent: false, // component of a parent prototype\n\t\tcomponentClass: [object Object],\n\t\tcomponentId: <componentId>,\n\t\tthreeLetterType: 'icd',\n\t\t generatedForPrototype: <this>,\n\t\tproperties: [\n\t\t\t{ id missing }\n\t\t]\n\t},\n\t{\n\t\t ownComponentData: <ComponentData> || null, // null if this prototype has 0 properties defined\n\t\t componentClass: [object Object],\n\t\t componentId: <componentId>,\n\t\t threeLetterType: 'icd',\n\t\t generatedForPrototype: <this>,\n\t\t properties: [\n\t\t\t { id found if own property } // some properties might be from parent prototypes and thus missing id\n\t\t ]\n\t }\n]\n */\n\nSerializable.registerSerializable(Prefab, 'pfa');\n","import Serializable from './serializable';\nimport PropertyOwner, { Prop } from './propertyOwner';\nimport Scene, { scene } from './scene';\n\nlet propertyTypes = [\n\tProp('name', 'No name', Prop.string)\n];\n\nexport default class Level extends PropertyOwner {\n\tname: string;\n\n\tconstructor(predefinedId?) {\n\t\tsuper(predefinedId);\n\t}\n\tcreateScene(predefinedSceneObject: Scene = null) {\n\t\tif (!predefinedSceneObject)\n\t\t\tnew Scene();\n\n\t\tscene.loadLevel(this);\n\n\t\treturn scene;\n\t}\n\tisEmpty() {\n\t\treturn this.getChildren('epr').length === 0;\n\t}\n\n\t/*\n\tOPTIMIZATION DOES NOT WORK, YET\n\ttoJSON() {\n\t\tlet json = super.toJSON();\n\t\tconsole.log('before', json);\n\t\tif (json.c) {\n\t\t\tlet prototypeIds = new Set();\n\t\t\tjson.c.forEach(child => {\n\t\t\t\tconsole.log('child', child);\n\t\t\t\tprototypeIds.add(child.p);\n\t\t\t});\n\n\t\t\tlet prototypeIdToNum = {};\n\t\t\tlet prototypeIdArray = [];\n\t\t\tlet num = 0;\n\t\t\tprototypeIds.forEach(key => {\n\t\t\t\tprototypeIdArray[num] = key;\n\t\t\t\tprototypeIdToNum[key] = num++;\n\t\t\t});\n\n\t\t\tjson.c.forEach(child => {\n\t\t\t\tchild.p = prototypeIdToNum[child.p] || child.p;\n\t\t\t});\n\n\t\t\tjson.p = prototypeIdArray;\n\n\t\t\tconsole.log(json, prototypeIds, prototypeIdToNum, prototypeIdArray);\n\t\t}\n\t\treturn json;\n\t}\n\t*/\n}\nPropertyOwner.defineProperties(Level, propertyTypes);\n\nSerializable.registerSerializable(Level, 'lvl');\n","import { Component, Prop } from '../core/component';\nimport Vector from '../util/vector';\nimport {default as PIXI} from '../features/graphics';\n\nComponent.register({\n\tname: 'Transform',\n\ticon: 'fa-dot-circle-o',\n\tallowMultiple: false,\n\tproperties: [\n\t\tProp('position', new Vector(0, 0), Prop.vector),\n\t\tProp('scale', new Vector(1, 1), Prop.vector),\n\t\tProp('angle', 0, Prop.float, Prop.float.modulo(0, Math.PI * 2), Prop.flagDegreesInEditor)\n\t],\n\tprototype: {\n\t\tconstructor() {\n\t\t\tthis.layer = this.scene.layers.main;\n\t\t},\n\t\tpreInit() {\n\t\t\tthis.container = new PIXI.Container();\n\t\t\tthis.container._debug = this.entity.makeUpAName() + ' ' + this.name;\n\t\t\tthis.container.position.set(this.position.x, this.position.y);\n\t\t\tthis.container.scale.set(this.scale.x, this.scale.y);\n\t\t\tthis.container.rotation = this.angle;\n\t\t},\n\t\tinit() {\n\n\t\t\t// TODO: move add code to parent? Because container logic is needed in init() of physics component.\n\t\t\tlet parentTransform = this.getParentTransform();\n\t\t\tif (parentTransform) {\n\t\t\t\tparentTransform.container.addChild(this.container);\n\t\t\t\tparentTransform.listen('globalTransformChanged', () => {\n\t\t\t\t\tthis.dispatch('globalTransformChanged', this);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthis.layer.addChild(this.container);\n\t\t\t}\n\n\t\t\t// Optimize this. Shouldn't be called multiple times per frame.\n\t\t\tlet change = () => {\n\t\t\t\tthis.dispatch('globalTransformChanged', this);\n\t\t\t};\n\n\t\t\tthis.listenProperty(this, 'position', position => {\n\t\t\t\tthis.container.position.set(position.x, position.y);\n\t\t\t\tchange();\n\t\t\t});\n\t\t\tthis.listenProperty(this, 'angle', angle => {\n\t\t\t\tthis.container.rotation = angle;\n\t\t\t\tchange();\n\t\t\t});\n\t\t\tthis.listenProperty(this, 'scale', scale => {\n\t\t\t\tthis.container.scale.set(scale.x, scale.y);\n\t\t\t\tchange();\n\t\t\t});\n\t\t\t// change();\n\t\t},\n\t\tgetParentTransform() {\n\t\t\tif (this.parentTransform !== undefined)\n\t\t\t\treturn this.parentTransform;\n\n\t\t\tlet parentEntity = this.entity.getParent();\n\t\t\tif (parentEntity && parentEntity.threeLetterType === 'ent')\n\t\t\t\tthis.parentTransform = parentEntity.getComponent('Transform');\n\t\t\telse\n\t\t\t\tthis.parentTransform = null;\n\n\t\t\treturn this.parentTransform;\n\t\t},\n\t\tgetGlobalPosition() {\n\t\t\treturn Vector.fromObject(this.layer.toLocal(zeroPoint, this.container, tempPoint));\n\t\t},\n\t\t// given position is altered\n\t\tsetGlobalPosition(position: Vector) {\n\t\t\tthis.position = position.set(this.container.parent.toLocal(position, this.layer, tempPoint));\n\t\t},\n\t\tgetGlobalAngle() {\n\t\t\tlet angle = this.angle;\n\t\t\tlet parent = this.getParentTransform();\n\t\t\twhile (parent) {\n\t\t\t\tangle += parent.angle;\n\t\t\t\tparent = parent.getParentTransform();\n\t\t\t}\n\t\t\treturn angle;\n\t\t},\n\t\tsetGlobalAngle(newGlobalAngle: number) {\n\t\t\tlet globalAngle = this.getGlobalAngle();\n\t\t\tlet change = newGlobalAngle - globalAngle;\n\t\t\tthis.angle = (this.angle + change + Math.PI * 2) % (Math.PI * 2);\n\t\t},\n\t\t// This may give wrong numbers if there are rotations and scale included in object tree.\n\t\tgetGlobalScale() {\n\t\t\tlet scale = this.scale.clone() as Vector;\n\t\t\tlet parentEntity = this.entity.getParent();\n\t\t\twhile (parentEntity && parentEntity.threeLetterType === 'ent') {\n\t\t\t\tscale.multiply(parentEntity.Transform.scale);\n\t\t\t\tparentEntity = parentEntity.getParent();\n\t\t\t}\n\t\t\treturn scale;\n\t\t},\n\t\tsleep() {\n\t\t\tthis.container.destroy();\n\t\t\tthis.container = null;\n\n\t\t\tdelete this.parentTransform;\n\t\t}\n\n\t}\n});\n\nlet zeroPoint = new PIXI.Point();\nlet tempPoint = new PIXI.Point();\n","import { Component, Prop } from '../core/component';\nimport Vector from '../util/vector';\n\nComponent.register({\n\tname: 'TransformVariance',\n\tcategory: 'Logic',\n\tdescription: `Adds random factor to object's transform/orientation.`,\n\ticon: 'fa-dot-circle-o',\n\tallowMultiple: false,\n\tproperties: [\n\t\tProp('positionVariance', new Vector(0, 0), Prop.vector),\n\t\tProp('scaleVariance', new Vector(0, 0), Prop.vector),\n\t\tProp('angleVariance', 0, Prop.float, Prop.float.range(0, Math.PI), Prop.flagDegreesInEditor)\n\t],\n\tprototype: {\n\t\tonStart() {\n\t\t\tif (!this.positionVariance.isZero())\n\t\t\t\tthis.Transform.position = this.Transform.position.add(this.positionVariance.clone().multiplyScalar(-1 + 2 * Math.random()));\n\n\t\t\tif (!this.scaleVariance.isZero())\n\t\t\t\tthis.Transform.scale = this.Transform.scale.add(this.scaleVariance.clone().multiplyScalar(Math.random()));\n\t\t\t\n\t\t\tif (this.angleVariance)\n\t\t\t\tthis.Transform.angle += this.angleVariance * (-1 + 2 * Math.random());\n\t\t}\n\t}\n});\n","import { Component, Prop } from '../core/component';\nimport Vector from '../util/vector';\nimport { Color } from '../util/color';\nimport { default as PIXI, generateTextureAndAnchor, getHashedTextureAndAnchor, hitTest } from '../features/graphics';\nimport { GameEvent, globalEventDispatcher } from '../core/eventDispatcher';\n\nComponent.register({\n\tname: 'Shape',\n\tcategory: 'Graphics',\n\ticon: 'fa-stop',\n\tallowMultiple: true,\n\tdescription: 'Draws shape on the screen.',\n\tproperties: [\n\t\tProp('type', 'rectangle', Prop.enum, Prop.enum.values('rectangle', 'circle', 'convex')),\n\t\tProp('radius', 20, Prop.float, Prop.visibleIf('type', ['circle', 'convex'])),\n\t\tProp('size', new Vector(20, 20), Prop.vector, Prop.visibleIf('type', 'rectangle')),\n\t\tProp('points', 3, Prop.int, Prop.int.range(3, 16), Prop.visibleIf('type', 'convex')),\n\t\tProp('topPointDistance', 0.5, Prop.float, Prop.float.range(0.001, 1), Prop.visibleIf('type', 'convex'), 'Only works with at most 8 points'), // Value 0\n\t\tProp('fillColor', new Color(222, 222, 222), Prop.color),\n\t\tProp('borderColor', new Color(255, 255, 255), Prop.color),\n\t\tProp('borderWidth', 1, Prop.float, Prop.float.range(0, 30))\n\t],\n\tprototype: {\n\t\tgraphicsContainPointFunc: null,\n\t\tinit() {\n\t\t\tthis.initSprite();\n\t\t\tthis.Transform.listen('globalTransformChanged', transform => {\n\t\t\t\t/*\n\t\t\t\tthis.sprite.x = transform.globalPosition.x;\n\t\t\t\tthis.sprite.y = transform.globalPosition.y;\n\n\t\t\t\t// rotation setter function has a function call. lets optimize.\n\t\t\t\tif (this.sprite.rotation !== transform.globalAngle)\n\t\t\t\t\tthis.sprite.rotation = transform.globalAngle;\n\n\t\t\t\tthis.sprite.scale.set(transform.globalScale.x, transform.globalScale.y);\n\t\t\t\t*/\n\t\t\t});\n\n\t\t\t/*\n\t\t\tthis.listenProperty(this.Transform, 'position', position => {\n\t\t\t\tthis.sprite.x = position.x;\n\t\t\t\tthis.sprite.y = position.y;\n\t\t\t});\n\n\t\t\tthis.listenProperty(this.Transform, 'angle', angle => {\n\t\t\t\tthis.sprite.rotation = angle;\n\t\t\t});\n\t\t\t*/\n\n\t\t\tlet redrawGraphics = () => {\n\t\t\t\tthis.updateTexture();\n\t\t\t};\n\n\t\t\t// this.listenProperty(this.Transform, 'scale', redrawGraphics);\n\n\t\t\tlet propertiesThatRequireRedraw = [\n\t\t\t\t'type',\n\t\t\t\t'radius',\n\t\t\t\t'size',\n\t\t\t\t'fillColor',\n\t\t\t\t'borderColor',\n\t\t\t\t'borderWidth',\n\t\t\t\t'points',\n\t\t\t\t'topPointDistance'\n\t\t\t];\n\n\t\t\tpropertiesThatRequireRedraw.forEach(propName => {\n\t\t\t\tthis.listenProperty(this, propName, redrawGraphics);\n\t\t\t});\n\t\t},\n\t\tcontainsPoint(vec: Vector) {\n\t\t\tif (this.graphicsContainPointFunc) {\n\t\t\t\treturn this.graphicsContainPointFunc(vec);\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\t\tinitSprite() {\n\t\t\tlet textureAndAnchor = this.getTextureAndAnchor();\n\t\t\tthis.sprite = new PIXI.Sprite(textureAndAnchor.texture);\n\t\t\tthis.sprite.anchor.set(textureAndAnchor.anchor.x, textureAndAnchor.anchor.y);\n\t\t\tthis.graphicsContainPointFunc = textureAndAnchor.containsPoint;\n\n\t\t\tthis.sprite.interactive = true;\n\t\t\tthis.sprite.on('pointerdown', (pointerDownEvent) => {\n\t\t\t\tlet localMousePoint = this.sprite.toLocal(pointerDownEvent.data.global, this.scene.stage);\n\n\t\t\t\tif (this.containsPoint(localMousePoint)) {\n\t\t\t\t\t// Only run in editor because player version has more stripped version of PIXI.\n\t\t\t\t\tglobalEventDispatcher.dispatch(GameEvent.GLOBAL_ENTITY_CLICKED, this.entity, this);\n\t\t\t\t\tthis.entity.dispatch(GameEvent.ENTITY_CLICKED, this);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.Transform.container.addChild(this.sprite);\n\t\t},\n\t\tupdateTexture() {\n\t\t\tlet textureAndAnchor = this.getTextureAndAnchor();\n\t\t\tthis.graphicsContainPointFunc = textureAndAnchor.containsPoint;\n\t\t\tthis.sprite.texture = textureAndAnchor.texture;\n\t\t\tthis.sprite.anchor.set(textureAndAnchor.anchor.x, textureAndAnchor.anchor.y);\n\t\t},\n\t\tgetTextureAndAnchor() {\n\t\t\tlet hash = this.createPropertyHash();// + this.Transform.scale;\n\t\t\tlet textureAndAnchor = getHashedTextureAndAnchor(hash);\n\n\t\t\tif (!textureAndAnchor) {\n\t\t\t\tlet graphics = this.createGraphics();\n\t\t\t\ttextureAndAnchor = generateTextureAndAnchor(graphics, hash);\n\t\t\t\t// graphics.destroy();\n\t\t\t}\n\t\t\treturn textureAndAnchor;\n\t\t},\n\t\tcreateGraphics() {\n\t\t\tlet scale = new Vector(1, 1);// this.Transform.scale;\n\t\t\tlet graphics = new PIXI.Graphics();\n\n\t\t\tif (this.type === 'rectangle') {\n\t\t\t\tlet\n\t\t\t\t\tx = -this.size.x / 2 * scale.x,\n\t\t\t\t\ty = -this.size.y / 2 * scale.y,\n\t\t\t\t\tw = this.size.x * scale.x,\n\t\t\t\t\th = this.size.y * scale.y;\n\n\t\t\t\tgraphics.lineStyle(this.borderWidth, this.borderColor.toHexNumber(), 1);\n\t\t\t\tgraphics.beginFill(this.fillColor.toHexNumber());\n\t\t\t\tgraphics.drawRect(x, y, w, h);\n\t\t\t\tgraphics.endFill();\n\t\t\t} else if (this.type === 'circle') {\n\t\t\t\tlet averageScale = (scale.x + scale.y) / 2;\n\n\t\t\t\tgraphics.lineStyle(this.borderWidth, this.borderColor.toHexNumber(), 1);\n\t\t\t\tgraphics.beginFill(this.fillColor.toHexNumber());\n\t\t\t\tgraphics.drawCircle(0, 0, this.radius * averageScale);\n\t\t\t\tgraphics.endFill();\n\t\t\t} else if (this.type === 'convex') {\n\t\t\t\tlet path = this.getConvexPoints(PIXI.Point, false);\n\t\t\t\tpath.push(path[0]); // Close the path\n\n\t\t\t\tgraphics.lineStyle(this.borderWidth, this.borderColor.toHexNumber(), 1);\n\t\t\t\tgraphics.beginFill(this.fillColor.toHexNumber());\n\t\t\t\tgraphics.drawPolygon(path);\n\t\t\t\tgraphics.endFill();\n\t\t\t}\n\n\t\t\treturn graphics;\n\t\t},\n\t\tgetConvexPoints(vectorClass = Vector, takeScaleIntoAccount = true) {\n\t\t\tconst centerAngle = Math.PI * 2 / this.points;\n\t\t\tconst isNotEventPolygon = this.topPointDistance !== 0.5 && this.points <= 8;\n\n\t\t\tlet minDistanceMultiplier;\n\t\t\tlet maxDistanceMultiplier;\n\t\t\tif (isNotEventPolygon) {\n\t\t\t\tconst segmentAngle = Math.PI - centerAngle;\n\t\t\t\tconst unitSegmentLength = 2 * Math.sin(centerAngle / 2);\n\t\t\t\tconst defaultMinDistanceMultiplier = 1 - unitSegmentLength * Math.cos(segmentAngle / 2);\n\n\t\t\t\tif (this.points === 3) {\n\t\t\t\t\tminDistanceMultiplier = 0.2;\n\t\t\t\t\tmaxDistanceMultiplier = 5;\n\t\t\t\t} else if (this.points === 8) {\n\t\t\t\t\tminDistanceMultiplier = defaultMinDistanceMultiplier;\n\t\t\t\t\tmaxDistanceMultiplier = 3;\n\t\t\t\t} else {\n\t\t\t\t\tminDistanceMultiplier = defaultMinDistanceMultiplier;\n\t\t\t\t\tmaxDistanceMultiplier = 5;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet path = [];\n\n\t\t\tlet currentAngle = 0;\n\t\t\tfor (let i = 0; i < this.points; ++i) {\n\t\t\t\tlet x = Math.sin(currentAngle) * this.radius;\n\t\t\t\tlet y = Math.cos(currentAngle) * this.radius;\n\n\t\t\t\tif (isNotEventPolygon && i === 0) {\n\t\t\t\t\tif (this.topPointDistance > 0.5) {\n\t\t\t\t\t\ty *= 1 + (this.topPointDistance - 0.5) * (maxDistanceMultiplier - 1);\n\t\t\t\t\t} else {\n\t\t\t\t\t\ty *= 2 * this.topPointDistance * (1 - minDistanceMultiplier) + minDistanceMultiplier;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tpath.push(new vectorClass(x, -y));\n\t\t\t\tcurrentAngle += centerAngle;\n\t\t\t}\n\t\t\tif (isNotEventPolygon) {\n\t\t\t\t// put weight to center\n\t\t\t\tlet averageY = path.reduce((prev, curr) => prev + curr.y, 0) / this.points;\n\t\t\t\tpath.forEach(p => p.y -= averageY);\n\t\t\t}\n\n\t\t\tif (takeScaleIntoAccount) {\n\t\t\t\tconst scale = this.Transform.getGlobalScale();\n\t\t\t\tif (scale.x !== 1 || scale.y !== 1) {\n\t\t\t\t\tpath.forEach(p => {\n\t\t\t\t\t\tp.x *= scale.x;\n\t\t\t\t\t\tp.y *= scale.y;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn path;\n\t\t},\n\t\tsleep() {\n\t\t\tthis.sprite.destroy();\n\t\t\tthis.sprite = null;\n\t\t\tthis.graphicsContainPointFunc = null;\n\t\t}\n\t}\n});\n","import { Component, Prop } from '../core/component';\nimport Vector from '../util/vector';\nimport { Color } from '../util/color';\nimport { default as PIXI, generateTextureAndAnchor, getHashedTextureAndAnchor, hitTest } from '../features/graphics';\nimport { globalEventDispatcher, GameEvent } from '../core/eventDispatcher';\n\nComponent.register({\n\tname: 'Sprite',\n\tcategory: 'Graphics',\n\ticon: 'fa-stop',\n\tallowMultiple: true,\n\tdescription: 'Draws a sprite on the screen.',\n\tproperties: [\n\t\tProp('resource', 'character.png', Prop.enum, Prop.enum.values('character.png', 'profile.png', 'sprite.png')),\n\t\tProp('anchor', new Vector(0.5, 0.5), Prop.vector)\n\t],\n\tprototype: {\n\t\tinit() {\n\t\t\tthis.initSprite();\n\n\t\t\tthis.listenProperty(this, 'anchor', anchor => {\n\t\t\t\tif (!this.sprite) return;\n\t\t\t\telse this.sprite.anchor.set(this.anchor.x, this.anchor.y);\n\t\t\t});\n\n\t\t\tthis.listenProperty(this, 'resource', resource => {\n\t\t\t\tthis.initSprite();\n\t\t\t});\n\t\t},\n\t\tinitSprite() {\n\t\t\tif (this.sprite) {\n\t\t\t\tthis.sprite.destroy();\n\t\t\t}\n\n\t\t\tthis.sprite = PIXI.Sprite.fromImage('/img/' + this.resource);\n\t\t\tthis.sprite.anchor.set(this.anchor.x, this.anchor.y);\n\n\t\t\tthis.sprite.interactive = true;\n\t\t\tthis.sprite.on('pointerdown', (pointerDownEvent) => {\n\t\t\t\tif (hitTest(this.sprite, pointerDownEvent, this.scene.stage)) {\n\t\t\t\t\t// Only run in editor because player version has more stripped version of PIXI.\n\t\t\t\t\tglobalEventDispatcher.dispatch(GameEvent.GLOBAL_ENTITY_CLICKED, this.entity, this);\n\t\t\t\t\tthis.entity.dispatch(GameEvent.ENTITY_CLICKED, this);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.Transform.container.addChild(this.sprite);\n\t\t},\n\t\tsleep() {\n\t\t\tthis.sprite.destroy();\n\t\t\tthis.sprite = null;\n\t\t}\n\t}\n});\n","import { Component, Prop } from '../core/component';\nimport EntityPrototype from '../core/entityPrototype';\n\nComponent.register({\n\tname: 'Spawner',\n\tcategory: 'Logic',\n\tdescription: 'Spawns types to world.',\n\tproperties: [\n\t\tProp('typeName', '', Prop.string),\n\t\tProp('trigger', 'start', Prop.enum, Prop.enum.values('start', 'interval')),\n\t\tProp('interval', 10, Prop.float, Prop.float.range(0.1, 1000000), Prop.visibleIf('trigger', 'interval'), 'Interval in seconds')\n\t],\n\tprototype: {\n\t\tconstructor() {\n\t\t\tthis.lastSpawn = 0;\n\t\t},\n\t\tinit() {\n\t\t\tthis.lastSpawn = this.scene.time;\n\t\t},\n\t\tonStart() {\n\t\t\tif (this.trigger === 'start')\n\t\t\t\tthis.spawn();\n\t\t},\n\t\tonUpdate() {\n\t\t\tif (this.scene.time > this.lastSpawn + this.interval)\n\t\t\t\tthis.spawn();\n\t\t},\n\t\tonDrawHelper(context) {\n\t\t\tlet size = 30;\n\t\t\tlet\n\t\t\t\tx = this.Transform.position.x - size * this.Transform.scale.x/2,\n\t\t\t\ty = this.Transform.position.y - size * this.Transform.scale.y/2,\n\t\t\t\tw = size * this.Transform.scale.x,\n\t\t\t\th = size * this.Transform.scale.y;\n\t\t\tcontext.save();\n\t\t\tcontext.fillStyle = 'blue';\n\t\t\tcontext.strokeStyle = 'white';\n\t\t\tcontext.lineWidth = 1;\n\t\t\tcontext.font = '40px Font Awesome 5 Free';\n\t\t\tcontext.textAlign = 'center';\n\t\t\tcontext.fillText('\\uF21D', this.Transform.position.x + 2, this.Transform.position.y);\n\t\t\tcontext.strokeText('\\uf21d', this.Transform.position.x + 2, this.Transform.position.y);\n\n\t\t\tcontext.restore();\n\t\t},\n\t\tspawn() {\n\t\t\t// window['testi']++;\n\t\t\tlet prototype = this.game.findChild('prt', prt => prt.name === this.typeName, true);\n\n\t\t\tif (!prototype)\n\t\t\t\treturn;\n\n\t\t\tlet entityPrototype = EntityPrototype.createFromPrototype(prototype);\n\t\t\tentityPrototype.spawnEntityToScene(this.scene, this.Transform.position);\n\t\t\tentityPrototype.delete();\n\t\t\tthis.lastSpawn = this.scene.time;\n\t\t}\n\t},\n\t/* TODO: This kind of thing can improve update performance by 2x or more\n\tsystems: {\n\t\tonUpdate(setOfSpawners, scene) {\n\t\t\tlet sceneTime = scene.time;\n\t\t\tsetOfSpawners.forEach(comp => {\n\t\t\t\tif (sceneTime > comp.lastSpawn + comp.interval)\n\t\t\t\t\tcomp.spawn();\n\t\t\t});\n\t\t}\n\t}\n\t*/\n});\n\n/*\nwindow['testi'] = 0;\nsetInterval(() => {\n\tconsole.log('testi', window['testi']);\n\twindow['testi'] = 0;\n}, 1000);\n*/","import { Component, Prop } from '../core/component';\nimport Vector from '../util/vector';\n\nComponent.register({\n\tname: 'Trigger',\n\tdescription: 'When _ then _.',\n\tcategory: 'Logic',\n\tallowMultiple: true,\n\tproperties: [\n\t\tProp('trigger', 'playerComesNear', Prop.enum, Prop.enum.values('playerComesNear')),\n\t\tProp('radius', 40, Prop.float, Prop.float.range(0, 1000), Prop.visibleIf('trigger', 'playerComesNear')),\n\t\tProp('action', 'win', Prop.enum, Prop.enum.values('win'))\n\t],\n\tprototype: {\n\t\tpreInit() {\n\t\t\tthis.storeProp = `__Trigger_${this._componentId}`;\n\t\t},\n\t\tonUpdate() {\n\t\t\tif (this.trigger === 'playerComesNear') {\n\t\t\t\tlet componentSet = this.scene.getComponents('CharacterController');\n\t\t\t\tlet entities = [];\n\t\t\t\tcomponentSet.forEach(c => entities.push(c.entity));\n\t\t\t\tlet distSq = this.radius * this.radius;\n\t\t\t\tlet pos = this.Transform.getGlobalPosition();\n\t\t\t\tfor (let i = 0; i < entities.length; ++i) {\n\t\t\t\t\tif (entities[i].Transform.getGlobalPosition().distanceSq(pos) < distSq) {\n\t\t\t\t\t\tif (!entities[i][this.storeProp] && this.launchTrigger(entities[i]) !== false)\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tentities[i][this.storeProp] = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tentities[i][this.storeProp] = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t// Return false if other triggers should not be checked\n\t\t// Note: check this return false logic. Looks weird.\n\t\tlaunchTrigger(entity) {\n\t\t\tif (this.action === 'win') {\n\t\t\t\tthis.scene.win();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t}\n});\n","import { Component, Prop } from '../core/component';\nimport Vector from '../util/vector';\nimport p2, { addBody, deleteBody, createMaterial, getWorld } from '../features/physics';\nimport assert from '../util/assert';\n\nconst PHYSICS_SCALE = 1 / 50;\nexport { PHYSICS_SCALE };\nconst PHYSICS_SCALE_INV = 1 / PHYSICS_SCALE;\n\nconst DENSITY_SCALE = 3 / 10;\n\nconst type = {\n\tdynamic: p2.Body.DYNAMIC,\n\tkinematic: p2.Body.KINEMATIC,\n\tstatic: p2.Body.STATIC\n};\n\nconst SLEEPING = p2.Body.SLEEPING;\nconst STATIC = p2.Body.STATIC;\n\nComponent.register({\n\tname: 'Physics',\n\tcategory: 'Dynamics',\n\tdescription: 'Forms physical rules for <span style=\"color: #84ce84;\">Shapes</span>.',\n\ticon: 'fa-stop',\n\tallowMultiple: false,\n\tproperties: [\n\t\tProp('type', 'dynamic', Prop.enum, Prop.enum.values('dynamic', 'static')),\n\t\tProp('density', 1, Prop.float, Prop.float.range(0, 100), Prop.visibleIf('type', 'dynamic')),\n\t\tProp('drag', 0.1, Prop.float, Prop.float.range(0, 1), Prop.visibleIf('type', 'dynamic')),\n\t\tProp('rotationalDrag', 0.1, Prop.float, Prop.float.range(0, 1), Prop.visibleIf('type', 'dynamic')),\n\t\tProp('bounciness', 0, Prop.float, Prop.float.range(0, 1)),\n\t\tProp('friction', 0.1, Prop.float, Prop.float.range(0, 1))\n\t],\n\trequirements: [\n\t\t'Shape'\n\t],\n\trequiresInitWhenEntityIsEdited: true,\n\tprototype: {\n\t\tinited: false,\n\t\tinit() {\n\t\t\tthis.inited = true;\n\t\t\tlet update = callback => {\n\t\t\t\treturn value => {\n\t\t\t\t\tif (!this.updatingOthers && this.body) {\n\t\t\t\t\t\tcallback(value);\n\t\t\t\t\t\tif (this.type === 'dynamic')\n\t\t\t\t\t\t\tthis.body.wakeUp();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tlet Shapes = this.entity.getComponents('Shape');\n\t\t\tconst shapePropertiesThatShouldUpdateShape = [\n\t\t\t\t'type',\n\t\t\t\t'size',\n\t\t\t\t'radius',\n\t\t\t\t'points',\n\t\t\t\t'topPointDistance'\n\t\t\t];\n\t\t\tfor (let i = 0; i < Shapes.length; ++i) {\n\t\t\t\tshapePropertiesThatShouldUpdateShape.forEach(property => {\n\t\t\t\t\tthis.listenProperty(Shapes[i], property, update(() => this.updateShape()));\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.listenProperty(this.Transform, 'position', update(position => {\n\t\t\t\tthis.body.position = fromTransformToBodyPosition(this.Transform);\n\t\t\t\tthis.body.updateAABB();\n\t\t\t}));\n\t\t\tthis.listenProperty(this.Transform, 'angle', update(angle => {\n\t\t\t\tlet globalAngle = this.Transform.getGlobalAngle();\n\t\t\t\tthis.body.angle = globalAngle;\n\t\t\t\tthis.body.updateAABB();\n\t\t\t}));\n\t\t\tthis.listenProperty(this.Transform, 'scale', update(scale => this.updateShape()));\n\t\t\tthis.listenProperty(this, 'density', update(density => {\n\t\t\t\tthis.body.setDensity(density * DENSITY_SCALE);\n\t\t\t}));\n\t\t\tthis.listenProperty(this, 'friction', update(friction => this.updateMaterial()));\n\t\t\tthis.listenProperty(this, 'drag', update(drag => this.body.damping = drag));\n\t\t\tthis.listenProperty(this, 'rotationalDrag', update(rotationalDrag => {\n\t\t\t\tthis.body.angularDamping = rotationalDrag > 0.98 ? 1 : rotationalDrag;\n\t\t\t\tthis.body.fixedRotation = rotationalDrag === 1;\n\t\t\t\tthis.body.updateMassProperties();\n\t\t\t}));\n\t\t\tthis.listenProperty(this, 'type', update(type => {\n\t\t\t\tthis.body.type = type[this.type];\n\t\t\t\tthis.entity.sleep();\n\t\t\t\tthis.entity.wakeUp();\n\t\t\t}));\n\t\t\tthis.listenProperty(this, 'bounciness', update(bounciness => this.updateMaterial()));\n\n\t\t\tif (this._rootType)\n\t\t\t\tthis.createBody();\n\t\t},\n\t\t// This is here because createBody in init() doesn't have access to Transform's global position because parents are inited later.\n\t\tonStart() {\n\t\t\tthis.body.position = fromTransformToBodyPosition(this.Transform);\n\t\t\tthis.body.angle = this.Transform.getGlobalAngle();\n\t\t\tthis.updateShape();\n\t\t},\n\t\tcreateBody() {\n\t\t\tassert(!this.body);\n\n\t\t\tthis.body = new p2.Body({\n\t\t\t\ttype: type[this.type],\n\n\t\t\t\t// position and angle are updated at onStart\n\t\t\t\tposition: [0, 0], // fromTransformToBodyPosition(this.Transform),\n\t\t\t\tangle: 0, // this.Transform.getGlobalAngle(),\n\t\t\t\tvelocity: [0, 0],\n\t\t\t\tangularVelocity: 0,\n\t\t\t\tsleepTimeLimit: 0.6,\n\t\t\t\tsleepSpeedLimit: 0.3,\n\t\t\t\tdamping: this.drag,\n\t\t\t\tangularDamping: this.rotationalDrag > 0.98 ? 1 : this.rotationalDrag,\n\t\t\t\tfixedRotation: this.rotationalDrag === 1\n\t\t\t});\n\t\t\t// this.updateShape(); // This is done at onStart. No need to do it here.\n\n\t\t\tthis.body.entity = this.entity;\n\n\t\t\taddBody(this.scene, this.body);\n\t\t},\n\t\tupdateShape() {\n\t\t\tif (this.body.shapes.length > 0) {\n\t\t\t\t// We update instead of create.\n\t\t\t\t// Should remove existing shapes\n\n\t\t\t\t// The library does not support updating shapes during the step.\n\t\t\t\tlet world = getWorld(this.scene);\n\t\t\t\tassert(!world.stepping);\n\n\t\t\t\tlet shapes = this.body.shapes;\n\t\t\t\tfor (let i = 0; i < shapes.length; ++i) {\n\t\t\t\t\tshapes[i].body = null;\n\t\t\t\t}\n\t\t\t\tshapes.length = 0;\n\t\t\t}\n\n\t\t\tlet Shapes = this.entity.getComponents('Shape');\n\t\t\tlet scale = this.Transform.getGlobalScale();\n\n\t\t\tShapes.forEach(Shape => {\n\t\t\t\tlet shape;\n\n\t\t\t\tif (Shape.type === 'rectangle') {\n\t\t\t\t\tshape = new p2.Box({\n\t\t\t\t\t\twidth: Shape.size.x * PHYSICS_SCALE * scale.x,\n\t\t\t\t\t\theight: Shape.size.y * PHYSICS_SCALE * scale.y\n\t\t\t\t\t});\n\t\t\t\t} else if (Shape.type === 'circle') {\n\t\t\t\t\tlet averageScale = (scale.x + scale.y) / 2;\n\n\t\t\t\t\tshape = new p2.Circle({\n\t\t\t\t\t\tradius: Shape.radius * PHYSICS_SCALE * averageScale\n\t\t\t\t\t});\n\t\t\t\t} else if (Shape.type === 'convex') {\n\t\t\t\t\tshape = new p2.Convex({\n\t\t\t\t\t\tvertices: Shape.getConvexPoints().map(p => ([p.x * PHYSICS_SCALE, p.y * PHYSICS_SCALE]))\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (shape)\n\t\t\t\t\tthis.body.addShape(shape);\n\t\t\t});\n\n\t\t\tthis.updateMass();\n\t\t\tthis.updateMaterial();\n\t\t},\n\t\tupdateMaterial() {\n\t\t\tlet material = createMaterial(this.scene, {\n\t\t\t\tfriction: this.friction,\n\t\t\t\trestitution: this.bounciness,\n\t\t\t\t// stiffness: 1e6,\n\t\t\t\t// relaxation: 4,\n\t\t\t\t// frictionStiffness: 1e6,\n\t\t\t\t// frictionRelaxation: 4,\n\t\t\t\t// surfaceVelocity: 0\n\t\t\t});\n\t\t\tthis.body.shapes.forEach(s => s.material = material);\n\t\t},\n\t\tupdateMass() {\n\t\t\tif (this.type === 'dynamic')\n\t\t\t\tthis.body.setDensity(this.density * DENSITY_SCALE);\n\t\t},\n\t\tsetRootType(rootType) {\n\t\t\tif (rootType) {\n\t\t\t\tif (this.inited)\n\t\t\t\t\tthis.createBody();\n\t\t\t}\n\t\t\treturn Component.prototype.setRootType.call(this, rootType);\n\t\t},\n\t\tonUpdate() {\n\t\t\tlet b = this.body;\n\t\t\tif (!b || b.sleepState === SLEEPING || b.type === STATIC)\n\t\t\t\treturn;\n\n\t\t\tthis.updatingOthers = true;\n\n\t\t\t// TODO: find out should these be optimized.\n\t\t\tlet newGlobalPosition = fromBodyPositionToGlobalVector(b.position);\n\t\t\tlet oldGlobalPosition = this.Transform.getGlobalPosition();\n\t\t\tif (!oldGlobalPosition.isEqualTo(newGlobalPosition))\n\t\t\t\tthis.Transform.setGlobalPosition(newGlobalPosition);\n\n\t\t\tif (this.Transform.getGlobalAngle() !== b.angle)\n\t\t\t\tthis.Transform.setGlobalAngle(b.angle);\n\n\t\t\tthis.updatingOthers = false;\n\t\t},\n\t\tsleep() {\n\t\t\tif (this.body) {\n\t\t\t\tdeleteBody(this.scene, this.body);\n\t\t\t\tthis.body = null;\n\t\t\t}\n\t\t\tthis.inited = false;\n\t\t},\n\t\tgetMass() {\n\t\t\treturn this.body.mass;\n\t\t},\n\t\tapplyForce(forceVector) {\n\t\t\tthis.body.applyForce(forceVector.toArray());\n\t\t\tthis.body.wakeUp();\n\t\t},\n\t\tsetAngularForce(force) {\n\t\t\tthis.body.angularForce = force;\n\t\t\tthis.body.wakeUp();\n\t\t}\n\t}\n});\n\nfunction fromTransformToBodyPosition(Transform): Array<number> {\n\treturn Transform.getGlobalPosition().toArray().map(x => x * PHYSICS_SCALE);\n}\nfunction fromBodyPositionToGlobalVector(bodyPosition): Vector {\n\treturn Vector.fromArray(bodyPosition).multiplyScalar(PHYSICS_SCALE_INV);\n}\n","import { Component, Prop } from '../core/component';\n\n// Export so that other components can have this component as parent\nexport default Component.register({\n\tname: 'Lifetime',\n\tdescription: 'Set the object to be destroyed after a time period.',\n\tcategory: 'Logic', // You can also make up new categories.\n\ticon: 'fa-bars', // Font Awesome id\n\trequirements: ['Transform'], // These shared components are autofilled. Error if component is not found.\n\tproperties: [\n\t\tProp('lifetime', 3, Prop.float, Prop.float.range(0.01, 1000), 'Life time seconds')\n\t],\n\tparentClass: Component,\n\tprototype: {\n\t\tonUpdate() {\n\t\t\tlet lifetime = this.scene.time - this.startTime;\n\t\t\tif (lifetime >= this.lifetime) {\n\t\t\t\tif (this.entity)\n\t\t\t\t\tthis.entity.delete();\n\t\t\t}\n\t\t},\n\t\tinit() {\n\t\t\tthis.startTime = this.scene.time;\n\t\t}\n\t}\n});\n","import { Component, Prop } from '../core/component';\nimport Vector from '../util/vector';\nimport { Color } from '../util/color';\nimport { default as PIXI, generateTextureAndAnchor, getHashedTextureAndAnchor } from '../features/graphics';\nimport { isClient } from '../util/environment';\n\nimport { PHYSICS_SCALE } from './Physics';\nimport { GameEvent } from '../core/eventDispatcher';\nimport Entity from '../core/entity';\n\nComponent.register({\n\tname: 'Particles',\n\tcategory: 'Graphics',\n\tdescription: 'Particle engine gives eye candy.',\n\tallowMultiple: true,\n\tproperties: [\n\t\tProp('startColor', new Color('#68c07f'), Prop.color),\n\t\tProp('endColor', new Color('#59abc0'), Prop.color),\n\t\tProp('alpha', 1, Prop.float, Prop.float.range(0, 1)),\n\t\tProp('particleSize', 10, Prop.float, Prop.float.range(1, 100)),\n\t\tProp('particleCount', 30, Prop.int, Prop.int.range(0, 10000)),\n\t\tProp('particleLifetime', 1, Prop.float, Prop.float.range(0.1, 10), 'in seconds'),\n\t\tProp('particleHardness', 0.2, Prop.float, Prop.float.range(0, 1)),\n\t\tProp('blendMode', 'add', Prop.enum, Prop.enum.values('add', 'normal')),\n\t\tProp('spawnType', 'circle', Prop.enum, Prop.enum.values('circle', 'rectangle')),\n\t\tProp('spawnRadius', 20, Prop.float, Prop.float.range(0, 1000), Prop.visibleIf('spawnType', 'circle')),\n\t\tProp('spawnRandom', 0.5, Prop.float, Prop.float.range(0, 1), Prop.visibleIf('spawnType', 'circle')),\n\t\tProp('spawnRect', new Vector(50, 50), Prop.vector, Prop.visibleIf('spawnType', 'rectangle')),\n\t\tProp('speedToOutside', 50, Prop.float, Prop.float.range(-1000, 1000), Prop.visibleIf('spawnType', 'circle')),\n\t\tProp('speed', new Vector(0, 0), Prop.vector),\n\t\tProp('speedRandom', 0, Prop.float, Prop.float.range(0, 1000), 'Max random velocity to random direction'),\n\t\tProp('acceleration', new Vector(0, 0), Prop.vector),\n\t\tProp('globalCoordinates', true, Prop.bool),\n\t\tProp('followObject', 0.4, Prop.float, Prop.float.range(0, 1), Prop.visibleIf('globalCoordinates', true))\n\t],\n\tprototype: {\n\t\tinit() {\n\t\t\t//ParticleContainer does not work properly!\n\n\t\t\t// maxSize < 40 will crash\n\t\t\t// With many Particle-components with few particles, this is deadly-expensive.\n\t\t\t// And also crashes now and then with low maxValue.\n\t\t\t// this.container = new PIXI.particles.ParticleContainer(5000, {\n\t\t\t// \tposition: true,\n\t\t\t// \talpha: true,\n\t\t\t// \tscale: false,\n\t\t\t// \trotation: false,\n\t\t\t// \tuvs: false\n\t\t\t// });\n\n\n\t\t\t// Use normal container instead\n\t\t\tthis.container = new PIXI.Container();\n\n\t\t\t// Texture\n\t\t\tthis.updateTexture();\n\t\t\t['particleSize', 'particleHardness', 'alpha'].forEach(propertyName => {\n\t\t\t\tthis.listenProperty(this, propertyName, () => {\n\t\t\t\t\tthis.updateTexture();\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t// Blend mode\n\t\t\tthis.listenProperty(this, 'blendMode', blendMode => {\n\t\t\t\tif (!this.particles)\n\t\t\t\t\treturn;\n\n\t\t\t\tthis.particles.forEach(p => {\n\t\t\t\t\tif (p.sprite)\n\t\t\t\t\t\tp.sprite.blendMode = blendModes[blendMode];\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t// this.scene.layers.main.addChild(this.container);\n\n\t\t\tthis.initParticles();\n\t\t\t['particleLifetime', 'particleCount'].forEach(propertyName => {\n\t\t\t\tthis.listenProperty(this, propertyName, () => {\n\t\t\t\t\tthis.initParticles();\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tthis.updateGlobalCoordinatesProperty();\n\t\t\tthis.listenProperty(this, 'globalCoordinates', () => {\n\t\t\t\tthis.updateGlobalCoordinatesProperty();\n\t\t\t});\n\n\t\t\tlet physicsEntity = this.entity as Entity;\n\t\t\twhile (physicsEntity && physicsEntity.threeLetterType === 'ent' && !this.Physics) {\n\t\t\t\tthis.Physics = physicsEntity.getComponent('Physics');\n\t\t\t\tphysicsEntity = physicsEntity.getParent() as Entity;\n\t\t\t}\n\t\t},\n\n\t\tupdateGlobalCoordinatesProperty() {\n\t\t\tif (this.positionListener) {\n\t\t\t\tthis.positionListener();\n\t\t\t\tthis.positionListener = null;\n\t\t\t}\n\t\t\tif (this.globalCoordinates) {\n\t\t\t\tthis.particles.forEach(p => {\n\t\t\t\t\tif (p.sprite) {\n\t\t\t\t\t\tp.sprite.x += this.container.position.x;\n\t\t\t\t\t\tp.sprite.y += this.container.position.y;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t// this.container.position.set(0, 0);\n\t\t\t\tthis.container.setParent(this.scene.layers.main);\n\t\t\t} else {\n\t\t\t\t/*\n\t\t\t\tthis.positionListener = this.Transform.listen('globalTransformChanged', Transform => {\n\t\t\t\t\tlet position = Transform.getGlobalPosition();\n\t\t\t\t\tthis.container.position.set(position.x, position.y);\n\t\t\t\t});\n\t\t\t\t*/\n\t\t\t\t// this.container.position.set(this.Transform.position.x, this.Transform.position.y);\n\t\t\t\tthis.container.setParent(this.Transform.container);\n\n\t\t\t\tthis.particles.forEach(p => {\n\t\t\t\t\tif (p.sprite) {\n\t\t\t\t\t\tp.sprite.x -= this.container.position.x;\n\t\t\t\t\t\tp.sprite.y -= this.container.position.y;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\n\t\tupdateTexture() {\n\t\t\tthis.texture = getParticleTexture(this.particleSize, this.particleHardness * 0.9, { r: 255, g: 255, b: 255, a: this.alpha });\n\t\t\t// this.container.baseTexture = this.texture;\n\t\t\tif (this.particles) {\n\t\t\t\tthis.particles.forEach(p => {\n\t\t\t\t\tif (p.sprite)\n\t\t\t\t\t\tp.sprite.texture = this.texture;\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\n\t\tinitParticles() {\n\t\t\tif (this.particles) {\n\t\t\t\tthis.particles.forEach(p => {\n\t\t\t\t\tif (p.sprite)\n\t\t\t\t\t\tp.sprite.destroy();\n\t\t\t\t});\n\t\t\t}\n\t\t\tthis.particles = [];\n\t\t\tlet interval = this.particleLifetime / this.particleCount;\n\t\t\tlet firstBirth = this.scene.time + Math.random() * interval;\n\t\t\tfor (let i = 0; i < this.particleCount; ++i) {\n\t\t\t\tthis.particles.push({\n\t\t\t\t\talive: false,\n\t\t\t\t\tnextBirth: firstBirth + i * interval\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\n\t\tresetParticle(p) {\n\n\t\t\tp.vx = this.speed.x;\n\t\t\tp.vy = this.speed.y;\n\t\t\tif (this.speedRandom > 0) {\n\t\t\t\tlet randomSpeed = this.speedRandom * Math.random();\n\t\t\t\tlet randomAngle = Math.random() * Math.PI * 2;\n\t\t\t\tp.vx += Math.sin(randomAngle) * randomSpeed;\n\t\t\t\tp.vy += Math.cos(randomAngle) * randomSpeed;\n\t\t\t}\n\n\t\t\t// Calculate starting position\n\t\t\tif (this.spawnType === 'circle') {\n\t\t\t\tlet r = this.spawnRadius;\n\t\t\t\tif (this.spawnRandom > 0) {\n\t\t\t\t\tr = this.spawnRandom * Math.random() * r + (1 - this.spawnRandom) * r;\n\t\t\t\t}\n\t\t\t\tlet angle = Math.random() * Math.PI * 2;\n\t\t\t\tp.sprite.x = Math.cos(angle) * r;\n\t\t\t\tp.sprite.y = Math.sin(angle) * r;\n\t\t\t\tif (this.speedToOutside !== 0) {\n\t\t\t\t\tp.vx += Math.cos(angle) * this.speedToOutside;\n\t\t\t\t\tp.vy += Math.sin(angle) * this.speedToOutside;\n\t\t\t\t}\n\t\t\t} else if (this.spawnType === 'rectangle') {\n\t\t\t\t// Rectangle\n\t\t\t\tp.sprite.x = -this.spawnRect.x / 2 + Math.random() * this.spawnRect.x;\n\t\t\t\tp.sprite.y = -this.spawnRect.y / 2 + Math.random() * this.spawnRect.y;\n\t\t\t}\n\n\t\t\tp.age = this.scene.time - p.nextBirth;\n\t\t\tp.nextBirth += this.particleLifetime;\n\n\t\t\tif (this.globalCoordinates) {\n\t\t\t\t// Change sprite position from Transform coordinates to main layer coordinates.\n\t\t\t\tVector.fromObject(this.container.toLocal(p.sprite.position, this.Transform.container, p.sprite.position));\n\n\t\t\t\tif (this.Physics && this.Physics.body) {\n\t\t\t\t\tlet vel = this.Physics.body.velocity;\n\t\t\t\t\tp.vx = p.vx + this.followObject * vel[0] / PHYSICS_SCALE;\n\t\t\t\t\tp.vy = p.vy + this.followObject * vel[1] / PHYSICS_SCALE;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tonUpdate(dt, t) {\n\t\t\tconst particleLifetime = this.particleLifetime;\n\t\t\tconst invParticleLifetime = 1 / particleLifetime;\n\t\t\tconst particles = this.particles;\n\t\t\tconst accelerationX = this.acceleration.x * dt;\n\t\t\tconst accelerationY = this.acceleration.y * dt;\n\n\t\t\t// Fast color interpolation\n\t\t\tconst startColor = this.startColor;\n\t\t\tconst endColor = this.endColor;\n\t\t\tfunction colorLerp(lerp) {\n\t\t\t\tlet startMultiplier = 1 - lerp;\n\t\t\t\tlet r = (startColor.r * startMultiplier + endColor.r * lerp) | 0; // to int\n\t\t\t\tlet g = (startColor.g * startMultiplier + endColor.g * lerp) | 0;\n\t\t\t\tlet b = (startColor.b * startMultiplier + endColor.b * lerp) | 0;\n\t\t\t\treturn 65536 * r + 256 * g + b;\n\t\t\t}\n\n\t\t\tlet sprite,\n\t\t\t\tspritePos,\n\t\t\t\tscale,\n\t\t\t\tlerp,\n\t\t\t\tp\n\t\t\t\t;\n\n\t\t\tfor (let i = 0; i < this.particleCount; i++) {\n\t\t\t\tp = particles[i];\n\n\t\t\t\tif (!p.alive) {\n\t\t\t\t\t// Not alive\n\t\t\t\t\tif (t >= p.nextBirth) {\n\t\t\t\t\t\t// The birth!\n\t\t\t\t\t\tp.sprite = new PIXI.Sprite(this.texture);\n\t\t\t\t\t\tp.sprite.blendMode = blendModes[this.blendMode];\n\t\t\t\t\t\tp.sprite.anchor.set(0.5, 0.5);\n\t\t\t\t\t\tp.alive = true;\n\t\t\t\t\t\tthis.resetParticle(p);\n\t\t\t\t\t\tthis.container.addChild(p.sprite);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Is alive\n\n\t\t\t\tsprite = p.sprite;\n\t\t\t\tspritePos = sprite.transform.position;\n\n\t\t\t\tp.age += dt;\n\t\t\t\tlerp = p.age * invParticleLifetime;\n\t\t\t\tif (lerp >= 1) {\n\t\t\t\t\tthis.resetParticle(p);\n\t\t\t\t\tlerp = p.age * invParticleLifetime;\n\t\t\t\t} else {\n\t\t\t\t\tp.vx += accelerationX;\n\t\t\t\t\tp.vy += accelerationY;\n\t\t\t\t\tspritePos.x += p.vx * dt;\n\t\t\t\t\tspritePos.y += p.vy * dt;\n\t\t\t\t}\n\n\t\t\t\tsprite.tint = colorLerp(lerp);\n\n\t\t\t\tsprite.alpha = alphaLerp(lerp);\n\n\t\t\t\tscale = scaleLerp(lerp);\n\t\t\t\tsprite.scale.set(scale, scale);\n\n\t\t\t}\n\t\t},\n\n\t\tsleep() {\n\t\t\tthis.particles = null;\n\n\t\t\tthis.container.destroy();\n\t\t\tthis.container = null;\n\n\t\t\tif (this.positionListener) {\n\t\t\t\tthis.positionListener();\n\t\t\t\tthis.positionListener = null;\n\t\t\t}\n\n\t\t\t// do not destroy textures. we can reuse them.\n\t\t}\n\t}\n});\n\nfunction alphaLerp(lerp) {\n\tif (lerp > 0.5) {\n\t\treturn (1 - lerp) / 0.5;\n\t} else if (lerp > 0.2) {\n\t\treturn 1;\n\t} else {\n\t\treturn lerp * 5;\n\t}\n}\n\nfunction scaleLerp(lerp) {\n\tif (lerp > 0.5) {\n\t\treturn 1;\n\t} else {\n\t\treturn 0.5 + lerp;\n\t}\n}\n\nconst blendModes = {\n\tadd: isClient ? PIXI.BLEND_MODES.ADD : 0,\n\tnormal: isClient ? PIXI.BLEND_MODES.NORMAL : 0\n};\n\nlet textureCache = {};\n\n// size: pixels\n// gradientHardness: 0..1\nfunction getParticleTexture(size, gradientHardness = 0, rgb = { r: 255, g: 255, b: 255, a: 1 }) {\n\tlet hash = `${size}-${gradientHardness}-${rgb.r}-${rgb.g}-${rgb.b}-${rgb.a}`;\n\tif (!textureCache[hash]) {\n\t\tlet canvas = document.createElement('canvas');\n\t\tcanvas.width = size;\n\t\tcanvas.height = size;\n\t\tlet context = canvas.getContext('2d');\n\t\tvar gradient = context.createRadialGradient(\n\t\t\tsize * 0.5,\n\t\t\tsize * 0.5,\n\t\t\tsize * 0.5 * (gradientHardness), // inner r\n\t\t\tsize * 0.5,\n\t\t\tsize * 0.5,\n\t\t\tsize * 0.5 // outer r\n\t\t);\n\t\tgradient.addColorStop(0, `rgba(${rgb.r}, ${rgb.g}, ${rgb.b}, ${rgb.a})`);\n\t\tgradient.addColorStop(1, `rgba(${rgb.r}, ${rgb.g}, ${rgb.b}, 0)`);\n\t\tcontext.fillStyle = gradient;\n\t\tcontext.fillRect(0, 0, size, size);\n\t\ttextureCache[hash] = PIXI.Texture.fromCanvas(canvas);\n\t}\n\treturn textureCache[hash];\n}\n","export function removeTheDeadFromArray(array) {\n\tfor (let i = array.length - 1; i >= 0; --i) {\n\t\tif (array[i]._alive === false)\n\t\t\tarray.splice(i, 1);\n\t}\n}\n\nexport function absLimit(value, absMax) {\n\tif (value > absMax)\n\t\treturn absMax;\n\telse if (value < -absMax)\n\t\treturn -absMax;\n\telse\n\t\treturn value;\n}\n","import { Component, Prop } from '../core/component';\nimport { key, keyPressed, listenKeyDown } from '../util/input';\nimport assert from '../util/assert'\nimport Vector from '../util/vector';\nimport { getWorld, default as p2 } from '../features/physics';\nimport {PHYSICS_SCALE} from './Physics'\nimport { absLimit } from '../util/algorithm';\n\nconst JUMP_SAFE_DELAY = 0.1; // seconds\n\nComponent.register({\n\tname: 'CharacterController',\n\tdescription: 'Lets user control the object.',\n\tcategory: 'Dynamics',\n\tallowMultiple: false,\n\tproperties: [\n\t\tProp('type', 'player', Prop.enum, Prop.enum.values('player', 'AI')),\n\t\tProp('keyboardControls', 'arrows or WASD', Prop.enum, Prop.enum.values('arrows', 'WASD', 'arrows or WASD')),\n\t\tProp('controlType', 'jumper', Prop.enum, Prop.enum.values('jumper', 'top down'/*, 'space ship'*/)),\n\t\tProp('jumpSpeed', 300, Prop.float, Prop.float.range(0, 1000), Prop.visibleIf('controlType', 'jumper')),\n\t\tProp('jumpAddedToVelocity', 0.4, Prop.float, Prop.float.range(0, 1), Prop.visibleIf('controlType', 'jumper'), '1 means that jump speed is added to y velocity when object has y velocity.'),\n\t\tProp('breakInTheAir', true, Prop.bool, Prop.visibleIf('controlType', 'jumper')),\n\t\tProp('speed', 200, Prop.float, Prop.float.range(0, 1000)),\n\t\tProp('acceleration', 2000, Prop.float, Prop.float.range(0, 10000)),\n\t\tProp('breaking', 2000, Prop.float, Prop.float.range(0, 10000))\n\t],\n\tprototype: {\n\t\tinit() {\n\t\t\tthis.Physics = this.entity.getComponent('Physics');\n\n\t\t\tthis.lastJumpTime = 0;\n\n\t\t\tthis.keyListener = listenKeyDown(keyCode => {\n\t\t\t\tif (this.controlType !== 'jumper' || !this.scene.playing)\n\t\t\t\t\treturn;\n\n\t\t\t\tif (this.keyboardControls === 'arrows') {\n\t\t\t\t\tif (keyCode === key.up)\n\t\t\t\t\t\tthis.jump();\n\t\t\t\t} else if (this.keyboardControls === 'WASD') {\n\t\t\t\t\tif (keyCode === key.w)\n\t\t\t\t\t\tthis.jump();\n\t\t\t\t} else if (this.keyboardControls === 'arrows or WASD') {\n\t\t\t\t\tif (keyCode === key.up || keyCode === key.w)\n\t\t\t\t\t\tthis.jump();\n\t\t\t\t} else {\n\t\t\t\t\tassert(false, 'Invalid CharacterController.keyboardControls');\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tsleep() {\n\t\t\tif (this.keyListener) {\n\t\t\t\tthis.keyListener();\n\t\t\t\tthis.keyListener = null;\n\t\t\t}\n\t\t},\n\t\tgetInput() {\n\t\t\tif (this.keyboardControls === 'arrows') {\n\t\t\t\treturn {\n\t\t\t\t\tup: keyPressed(key.up),\n\t\t\t\t\tdown: keyPressed(key.down),\n\t\t\t\t\tleft: keyPressed(key.left),\n\t\t\t\t\tright: keyPressed(key.right)\n\t\t\t\t};\n\t\t\t} else if (this.keyboardControls === 'WASD') {\n\t\t\t\treturn {\n\t\t\t\t\tup: keyPressed(key.w),\n\t\t\t\t\tdown: keyPressed(key.s),\n\t\t\t\t\tleft: keyPressed(key.a),\n\t\t\t\t\tright: keyPressed(key.d)\n\t\t\t\t};\n\t\t\t} else if (this.keyboardControls === 'arrows or WASD') {\n\t\t\t\treturn {\n\t\t\t\t\tup: keyPressed(key.up) || keyPressed(key.w),\n\t\t\t\t\tdown: keyPressed(key.down) || keyPressed(key.s),\n\t\t\t\t\tleft: keyPressed(key.left) || keyPressed(key.a),\n\t\t\t\t\tright: keyPressed(key.right) || keyPressed(key.d)\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tassert(false, 'Invalid CharacterController.keyboardControls');\n\t\t\t}\n\t\t},\n\t\tonUpdate(dt, t) {\n\t\t\tlet { up, down, left, right } = this.getInput();\n\n\t\t\tlet dx = 0,\n\t\t\t\tdy = 0;\n\n\t\t\tif (right) dx++;\n\t\t\tif (left) dx--;\n\t\t\tif (up) dy--;\n\t\t\tif (down) dy++;\n\n\t\t\tif (this.controlType === 'top down') {\n\t\t\t\tthis.moveTopDown(dx, dy, dt);\n\t\t\t} else if (this.controlType === 'jumper') {\n\t\t\t\tthis.moveJumper(dx, dy, dt);\n\t\t\t}\n\t\t},\n\t\t// dx and dy between [-1, 1]\n\t\tmoveTopDown(dx, dy, dt) {\n\t\t\tif (!this.Physics) {\n\t\t\t\tif (dx !== 0 || dy !== 0) {\n\t\t\t\t\tlet Transform = this.Transform;\n\t\t\t\t\tlet p = Transform.position;\n\t\t\t\t\tlet delta = this.speed * dt;\n\t\t\t\t\tTransform.position = new Vector(p.x + dx * delta, p.y + dy * delta);\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this.Physics.body)\n\t\t\t\treturn;\n\n\t\t\t// Physics based\n\t\t\t// #############\n\n\t\t\tlet bodyVelocity = this.Physics.body.velocity;\n\n\t\t\tbodyVelocity[0] = absLimit(this.calculateNewVelocity(bodyVelocity[0] / PHYSICS_SCALE, dx, dt), this.speed) * PHYSICS_SCALE;\n\t\t\tbodyVelocity[1] = absLimit(this.calculateNewVelocity(bodyVelocity[1] / PHYSICS_SCALE, dy, dt), this.speed) * PHYSICS_SCALE;\n\t\t},\n\t\tmoveJumper(dx, dy, dt) {\n\t\t\tif (!this.Physics || !this.Physics.body)\n\t\t\t\treturn false;\n\n\t\t\tlet bodyVelocity = this.Physics.body.velocity;\n\n\t\t\tbodyVelocity[0] = this.calculateNewVelocity(bodyVelocity[0] / PHYSICS_SCALE, dx, dt) * PHYSICS_SCALE;\n\t\t},\n\t\tjump() {\n\t\t\tif (this.scene.time > this.lastJumpTime + JUMP_SAFE_DELAY && this.checkIfCanJump()) {\n\t\t\t\tthis.lastJumpTime = this.scene.time;\n\n\t\t\t\tlet bodyVelocity = this.Physics.body.velocity;\n\t\t\t\tif (bodyVelocity[1] > 0) {\n\t\t\t\t\t// going down\n\t\t\t\t\tbodyVelocity[1] = -this.jumpSpeed * PHYSICS_SCALE;\n\t\t\t\t} else {\n\t\t\t\t\t// going up\n\t\t\t\t\tlet velocityVector = Vector.fromArray(bodyVelocity);\n\n\t\t\t\t\tlet contactEquations = getWorld(this.scene).narrowphase.contactEquations;\n\t\t\t\t\tlet body = this.Physics.body;\n\n\t\t\t\t\tfor (let i = contactEquations.length - 1; i >= 0; --i) {\n\t\t\t\t\t\tlet contact = contactEquations[i];\n\t\t\t\t\t\tif (contact.bodyA === body || contact.bodyB === body) {\n\t\t\t\t\t\t\tlet normal = Vector.fromArray(contact.normalA);\n\t\t\t\t\t\t\tif (contact.bodyB === body)\n\t\t\t\t\t\t\t\tnormal.multiplyScalar(-1);\n\t\t\t\t\t\t\tlet dotProduct = velocityVector.dot(normal);\n\t\t\t\t\t\t\tif (dotProduct < 0) {\n\t\t\t\t\t\t\t\t// character is moving away from the contact. could be caused by physics engine.\n\t\t\t\t\t\t\t\tvelocityVector.subtract(normal.multiplyScalar(dotProduct));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tbodyVelocity[1] = velocityVector.y * this.jumpAddedToVelocity - this.jumpSpeed * PHYSICS_SCALE;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tcheckIfCanJump() {\n\t\t\tif (!this.Physics || this.controlType !== 'jumper')\n\t\t\t\treturn false;\n\n\t\t\tlet contactEquations = getWorld(this.scene).narrowphase.contactEquations;\n\t\t\tlet body = this.Physics.body;\n\n\t\t\tif (!body)\n\t\t\t\treturn false;\n\n\t\t\tif (body.sleepState === p2.Body.SLEEPING)\n\t\t\t\treturn true;\n\n\t\t\tfor (let i = contactEquations.length - 1; i >= 0; --i) {\n\t\t\t\tlet contact = contactEquations[i];\n\t\t\t\tif (contact.bodyA === body || contact.bodyB === body) {\n\t\t\t\t\tlet normalY = contact.normalA[1];\n\t\t\t\t\tif (contact.bodyB === body)\n\t\t\t\t\t\tnormalY *= -1;\n\t\t\t\t\tif (normalY > 0.5)\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\t\tcalculateNewVelocity(velocity, input, dt) {\n\t\t\tif (input !== 0) {\n\t\t\t\tif (velocity >= this.speed && input > 0) {\n\t\t\t\t\t// don't do anything\n\t\t\t\t} else if (velocity <= -this.speed && input < 0) {\n\t\t\t\t\t// don't do anything\n\t\t\t\t} else {\n\t\t\t\t\t// do something\n\t\t\t\t\tvelocity += input * this.acceleration * dt;\n\n\t\t\t\t\tif (input < 0 && velocity < -this.speed)\n\t\t\t\t\t\tvelocity = -this.speed;\n\n\t\t\t\t\tif (input > 0 && velocity > this.speed)\n\t\t\t\t\t\tvelocity = this.speed;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (velocity !== 0 && (this.controlType !== 'jumper' || this.breakInTheAir || this.checkIfCanJump())) {\n\t\t\t\t\tlet absVel = Math.abs(velocity);\n\t\t\t\t\tabsVel -= this.breaking * dt;\n\t\t\t\t\tif (absVel < 0)\n\t\t\t\t\t\tabsVel = 0;\n\n\t\t\t\t\tif (velocity > 0)\n\t\t\t\t\t\tvelocity = absVel;\n\t\t\t\t\telse\n\t\t\t\t\t\tvelocity = -absVel;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn velocity;\n\t\t}\n\t}\n});\n","// Animation clashes with typescript lib \"DOM\" (lib.dom.d.ts). Therefore we have namespace.\nexport namespace animation {\n\n    // Changing this will break games\n    export const DEFAULT_FRAME_COUNT = 24;\n    export const MAX_FRAME_COUNT = 100;\n\n    export type AnimationData = {\n        animations: AnimationDataAnimation[];\n    };\n    export type AnimationDataAnimation = {\n        name: string;\n        tracks: AnimationDataTrack[];\n        frames?: number; // If falsy, use DEFAULT_FRAME_COUNT\n    };\n    export type AnimationDataTrack = {\n        eprId: string;\n        cId: string;\n        prpName: string;\n        keyFrames: { [frame: number]: any }\n    };\n\n    // export function parseAnimationData\n\n    /**\n     * @param animationDataString data from Animation component\n     */\n    export function parseAnimationData(animationDataString) {\n        let animationData;\n        try {\n\t\t\tanimationData = JSON.parse(animationDataString);\n\t\t} catch (e) {\n\t\t\tanimationData = {};\n        }\n\n        animationData.animations = animationData.animations || [];\n        return animationData as AnimationData;\n    }\n\n    /**\n     * Helper class for editor. Just JSON.stringify this to get valid animationData animation out.\n     */\n    export class Animation {\n        // If frames is falsy, use DEFAULT_FRAME_COUNT\n        constructor(public name: string, public tracks: Track[] = [], public frames: number = undefined) {\n        }\n\n        /**\n         *\n         * @param entityPrototypeId\n         * @param componendId\n         * @param value jsoned property value\n         */\n        saveValue(entityPrototypeId: string, componendId: string, propertyName: string, frameNumber: number, value: any) {\n            let track = this.tracks.find(track=> track.cId === componendId && track.eprId === entityPrototypeId && track.prpName === propertyName);\n            if (!track) {\n                track = new Track(entityPrototypeId, componendId, propertyName);\n                this.tracks.push(track);\n            }\n            track.saveValue(frameNumber, value);\n        }\n\n        deleteEmptyTracks() {\n            for (let i = this.tracks.length - 1; i >= 0; i--) {\n                if (Object.keys(this.tracks[i].keyFrames).length === 0) {\n                    this.tracks.splice(i, 1);\n                }\n            }\n        }\n\n        deleteOutOfBoundsKeyFrames() {\n            let frameCount = this.frames || DEFAULT_FRAME_COUNT;\n            for (const track of this.tracks) {\n                let keyFrameKeys = Object.keys(track.keyFrames);\n                for (const keyFrameKey of keyFrameKeys) {\n                    if (+keyFrameKey > frameCount) {\n                        delete track.keyFrames[keyFrameKey];\n                    }\n                }\n            }\n        }\n\n        getHighestKeyFrame() {\n            let highestKeyFrame = 0;\n            for (const track of this.tracks) {\n                let keyFrameKeys = Object.keys(track.keyFrames);\n                for (const keyFrameKey of keyFrameKeys) {\n                    if (+keyFrameKey > highestKeyFrame) {\n                        highestKeyFrame = +keyFrameKey;\n                    }\n                }\n            }\n            return highestKeyFrame;\n        }\n\n        static create(json){\n            let tracks = (json.tracks || []).map(Track.create);\n            return new Animation(json.name, tracks, json.frames);\n        }\n    }\n\n    export class Track {\n        constructor(public eprId: string, public cId: string, public prpName: string, public keyFrames: { [frame: number]: any } = {}) {\n        }\n\n        saveValue(frameNumber: number, value) {\n            this.keyFrames[frameNumber] = value;\n        }\n\n        static create(json) {\n            let keyFrames = json.keyFrames || {};\n            return new Track(json.eprId, json.cId, json.prpName, keyFrames);\n        }\n    }\n}\n","import { Component, Prop } from '../core/component';\nimport { animation } from '../features/animation/animation';\nimport { getSerializable } from '../core/serializableManager';\nimport EntityPrototype from '../core/entityPrototype';\nimport Entity from '../core/entity';\nimport assert from '../util/assert';\nimport Property from '../core/property';\nimport Vector from '../util/vector';\nimport { PropertyType } from '../core/propertyType';\nimport { Color } from '../util/color';\n\n// Export so that other components can have this component as parent\nexport default Component.register({\n\tname: 'Animation',\n\tdescription: 'Allows animation of children',\n\tcategory: 'Graphics', // You can also make up new categories.\n\ticon: 'fa-bars', // Font Awesome id\n\tproperties: [\n\t\tProp('animationData', '{}', Prop.longString, 'temporary var for development')\n\t],\n\tprototype: {\n\t\tanimator: null,\n\t\tconstructor() {\n\t\t},\n\t\tpreInit() {\n\t\t},\n\t\tinit() {\n\t\t\tthis.listenProperty(this, 'animationData', () => this.loadAnimation());\n\t\t\tthis.loadAnimation();\n\t\t},\n\t\tonUpdate(dt) {\n\t\t\tthis.animator.update(dt);\n\t\t},\n\t\tloadAnimation() {\n\t\t\tif (this.animator) {\n\t\t\t\tthis.animator.delete();\n\t\t\t}\n\t\t\tthis.animator = new Animator(animation.parseAnimationData(this.animationData), this);\n\t\t},\n\t\tsleep() {\n\t\t\tthis.animator.delete();\n\t\t\tthis.animator = null;\n\t\t}\n\t}\n});\n\nconst controlPointDistanceFactor = 0.33;\n\nclass Animator {\n\ttime: number = 0;\n\tanimations: AnimatorAnimation[];\n\tcurrentAnimation: AnimatorAnimation;\n\tconstructor(animationData: animation.AnimationData, public component: Component) {\n\t\tthis.animations = animationData.animations.map(anim => new AnimatorAnimation(anim));\n\t\tthis.currentAnimation = this.animations[0];\n\t}\n\tupdate(dt) {\n\t\tthis.time += dt;\n\t\tif (this.time > 1) {\n\t\t\tthis.time -= 1;\n\t\t}\n\t\tif (!this.currentAnimation) {\n\t\t\treturn;\n\t\t}\n\t\tlet totalFrames = this.currentAnimation.frames;\n\t\tlet frame = (this.time * totalFrames + 1);\n\t\tthis.currentAnimation.setFrame(frame);\n\t}\n\tsetAnimation(name: string) {\n\t\tif (!name) {\n\t\t\tthis.time = 0;\n\t\t\tthis.currentAnimation = null;\n\t\t\tthis.component.entity.resetComponents();\n\t\t\treturn;\n\t\t}\n\t\tlet anim = this.animations.find(anim => anim.name === name);\n\t\tif (anim) {\n\t\t\tthis.currentAnimation = anim;\n\t\t\tthis.time = 0;\n\t\t}\n\t}\n\tdelete() {\n\t\tdelete this.animations;\n\t\tdelete this.currentAnimation;\n\t}\n}\n\nclass AnimatorAnimation {\n\tname: string;\n\ttracks: AnimatorTrack[];\n\tframes: number;\n\tconstructor(animationJSON: animation.AnimationDataAnimation) {\n\t\tthis.name = animationJSON.name;\n\t\tthis.frames = animationJSON.frames || animation.DEFAULT_FRAME_COUNT;\n\t\tthis.tracks = animationJSON.tracks.map(trackData => new AnimatorTrack(trackData, this.frames));\n\t}\n\tsetFrame(frame) {\n\t\tassert(frame > 0, 'frame must be positive');\n\t\tfor (let track of this.tracks) {\n\t\t\ttrack.setFrame(frame);\n\t\t}\n\t}\n}\n\nclass AnimatorTrack {\n\tentityPrototype: EntityPrototype;\n\tentity: Entity;\n\tanimatedProperty: Property;\n\tcurrentKeyFrameIndex: number = 0;\n\tkeyFrames: Array<{\n\t\tframe: number;\n\t\tvalue: any;\n\t\tcontrol1: any;\n\t\tcontrol2: any;\n\t}> = [];\n\tconstructor(trackData: animation.AnimationDataTrack, public frames: number) {\n\t\tthis.entityPrototype = getSerializable(trackData.eprId) as EntityPrototype;\n\t\tlet componentData = this.entityPrototype.findComponentDataByComponentId(trackData.cId, true);\n\t\tlet componentName = componentData.componentClass.componentName;\n\t\tthis.entity = this.entityPrototype.previouslyCreatedEntity;\n\t\tassert(this.entity, 'must have entity');\n\t\tlet component = this.entity.getComponents(componentName).find(c => c._componentId === trackData.cId);\n\t\tassert(component, 'component must be found');\n\t\tthis.animatedProperty = component._properties[trackData.prpName];\n\t\tlet keyFrameFrames = Object.keys(trackData.keyFrames).map(key => ~~key).sort((a, b) => a - b);\n\n\t\tfor (let frame of keyFrameFrames) {\n\t\t\tlet value = this.animatedProperty.propertyType.type.fromJSON(trackData.keyFrames[frame]);\n\t\t\tthis.keyFrames.push({\n\t\t\t\tframe,\n\t\t\t\tvalue,\n\t\t\t\tcontrol1: value,\n\t\t\t\tcontrol2: value\n\t\t\t});\n\t\t}\n\t\tlet propertyTypeName = this.animatedProperty.propertyType.type.name;\n\t\tlet propertyType = this.animatedProperty.propertyType;\n\t\tconst color = value => Math.min(Math.max(value, 0), 255);\n\t\tfor (let i = 0; i < this.keyFrames.length; i++) {\n\t\t\tlet prev = this.keyFrames[i];\n\t\t\tlet curr = this.keyFrames[(i + 1) % this.keyFrames.length];\n\t\t\tlet next = this.keyFrames[(i + 2) % this.keyFrames.length];\n\n\t\t\tif (propertyTypeName === 'float') {\n\t\t\t\tlet controlPoints;\n\t\t\t\tif (propertyType.getFlag(Prop.flagDegreesInEditor)) {\n\t\t\t\t\t// It's angle we are dealing with.\n\t\t\t\t\tcontrolPoints = calculateControlPointsForScalar(\n\t\t\t\t\t\tgetClosestAngle(curr.value, prev.value),\n\t\t\t\t\t\tcurr.value,\n\t\t\t\t\t\tgetClosestAngle(curr.value, next.value)\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tcontrolPoints = calculateControlPointsForScalar(prev.value, curr.value, next.value);\n\t\t\t\t}\n\t\t\t\tcurr.control1 = controlPoints.control1;\n\t\t\t\tcurr.control2 = controlPoints.control2;\n\t\t\t} else if (propertyTypeName === 'vector') {\n\t\t\t\tlet prevValue = prev.value as Vector;\n\t\t\t\tlet currValue = curr.value as Vector;\n\t\t\t\tlet nextValue = next.value as Vector;\n\n\t\t\t\tlet prevToCurr = currValue.clone().subtract(prevValue);\n\t\t\t\tlet currToNext = nextValue.clone().subtract(currValue);\n\n\t\t\t\tlet angleFactor = prevToCurr.closestAngleTo(currToNext) * 2 / Math.PI;\n\n\t\t\t\tlet prevControlDist = prevToCurr.length() * controlPointDistanceFactor * angleFactor;\n\t\t\t\tlet nextControlDist = currToNext.length() * controlPointDistanceFactor * angleFactor;\n\n\t\t\t\tlet prevNextDirection = nextValue.clone().subtract(prevValue).setLength(1);\n\n\t\t\t\tcurr.control1 = currValue.clone().subtract(prevNextDirection.clone().multiplyScalar(prevControlDist));\n\t\t\t\tcurr.control2 = currValue.clone().add(prevNextDirection.multiplyScalar(nextControlDist));\n\t\t\t} else if (propertyTypeName === 'color') {\n\t\t\t\tlet rControl = calculateControlPointsForScalar(prev.value.r, curr.value.r, next.value.r);\n\t\t\t\tlet gControl = calculateControlPointsForScalar(prev.value.g, curr.value.g, next.value.g);\n\t\t\t\tlet bControl = calculateControlPointsForScalar(prev.value.b, curr.value.b, next.value.b);\n\t\t\t\tcurr.control1 = new Color(color(rControl.control1), color(gControl.control1), color(bControl.control1));\n\t\t\t\tcurr.control2 = new Color(color(rControl.control2), color(gControl.control2), color(bControl.control2));\n\t\t\t}\n\t\t}\n\t}\n\t/**\n\t * @param frame float because of interpolation\n\t */\n\tsetFrame(frame: number) {\n\t\tlet keyFrames = this.keyFrames;\n\t\tif (keyFrames.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet prev, next;\n\n\t\t// This is optimal enough. This for loop takes 0 time compared to setting the property value.\n\t\tfor (let i = 0; i < keyFrames.length; i++) {\n\t\t\tif (keyFrames[i].frame > frame) {\n\t\t\t\tnext = keyFrames[i];\n\t\t\t\tprev = keyFrames[(i - 1 + keyFrames.length) % keyFrames.length];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (!prev) {\n\t\t\tprev = keyFrames[keyFrames.length - 1];\n\t\t\tnext = keyFrames[0];\n\t\t}\n\n\t\tlet newValue;\n\t\tif (prev === next) {\n\t\t\tnewValue = prev.value;\n\t\t} else {\n\t\t\tlet prevFrame: number = prev.frame;\n\t\t\tif (prevFrame > frame) {\n\t\t\t\tprevFrame -= this.frames;\n\t\t\t}\n\n\t\t\tlet nextFrame: number = next.frame;\n\t\t\tif (nextFrame < frame) {\n\t\t\t\tnextFrame += this.frames;\n\t\t\t}\n\n\t\t\tlet t = (frame - prevFrame) / (nextFrame - prevFrame);\n\t\t\tnewValue = interpolateBezier(prev.value, prev.control2, next.control1, next.value, t, this.animatedProperty.propertyType);\n\t\t\t// newValue = interpolateLinear(prev.value, next.value, t, this.animatedProperty.propertyType);\n\t\t}\n\n\t\tif (this.animatedProperty.value !== newValue) {\n\t\t\tthis.animatedProperty.value = newValue;\n\t\t}\n\t\treturn newValue;\n\t}\n}\n\n// Returns angle that is at most Math.PI away.\nfunction getClosestAngle(origin, target) {\n\tlet diff = target - origin;\n\tif (diff > Math.PI) {\n\t\treturn target - Math.PI * 2;\n\t} else if (diff < -Math.PI) {\n\t\treturn target + Math.PI * 2;\n\t}\n\treturn target;\n}\n\nfunction interpolateBezier(fromValue, control1Value, control2Value, targetValue, t: number, propertyType: PropertyType) {\n\tlet typeName = propertyType.type.name;\n\tif (typeName === 'float') {\n\t\tif (propertyType.getFlag(Prop.flagDegreesInEditor)) {\n\t\t\t// It's angle we are dealing with.\n\t\t\tcontrol1Value = getClosestAngle(fromValue, control1Value);\n\t\t\tcontrol2Value = getClosestAngle(fromValue, control2Value);\n\t\t\ttargetValue = getClosestAngle(fromValue, targetValue);\n\t\t}\n\t\tlet t2 = 1 - t;\n\t\treturn t2 ** 3 * fromValue +\n\t\t\t3 * t2 * t2 * t * control1Value +\n\t\t\t3 * t2 * t * t * control2Value +\n\t\t\tt ** 3 * targetValue;\n\t} else if (typeName === 'vector') {\n\t\treturn fromValue.interpolateCubic(targetValue, control1Value, control2Value, t);\n\t} else if (typeName === 'color') {\n\t\treturn fromValue.interpolateCubic(targetValue, control1Value, control2Value, t);\n\t} else {\n\t\treturn fromValue;\n\t}\n}\n\nfunction interpolateLinear(fromValue, targetValue, t: number, propertyType: PropertyType) {\n\tlet typeName = propertyType.type.name;\n\tif (typeName === 'float') {\n\t\tif (propertyType.getFlag(Prop.flagDegreesInEditor)) {\n\t\t\t// It's angle we are dealing with.\n\t\t\ttargetValue = getClosestAngle(fromValue, targetValue);\n\t\t}\n\t\treturn fromValue + t * (targetValue - fromValue);\n\t} else if (typeName === 'vector') {\n\t\treturn fromValue.interpolateLinear(targetValue, t);\n\t} else if (typeName === 'color') {\n\t\treturn fromValue.interpolateLinear(targetValue, t);\n\t} else {\n\t\treturn fromValue;\n\t}\n}\n\nfunction calculateControlPointsForScalar(prev: number, curr: number, next: number) {\n\tif (curr >= prev && curr >= next || curr <= prev && curr <= next) {\n\t\treturn {\n\t\t\tcontrol1: curr,\n\t\t\tcontrol2: curr\n\t\t};\n\t}\n\n\tlet prevDist = Math.abs(curr - prev);\n\tlet nextDist = Math.abs(next - curr);\n\n\tlet prevNextDirection = (next - prev) < 0 ? -1 : 1;\n\n\treturn {\n\t\tcontrol1: curr - prevNextDirection * prevDist * controlPointDistanceFactor,\n\t\tcontrol2: curr + prevNextDirection * nextDist * controlPointDistanceFactor,\n\t};\n}\n","/*\n milliseconds: how often callback can be called\n callbackLimitMode:\n \t- instant: if it has been quiet, call callback() instantly\n \t- soon: if it has been quiet, call callback() instantly after current code loop\n \t- next: if it has been quiet, call callback() after waiting milliseconds.\n\n When calling the callback, limitMode can be overridden: func(callLimitMode);\n */\nexport function limit(milliseconds, callbackLimitMode = 'soon', callback) {\n\tif (!['instant', 'soon', 'next'].includes(callbackLimitMode))\n\t\tthrow new Error('Invalid callbackLimitMode');\n\n\tlet queueTimeout = null; // non-null when call is in queue\n\tlet lastCall = 0; // last time when callback was called\n\n\tfunction callCallback() {\n\t\tlastCall = Date.now();\n\t\tqueueTimeout = null;\n\t\tcallback();\n\t}\n\tfunction callCallbackWithDelay(delayMilliseconds) {\n\t\tqueueTimeout = setTimeout(callCallback, delayMilliseconds);\n\t}\n\n\treturn function(callLimitMode?) {\n\t\tif (queueTimeout)\n\t\t\treturn;\n\n\t\tlet timeToNextPossibleCall = lastCall + milliseconds - Date.now();\n\t\tif (timeToNextPossibleCall > 0) {\n\t\t\tcallCallbackWithDelay(timeToNextPossibleCall);\n\t\t} else {\n\t\t\tlet mode = callLimitMode || callbackLimitMode;\n\t\t\tif (mode === 'instant')\n\t\t\t\tcallCallback();\n\t\t\telse if (mode === 'soon')\n\t\t\t\tcallCallbackWithDelay(0)\n\t\t\telse if (mode === 'next')\n\t\t\t\tcallCallbackWithDelay(milliseconds)\n\t\t}\n\t}\n}\n","import {\n\texecuteExternal,\n\tchangeType,\n\tChange\n} from './change'\nimport Serializable from './serializable';\nimport {game} from './game';\nimport {limit} from '../util/callLimiter';\nimport {stickyNonModalErrorPopup} from \"../util/popup\";\nimport assert from '../util/assert';\nimport { getSerializable } from './serializableManager';\nimport Property from './property';\nimport { GameEvent, globalEventDispatcher } from './eventDispatcher';\n\nlet options = {\n\tcontext: null, // 'play' or 'edit'. This is communicated to server. Doesn't affect client.\n\tserverToClientEnabled: true,\n\tclientToServerEnabled: false\n};\n\nexport function configureNetSync(_options) {\n\toptions = Object.assign(options, _options);\n}\n\nlet changes = [];\nlet valueChanges = {}; // id => change\n\nfunction isInSceneTree(change) {\n\treturn change.reference._rootType === 'sce';\n}\n\nfunction getQueryVariable(variable) {\n\tvar query = window.location.search.substring(1);\n\tvar vars = query.split('&');\n\tfor (var i = 0; i < vars.length; i++) {\n\t\tvar pair = vars[i].split('=');\n\t\tif (decodeURIComponent(pair[0]) == variable) {\n\t\t\treturn decodeURIComponent(pair[1]);\n\t\t}\n\t}\n\tconsole.log('Query variable %s not found', variable);\n}\n\nfunction changeReceivedOverNet(packedChanges) {\n\tif (!options.serverToClientEnabled)\n\t\treturn;\n\tpackedChanges.forEach(change => {\n\t\tchange = unpackChange(change);\n\t\tif (change) {\n\t\t\texecuteChange(change);\n\t\t}\n\t});\n}\nfunction gameReceivedOverNet(gameData){\n\tconsole.log('receive gameData', gameData);\n\tif (!gameData)\n\t\treturn console.error('Game data was not received');\n\ttry {\n\t\texecuteExternal(() => {\n\t\t\tSerializable.fromJSON(gameData);\n\t\t});\n\t\tlocalStorage.openEditPlayGameId = gameData.id;\n\t\t// location.replace(`${location.origin}${location.pathname}?gameId=${gameData.id}`);\n\t\thistory.replaceState({}, null, `?gameId=${gameData.id}`);\n\t} catch(e) {\n\t\tconsole.error('Game is corrupt.', e);\n\t\tstickyNonModalErrorPopup('Game is corrupt.');\n\t}\n}\n\nglobalEventDispatcher.listen(GameEvent.GLOBAL_CHANGE_OCCURED, change => {\n\tif (change.external || !options.clientToServerEnabled)\n\t\treturn; // Don't send a change that you have received.\n\n\tif (isInSceneTree(change)) // Don't sync scene\n\t\treturn;\n\n\tif (change.type === changeType.setPropertyValue) {\n\t\tlet duplicateChange = valueChanges[change.id];\n\t\tif (duplicateChange) {\n\t\t\tchanges.splice(changes.indexOf(duplicateChange), 1);\n\t\t}\n\t\tvalueChanges[change.id] = change;\n\t}\n\tchanges.push(change);\n\n\tif (sendChanges)\n\t\tsendChanges();\n});\n\nfunction parseSocketMessage(message) {\n\tlet type = message.split(' ')[0];\n\tlet body = message.substring(type.length + 1);\n\tif (body.length > 0)\n\t\tbody = JSON.parse(body);\n\n\tconsole.log('parseSocketMessage', type, body);\n\n\treturn {\n\t\ttype,\n\t\tbody\n\t};\n}\n\nfunction sendSocketMessage(eventName, data) {\n\tif (!socket)\n\t\treturn console.log('Could not send', eventName);\n\n\tif (eventName)\n\t\tsocket.emit(eventName, data);\n\telse\n\t\tsocket.emit(data);\n}\n\nlet listeners = {\n\tdata(result) {\n\t\tlet {profile, gameData, editAccess} = result;\n\t\tlocalStorage.openEditPlayUserId = profile.id;\n\t\tlocalStorage.openEditPlayUserToken = profile.userToken;\n\n\t\tif (!editAccess) {\n\t\t\tglobalEventDispatcher.dispatch('noEditAccess');\n\t\t}\n\n\t\tdelete profile.userToken;\n\t\twindow.user = profile;\n\n\t\tgameReceivedOverNet(gameData);\n\t},\n\tidentifyYourself() {\n\t\tif (game)\n\t\t\treturn location.reload();\n\n\t\tlet gameId = getQueryVariable('gameId') || localStorage.openEditPlayGameId;\n\t\tlet userId = localStorage.openEditPlayUserId; // if doesn't exist, server will create one\n\t\tlet userToken = localStorage.openEditPlayUserToken; // if doesn't exist, server will create one\n\t\tlet context = options.context;\n\t\tsendSocketMessage('identify', {userId, userToken, gameId, context});\n\t},\n\terrorMessage(result) {\n\t\tlet {message, isFatal, data} = result;\n\t\tconsole.error(`Server sent ${isFatal ? 'FATAL ERROR' : 'error'}:`, message, data);\n\t\tif (isFatal) {\n\t\t\tstickyNonModalErrorPopup(message);\n\t\t\t// document.body.textContent = message;\n\t\t}\n\t}\n};\n\nlet sendChanges = limit(200, 'soon', () => {\n\tif (!socket || changes.length === 0 || !options.clientToServerEnabled)\n\t\treturn;\n\n\tlet packedChanges = changes.map(packChange);\n\tchanges.length = 0;\n\tvalueChanges = {};\n\tconsole.log('send change', packedChanges);\n\tsendSocketMessage('', packedChanges);\n});\n\nlet socket;\nfunction connect() {\n\tlet io = window['io'];\n\tif (!io) {\n\t\treturn console.error('socket.io not defined after window load.');\n\t}\n\n\tsocket = new io();\n\tsocket.on('connect', () => {\n\t\tsocket.onevent = packet => {\n\t\t\tlet param1 = packet.data[0];\n\t\t\tif (typeof param1 === 'string') {\n\t\t\t\tlisteners[param1](packet.data[1]);\n\t\t\t} else {\n\t\t\t\t// Optimized change-event\n\t\t\t\tchangeReceivedOverNet(param1);\n\t\t\t}\n\t\t};\n\t\tsocket.on('disconnect', () => {\n\t\t\tconsole.warn('Disconnected!');\n\t\t\tstickyNonModalErrorPopup('Disconnected!');\n\t\t\toptions.serverToClientEnabled = false;\n\t\t\toptions.clientToServerEnabled = false;\n\t\t});\n\t});\n}\nwindow.addEventListener('load', connect);\n\nlet keyToShortKey = {\n\tid: 'i', // obj.id\n\ttype: 't', // changeType.*\n\tvalue: 'v', // value after toJSON\n\tparentId: 'p' // obj._parent.id\n};\nlet shortKeyToKey = {};\nObject.keys(keyToShortKey).forEach(k => {\n\tshortKeyToKey[keyToShortKey[k]] = k;\n});\n\nfunction packChange(change) {\n\tif (change.packedChange)\n\t\treturn change.packedChange; // optimization\n\n\tlet packed = {};\n\ttry {\n\t\tif (change.parent)\n\t\t\tchange.parentId = change.parent.id;\n\n\t\tif (change.type === changeType.addSerializableToTree) {\n\t\t\tif (change.reference) {\n\t\t\t\tchange.value = change.reference.toJSON();\n\t\t\t} else {\n\t\t\t\tassert(false, 'invalid change of type addSerializableToTree', change);\n\t\t\t}\n\t\t} else if (change.value !== undefined) {\n\t\t\tchange.value = change.reference.propertyType.type.toJSON(change.value);\n\t\t}\n\n\t\tObject.keys(keyToShortKey).forEach(key => {\n\t\t\tif (change[key] !== undefined) {\n\t\t\t\tif (key === 'type' && change[key] === changeType.setPropertyValue) return; // optimize most common type\n\t\t\t\tpacked[keyToShortKey[key]] = change[key];\n\t\t\t}\n\t\t});\n\t} catch (e) {\n\t\tconsole.log('PACK ERROR', e);\n\t}\n\treturn packed;\n}\n\nfunction unpackChange(packedChange): Change {\n\tlet change: any = {\n\t\tpackedChange // optimization\n\t};\n\tObject.keys(packedChange).forEach(shortKey => {\n\t\tlet key = shortKeyToKey[shortKey];\n\t\tchange[key] = packedChange[shortKey];\n\t});\n\tif (!change.type)\n\t\tchange.type = changeType.setPropertyValue;\n\n\tif (change.type === changeType.addSerializableToTree) {\n\t\t// reference does not exist because it has not been created yet\n\t\tchange.id = change.value.id;\n\t} else {\n\t\tchange.reference = getSerializable(change.id);\n\t\tif (change.reference) {\n\t\t\tchange.id = change.reference.id;\n\t\t} else {\n\t\t\tconsole.error('received a change with unknown id', change, 'packed:', packedChange);\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tif (change.parentId)\n\t\tchange.parent = getSerializable(change.parentId);\n\treturn change as Change;\n}\n\nfunction executeChange(change: Change) {\n\tlet newScene;\n\n\texecuteExternal(() => {\n\t\tif (change.type === changeType.setPropertyValue) {\n\t\t\t(change.reference as Property).value = (change.reference as Property).propertyType.type.fromJSON(change.value);\n\t\t} else if (change.type === changeType.addSerializableToTree) {\n\t\t\tif (change.parent) {\n\t\t\t\tlet obj = Serializable.fromJSON(change.value);\n\t\t\t\tchange.parent.addChild(obj);\n\t\t\t\tif (obj.threeLetterType === 'ent') {\n\t\t\t\t\tobj.localMaster = false;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tlet obj = Serializable.fromJSON(change.value); // Scene does not need a parent\n\t\t\t\tif (obj.threeLetterType === 'sce')\n\t\t\t\t\tnewScene = obj;\n\t\t\t}\n\t\t} else if (change.type === changeType.deleteAllChildren) {\n\t\t\tchange.reference.deleteChildren();\n\t\t} else if (change.type === changeType.deleteSerializable) {\n\t\t\tchange.reference.delete();\n\t\t} else if (change.type === changeType.move) {\n\t\t\tchange.reference.move(change.parent);\n\t\t}\n\t});\n\n\tif (newScene)\n\t\tnewScene.play();\n}\n","import { scene, forEachScene } from '../core/scene';\nimport debug from './debug'\n\nimport Vector from '../util/vector';\nimport { globalEventDispatcher } from '../core/eventDispatcher';\n\nlet previousWidth = null;\nlet previousHeight = null;\nfunction resizeCanvas() {\n\tif (!scene)\n\t\treturn;\n\n\tlet screen = document.getElementById('screen');\n\n\tfunction setSize(force: boolean = false) {\n\t\tif (!screen)\n\t\t\treturn;\n\n\t\tlet width = window.innerWidth;\n\t\tlet height = window.innerHeight;\n\n\t\tif (!force && width === previousWidth && height === previousHeight)\n\t\t\treturn;\n\n\t\tscreen.style.width = width + 'px';\n\t\tscreen.style.height = height + 'px';\n\n\t\t// Here you can change the resolution of the canvas\n\t\tlet pixels = width * height;\n\t\tlet quality = 1;\n\t\tif (pixels > MAX_PIXELS) {\n\t\t\tquality = Math.sqrt(MAX_PIXELS / pixels);\n\t\t}\n\n\t\tlet screenResolution = new Vector(width, height);\n\t\tlet gameResolution = screenResolution.clone().multiplyScalar(quality);\n\n\t\tscene.resizeCanvas(gameResolution, screenResolution);\n\t\t// scene.renderer.resize(width * quality, height * quality);\n\n\t\twindow.scrollTo(0, 0);\n\n\t\tpreviousWidth = width;\n\t\tpreviousHeight = height;\n\n\t\tglobalEventDispatcher.dispatch('canvas resize', scene);\n\n\t\t// Lets see if it has changed after 200ms.\n\t\tsetTimeout(() => setSize(), 200);\n\t}\n\n\tsetSize(true);\n\n\t// setTimeout(setSize, 50);\n\t// setTimeout(setSize, 400);\n\t// setTimeout(setSize, 1000);\n}\n\nwindow.addEventListener('resize', resizeCanvas);\nforEachScene(resizeCanvas);\n\nconst MAX_PIXELS = 800 * 600;\n","import { keyPressed, key, listenKeyDown, simulateKeyEvent } from '../util/input'\nimport Vector from '../util/vector';\nimport debug from './debug'\n\nexport const CONTROL_SIZE = 70; // pixels\n\nexport default class TouchControl {\n\telement: HTMLElement = null; // document not loaded yet.\n\tstate: boolean = false; // is key binding simulated?\n\tvisible: boolean = false;\n\tcontainsFunc: (point: Vector) => boolean = null;\n\n\tconstructor(public elementId: string, public keyBinding: number, public requireTouchStart = false) {\n\t}\n\n\tinitElement() {\n\t\tif (!this.element)\n\t\t\tthis.element = document.getElementById(this.elementId);\n\t}\n\n\tsetPosition(left: number, right: number, bottom: number) {\n\t\tif (left)\n\t\t\tthis.element.style.left = left + 'px';\n\t\telse\n\t\t\tthis.element.style.right = right + 'px';\n\t\tthis.element.style.bottom = bottom + 'px';\n\t}\n\n\tgetPosition() {\n\t\tlet screen = document.getElementById('screen');\n\t\tlet screenWidth = parseInt(screen.style.width);\n\t\tlet screenHeight = parseInt(screen.style.height);\n\n\t\tlet left = parseInt(this.element.style.left);\n\t\tlet right = parseInt(this.element.style.right);\n\t\tlet bottom = parseInt(this.element.style.bottom);\n\n\t\tlet x = !isNaN(left) ? (left + this.element.offsetWidth / 2) : (screenWidth - right - this.element.offsetWidth / 2);\n\t\tlet y = screenHeight - bottom - this.element.offsetHeight / 2;\n\n\t\treturn new Vector(x, y);\n\t}\n\n\tcontains(point: Vector) {\n\t\tif (!this.visible)\n\t\t\treturn false;\n\n\t\tif (this.containsFunc)\n\t\t\treturn this.containsFunc.call(this, point);\n\n\t\tlet position = this.getPosition();\n\t\treturn position.distance(point) <= CONTROL_SIZE / 2;\n\t}\n\t// function(point) {...}\n\tsetContainsFunction(func: (point: Vector) => boolean) {\n\t\tthis.containsFunc = func;\n\t}\n\n\tsetVisible(visible: boolean) {\n\t\tif (this.visible === visible)\n\t\t\treturn;\n\n\t\tthis.visible = visible;\n\t\tif (visible)\n\t\t\tthis.element.style.display = 'inline-block';\n\t\telse\n\t\t\tthis.element.style.display = 'none';\n\t}\n\n\tsetState(controlContainsATouch: boolean, isTouchStartEvent: boolean) {\n\t\tlet oldState = this.state;\n\n\t\tif (this.requireTouchStart && !this.state && !isTouchStartEvent)\n\t\t\tthis.state = false;\n\t\telse\n\t\t\tthis.state = !!controlContainsATouch;\n\n\t\tif (this.state === oldState)\n\t\t\treturn;\n\n\t\tif (this.state) {\n\t\t\tthis.element.classList.add('pressed');\n\t\t\tsimulateKeyEvent('keydown', this.keyBinding);\n\t\t} else {\n\t\t\tthis.element.classList.remove('pressed');\n\t\t\tsimulateKeyEvent('keyup', this.keyBinding);\n\t\t}\n\t}\n}\n","import {keyPressed, key, listenKeyDown, simulateKeyEvent} from '../util/input'\nimport {forEachScene, scene} from '../core/scene';\nimport Vector from '../util/vector';\nimport { default as TouchControl, CONTROL_SIZE } from './TouchControl';\nimport debug from './debug'\nimport { GameEvent } from '../core/eventDispatcher';\n\nconst ARROW_HITBOX_RADIUS = 110;\n\nconst controls: { [s: string]: TouchControl; } = {\n\ttouchUp:\tnew TouchControl('touchUp',\t\tkey.up),\n\ttouchDown:\tnew TouchControl('touchDown',\tkey.down),\n\ttouchLeft:\tnew TouchControl('touchLeft',\tkey.left),\n\ttouchRight:\tnew TouchControl('touchRight',\tkey.right),\n\ttouchJump:\tnew TouchControl('touchJump',\tkey.up, true),\n\ttouchA:\t\tnew TouchControl('touchA',\t\tkey.space, true),\n\ttouchB:\t\tnew TouchControl('touchB',\t\tkey.b, true)\n};\nconst rightHandControlArray = [controls.touchJump, controls.touchA, controls.touchB];\nconst controlArray = Object.keys(controls).map(key => controls[key]);\n\nwindow.addEventListener('load', () => {\n\tdocument.addEventListener(\"touchmove\", touchChange, {passive: false});\n\tdocument.addEventListener(\"touchstart\", touchChange, {passive: false});\n\tdocument.addEventListener(\"touchend\", touchChange, {passive: false});\n\tdocument.addEventListener(\"scroll\", event => event.preventDefault(), {passive: false});\n\n\twindow.IS_TOUCH_DEVICE = 'ontouchstart' in window || navigator.maxTouchPoints;\n\tif (window.IS_TOUCH_DEVICE)\n\t\tdocument.body.classList.add('touch');\n\n\tif (window.navigator.standalone)\n\t\tdocument.body.classList.add('nativeFullscreen');\n\n\tcontrolArray.forEach(control => control.initElement());\n});\n\nfunction touchChange(event) {\n\tevent.preventDefault();\n\n\tlet touchCoordinates = getTouchCoordinates(event);\n\tcontrolArray.forEach(control => {\n\t\tlet isPressed = !!touchCoordinates.find(coord => control.contains(coord));\n\t\tcontrol.setState(isPressed, event.type === 'touchstart');\n\t});\n}\n\nfunction getTouchCoordinates(touchEvent) {\n\tlet touchCoordinates = [];\n\tfor (let i = 0; i < touchEvent.targetTouches.length; ++i) {\n\t\tlet touch = touchEvent.targetTouches[i];\n\t\ttouchCoordinates.push(new Vector(touch.clientX,touch.clientY));\n\t}\n\treturn touchCoordinates;\n}\n\nforEachScene(() => {\n\tscene.listen(GameEvent.SCENE_START, () => positionControls());\n});\n\nfunction positionControls() {\n\tif (!scene)\n\t\treturn;\n\n\tlet\n\t\tplayerFound = false,\n\t\tjumperFound = false,\n\t\tjumpSpeedFound = false,\n\t\ttopDownFound = false,\n\t\tnextLevelButton = true // Press A to reset. Temp solution.\n\t;\n\n\tlet characterControllers = scene.getComponents('CharacterController');\n\tcharacterControllers.forEach(characterController => {\n\t\tif (characterController.type === 'player') {\n\t\t\tplayerFound = true;\n\t\t\tif (characterController.controlType === 'jumper') {\n\t\t\t\tjumperFound = true;\n\t\t\t\tif (characterController.jumpSpeed !== 0) {\n\t\t\t\t\tjumpSpeedFound = true;\n\t\t\t\t}\n\t\t\t} else if (characterController.controlType === 'top down') {\n\t\t\t\ttopDownFound = true;\n\t\t\t}\n\t\t}\n\t});\n\n\tcontrols.touchUp.setVisible(topDownFound);\n\tcontrols.touchLeft.setVisible(playerFound);\n\tcontrols.touchRight.setVisible(playerFound);\n\tcontrols.touchDown.setVisible(topDownFound);\n\tcontrols.touchJump.setVisible(jumpSpeedFound);\n\tcontrols.touchA.setVisible(nextLevelButton); // Temp solution.\n\tcontrols.touchB.setVisible(false);\n\n\tif (controls.touchUp.visible && controls.touchDown.visible) {\n\t\tcontrols.touchLeft.setPosition(10, null, 60);\n\t\tcontrols.touchRight.setPosition(110, null, 60);\n\t\tcontrols.touchUp.setPosition(60, null, 110);\n\t\tcontrols.touchDown.setPosition(60, null, 10);\n\n\t\tcontrols.touchLeft.setContainsFunction(point => {\n\t\t\tlet rel = getRelativePositionToArrowCenter(point);\n\t\t\treturn rel.x < 0 && Math.abs(rel.x) > Math.abs(rel.y) && rel.length() <= ARROW_HITBOX_RADIUS;\n\t\t});\n\n\t\tcontrols.touchUp.setContainsFunction(point => {\n\t\t\tlet rel = getRelativePositionToArrowCenter(point);\n\t\t\treturn rel.y < 0 && Math.abs(rel.y) > Math.abs(rel.x) && rel.length() <= ARROW_HITBOX_RADIUS;\n\t\t});\n\n\t\tcontrols.touchRight.setContainsFunction(point => {\n\t\t\tlet rel = getRelativePositionToArrowCenter(point);\n\t\t\treturn rel.x > 0 && Math.abs(rel.x) > Math.abs(rel.y) && rel.length() <= ARROW_HITBOX_RADIUS;\n\t\t});\n\n\t\tcontrols.touchDown.setContainsFunction(point => {\n\t\t\tlet rel = getRelativePositionToArrowCenter(point);\n\t\t\treturn rel.y > 0 && Math.abs(rel.y) > Math.abs(rel.x) && rel.length() <= ARROW_HITBOX_RADIUS;\n\t\t});\n\t} else {\n\t\tcontrols.touchLeft.setPosition(10, null, 20);\n\t\tcontrols.touchRight.setPosition(90, null, 20);\n\n\t\tcontrols.touchLeft.setContainsFunction(point => {\n\t\t\tlet rel = getRelativePositionToArrowCenter(point);\n\t\t\treturn rel.x <= 0 && rel.y > -ARROW_HITBOX_RADIUS;\n\t\t});\n\t\tcontrols.touchRight.setContainsFunction(point => {\n\t\t\tlet rel = getRelativePositionToArrowCenter(point);\n\t\t\treturn rel.x > 0 && rel.y > -ARROW_HITBOX_RADIUS && rel.x < ARROW_HITBOX_RADIUS;\n\t\t});\n\t}\n\n\tconst SIDE_BUTTON_EXTRA_LEFT_HITBOX = 15; // pixels\n\tlet visibleRightHandControls = rightHandControlArray.filter(control => control.visible);\n\tvisibleRightHandControls.forEach((control, idx) => {\n\t\tlet idxFromRightWall = visibleRightHandControls.length - 1 - idx;\n\t\tcontrol.setPosition(null, 10 + idxFromRightWall * 20, 20 + idx * 70);\n\n\t\tif (idx === 0) {\n\t\t\t// Bottom right corner control\n\t\t\tcontrol.setContainsFunction(point => {\n\t\t\t\tlet pos = control.getPosition();\n\t\t\t\treturn point.x >= pos.x - CONTROL_SIZE / 2 - SIDE_BUTTON_EXTRA_LEFT_HITBOX && point.y >= pos.y - CONTROL_SIZE / 2;\n\t\t\t});\n\t\t} else {\n\t\t\tcontrol.setContainsFunction(point => {\n\t\t\t\tlet pos = control.getPosition();\n\t\t\t\treturn point.y >= pos.y - CONTROL_SIZE / 2 && point.y <= pos.y + CONTROL_SIZE / 2 && point.x >= pos.x - CONTROL_SIZE / 2 - SIDE_BUTTON_EXTRA_LEFT_HITBOX;\n\t\t\t});\n\t\t}\n\t});\n}\n\nfunction getArrowCenter() {\n\tlet leftPos = controls.touchLeft.getPosition();\n\tlet rightPos = controls.touchRight.getPosition();\n\tlet center = leftPos.add(rightPos).divideScalar(2);\n\treturn center;\n}\nfunction getRelativePositionToArrowCenter(point) {\n\tlet center = getArrowCenter();\n\treturn point.clone().subtract(center);\n}\n","import '../core/index'\nimport '../components'\nimport { keyPressed, key, listenKeyDown, simulateKeyEvent } from '../util/input'\nimport { scene, forEachScene } from '../core/scene';\nimport { forEachGame } from '../core/game';\nimport { configureNetSync } from '../core/net'\nimport { disableAllChanges } from '../core/property';\n\nimport './canvasResize'\nimport './touchControlManager'\n\nimport * as fullscreen from '../util/fullscreen';\nimport Level from '../core/level';\nimport { GameEvent } from '../core/eventDispatcher';\n\ndisableAllChanges();\n\nconfigureNetSync({\n\tserverToClientEnabled: true,\n\tclientToServerEnabled: false,\n\tcontext: 'play'\n});\n\nforEachGame(game => {\n\tlet levelIndex = 0;\n\n\tfunction play() {\n\t\tlet levels = game.getChildren('lvl') as Array<Level>;\n\t\tif (levelIndex >= levels.length)\n\t\t\tlevelIndex = 0;\n\t\tlevels[levelIndex].createScene().play();\n\t}\n\n\tplay();\n\tif (window['introLogo']) {\n\t\twindow['introLogo'].style.display = 'none';\n\t}\n\n\tgame.listen(GameEvent.GAME_LEVEL_COMPLETED, () => {\n\t\tlevelIndex++;\n\t\tplay();\n\t});\n});\n\nlistenKeyDown(keyValue => {\n\tif (keyValue === key.space && scene)\n\t\tscene.win();\n});\n\n\n\n// Fullscreen\n/*\nif (fullscreen.fullscreenSupport()) {\n\twindow.addEventListener('click', () => fullscreen.toggleFullscreen(window.document.body));\n}\nsetTimeout(() => {\n\tdocument.getElementById('fullscreenInfo').classList.add('showSlowly');\n}, 1000);\nsetTimeout(() => {\n\tdocument.getElementById('fullscreenInfo').classList.remove('showSlowly');\n}, 3000);\n*/\n"],"names":["this","assertChangeGetter","tslib_1.__extends","arguments","text","PIXI","isClient","performance","performanceTool.start","performanceTool.stop","performanceTool.eventHappened","performance.start","performance.stop","propertyTypes","p2","key","game"],"mappings":"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"}