{"version":3,"file":null,"sources":["../src/homepage/util.ts","../node_modules/redom/dist/redom.es.js","../src/homepage/profile.ts","../src/homepage/contextMenu.ts","../src/homepage/gameElement.ts","../src/homepage/main.ts"],"sourcesContent":["export function getAjax(url) {\n\treturn new Promise(function(resolve, reject) {\n\t\tlet xhttp = new XMLHttpRequest();\n\t\txhttp.onreadystatechange = function() {\n\t\t\tif (this.readyState == 4) {\n\t\t\t\tif (this.status === 200)\n\t\t\t\t\tresolve(JSON.parse(this.responseText));\n\t\t\t\telse\n\t\t\t\t\treject();\n\t\t\t}\n\t\t};\n\t\txhttp.open(\"GET\", url, true);\n\t\txhttp.send();\n\t});\n}\n\nexport function standaloneMobileLinkClickEventSupport(e) {\n\tif (window.navigator.standalone) {\n\t\te.preventDefault();\n\t\tlet url = e.target.getAttribute('href');\n\t\twindow.location.href = url;\n\t}\n}\n\n// 2016-01-01 -> 3 years ago\nexport function dateToAgoFormat(date) {\n\tdate = new Date(date);\n\t\n\tlet now = new Date();\n\tlet diffSeconds = (now - date) / 1000;\n\tif (diffSeconds < 10) {\n\t\treturn 'now';\n\t} else if (diffSeconds < 60) {\n\t\treturn 'less than minute ago';\n\t}\n\t\n\tlet diffMinutes = diffSeconds / 60;\n\t\n\tif (diffMinutes < 2) {\n\t\treturn 'minute ago';\n\t} else if (diffMinutes < 60) {\n\t\treturn `${diffMinutes | 0} minutes ago`;\n\t}\n\n\tlet diffHours = diffMinutes / 60;\n\n\tif (diffHours < 2) {\n\t\treturn 'hour ago';\n\t} else if (diffHours < 24) {\n\t\treturn `${diffHours | 0} hours ago`;\n\t}\n\n\tlet diffDays = diffHours / 60;\n\n\tif (diffDays < 2) {\n\t\treturn 'day ago';\n\t} else if (diffDays < 7) {\n\t\treturn `${diffDays | 0} days ago`;\n\t}\n\t\n\tlet diffWeeks = diffDays / 7;\n\t\n\tif (diffWeeks < 2) {\n\t\treturn 'week ago';\n\t} else if (diffWeeks < 4) {\n\t\treturn `${diffDays | 0} weeks ago`;\n\t}\n\n\tlet diffMonths = diffDays / 30;\n\n\tif (diffMonths < 2) {\n\t\treturn 'month ago';\n\t} else if (diffMonths < 12) {\n\t\treturn `${diffMonths | 0} months ago`;\n\t}\n\n\tlet diffYears = diffDays / 365;\n\n\tif (diffYears < 2) {\n\t\treturn 'year ago';\n\t} else {\n\t\treturn `${diffYears | 0} years ago`;\n\t}\n}\n","var HASH = '#'.charCodeAt(0);\nvar DOT = '.'.charCodeAt(0);\n\nvar TAG_NAME = 0;\nvar ID = 1;\nvar CLASS_NAME = 2;\n\nvar parseQuery = function (query) {\n  var tag = null;\n  var id = null;\n  var className = null;\n  var mode = TAG_NAME;\n  var offset = 0;\n\n  for (var i = 0; i <= query.length; i++) {\n    var char = query.charCodeAt(i);\n    var isHash = char === HASH;\n    var isDot = char === DOT;\n    var isEnd = !char;\n\n    if (isHash || isDot || isEnd) {\n      if (mode === TAG_NAME) {\n        if (i === 0) {\n          tag = 'div';\n        } else {\n          tag = query.substring(offset, i);\n        }\n      } else if (mode === ID) {\n        id = query.substring(offset, i);\n      } else {\n        if (className) {\n          className += ' ' + query.substring(offset, i);\n        } else {\n          className = query.substring(offset, i);\n        }\n      }\n\n      if (isHash) {\n        mode = ID;\n      } else if (isDot) {\n        mode = CLASS_NAME;\n      }\n\n      offset = i + 1;\n    }\n  }\n\n  return { tag: tag, id: id, className: className };\n};\n\nvar createElement = function (query, ns) {\n  var ref = parseQuery(query);\n  var tag = ref.tag;\n  var id = ref.id;\n  var className = ref.className;\n  var element = ns ? document.createElementNS(ns, tag) : document.createElement(tag);\n\n  if (id) {\n    element.id = id;\n  }\n\n  if (className) {\n    if (ns) {\n      element.setAttribute('class', className);\n    } else {\n      element.className = className;\n    }\n  }\n\n  return element;\n};\n\nvar unmount = function (parent, child) {\n  var parentEl = getEl(parent);\n  var childEl = getEl(child);\n\n  if (child === childEl && childEl.__redom_view) {\n    // try to look up the view if not provided\n    child = childEl.__redom_view;\n  }\n\n  if (childEl.parentNode) {\n    doUnmount(child, childEl, parentEl);\n\n    parentEl.removeChild(childEl);\n  }\n\n  return child;\n};\n\nvar doUnmount = function (child, childEl, parentEl) {\n  var hooks = childEl.__redom_lifecycle;\n\n  if (hooksAreEmpty(hooks)) {\n    childEl.__redom_mounted = false;\n    return;\n  }\n\n  var traverse = parentEl;\n\n  if (childEl.__redom_mounted) {\n    trigger(childEl, 'onunmount');\n  }\n\n  while (traverse) {\n    var parentHooks = traverse.__redom_lifecycle || {};\n\n    for (var hook in hooks) {\n      if (parentHooks[hook]) {\n        parentHooks[hook] -= hooks[hook];\n      }\n    }\n\n    if (hooksAreEmpty(parentHooks)) {\n      traverse.__redom_lifecycle = null;\n    }\n\n    traverse = traverse.parentNode;\n  }\n};\n\nvar hooksAreEmpty = function (hooks) {\n  if (hooks == null) {\n    return true;\n  }\n  for (var key in hooks) {\n    if (hooks[key]) {\n      return false;\n    }\n  }\n  return true;\n};\n\nvar hookNames = ['onmount', 'onunmount'];\nvar shadowRootAvailable = typeof window !== 'undefined' && 'ShadowRoot' in window;\n\nvar mount = function (parent, child, before) {\n  var parentEl = getEl(parent);\n  var childEl = getEl(child);\n\n  if (child === childEl && childEl.__redom_view) {\n    // try to look up the view if not provided\n    child = childEl.__redom_view;\n  }\n\n  if (child !== childEl) {\n    childEl.__redom_view = child;\n  }\n\n  var wasMounted = childEl.__redom_mounted;\n  var oldParent = childEl.parentNode;\n\n  if (wasMounted && (oldParent !== parentEl)) {\n    doUnmount(child, childEl, oldParent);\n  }\n\n  if (before != null) {\n    parentEl.insertBefore(childEl, getEl(before));\n  } else {\n    parentEl.appendChild(childEl);\n  }\n\n  doMount(child, childEl, parentEl, oldParent);\n\n  return child;\n};\n\nvar doMount = function (child, childEl, parentEl, oldParent) {\n  var hooks = childEl.__redom_lifecycle || (childEl.__redom_lifecycle = {});\n  var remount = (parentEl === oldParent);\n  var hooksFound = false;\n\n  for (var i = 0; i < hookNames.length; i++) {\n    var hookName = hookNames[i];\n\n    if (!remount && (child !== childEl) && (hookName in child)) {\n      hooks[hookName] = (hooks[hookName] || 0) + 1;\n    }\n    if (hooks[hookName]) {\n      hooksFound = true;\n    }\n  }\n\n  if (!hooksFound) {\n    childEl.__redom_mounted = true;\n    return;\n  }\n\n  var traverse = parentEl;\n  var triggered = false;\n\n  if (remount || (!triggered && (traverse && traverse.__redom_mounted))) {\n    trigger(childEl, remount ? 'onremount' : 'onmount');\n    triggered = true;\n  }\n\n  if (remount) {\n    return;\n  }\n\n  while (traverse) {\n    var parent = traverse.parentNode;\n    var parentHooks = traverse.__redom_lifecycle || (traverse.__redom_lifecycle = {});\n\n    for (var hook in hooks) {\n      parentHooks[hook] = (parentHooks[hook] || 0) + hooks[hook];\n    }\n\n    if (!triggered && (traverse === document || (shadowRootAvailable && (traverse instanceof window.ShadowRoot)) || (parent && parent.__redom_mounted))) {\n      trigger(traverse, remount ? 'onremount' : 'onmount');\n      triggered = true;\n    }\n\n    traverse = parent;\n  }\n};\n\nvar trigger = function (el, eventName) {\n  if (eventName === 'onmount') {\n    el.__redom_mounted = true;\n  } else if (eventName === 'onunmount') {\n    el.__redom_mounted = false;\n  }\n\n  var hooks = el.__redom_lifecycle;\n\n  if (!hooks) {\n    return;\n  }\n\n  var view = el.__redom_view;\n  var hookCount = 0;\n\n  view && view[eventName] && view[eventName]();\n\n  for (var hook in hooks) {\n    if (hook) {\n      hookCount++;\n    }\n  }\n\n  if (hookCount) {\n    var traverse = el.firstChild;\n\n    while (traverse) {\n      var next = traverse.nextSibling;\n\n      trigger(traverse, eventName);\n\n      traverse = next;\n    }\n  }\n};\n\nvar setStyle = function (view, arg1, arg2) {\n  var el = getEl(view);\n\n  if (arg2 !== undefined) {\n    el.style[arg1] = arg2;\n  } else if (isString(arg1)) {\n    el.setAttribute('style', arg1);\n  } else {\n    for (var key in arg1) {\n      setStyle(el, key, arg1[key]);\n    }\n  }\n};\n\n/* global SVGElement */\n\nvar xlinkns = 'http://www.w3.org/1999/xlink';\n\nvar setAttr = function (view, arg1, arg2) {\n  var el = getEl(view);\n  var isSVG = el instanceof SVGElement;\n\n  if (arg2 !== undefined) {\n    if (arg1 === 'style') {\n      setStyle(el, arg2);\n    } else if (isSVG && isFunction(arg2)) {\n      el[arg1] = arg2;\n    } else if (arg1 === 'dataset') {\n      setData(el, arg2);\n    } else if (!isSVG && (arg1 in el || isFunction(arg2))) {\n      el[arg1] = arg2;\n    } else {\n      if (isSVG && (arg1 === 'xlink')) {\n        setXlink(el, arg2);\n        return;\n      }\n      el.setAttribute(arg1, arg2);\n    }\n  } else {\n    for (var key in arg1) {\n      setAttr(el, key, arg1[key]);\n    }\n  }\n};\n\nfunction setXlink (el, obj) {\n  for (var key in obj) {\n    el.setAttributeNS(xlinkns, key, obj[key]);\n  }\n}\n\nfunction setData (el, obj) {\n  for (var key in obj) {\n    el.dataset[key] = obj[key];\n  }\n}\n\nvar text = function (str) { return document.createTextNode((str != null) ? str : ''); };\n\nvar parseArguments = function (element, args) {\n  for (var i = 0; i < args.length; i++) {\n    var arg = args[i];\n\n    if (arg !== 0 && !arg) {\n      continue;\n    }\n\n    // support middleware\n    if (typeof arg === 'function') {\n      arg(element);\n    } else if (isString(arg) || isNumber(arg)) {\n      element.appendChild(text(arg));\n    } else if (isNode(getEl(arg))) {\n      mount(element, arg);\n    } else if (arg.length) {\n      parseArguments(element, arg);\n    } else if (typeof arg === 'object') {\n      setAttr(element, arg);\n    }\n  }\n};\n\nvar ensureEl = function (parent) { return isString(parent) ? html(parent) : getEl(parent); };\nvar getEl = function (parent) { return (parent.nodeType && parent) || (!parent.el && parent) || getEl(parent.el); };\n\nvar isString = function (a) { return typeof a === 'string'; };\nvar isNumber = function (a) { return typeof a === 'number'; };\nvar isFunction = function (a) { return typeof a === 'function'; };\n\nvar isNode = function (a) { return a && a.nodeType; };\n\nvar htmlCache = {};\n\nvar memoizeHTML = function (query) { return htmlCache[query] || (htmlCache[query] = createElement(query)); };\n\nvar html = function (query) {\n  var args = [], len = arguments.length - 1;\n  while ( len-- > 0 ) args[ len ] = arguments[ len + 1 ];\n\n  var element;\n\n  if (isString(query)) {\n    element = memoizeHTML(query).cloneNode(false);\n  } else if (isNode(query)) {\n    element = query.cloneNode(false);\n  } else {\n    throw new Error('At least one argument required');\n  }\n\n  parseArguments(element, args);\n\n  return element;\n};\n\nhtml.extend = function (query) {\n  var args = [], len = arguments.length - 1;\n  while ( len-- > 0 ) args[ len ] = arguments[ len + 1 ];\n\n  var clone = memoizeHTML(query);\n\n  return html.bind.apply(html, [ this, clone ].concat( args ));\n};\n\nvar el = html;\nvar h = html;\n\nvar setChildren = function (parent) {\n  var children = [], len = arguments.length - 1;\n  while ( len-- > 0 ) children[ len ] = arguments[ len + 1 ];\n\n  var parentEl = getEl(parent);\n  var current = traverse(parent, children, parentEl.firstChild);\n\n  while (current) {\n    var next = current.nextSibling;\n\n    unmount(parent, current);\n\n    current = next;\n  }\n};\n\nfunction traverse (parent, children, _current) {\n  var current = _current;\n\n  for (var i = 0; i < children.length; i++) {\n    var child = children[i];\n\n    if (!child) {\n      continue;\n    }\n\n    var childEl = getEl(child);\n\n    if (childEl === current) {\n      current = current.nextSibling;\n      continue;\n    }\n\n    if (isNode(childEl)) {\n      mount(parent, child, current);\n      continue;\n    }\n\n    if (child.length != null) {\n      current = traverse(parent, child, current);\n    }\n  }\n\n  return current;\n}\n\nvar propKey = function (key) { return function (item) { return item[key]; }; };\n\nvar listPool = function (View, key, initData) {\n  return new ListPool(View, key, initData);\n};\n\nvar ListPool = function ListPool (View, key, initData) {\n  this.View = View;\n  this.initData = initData;\n  this.oldLookup = {};\n  this.lookup = {};\n  this.oldViews = [];\n  this.views = [];\n\n  if (key != null) {\n    this.lookup = {};\n    this.key = isFunction(key) ? key : propKey(key);\n  }\n};\nListPool.prototype.update = function update (data, context) {\n  var ref = this;\n    var View = ref.View;\n    var key = ref.key;\n    var initData = ref.initData;\n  var keySet = key != null;\n\n  var oldLookup = this.lookup;\n  var newLookup = {};\n\n  var newViews = new Array(data.length);\n  var oldViews = this.views;\n\n  for (var i = 0; i < data.length; i++) {\n    var item = data[i];\n    var view = (void 0);\n\n    if (keySet) {\n      var id = key(item);\n      view = oldLookup[id] || new View(initData, item, i, data);\n      newLookup[id] = view;\n      view.__redom_id = id;\n    } else {\n      view = oldViews[i] || new View(initData, item, i, data);\n    }\n    view.update && view.update(item, i, data, context);\n\n    var el = getEl(view.el);\n    el.__redom_view = view;\n    newViews[i] = view;\n  }\n\n  this.oldViews = oldViews;\n  this.views = newViews;\n\n  this.oldLookup = oldLookup;\n  this.lookup = newLookup;\n};\n\nvar list = function (parent, View, key, initData) {\n  return new List(parent, View, key, initData);\n};\n\nvar List = function List (parent, View, key, initData) {\n  this.__redom_list = true;\n  this.View = View;\n  this.initData = initData;\n  this.views = [];\n  this.pool = new ListPool(View, key, initData);\n  this.el = ensureEl(parent);\n  this.keySet = key != null;\n};\nList.prototype.update = function update (data, context) {\n    var this$1 = this;\n    if ( data === void 0 ) data = [];\n\n  var ref = this;\n    var keySet = ref.keySet;\n  var oldViews = this.views;\n  var oldLookup = keySet && this.lookup;\n\n  this.pool.update(data, context);\n  var ref$1 = this.pool;\n    var views = ref$1.views;\n    var lookup = ref$1.lookup;\n\n  if (keySet) {\n    for (var i = 0; i < oldViews.length; i++) {\n      var id = oldViews[i].__redom_id;\n      if (!(id in lookup)) {\n        unmount(this$1, oldLookup[id]);\n      }\n    }\n  }\n\n  setChildren(this, views);\n\n  if (keySet) {\n    this.lookup = lookup;\n  }\n  this.views = views;\n};\n\nList.extend = function (parent, View, key, initData) {\n  return List.bind(List, parent, View, key, initData);\n};\n\nlist.extend = List.extend;\n\n/* global Node */\n\nvar place = function (View, initData) {\n  return new Place(View, initData);\n};\n\nvar Place = function Place (View, initData) {\n  this.el = text('');\n  this.visible = false;\n  this.view = null;\n  this._placeholder = this.el;\n  if (View instanceof Node) {\n    this._el = View;\n  } else {\n    this._View = View;\n  }\n  this._initData = initData;\n};\nPlace.prototype.update = function update (visible, data) {\n  var placeholder = this._placeholder;\n  var parentNode = this.el.parentNode;\n\n  if (visible) {\n    if (!this.visible) {\n      if (this._el) {\n        mount(parentNode, this._el, placeholder);\n        unmount(parentNode, placeholder);\n        this.el = this._el;\n        this.visible = visible;\n        return;\n      }\n      var View = this._View;\n      var view = new View(this._initData);\n\n      this.el = getEl(view);\n      this.view = view;\n\n      mount(parentNode, view, placeholder);\n      unmount(parentNode, placeholder);\n    }\n    this.view && this.view.update && this.view.update(data);\n  } else {\n    if (this.visible) {\n      if (this._el) {\n        mount(parentNode, placeholder, this._el);\n        unmount(parentNode, this._el);\n        this.el = placeholder;\n        this.visible = visible;\n        return;\n      }\n      mount(parentNode, placeholder, this.view);\n      unmount(parentNode, this.view);\n\n      this.el = placeholder;\n      this.view = null;\n    }\n  }\n  this.visible = visible;\n};\n\nvar router = function (parent, Views, initData) {\n  return new Router(parent, Views, initData);\n};\n\nvar Router = function Router (parent, Views, initData) {\n  this.el = ensureEl(parent);\n  this.Views = Views;\n  this.initData = initData;\n};\nRouter.prototype.update = function update (route, data) {\n  if (route !== this.route) {\n    var Views = this.Views;\n    var View = Views[route];\n\n    this.route = route;\n    this.view = View && new View(this.initData, data);\n\n    setChildren(this.el, [ this.view ]);\n  }\n  this.view && this.view.update && this.view.update(data, route);\n};\n\nvar ns = 'http://www.w3.org/2000/svg';\n\nvar svgCache = {};\n\nvar memoizeSVG = function (query) { return svgCache[query] || (svgCache[query] = createElement(query, ns)); };\n\nvar svg = function (query) {\n  var args = [], len = arguments.length - 1;\n  while ( len-- > 0 ) args[ len ] = arguments[ len + 1 ];\n\n  var element;\n\n  if (isString(query)) {\n    element = memoizeSVG(query).cloneNode(false);\n  } else if (isNode(query)) {\n    element = query.cloneNode(false);\n  } else {\n    throw new Error('At least one argument required');\n  }\n\n  parseArguments(element, args);\n\n  return element;\n};\n\nsvg.extend = function (query) {\n  var clone = memoizeSVG(query);\n\n  return svg.bind(this, clone);\n};\n\nsvg.ns = ns;\n\nvar s = svg;\n\nexport { el, h, html, list, List, listPool, ListPool, mount, unmount, place, Place, router, Router, setAttr, setStyle, setChildren, s, svg, text };\n","import {getAjax} from \"./util\";\nimport {el, mount, list} from 'redom';\n\nlet profile = {};\n\nlet profileButton = null;\nlet profileMenu = null;\nlet buttonContainer = null;\n\nlet windowLoadPromise = new Promise((resolve, reject) => window.addEventListener('load', resolve));\n\nlet promiseResolve = null;\nexport let profilePromise = new Promise((resolve, reject) => {\n\tpromiseResolve = resolve;\n});\n\nexport function setButtonContainer(container) {\n\tif (buttonContainer)\n\t\treturn console.error('profile.setButtonContainer can only be called once');\n\tbuttonContainer = container;\n\n\t// return; // Remove this line to enable profile\n\n\twindowLoadPromise.then(() => {\n\t\tprofileButton = new ProfileButton();\n\t\tprofileMenu = new ProfileMenu();\n\n\t\tmount(document.body, profileMenu);\n\t\tmount(buttonContainer, profileButton);\n\n\t\tgetAjax(`/api/profile?userId=${localStorage.openEditPlayUserId}&userToken=${localStorage.openEditPlayUserToken}`).then(user => {\n\t\t\tdelete user.userToken;\n\t\t\tif (user.games)\n\t\t\t\tuser.gameIdList = user.games.map(game => game.id);\n\t\t\twindow.user = user;\n\t\t\tif (promiseResolve)\n\t\t\t\tpromiseResolve(user) && console.log('resolved');\n\t\t\tprofileMenu.gamesCreated.textContent = user.games;\n\t\t});\n\t});\n}\n\nclass ProfileButton {\n\tconstructor() {\n\t\tthis.el = el('img.profileButton', {\n\t\t\tsrc: '/img/profile.png',\n\t\t\tonclick: () => profileMenu.el.classList.toggle('visible')\n\t\t});\n\t}\n\n\tupdate(data) {\n\t}\n}\n\nclass ProfileMenu {\n\tconstructor() {\n\t\tthis.el = el('div.profileMenu',\n\t\t\tel('div.profileMenuContent',\n\t\t\t\tel('div.gamesCreatedBlock',\n\t\t\t\t\t'Welcome to Open Edit Play! Play or Edit a game and profile will be created for you.',\n\t\t\t\t\tel('div'),\n\t\t\t\t\t'Games created: ',\n\t\t\t\t\tthis.gamesCreated = el('span.gamesCreated')\n\t\t\t\t)\n\t\t\t),\n\t\t\t{\n\t\t\t\tonclick: () => profileMenu.el.classList.toggle('visible')\n\t\t\t}\n\t\t);\n\t}\n\n\tupdate(data) {\n\t}\n}\n\n\n/*\nWhat?\n\nremember games that i have created\naccess games that i have created\n\n\n\n\n\n\n\n\n\n */\n","import {el, mount, list} from 'redom';\n\n// item: {label, callback}\nexport class ContextMenu {\n\tconstructor(triggerElement, items) {\n\t\tlet triggerBounds = triggerElement.getBoundingClientRect();\n\t\t\n\n\t\tthis.el = el('div.contextMenu', {\n\t\t\tstyle: {\n\t\t\t\ttop: (triggerBounds.bottom + window.pageYOffset) + 'px',\n\t\t\t\tleft: triggerBounds.left + 'px'\n\t\t\t}\n\t\t});\n\t\tthis.list = list(this.el, ContextMenuItem);\n\t\tthis.list.update(items);\n\t\t\n\t\tsetTimeout(() => {\n\t\t\tthis.eventListener = window.addEventListener('click', () => {\n\t\t\t\tthis.remove();\n\t\t\t});\n\t\t}, 0);\n\t\t\n\t\tmount(document.body, this.el);\n\t}\n\t\n\tremove() {\n\t\tif (this.eventListener) \n\t\t\twindow.removeEventListener('click', this.eventListener);\n\t\t\n\t\tif (this.el.parentNode)\n\t\t\tthis.el.parentNode.removeChild(this.el);\n\t}\n}\n\nclass ContextMenuItem {\n\tconstructor() {\n\t\tthis.el = el('div.contextMenuItem',\n\t\t\t{\n\t\t\t\tonclick: () => this.callback && this.callback()\n\t\t\t}\n\t\t);\n\n\t\tthis.callback = null;\n\t}\n\n\tupdate(data) {\n\t\tthis.el.textContent = data.label;\n\t\tthis.callback = data.callback;\n\t}\n}\n","import {dateToAgoFormat, standaloneMobileLinkClickEventSupport} from \"./util\";\nimport {ContextMenu} from \"./contextMenu\";\nimport {el, mount, list} from 'redom';\nimport {profilePromise} from \"./profile\";\n\nconst sizeExplanation = 'Game size in data units. Every object in scene, type, component, level and property is a data unit.';\n\nexport class GameList {\n\tconstructor() {\n\t\tthis.el = el('div.gameListContainer',\n\t\t\tel('table.gameList',\n\t\t\t\tel('thead.gameListHeader',\n\t\t\t\t\tel('th.gameListHeaderName', 'Name'),\n\t\t\t\t\tel('th.gameListHeaderPlay'),\n\t\t\t\t\tel('th.gameListHeaderSize', 'Size', {title: sizeExplanation}),\n\t\t\t\t\tel('th.gameListHeaderLevels', 'Levels'),\n\t\t\t\t\tel('th.gameListHeaderCreated', 'Created'),\n\t\t\t\t\tel('th.gameListHeaderModified', 'Modified')\n\t\t\t\t),\n\t\t\t\tthis.list = list('tbody.gameListContent', Game)\n\t\t\t)\n\t\t);\n\t}\n\n\tupdate(gameListData) {\n\t\tthis.list.update(gameListData);\n\t}\n}\n\nclass Game {\n\tconstructor() {\n\t\tthis.el = el('tr.gameElement',\n\t\t\tthis.name = el('td.gameElementName'),\n\t\t\tthis.play = el('td.gameElementPlay',\n\t\t\t\tthis.primaryButton = el('a.linkButton', 'Play', {\n\t\t\t\t\tonclick: standaloneMobileLinkClickEventSupport\n\t\t\t\t}),\n\t\t\t\tthis.secondaryButton = el('a.linkButton.hideInSmallScreens.gameElementSecondaryButton', '...', {\n\t\t\t\t\thref: '#',\n\t\t\t\t\tonclick: e => {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tif (this.isMyGame) {\n\t\t\t\t\t\t\twindow.location.href = '/edit/?gameId=' + this.gameId\n\t\t\t\t\t\t\t/*\n\t\t\t\t\t\t\tnew ContextMenu(this.secondaryButton, [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tlabel: 'Edit',\n\t\t\t\t\t\t\t\t\tcallback: () => window.location.href = '/edit/?gameId=' + this.gameId\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]);\t\n\t\t\t\t\t\t\t*/\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tnew ContextMenu(this.secondaryButton, [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tlabel: 'Open editor sandbox',\n\t\t\t\t\t\t\t\t\tcallback: () => window.location.href = '/edit/?gameId=' + this.gameId\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t),\n\t\t\tthis.size = el('td.gameElementSize', {title: sizeExplanation}),\n\t\t\tthis.levels = el('td.gameElementLevels'),\n\t\t\tthis.created = el('td.gameElementCreated'),\n\t\t\tthis.modified = el('td.gameElementModified')\n\t\t);\n\t}\n\n\tupdate(gameData) {\n\t\tthis.isMyGame = null;\n\t\tthis.gameId = gameData.id;\n\t\t\n\t\tthis.name.textContent = gameData.name;\n\t\tthis.size.textContent = gameData.serializableCount;\n\t\tthis.levels.textContent = gameData.levelCount;\n\n\t\tthis.created.textContent = dateToAgoFormat(gameData.createdAt);\n\t\tthis.created.setAttribute('title', new Date(gameData.createdAt).toLocaleString());\n\n\t\tthis.modified.textContent = dateToAgoFormat(gameData.updatedAt);\n\t\tthis.modified.setAttribute('title', new Date(gameData.updatedAt).toLocaleString());\n\n\t\tthis.primaryButton.setAttribute('href', '/play/?gameId=' + gameData.id);\n\t\t\n\t\tprofilePromise.then(user => {\n\t\t\tthis.isMyGame = !!(user.gameIdList && user.gameIdList.includes(gameData.id));\n\t\t\tthis.el.classList.toggle('isMyGame', this.isMyGame);\n\t\t\t\n\t\t\t// this.primaryButton.classList.toggle('playButton', !this.isMyGame);\n\t\t\t// this.primaryButton.classList.toggle('editButton', this.isMyGame);\n\t\t\t\n\t\t\tif (this.isMyGame) {\n\t\t\t\tthis.secondaryButton.textContent = 'Edit';\n\t\t\t} else {\n\t\t\t\tthis.secondaryButton.textContent = '...';\n\t\t\t}\n\t\t});\n\t}\n}\n\n","import {getAjax} from \"./util\";\nimport {el, mount, list, text} from 'redom';\nimport {GameList} from \"./gameElement\";\nimport {profilePromise, setButtonContainer} from \"./profile\";\n\nwindow.IS_SMALL_SCREEN = window.screen.width < 800;\nwindow.IS_MOBILE_STANDALONE = window.navigator.standalone;\n\nwindow.addEventListener('load', () => {\n\tif (IS_SMALL_SCREEN)\n\t\tdocument.body.classList.add('isSmallDevice');\n\t\n\tsetButtonContainer(document.getElementById('profileButtonContainer'));\n\t\n\tlet gamesElement = document.getElementById('games');\n\tgetAjax('/api/gameListSample').then(gameListData => {\n\t\tlet gameList = new GameList();\n\t\tgameList.update(gameListData);\n\t\tmount(gamesElement, gameList);\n\t}).catch((e) => {\n\t\tmount(gamesElement, text('Could not load'));\n\t});\n\n\tprofilePromise.then(profile => {\n\t\tif (!profile.id || profile.games.length === 0)\n\t\t\treturn;\n\t\tlet myGamesElement = document.getElementById('myGames');\n\t\tmyGamesElement.style.display = 'block';\n\t\tlet myGameList = new GameList();\n\t\tmyGameList.update(profile.games);\n\t\tmount(myGamesElement, myGameList);\n\t});\n\n\tlet topBarBackground = document.getElementById('topBarBackground');\n\n\tif (IS_MOBILE_STANDALONE) {\n\t\t// In standalone mode, just show the top bar always. In iOS, scolling events can't be trusted.\n\t\ttopBarBackground.style.opacity = 1;\n\t} else {\n\t\t// In large devices, do mooth scrolling experience\n\n\t\twindow.onscroll = function () {\n\t\t\t\"use strict\";\n\t\t\tlet scroll = document.documentElement.scrollTop || document.body.scrollTop;\n\n\t\t\tlet point1 = 100;\n\t\t\tlet point2 = 350;\n\t\t\tlet fullOpacity = 1;\n\n\t\t\tif (scroll < point1) {\n\t\t\t\ttopBarBackground.style.opacity = 0;\n\t\t\t} else if (scroll < point2) {\n\t\t\t\ttopBarBackground.style.opacity = (scroll - point1) / (point2 - point1) * fullOpacity;\n\t\t\t} else {\n\t\t\t\ttopBarBackground.style.opacity = fullOpacity;\n\t\t\t}\n\t\t};\n\t\twindow.onscroll();\n\t}\n});\n"],"names":["url","Promise","resolve","reject","xhttp","XMLHttpRequest","onreadystatechange","this","readyState","status","JSON","parse","responseText","open","send","e","window","navigator","standalone","preventDefault","target","getAttribute","location","href","date","Date","now","diffSeconds","diffMinutes","diffHours","diffDays","diffWeeks","diffMonths","diffYears","setXlink","el","obj","key","setAttributeNS","xlinkns","setData","dataset","traverse","parent","children","_current","current","i","length","child","childEl","getEl","isNode","mount","nextSibling","container","buttonContainer","console","error","windowLoadPromise","then","profileButton","ProfileButton","profileMenu","ProfileMenu","document","body","getAjax","localStorage","openEditPlayUserId","openEditPlayUserToken","user","userToken","games","gameIdList","map","game","id","promiseResolve","log","gamesCreated","textContent","HASH","charCodeAt","DOT","parseQuery","query","tag","className","mode","offset","char","isHash","isDot","isEnd","substring","createElement","ns","ref","element","createElementNS","setAttribute","unmount","parentEl","__redom_view","parentNode","doUnmount","removeChild","hooks","__redom_lifecycle","hooksAreEmpty","__redom_mounted","trigger","parentHooks","hook","hookNames","shadowRootAvailable","before","wasMounted","oldParent","insertBefore","appendChild","doMount","remount","hooksFound","hookName","triggered","ShadowRoot","eventName","view","hookCount","firstChild","next","setStyle","arg1","arg2","undefined","style","isString","setAttr","isSVG","SVGElement","isFunction","text","str","createTextNode","parseArguments","args","arg","isNumber","ensureEl","html","nodeType","a","htmlCache","memoizeHTML","len","arguments","cloneNode","Error","extend","clone","bind","apply","concat","setChildren","propKey","item","ListPool","View","initData","oldLookup","lookup","oldViews","views","prototype","update","data","context","keySet","newLookup","newViews","Array","__redom_id","list","List","__redom_list","pool","this$1","ref$1","visible","_placeholder","Node","_el","_View","_initData","placeholder","Views","route","svgCache","memoizeSVG","svg","triggerElement","items","triggerBounds","getBoundingClientRect","top","bottom","pageYOffset","left","ContextMenuItem","setTimeout","_this","eventListener","addEventListener","remove","ContextMenu","removeEventListener","onclick","callback","label","profilePromise","src","classList","toggle","sizeExplanation","title","Game","GameList","gameListData","name","play","primaryButton","standaloneMobileLinkClickEventSupport","secondaryButton","isMyGame","gameId","size","levels","created","modified","gameData","serializableCount","levelCount","dateToAgoFormat","createdAt","toLocaleString","updatedAt","includes","IS_SMALL_SCREEN","screen","width","IS_MOBILE_STANDALONE","add","setButtonContainer","getElementById","gamesElement","gameList","catch","profile","myGamesElement","display","myGameList","topBarBackground","opacity","onscroll","scroll","documentElement","scrollTop"],"mappings":"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"}