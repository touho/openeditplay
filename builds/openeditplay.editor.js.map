{"version":3,"file":null,"sources":["../src/util/environment.ts","../src/util/events.ts","../src/util/performance.ts","../src/core/serializable.ts","../src/core/serializableManager.ts","../src/util/assert.ts","../src/core/property.ts","../src/core/propertyType.ts","../src/util/vector.ts","../src/util/color.ts","../src/core/dataTypes.ts","../src/core/propertyOwner.ts","../node_modules/redom/dist/redom.es.js","../src/util/popup.ts","../src/features/graphics.ts","../src/modules/backgroundGradient.ts","../src/core/game.ts","../src/features/physics.ts","../src/util/input.ts","../src/core/scene.ts","../src/core/componentData.ts","../src/core/component.ts","../src/core/entity.ts","../src/core/prototype.ts","../src/core/entityPrototype.ts","../src/core/prefab.ts","../src/core/level.ts","../src/components/Transform.ts","../src/components/TransformVariance.ts","../src/components/Shape.ts","../src/components/Sprite.ts","../src/components/Spawner.ts","../src/components/Trigger.ts","../src/components/Physics.ts","../src/components/Lifetime.ts","../src/components/Particles.ts","../src/util/algorithm.ts","../src/components/CharacterController.ts","../src/util/callLimiter.ts","../src/core/net.ts","../src/editor/layout/moduleContainer.ts","../src/editor/layout/layout.ts","../src/editor/module/module.ts","../src/editor/module/topBar.ts","../src/editor/util/sceneEditUtil.ts","../src/editor/help.ts","../src/editor/widget/widget.ts","../src/editor/widget/angleWidget.ts","../src/editor/widget/positionWidget.ts","../src/editor/widget/scaleWidget.ts","../src/editor/widget/moveWidget.ts","../src/editor/components/EditorWidget.ts","../src/editor/module/scene.ts","../src/editor/module/types.ts","../src/editor/util/dragAndDrop.ts","../src/editor/views/treeView.ts","../src/editor/module/prefabs.ts","../src/editor/views/popup/Popup.ts","../src/editor/views/popup/createObject.ts","../src/editor/module/objects.ts","../src/editor/module/levels.ts","../src/editor/views/propertyEditor/propertyEditorTypes.ts","../src/editor/views/popup/Confirmation.ts","../src/editor/views/popup/componentAdder.ts","../src/editor/views/popup/objectMoreButtonContextMenu.ts","../src/editor/views/propertyEditor/util.ts","../src/editor/views/propertyEditor/propertyEditor.ts","../src/editor/module/type.ts","../src/editor/module/prefab.ts","../src/editor/module/object.ts","../src/editor/module/level.ts","../src/editor/module/game.ts","../src/editor/module/performance.ts","../src/editor/module/perSecond.ts","../src/editor/test/index.ts","../src/editor/views/popup/OKPopup.ts","../src/editor/editor.ts"],"sourcesContent":["let isClient = typeof window !== 'undefined';\nlet isServer = typeof module !== 'undefined';\n\nif (isClient && isServer)\n\tthrow new Error('Can not be client and server at the same time.');\n\nexport { isClient, isServer };\n","/*\n Global event system\n\n let unlisten = events.listen('event name', function(params, ...) {});\n eventManager.dispatch('event name', paramOrParamArray);\n unlisten();\n */\n\nlet listeners = {};\n\nlet events = {\n\t// priority should be a whole number between -100000 and 100000. a smaller priority number means that it will be executed first.\n\tlisten(event, callback, priority = 0) {\n\t\tcallback.priority = priority + (listenerCounter++ / NUMBER_BIGGER_THAN_LISTENER_COUNT);\n\t\tif (!listeners.hasOwnProperty(event)) {\n\t\t\tlisteners[event] = [];\n\t\t}\n\t\t// listeners[event].push(callback);\n\t\t// if (!this._listeners.hasOwnProperty(event)) {\n\t\t// \tthis._listeners[event] = [];\n\t\t// }\n\t\tlet index = indexOfListener(listeners[event], callback);\n\t\tlisteners[event].splice(index, 0, callback);\n\t\treturn () => {\n\t\t\tvar index = listeners[event].indexOf(callback);\n\t\t\tlisteners[event].splice(index, 1);\n\t\t};\n\t},\n\tdispatch(event, ...args) {\n\t\tif (listeners.hasOwnProperty(event)) {\n\t\t\tlet listener = listeners[event];\n\t\t\tfor (var i = 0; i < listener.length; ++i) {\n\t\t\t\tlistener[i].apply(null, args);\n\t\t\t\t/*\n\t\t\t\ttry {\n\t\t\t\t\tlisteners[event][i].apply(null, args);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tif (console && console.sendError) {\n\t\t\t\t\t\tconsole.sendError(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t*/\n\t\t\t}\n\t\t}\n\t},\n\t// Promise is resolved when next event if this type is sent\n\tgetEventPromise(event) {\n\t\treturn new Promise(function(res) {\n\t\t\tevents.listen(event, res);\n\t\t});\n\t}\n};\nexport default events;\n\n// DOM / ReDom event system\n\nexport function dispatch(view, type, data) {\n\tconst el = view === window ? view : view.el || view;\n\tconst debug = 'Debug info ' + new Error().stack;\n\tel.dispatchEvent(new CustomEvent(type, {\n\t\tdetail: { data, debug, view },\n\t\tbubbles: true\n\t}));\n}\nexport function listen(view, type, handler) {\n\tlet el = view === window ? view : view.el || view;\n\tel.addEventListener(type, event => {\n\t\tif (event instanceof CustomEvent)\n\t\t\thandler(event.detail.data, event.detail.view);\n\t\telse\n\t\t\thandler(event);\n\t});\n}\n\nlet listenerCounter = 0;\nconst NUMBER_BIGGER_THAN_LISTENER_COUNT = 10000000000;\n\nfunction indexOfListener(array, callback) {\n\tlet low = 0,\n\t\thigh = array.length,\n\t\tpriority = callback.priority;\n\n\twhile (low < high) {\n\t\tlet mid = low + high >>> 1;\n\t\tif (array[mid].priority < priority) low = mid + 1;\n\t\telse high = mid;\n\t}\n\treturn low;\n}\n","import events from \"./events\";\n\nconst UPDATE_INTERVAL = 1000; //ms\n\nimport { isClient } from './environment';\n\nlet performance;\nperformance = isClient ? window.performance : { now: Date.now };\n\nlet snapshotPerformance = []; // is static data for UPDATE_INTERVAL. then it changes.\nlet cumulativePerformance = {}; // will be reseted every UPDATE_INTERVAL\nlet currentPerformanceMeters = {}; // very short term\n\nlet perSecondSnapshot = [];\nlet currentPerSecondMeters = {};\nexport function eventHappened(name, count = 1) {\n\t// @ifndef OPTIMIZE\n\tcurrentPerSecondMeters[name] = (currentPerSecondMeters[name] || 0) + count;\n\t// @endif\n}\n\nexport function start(name) {\n\t// @ifndef OPTIMIZE\n\tcurrentPerformanceMeters[name] = performance.now();\n\t// @endif\n}\n\nexport function stop(name) {\n\t// @ifndef OPTIMIZE\n\tlet millis = performance.now() - currentPerformanceMeters[name];\n\tif (cumulativePerformance[name])\n\t\tcumulativePerformance[name] += millis;\n\telse\n\t\tcumulativePerformance[name] = millis;\n\t// @endif\n}\n\nlet performanceInterval = null;\nexport function startPerformanceUpdates() {\n\tperformanceInterval = setInterval(() => {\n\t\tprintPrivatePerformance(cumulativePerformance);\n\t\t\n\t\tsnapshotPerformance = performanceObjectToPublicArray(cumulativePerformance);\n\t\tcumulativePerformance = {};\n\t\tevents.dispatch('performance snapshot', snapshotPerformance);\n\n\t\tperSecondSnapshot = perSecondObjectToPublicArray(currentPerSecondMeters);\n\t\tcurrentPerSecondMeters = {};\n\t\tevents.dispatch('perSecond snapshot', perSecondSnapshot);\n\t}, UPDATE_INTERVAL);\n}\n\nfunction printPrivatePerformance(object) {\n\tlet msg = '';\n\tObject.keys(object).filter(key => key.startsWith('#')).map(key => ({\n\t\tname: key,\n\t\tvalue: object[key] / UPDATE_INTERVAL\n\t})).sort((a, b) => {\n\t\treturn a.value < b.value ? 1 : -1;\n\t}).forEach(perf => {\n\t\tmsg += `\\n   ${perf.name.substring(1)}: ${perf.value * 100}`;\n\t});\n\tif (msg)\n\t\tconsole.log('#Performance:' + msg);\n}\n\nfunction performanceObjectToPublicArray(object) {\n\treturn Object.keys(object).filter(key => !key.startsWith('#')).map(key => ({\n\t\tname: key,\n\t\tvalue: object[key] / UPDATE_INTERVAL\n\t})).sort((a, b) => {\n\t\treturn a.value < b.value ? 1 : -1;\n\t});\n}\nfunction perSecondObjectToPublicArray(object) {\n\treturn Object.keys(object).map(key => ({\n\t\tname: key,\n\t\tcount: object[key]\n\t})).sort((a, b) => a.name.localeCompare(b.name));\n}\n\nexport let FRAME_MEMORY_LENGTH = 60 * 8;\nlet frameTimes = [];\nfor (let i = 0; i < FRAME_MEMORY_LENGTH; ++i) {\n\tframeTimes.push(0);\n}\nexport function setFrameTime(seconds) {\n\t// @ifndef OPTIMIZE\n\tframeTimes.shift();\n\tframeTimes.push(seconds);\n\t// @endif\n}\nexport function getFrameTimes() {\n\treturn frameTimes;\n}\n","import assert from '../util/assert';\nimport { addSerializable, removeSerializable, addChange, changeType } from './serializableManager';\nimport { isClient } from '../util/environment';\nimport * as performanceTool from '../util/performance';\n\nconst CHARACTERS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'; // 62 chars\nconst CHAR_COUNT = CHARACTERS.length;\n\nconst random = Math.random;\nexport function createStringId(threeLetterPrefix = '???', characters = 16) {\n\tlet id = threeLetterPrefix;\n\tfor (let i = characters - 1; i >= 0; --i)\n\t\tid += CHARACTERS[random() * CHAR_COUNT | 0];\n\treturn id;\n}\n\nlet serializableClasses = new Map();\n\n/*\nSerializable lifecycle:\n\nfromJSON()\n\n */\n\nexport default class Serializable {\n\tconstructor(predefinedId = false, skipSerializableRegistering = false) {\n// @ifndef OPTIMIZE\n\t\tassert(this.threeLetterType, 'Forgot to Serializable.registerSerializable your class?');\n// @endif\n\t\tthis._children = new Map(); // threeLetterType -> array\n\t\tthis._listeners = {};\n\t\tthis._rootType = this.isRoot ? this.threeLetterType : null;\n\t\tif (skipSerializableRegistering)\n\t\t\treturn;\n\t\tif (predefinedId) {\n\t\t\tthis.id = predefinedId;\n\t\t} else {\n\t\t\tthis.id = createStringId(this.threeLetterType);\n\t\t}\n\t\t/*\n\t\tif (this.id.startsWith('?'))\n\t\t\tthrow new Error('?');\n\t\t\t*/\n\t\taddSerializable(this);\n\t}\n\tmakeUpAName() {\n\t\treturn 'Serializable';\n\t}\n\tdelete() {\n\t\tif (this._parent) {\n\t\t\tthis._parent.deleteChild(this);\n\t\t\treturn false;\n\t\t}\n\t\tthis.deleteChildren();\n\t\tthis._alive = false;\n\t\tthis._rootType = null;\n\t\tthis._listeners = {};\n\t\tremoveSerializable(this.id);\n\t\tthis._state |= Serializable.STATE_DESTROY;\n\t\treturn true;\n\t}\n\tdeleteChildren() {\n\t\tif (this._children.size) {\n\t\t\tthis._children.forEach(array => {\n\t\t\t\tarray.forEach(child => {\n\t\t\t\t\tchild._parent = null;\n\t\t\t\t\tchild.delete();\n\t\t\t\t});\n\t\t\t});\n\t\t\tthis._children.clear();\n\n\t\t\tif (this._parent) {\n\t\t\t\taddChange(changeType.deleteAllChildren, this);\n\t\t\t}\n\t\t}\n\t}\n\t// this is called right after constructor\n\tinitWithChildren(children = []) {\n\t\tassert(!(this._state & Serializable.STATE_INIT), 'init already done');\n\t\tthis._state |= Serializable.STATE_INIT;\n\t\tif (children.length > 0)\n\t\t\tthis.addChildren(children);\n\t\treturn this;\n\t}\n\taddChildren(children) {\n\t\tfor (let i = 0; i < children.length; i++)\n\t\t\tthis.addChild(children[i]);\n\t\treturn this;\n\t}\n\taddChild(child) {\n\t\tthis._addChild(child);\n\t\t\n\t\tthis._state |= Serializable.STATE_ADDCHILD;\n\t\t\n\t\tif (this._rootType)\n\t\t\taddChange(changeType.addSerializableToTree, child);\n\t\treturn this;\n\t}\n\t_addChild(child) {\n\t\tassert(child._parent === null);\n\t\t\n\t\tlet array = this._children.get(child.threeLetterType);\n\t\tif (array === undefined) {\n\t\t\tarray = [];\n\t\t\tthis._children.set(child.threeLetterType, array);\n\t\t}\n\t\tarray.push(child);\n\t\tchild._parent = this;\n\t\tchild._state |= Serializable.STATE_ADDPARENT;\n\t\t\n\t\tif (child._rootType !== this._rootType) // tiny optimization\n\t\t\tchild.setRootType(this._rootType);\n\t\t\n\t\treturn this;\n\t}\n\tfindChild(threeLetterType, filterFunction, deep = false) {\n\t\tlet array = this._children.get(threeLetterType);\n\t\tif (!array) return null;\n\t\tif (filterFunction) {\n\t\t\tlet foundChild = array.find(filterFunction);\n\t\t\tif (foundChild) {\n\t\t\t\treturn foundChild;\n\t\t\t} else if (deep) {\n\t\t\t\tfor (let i = 0; i < array.length; ++i) {\n\t\t\t\t\tlet child = array[i];\n\t\t\t\t\tlet foundChild = child.findChild(threeLetterType, filterFunction, true);\n\t\t\t\t\tif (foundChild)\n\t\t\t\t\t\treturn foundChild;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t} else {\n\t\t\treturn array[0];\n\t\t}\n\t}\n\tfindParent(threeLetterType, filterFunction = null) {\n\t\tlet parent = this;\n\t\twhile (parent) {\n\t\t\tif (parent.threeLetterType === threeLetterType && (!filterFunction || filterFunction(parent)))\n\t\t\t\treturn parent;\n\t\t\tparent = parent._parent;\n\t\t}\n\t\treturn null;\n\t}\n\tgetRoot() {\n\t\tlet element = this;\n\t\twhile (element._parent) {\n\t\t\telement = element._parent;\n\t\t}\n\t\treturn element;\n\t}\n\t// idx is optional\n\tdeleteChild(child, idx) {\n\t\taddChange(changeType.deleteSerializable, child);\n\t\tthis._detachChild(child, idx);\n\t\tchild.delete();\n\t\treturn this;\n\t}\n\t// idx is optional\n\t_detachChild(child, idx = 0) {\n\t\tlet array = this._children.get(child.threeLetterType);\n\t\tassert(array, 'child not found');\n\t\tif (array[idx] !== child)\n\t\t\tidx = array.indexOf(child);\n\t\tassert(idx >= 0, 'child not found');\n\t\tarray.splice(idx, 1);\n\t\tif (array.length === 0)\n\t\t\tthis._children.delete(child.threeLetterType);\n\t\tchild._parent = null;\n\t\tchild.setRootType(null);\n\t\t\n\t\treturn this;\n\t}\n\tforEachChild(threeLetterType = null, callback, deep = false) {\n\t\tfunction processArray(array) {\n\t\t\tarray.forEach(child => {\n\t\t\t\tcallback(child);\n\t\t\t\tdeep && child.forEachChild(threeLetterType, callback, true);\n\t\t\t});\n\t\t}\n\t\tif (threeLetterType) {\n\t\t\tprocessArray(this._children.get(threeLetterType) || []);\n\t\t} else {\n\t\t\tthis._children.forEach(processArray);\n\t\t}\n\t\treturn this;\n\t}\n\tmove(newParent) {\n\t\t\n\t\tnewParent._addChild(this._detach());\n\t\taddChange(changeType.move, this);\n\t\t\n\t\treturn this;\n\t}\n\t_detach() {\n\t\tthis._parent && this._parent._detachChild(this);\n\t\treturn this;\n\t}\n\tgetParent() {\n\t\treturn this._parent || null;\n\t}\n\tgetChildren(threeLetterType) {\n\t\treturn this._children.get(threeLetterType) || [];\n\t}\n\ttoJSON() {\n\t\tlet json = {\n\t\t\tid: this.id\n\t\t};\n\t\tif (this._children.size > 0) {\n\t\t\tlet arrays = [];\n\t\t\t// prototypes must come before a level\n\t\t\tArray.from(this._children.keys()).sort((a, b) => a === 'prt' ? -1 : 1)\n\t\t\t\t.forEach(key => arrays.push(this._children.get(key)));\n\t\t\tjson.c = [].concat(...arrays).map(child => child.toJSON());\n\t\t}\n\t\treturn json;\n\t}\n\ttoString() {\n\t\treturn JSON.stringify(this.toJSON(), null, 4);\n\t}\n\tclone() {\n\t\tlet obj = new this.constructor();\n\t\tlet children = [];\n\t\tthis.forEachChild(null, child => {\n\t\t\tchildren.push(child.clone());\n\t\t});\n\t\tobj.initWithChildren(children);\n\t\tthis._state |= Serializable.STATE_CLONE;\n\t\treturn obj;\n\t}\n\t// priority should be a whole number between -100000 and 100000. a smaller priority number means that it will be executed first.\n\tlisten(event, callback, priority = 0) {\n\t\tcallback.priority = priority + (listenerCounter++ / NUMBER_BIGGER_THAN_LISTENER_COUNT);\n\t\tif (!this._listeners.hasOwnProperty(event)) {\n\t\t\tthis._listeners[event] = [];\n\t\t}\n\t\tlet index = indexOfListener(this._listeners[event], callback);\n\t\tthis._listeners[event].splice(index, 0, callback);\n\t\treturn () => {\n\t\t\tif (!this._alive)\n\t\t\t\treturn; // listeners already deleted\n\t\t\tlet index = this._listeners[event].indexOf(callback);\n\t\t\tif (index >= 0)\n\t\t\t\tthis._listeners[event].splice(index, 1);\n\t\t};\n\t}\n\tdispatch(event, a, b, c) {\n\t\tlet listeners = this._listeners[event];\n\t\tif (!listeners)\n\t\t\treturn;\n\t\t\n\t\tperformanceTool.eventHappened('Event ' + event, listeners.length);\n\t\t\n\t\tfor (let i = 0; i < listeners.length; i++) {\n// @ifndef OPTIMIZE\n\t\t\ttry {\n// @endif\n\n\t\t\t\tlisteners[i](a, b, c);\n\n// @ifndef OPTIMIZE\n\t\t\t} catch(e) {\n\t\t\t\tconsole.error(`Event ${event} listener crashed.`, this._listeners[event][i], e);\n\t\t\t}\n// @endif\n\t\t}\n\t}\n\thasDescendant(child) {\n\t\tif (!child) return false;\n\t\tlet parent = child._parent;\n\t\twhile (parent) {\n\t\t\tif (parent === this) return true;\n\t\t\tparent = parent._parent;\n\t\t}\n\t\treturn false;\n\t}\n\tsetRootType(rootType) {\n\t\tif (this._rootType === rootType)\n\t\t\treturn;\n\t\tthis._rootType = rootType;\n\t\t\n\t\t// Optimized\n\t\tlet i;\n\t\tthis._children.forEach(childArray => {\n\t\t\tfor (i = 0; i < childArray.length; ++i) {\n\t\t\t\tchildArray[i].setRootType(rootType);\n\t\t\t}\n\t\t});\n\t}\n\tisInTree() {\n\t\treturn !!this._rootType;\n\t}\n\tstatic fromJSON(json) {\n\t\tassert(typeof json.id === 'string' && json.id.length > 5, 'Invalid id.');\n\t\tlet fromJSON = serializableClasses.get(json.id.substring(0, 3));\n\t\tassert(fromJSON);\n\t\tlet obj;\n\t\ttry {\n\t\t\tobj = fromJSON(json);\n\t\t} catch(e) {\n\t\t\tif (isClient) {\n\t\t\t\tif (!window.force)\n\t\t\t\t\tdebugger; // Type 'force = true' in console to ignore failed imports.\n\n\t\t\t\tif (!window.force)\n\t\t\t\t\tthrow new Error();\n\t\t\t} else {\n\t\t\t\tconsole.log('Error fromJSON', e);\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t\tlet children = json.c ? json.c.map(child => Serializable.fromJSON(child)).filter(Boolean) : [];\n\t\tif (obj._state & Serializable.STATE_INIT)\n\t\t\tobj.addChildren(children);\n\t\telse\n\t\t\tobj.initWithChildren(children);\n\t\tobj._state |= Serializable.STATE_FROMJSON;\n\t\treturn obj;\n\t}\n\tstatic registerSerializable(Class, threeLetterType, fromJSON = null) {\n\t\tClass.prototype.threeLetterType = threeLetterType;\n\t\tassert(typeof threeLetterType === 'string' && threeLetterType.length === 3);\n\t\tif (!fromJSON)\n\t\t\tfromJSON = json => new Class(json.id);\n\t\tserializableClasses.set(threeLetterType, fromJSON);\n\t}\n}\n\nSerializable.prototype._parent = null;\nSerializable.prototype._alive = true;\nSerializable.prototype._state = 0;\nSerializable.prototype._rootType = null;\n\nSerializable.STATE_INIT = 2;\nSerializable.STATE_ADDCHILD = 4;\nSerializable.STATE_ADDPARENT = 8;\nSerializable.STATE_CLONE = 16;\nSerializable.STATE_DESTROY = 32;\nSerializable.STATE_FROMJSON = 64;\n\nSerializable.prototype.isRoot = false; // If this should be a root node\nObject.defineProperty(Serializable.prototype, 'debug', {\n\tget() {\n\t\tlet info = this.threeLetterType;\n\n\t\tif (this.threeLetterType === 'cda')\n\t\t\tinfo += '|' + this.name;\n\n\t\tthis._children.forEach((value, key) => {\n\t\t\tinfo += '|';\n\t\t\tif (key === 'prp')\n\t\t\t\tinfo += this.getChildren('prp').map(p => `${p.name}=${p._value}`).join(', ');\n\t\t\telse\n\t\t\t\tinfo += `${key}(${value.length})`;\n\t\t});\n\t\t\n\t\tinfo += '|state: ';\n\t\t\n\t\tlet states = [];\n\t\tlet logState = (state, stateString) => {\n\t\t\tif (this._state & state)\n\t\t\t\tstates.push(stateString);\n\t\t};\n\t\t\n\t\tlogState(Serializable.STATE_INIT, 'init');\n\t\tlogState(Serializable.STATE_ADDCHILD, 'add child');\n\t\tlogState(Serializable.STATE_ADDPARENT, 'add parent');\n\t\tlogState(Serializable.STATE_CLONE, 'clone');\n\t\tlogState(Serializable.STATE_DESTROY, 'destroy');\n\t\tlogState(Serializable.STATE_FROMJSON, 'from json');\n\t\t\n\t\tinfo += states.join(', ');\n\t\t\n\t\treturn info;\n\t}\n});\nObject.defineProperty(Serializable.prototype, 'debugChildren', {\n\tget() {\n\t\tlet c = [];\n\t\tthis._children.forEach((value, key) => {\n\t\t\tc = c.concat(value);\n\t\t});\n\t\t\n\t\tlet children = [];\n\t\t\n\t\tfunction createDebugObject(type)Â {\n\t\t\tif (type === 'gam') return new function Game(){};\n\t\t\tif (type === 'sce') return new function Scene(){};\n\t\t\tif (type === 'prt') return new function Prototype(){};\n\t\t\tif (type === 'prp') return new function Property(){};\n\t\t\tif (type === 'cda') return new function ComponentData(){};\n\t\t\tif (type === 'com') return new function Component(){};\n\t\t\tif (type === 'epr') return new function EntityPrototype(){};\n\t\t\tif (type === 'ent') return new function Entity(){};\n\t\t\tif (type === 'lvl') return new function Level(){};\n\t\t\tif (type === 'pfa') return new function Prefab(){};\n\t\t\treturn new function Other(){};\n\t\t}\n\n\t\tc.forEach(child => {\n\t\t\tlet obj = createDebugObject(child.threeLetterType);\n\t\t\t\n\t\t\tobj.debug = child.debug;\n\t\t\tobj.ref = child;\n\t\t\tobj.debugChildren = child.debugChildren;\n\t\t\tlet c = child.debugChildArray;\n\t\t\tif (c && c.length > 0)\n\t\t\t\tobj.children = c;\n\t\t\tchildren.push(obj);\n\t\t});\n\n\t\treturn children;\n\t}\n});\n\n// If a serializable is a ancestor of another serializable, it is filtered out from the list\nexport function filterChildren(serializables) {\n\tlet idSet = new Set(serializables.map(s => s.id));\n\treturn serializables.filter(serializable => {\n\t\tlet parent = serializable.getParent();\n\t\twhile (parent) {\n\t\t\tif (idSet.has(parent.id))\n\t\t\t\treturn false;\n\t\t\tparent = parent.getParent();\n\t\t}\n\t\treturn true;\n\t});\n}\n\nlet listenerCounter = 0;\nconst NUMBER_BIGGER_THAN_LISTENER_COUNT = 10000000000;\n\nfunction indexOfListener(array, callback) {\n\tlet low = 0,\n\t\thigh = array.length, \n\t\tpriority = callback.priority;\n\n\twhile (low < high) {\n\t\tlet mid = low + high >>> 1;\n\t\tif (array[mid].priority < priority) low = mid + 1;\n\t\telse high = mid;\n\t}\n\treturn low;\n}\n","import assert from '../util/assert';\nimport Serializable from './serializable';\n\nexport let serializables = {};\n\nlet DEBUG_CHANGES = 0;\nlet CHECK_FOR_INVALID_ORIGINS = 0;\n\nexport function addSerializable(serializable) {\n// @ifndef OPTIMIZE\n\tif (serializables[serializable.id] !== undefined)\n\t\tassert(false, (\"Serializable id clash \" + (serializable.id)));\n// @endif\n\tserializables[serializable.id] = serializable;\n}\n\nexport function getSerializable(id) {\n\treturn serializables[id] || null;\n}\n\nexport function hasSerializable(id) {\n\treturn Boolean(serializables[id]);\n}\n\nexport function removeSerializable(id) {\n\t/* When deleting a scene, this function is called a lot of times\n\tif (!serializables[id])\n\t\tthrow new Error('Serializable not found!');\n\t*/\n\tdelete serializables[id];\n}\n\n// reference parameters are not sent over net. they are helpers in local game instance\nexport let changeType = {\n\taddSerializableToTree: 'a', // parentId, reference\n\tsetPropertyValue: 's', // id, value\n\tdeleteSerializable: 'd', // id\n\tmove: 'm', // id, parentId\n\tdeleteAllChildren: 'c', // id\n};\nlet keyToShortKey = {\n\tid: 'i', // obj.id\n\ttype: 't', // changeType.*\n\tvalue: 'v', // value after toJSON\n\tparentId: 'p' // obj._parent.id\n};\nlet shortKeyToKey = {};\nObject.keys(keyToShortKey).forEach(k => {\n\tshortKeyToKey[keyToShortKey[k]] = k;\n});\n\nlet origin;\n\n// @ifndef OPTIMIZE\nlet previousVisualOrigin;\nfunction resetOrigin() {\n\torigin = null;\n}\nexport function getChangeOrigin() {\n\treturn origin;\n}\n// @endif\nexport function setChangeOrigin(_origin) {\n\t// @ifndef OPTIMIZE\n\tif (_origin !== origin) {\n\t\torigin = _origin;\n\t\tif (DEBUG_CHANGES && _origin && _origin !== previousVisualOrigin) {\n\t\t\tconsole.log('origin', previousVisualOrigin);\n\t\t\tpreviousVisualOrigin = _origin;\n\t\t}\n\t\t\n\t\tif (CHECK_FOR_INVALID_ORIGINS)\n\t\t\tsetTimeout(resetOrigin, 0);\n\t}\n\t// @endif\n}\n\nlet externalChange = false;\n\n// addChange needs to be called if editor, server or net game needs to share changes\nexport function addChange(type, reference) {\n\t// @ifndef OPTIMIZE\n\tassert(origin, 'Change without origin!');\n\t// @endif\n\t\n\tif (!reference.id) return;\n\t\n\tlet change = {\n\t\ttype,\n\t\treference,\n\t\tid: reference.id,\n\t\texternal: externalChange,\n\t\torigin // exists in editor, but not in optimized release\n\t};\n\tif (type === changeType.setPropertyValue) {\n\t\tchange.value = reference._value;\n\t} else if (type === changeType.move) {\n\t\tchange.parent = reference._parent;\n\t} else if (type === changeType.addSerializableToTree) {\n\t\tchange.parent = reference._parent;\n\t\tdelete change.id;\n\t}\n\t\n\t// @ifndef OPTIMIZE\n\tif (DEBUG_CHANGES)\n\t\tconsole.log('change', change);\n\n\tlet previousOrigin = origin;\n\t// @endif\n\n\tfor (let i = 0; i < listeners.length; ++i) {\n\t\tlisteners[i](change);\n\t}\n\n\t// @ifndef OPTIMIZE\n\tif (origin !== previousOrigin) {\n\t\tif (DEBUG_CHANGES)\n\t\t\tconsole.log('origin changed from', previousOrigin, 'to', origin && origin.constructor || origin);\n\t\torigin = previousOrigin;\n\t}\n\t// @endif\n}\n\nexport function executeExternal(callback) {\n\tsetChangeOrigin('external');\n\tif (externalChange) return callback();\n\texternalChange = true;\n\tcallback();\n\texternalChange = false;\n}\n\nlet listeners = [];\n\nexport function addChangeListener(callback) {\n\tassert(typeof callback === 'function');\n\tlisteners.push(callback);\n}\n\nexport function packChange(change) {\n\tif (change.packedChange)\n\t\treturn change.packedChange; // optimization\n\t\n\tlet packed = {};\n\ttry {\n\t\tif (change.parent)\n\t\t\tchange.parentId = change.parent.id;\n\t\t\n\t\tif (change.type === changeType.addSerializableToTree) {\n\t\t\tif (change.reference) {\n\t\t\t\tchange.value = change.reference.toJSON();\n\t\t\t} else {\n\t\t\t\tassert(false, 'invalid change of type addSerializableToTree', change);\n\t\t\t}\n\t\t} else if (change.value !== undefined) {\n\t\t\tchange.value = change.reference.propertyType.type.toJSON(change.value);\n\t\t}\n\n\t\tObject.keys(keyToShortKey).forEach(key => {\n\t\t\tif (change[key] !== undefined) {\n\t\t\t\tif (key === 'type' && change[key] === changeType.setPropertyValue) return; // optimize most common type\n\t\t\t\tpacked[keyToShortKey[key]] = change[key];\n\t\t\t}\n\t\t});\n\t} catch(e) {\n\t\tconsole.log('PACK ERROR', e);\n\t}\n\treturn packed;\n}\n\nexport function unpackChange(packedChange) {\n\tlet change = {\n\t\tpackedChange // optimization\n\t};\n\tObject.keys(packedChange).forEach(shortKey => {\n\t\tlet key = shortKeyToKey[shortKey];\n\t\tchange[key] = packedChange[shortKey];\n\t});\n\tif (!change.type)\n\t\tchange.type = changeType.setPropertyValue;\n\t\n\tif (change.type === changeType.addSerializableToTree) {\n\t\t// reference does not exist because it has not been created yet\n\t\tchange.id = change.value.id;\n\t} else {\n\t\tchange.reference = getSerializable(change.id);\n\t\tif (change.reference) {\n\t\t\tchange.id = change.reference.id;\n\t\t} else {\n\t\t\tconsole.error('received a change with unknown id', change, 'packed:', packedChange);\n\t\t\treturn null;\n\t\t}\n\t}\n\t\n\tif (change.parentId)\n\t\tchange.parent = getSerializable(change.parentId);\n\treturn change;\n}\n\nexport function executeChange(change) {\n\tlet newScene;\n\t\n\texecuteExternal(() => {\n\t\tif (change.type === changeType.setPropertyValue) {\n\t\t\tchange.reference.value = change.reference.propertyType.type.fromJSON(change.value);\n\t\t} else if (change.type === changeType.addSerializableToTree) {\n\t\t\tif (change.parent) {\n\t\t\t\tlet obj = Serializable.fromJSON(change.value);\n\t\t\t\tchange.parent.addChild(obj);\n\t\t\t\tif (obj.threeLetterType === 'ent') {\n\t\t\t\t\tobj.localMaster = false;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tlet obj = Serializable.fromJSON(change.value); // Scene does not need a parent\n\t\t\t\tif (obj.threeLetterType === 'sce')\n\t\t\t\t\tnewScene = obj;\n\t\t\t}\n\t\t} else if (change.type === changeType.deleteAllChildren) {\n\t\t\tchange.reference.deleteChildren();\n\t\t} else if (change.type === changeType.deleteSerializable) {\n\t\t\tchange.reference.delete();\n\t\t} else if (change.type === changeType.move) {\n\t\t\tchange.reference.move(change.parent);\n\t\t}\n\t});\n\t\n\tif (newScene)\n\t\tnewScene.play();\n}\n","// @ifndef OPTIMIZE\nimport { getChangeOrigin } from '../core/serializableManager';\n// @endif\n\nexport default function assert(condition, message) {\n\t// @ifndef OPTIMIZE\n\tif (!condition) {\n\t\tconsole.log('Assert', message, new Error().stack, '\\norigin', getChangeOrigin());\n\t\tdebugger;\n\t\tif (!window.force)\n\t\t\tthrow new Error(message);\n\t}\n\t// @endif\n}\n","import Serializable from './serializable';\nimport { addChange, changeType, setChangeOrigin } from './serializableManager'; \nimport assert from '../util/assert';\nimport * as performanceTool from '../util/performance';\n\nlet changesEnabled = true;\nlet scenePropertyFilter = null;\n// true / false to enable / disable property value change sharing.\n// if object is passed, changes are only sent \nexport function filterSceneChanges(_scenePropertyFilter) {\n\tscenePropertyFilter = _scenePropertyFilter;\n\tchangesEnabled = true;\n}\n\nexport function disableAllChanges() {\n\tchangesEnabled = false;\n}\n\nexport function enableAllChanges() {\n\tchangesEnabled = true;\n}\n\n// Object of a property\nexport default class Property extends Serializable {\n\t// set skipSerializableRegistering=true if you are not planning to add this property to the hierarchy\n\t// if you give propertyType, value in real value form\n\t// if you don't give propertyType (give it later), value as JSON form\n\tconstructor({ value, predefinedId, name, propertyType, skipSerializableRegistering = false }) {\n\t\tassert(name, 'Property without a name can not exist');\n\t\tsuper(predefinedId, skipSerializableRegistering);\n\t\tthis._initialValue = value;\n\t\tif (propertyType)\n\t\t\tthis.setPropertyType(propertyType);\n\t\telse {\n\t\t\tthis.name = name;\n\t\t\tthis._initialValueIsJSON = true;\n\t\t}\n\t}\n\tmakeUpAName() {\n\t\treturn this.name;\n\t}\n\tsetPropertyType(propertyType) {\n\t\tthis.propertyType = propertyType;\n\t\ttry {\n\t\t\tif (this._initialValue !== undefined)\n\t\t\t\tthis.value = this._initialValueIsJSON ? propertyType.type.fromJSON(this._initialValue) : this._initialValue;\n\t\t\telse\n\t\t\t\tthis.value = propertyType.initialValue;\n\t\t} catch(e) {\n\t\t\tconsole.log('Invalid value', e, propertyType, this);\n\t\t\tthis.value = propertyType.initialValue;\n\t\t}\n\t\tthis.name = propertyType.name;\n\t}\n\tclone(skipSerializableRegistering = false) {\n\t\treturn new Property({\n\t\t\tvalue: this.propertyType.type.clone(this.value),\n\t\t\tname: this.name,\n\t\t\tpropertyType: this.propertyType,\n\t\t\tskipSerializableRegistering\n\t\t});\n\t}\n\ttoJSON() {\n\t\treturn Object.assign(super.toJSON(), {\n\t\t\tv: this.type.toJSON(this.value),\n\t\t\tn: this.propertyType.name\n\t\t});\n\t}\n}\nProperty.prototype.propertyType = null;\nObject.defineProperty(Property.prototype, 'type', {\n\tget() {\n\t\treturn this.propertyType.type;\n\t}\n});\nObject.defineProperty(Property.prototype, 'value', {\n\tset(newValue) {\n\t\tthis._value = this.propertyType.validator.validate(newValue);\n\t\t\n\t\tthis.dispatch('change', this._value);\n\t\tif (changesEnabled && this._rootType) { // not scene or empty\n\t\t\tif (scenePropertyFilter === null\n\t\t\t\t|| this._rootType !== 'sce'\n\t\t\t\t|| scenePropertyFilter(this)\n\t\t\t) {\n\t\t\t\taddChange(changeType.setPropertyValue, this);\n\t\t\t}\n\t\t}\n\t},\n\tget() {\n\t\treturn this._value;\n\t}\n});\n\nSerializable.registerSerializable(Property, 'prp', json => {\n\treturn new Property({\n\t\tvalue: json.v,\n\t\tpredefinedId: json.id,\n\t\tname: json.n\n\t});\n});\n\nObject.defineProperty(Property.prototype, 'debug', {\n\tget() {\n\t\treturn `prp ${this.name}=${this.value}`;\n\t}\n});\n","import assert from '../util/assert';\nimport Property from './property';\n\n// info about type, validator, validatorParameters, initialValue\n\n\n\nclass PropertyType {\n\tconstructor(name, type, validator, initialValue, description, flags = [], visibleIf) {\n\t\tassert(typeof name === 'string');\n\t\tassert(name[0] >= 'a' && name[0] <= 'z', 'Name of a property must start with lower case letter.');\n\t\tassert(type && typeof type.name === 'string');\n\t\tassert(validator && typeof validator.validate === 'function');\n\t\t\n\t\tthis.name = name;\n\t\tthis.type = type;\n\t\tthis.validator = validator;\n\t\tthis.initialValue = initialValue;\n\t\tthis.description = description;\n\t\tthis.visibleIf = visibleIf;\n\t\tthis.flags = {};\n\t\tflags.forEach(f => this.flags[f.type] = f);\n\t}\n\tgetFlag(flag) {\n\t\treturn this.flags[flag.type];\n\t}\n\tcreateProperty({ value, predefinedId, skipSerializableRegistering = false } = {}) {\n\t\treturn new Property({\n\t\t\tpropertyType: this,\n\t\t\tvalue,\n\t\t\tpredefinedId,\n\t\t\tname: this.name,\n\t\t\tskipSerializableRegistering\n\t\t});\n\t}\n}\n\n/*\n\tBeautiful way of creating property types\n\t\n\toptionalParameters:\n\t\tdescription: 'Example',\n\t\tvalidator: PropertyType.\n */\nexport default function createPropertyType(propertyName, defaultValue, type, ...optionalParameters) {\n\ttype = type();\n\tlet validator = type.validators.default();\n\tlet description = '';\n\tlet flags = [];\n\tlet visibleIf = null;\n\toptionalParameters.forEach((p, idx) => {\n\t\tif (typeof p === 'string')\n\t\t\tdescription = p;\n\t\telse if (p && p.validate)\n\t\t\tvalidator = p;\n\t\telse if (p && p.isFlag)\n\t\t\tflags.push(p);\n\t\telse if (p && p.visibleIf)\n\t\t\tvisibleIf = p;\n\t\telse\n\t\t\tassert(false, 'invalid parameter ' + p + ' idx ' + idx);\n\t});\n\treturn new PropertyType(propertyName, type, validator, defaultValue, description, flags, visibleIf);\n};\n\nexport let dataType = createPropertyType;\n\n// if value is string, property must be value\n// if value is an array, property must be one of the values\ndataType.visibleIf = function(propertyName, value) {\n\tassert(typeof propertyName === 'string' && propertyName.length);\n\tassert(typeof value !== 'undefined');\n\treturn {\n\t\tvisibleIf: true,\n\t\tpropertyName,\n\t\tvalues: Array.isArray(value) ? value : [value]\n\t};\n};\n\nfunction createFlag(type, func = {}) {\n\tfunc.isFlag = true;\n\tfunc.type = type;\n\treturn func;\n}\n\ncreatePropertyType.flagDegreesInEditor = createFlag('degreesInEditor');\n\nexport function createDataType({\n\tname = '',\n\tvalidators = { default: x => x }, // default must exist. if value is a reference(object), validator should copy the value.\n\ttoJSON = x => x,\n\tfromJSON = x => x,\n\tclone = x => x\n}) {\n\tassert(name, 'name missing from property type');\n\tassert(typeof validators.default === 'function','default validator missing from property type: ' + name);\n\tassert(typeof toJSON === 'function', 'invalid toJSON for property type: ' + name);\n\tassert(typeof fromJSON === 'function', 'invalid fromJSON for property type: ' + name);\n\n\tlet type = {\n\t\tname,\n\t\tvalidators,\n\t\ttoJSON,\n\t\tfromJSON,\n\t\tclone\n\t};\n\tlet createType = () => type;\n\n\tObject.keys(validators).forEach(validatorName => {\n\t\tcreateType[validatorName] = createValidator(validatorName, validators[validatorName]);\n\t\tvalidators[validatorName] = createType[validatorName];\n\t});\n\treturn createType;\n}\n\nfunction createValidator(name, validatorFunction) {\n\tlet validator = function(...args) {\n\t\tlet parameters = args;\n\t\tlet validatorArgs = [null, ...args];\n\t\treturn {\n\t\t\tvalidatorName: name,\n\t\t\tvalidate: function(x) {\n\t\t\t\tvalidatorArgs[0] = x;\n\t\t\t\treturn validatorFunction.apply(null, validatorArgs);\n\t\t\t},\n\t\t\tparameters\n\t\t};\n\t};\n\tvalidator.validatorName = name;\n\tvalidator.validate = validatorFunction;\n\treturn validator;\n}\n","export default class Vector {\n\tconstructor(x, y) {\n\t\tthis.x = x || 0;\n\t\tthis.y = y || 0;\n\t}\n\tadd(vec) {\n\t\tthis.x += vec.x;\n\t\tthis.y += vec.y;\n\t\treturn this;\n\t}\n\taddScalars(x, y) {\n\t\tthis.x += x;\n\t\tthis.y += y;\n\t\treturn this;\n\t}\n\tsubtract(vec) {\n\t\tthis.x -= vec.x;\n\t\tthis.y -= vec.y;\n\t\treturn this;\n\t}\n\tsubtractScalars(x, y) {\n\t\tthis.x -= x;\n\t\tthis.y -= y;\n\t\treturn this;\n\t}\n\tmultiply(vec) {\n\t\tthis.x *= vec.x;\n\t\tthis.y *= vec.y;\n\t\treturn this;\n\t}\n\tmultiplyScalar(scalar) {\n\t\tthis.x *= scalar;\n\t\tthis.y *= scalar;\n\t\treturn this;\n\t}\n\tdivide(vec) {\n\t\tthis.x /= vec.x;\n\t\tthis.y /= vec.y;\n\t\treturn this;\n\t}\n\tdivideScalar(scalar) {\n\t\tthis.x /= scalar;\n\t\tthis.y /= scalar;\n\t\treturn this;\n\t}\n\tdot(vec) {\n\t\treturn this.x * vec.x + this.y * vec.y;\n\t}\n\tlength() {\n\t\treturn Math.sqrt(this.x * this.x + this.y * this.y);\n\t}\n\tlengthSq() {\n\t\treturn this.x * this.x + this.y * this.y;\n\t}\n\tsetLength(newLength) {\n\t\tlet oldLength = this.length();\n\n\t\tif (oldLength === 0) {\n\t\t\tthis.x = newLength;\n\t\t\tthis.y = 0;\n\t\t} else {\n\t\t\tthis.multiplyScalar(newLength / oldLength);\n\t\t}\n\t\treturn this;\n\t}\n\tgetProjectionOn(vec) {\n\t\tlet length = vec.length();\n\t\tif (length === 0)\n\t\t\treturn this.clone();\n\t\telse\n\t\t\treturn vec.clone().multiplyScalar(this.dot(vec) / (length * length));\n\t}\n\tdistance(vec) {\n\t\tlet dx = this.x - vec.x,\n\t\t\tdy = this.y - vec.y;\n\t\treturn Math.sqrt(dx * dx + dy * dy);\n\t}\n\tdistanceSq(vec) {\n\t\tlet dx = this.x - vec.x,\n\t\t\tdy = this.y - vec.y;\n\t\treturn dx * dx + dy * dy;\n\t}\n\tnormalize() {\n\t\treturn this.setLength(1);\n\t}\n\thorizontalAngle() {\n\t\treturn Math.atan2(this.y, this.x);\n\t}\n\tverticalAngle() {\n\t\treturn Math.atan2(this.x, this.y);\n\t}\n\trotate(angle) {\n\t\tlet x = this.x * Math.cos(angle) - this.y * Math.sin(angle);\n\t\tthis.y = this.x * Math.sin(angle) + this.y * Math.cos(angle);\n\t\tthis.x = x;\n\n\t\treturn this;\n\t}\n\trotateTo(angle) {\n\t\treturn this.rotate(angle-this.verticalAngle());\n\t}\n\tisEqualTo(vec) {\n\t\treturn this.x === vec.x && this.y === vec.y;\n\t}\n\tisZero() {\n\t\treturn !this.x && !this.y;\n\t}\n\tclone() {\n\t\treturn new Vector(this.x, this.y);\n\t}\n\tset(vec) {\n\t\tthis.x = vec.x;\n\t\tthis.y = vec.y;\n\t\treturn this;\n\t}\n\tsetScalars(x, y) {\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\treturn this;\n\t}\n\ttoString() {\n\t\treturn `[${this.x}, ${this.y}]`;\n\t}\n\ttoArray() {\n\t\treturn [this.x, this.y];\n\t}\n}\nVector.fromObject = function(obj) {\n\treturn new Vector(obj.x, obj.y);\n};\nVector.fromArray = function(obj) {\n\treturn new Vector(obj[0], obj[1]);\n};\n","import assert from './assert'\n\nexport class Color {\n\tconstructor(r, g, b) {\n\t\tif (r && r.constructor === Color) {\n\t\t\tthis.r = r.r;\n\t\t\tthis.g = r.g;\n\t\t\tthis.b = r.b;\n\t\t} else if (typeof r === 'number') {\n\t\t\tthis.r = r;\n\t\t\tthis.g = g;\n\t\t\tthis.b = b;\n\t\t} else if (typeof r === 'string') {\n\t\t\tlet rgb = hexToRgb(r);\n\t\t\tthis.r = rgb.r;\n\t\t\tthis.g = rgb.g;\n\t\t\tthis.b = rgb.b;\n\t\t} else {\n\t\t\tassert(false, 'Invalid Color parameters');\n\t\t}\n\t}\n\ttoHexString() {\n\t\treturn rgbToHex(this.r, this.g, this.b);\n\t}\n\ttoHexNumber() {\n\t\treturn this.r * 256 * 256 + this.g * 256 + this.b;\n\t}\n\ttoString() {\n\t\treturn `[${this.r},${this.g},${this.b}]`;\n\t}\n}\n\nexport function hexToRgb(hex) {\n\tvar result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n\treturn result ? {\n\t\tr: parseInt(result[1], 16),\n\t\tg: parseInt(result[2], 16),\n\t\tb: parseInt(result[3], 16)\n\t} : null;\n}\n\nexport function componentToHex(c) {\n\tvar hex = c.toString(16);\n\treturn hex.length == 1 ? \"0\" + hex : hex;\n}\n\nexport function rgbToHex(r, g, b) {\n\treturn \"#\" + componentToHex(r) + componentToHex(g) + componentToHex(b);\n}\n\nexport function isHexString(hex) {\n\treturn hex && hex.match(/^#[0-9a-f]{6}$/i) ? true : false;\n}\n","import assert from '../util/assert';\nimport { createDataType, dataType } from './propertyType';\nimport Vector from '../util/vector';\nimport {isHexString, Color} from '../util/color';\n\nfunction validateFloat(val) {\n\tif (isNaN(val) || val === Infinity || val === -Infinity)\n\t\tthrow new Error('Invalid float: ' + val);\n}\n\nconst FLOAT_JSON_PRECISION = 4;\nconst FLOAT_JSON_PRECISION_MULTIPLIER = Math.pow(10, FLOAT_JSON_PRECISION);\nconst FLOAT_DELTA = 0.0000001;\n\ndataType.float = createDataType({\n\tname: 'float',\n\tvalidators: {\n\t\tdefault(x) {\n\t\t\tx = parseFloat(x);\n\t\t\t// @ifndef OPTIMIZE\n\t\t\tvalidateFloat(x);\n\t\t\t// @endif\n\t\t\treturn x;\n\t\t},\n\t\t// PropertyType.float.range(min, max)\n\t\trange(x, min, max) {\n\t\t\tx = parseFloat(x);\n\t\t\tvalidateFloat(x);\n\t\t\treturn Math.min(max, Math.max(min, x));\n\t\t},\n\t\tmodulo(x, min, max) {\n\t\t\tx = parseFloat(x);\n\t\t\tvalidateFloat(x);\n\t\t\t\n\t\t\tlet range = max - min;\n\t\t\t\n\t\t\tif (x < min) {\n\t\t\t\tx += (((min - x) / range | 0) + 1) * range;\n\t\t\t} else if (x > max - FLOAT_DELTA) {\n\t\t\t\tx -= (((x - max) / range | 0) + 1) * range;\n\t\t\t}\n\t\t\t\n\t\t\treturn x;\n\t\t}\n\t},\n\ttoJSON: x => Math.round(x*FLOAT_JSON_PRECISION_MULTIPLIER)/FLOAT_JSON_PRECISION_MULTIPLIER,\n\tfromJSON: x => x\n});\ndataType.int = createDataType({\n\tname: 'int',\n\tvalidators: {\n\t\tdefault(x) {\n\t\t\tx = parseInt(x);\n\t\t\t// @ifndef OPTIMIZE\n\t\t\tvalidateFloat(x);\n\t\t\t// @endif\n\t\t\treturn x;\n\t\t},\n\t\t// PropertyType.float.range(min, max)\n\t\trange(x, min, max) {\n\t\t\tx = parseInt(x);\n\t\t\tvalidateFloat(x);\n\t\t\treturn Math.min(max, Math.max(min, x));\n\t\t}\n\t},\n\ttoJSON: x => x,\n\tfromJSON: x => x\n});\n\ndataType.vector = createDataType({\n\tname: 'vector',\n\tvalidators: {\n\t\tdefault(vec) {\n\t\t\t// @ifndef OPTIMIZE\n\t\t\tif (!(vec instanceof Vector))\n\t\t\t\tthrow new Error();\n\t\t\t// @endif\n\t\t\tvec = vec.clone();\n\t\t\t// @ifndef OPTIMIZE\n\t\t\tvec.x = parseFloat(vec.x);\n\t\t\tvec.y = parseFloat(vec.y);\n\t\t\tvalidateFloat(vec.x);\n\t\t\tvalidateFloat(vec.y);\n\t\t\t// @endif\n\t\t\treturn vec;\n\t\t}\n\t},\n\ttoJSON: vec => ({\n\t\tx: Math.round(vec.x*FLOAT_JSON_PRECISION_MULTIPLIER)/FLOAT_JSON_PRECISION_MULTIPLIER,\n\t\ty: Math.round(vec.y*FLOAT_JSON_PRECISION_MULTIPLIER)/FLOAT_JSON_PRECISION_MULTIPLIER\n\t}),\n\tfromJSON: vec => Vector.fromObject(vec),\n\tclone: vec => vec.clone()\n});\n\ndataType.string = createDataType({\n\tname: 'string',\n\tvalidators: {\n\t\tdefault: x => x ? String(x) : ''\n\t},\n\ttoJSON: x => x,\n\tfromJSON: x => x\n});\n\ndataType.bool = createDataType({\n\tname: 'bool',\n\tvalidators: {\n\t\tdefault(x) {\n\t\t\tif (typeof x !== 'boolean')\n\t\t\t\tthrow new Error();\n\t\t\treturn x;\n\t\t}\n\t},\n\ttoJSON: x => x ? 1 : 0,\n\tfromJSON: x => !!x\n});\n\ndataType.enum = createDataType({\n\tname: 'enum',\n\tvalidators: {\n\t\tdefault() {\n\t\t\tassert(false, `also specify enum values with Prop.enum.values('value1', 'value2', ...)`);\n\t\t},\n\t\tvalues(x, ...values) {\n\t\t\tif (!Array.isArray(values))\n\t\t\t\tthrow new Error();\n\t\t\tif (typeof x !== 'string')\n\t\t\t\tthrow new Error('val should be string');\n\t\t\tif (values.indexOf(x) < 0)\n\t\t\t\tthrow new Error(`value ${x} not in enum: [${values}]`);\n\t\t\treturn x;\n\t\t}\n\t},\n\ttoJSON: x => x,\n\tfromJSON: x => x\n});\n\ndataType.color = createDataType({\n\tname: 'color',\n\tvalidators: {\n\t\tdefault(color) {\n\t\t\tlet newColor = new Color(color);\n\t\t\t// @ifndef OPTIMIZE\n\t\t\tassert(newColor.r >= 0 && newColor.r < 256);\n\t\t\tassert(newColor.g >= 0 && newColor.g < 256);\n\t\t\tassert(newColor.b >= 0 && newColor.b < 256);\n\t\t\t// @endif\n\t\t\treturn newColor;\n\t\t}\n\t},\n\ttoJSON: x => x.toHexString(),\n\tfromJSON: x => new Color(x)\n});\n","import Serializable from './serializable';\nimport assert from '../util/assert';\nimport { getSerializable } from './serializableManager';\nexport { default as Prop } from './propertyType';\n\nexport default class PropertyOwner extends Serializable {\n\tconstructor(predefinedId = false) {\n\t\tsuper(predefinedId);\n\t\tassert(Array.isArray(this.constructor._propertyTypes), 'call PropertyOwner.defineProperties after class definition');\n\t\tthis._properties = {};\n\t}\n\tmakeUpAName() {\n\t\treturn this.name || 'PropertyOwner';\n\t}\n\t// Just a helper\n\tinitWithPropertyValues(values = {}) {\n\t\tlet children = [];\n\t\t\n\t\tObject.keys(values).forEach(propName => {\n\t\t\tlet propertyType = this.constructor._propertyTypesByName[propName];\n\t\t\tassert(propertyType, 'Invalid property ' + propName);\n\t\t\tchildren.push(propertyType.createProperty({\n\t\t\t\tvalue: values[propName]\n\t\t\t}));\n\t\t});\n\t\tthis.initWithChildren(children);\n\t\treturn this;\n\t}\n\tinitWithChildren(children = []) {\n\t\tassert(!(this._state & Serializable.STATE_INIT), 'init already done');\n\t\tthis._state |= Serializable.STATE_INIT;\n\t\t\n\t\tlet propChildren = [];\n\t\tlet otherChildren = [];\n\t\t// Separate Property children and other children\n\t\tchildren.forEach(child => {\n\t\t\tif (child.threeLetterType === 'prp') {\n\t\t\t\tpropChildren.push(child);\n\t\t\t} else {\n\t\t\t\totherChildren.push(child);\n\t\t\t}\n\t\t});\n\t\tsuper.addChildren(otherChildren);\n\t\t\n\t\tlet invalidPropertiesCount = 0;\n\t\t\n\t\t// Make sure Properties have a PropertyType. They don't work without it.\n\t\tpropChildren.filter(prop => !prop.propertyType).forEach(prop => {\n\t\t\tlet propertyType = this.constructor._propertyTypesByName[prop.name];\n\t\t\tif (!propertyType) {\n\t\t\t\tconsole.log('Property of that name not defined', this.id, prop.name, this);\n\t\t\t\tinvalidPropertiesCount++;\n\t\t\t\tprop.isInvalid = true;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tprop.setPropertyType(propertyType);\n\t\t});\n\t\tif (invalidPropertiesCount)\n\t\t\tpropChildren = propChildren.filter(p => !p.isInvalid);\n\t\t\n\t\t// Make sure all PropertyTypes have a matching Property\n\t\tlet nameToProp = {};\n\t\tpropChildren.forEach(c => nameToProp[c.name] = c);\n\t\tthis.constructor._propertyTypes.forEach(propertyType => {\n\t\t\tif (!nameToProp[propertyType.name])\n\t\t\t\tpropChildren.push(propertyType.createProperty());\n\t\t});\n\t\t\n\t\tsuper.addChildren(propChildren);\n\t\treturn this;\n\t}\n\taddChild(child) {\n\t\tassert(this._state & Serializable.STATE_INIT, this.constructor.componentName || this.constructor + ' requires that initWithChildren will be called before addChild');\n\t\tsuper.addChild(child);\n\t\tif (child.threeLetterType === 'prp') {\n\t\t\tif (!child.propertyType) {\n\t\t\t\tif (!this.constructor._propertyTypesByName[child.name]) {\n\t\t\t\t\tconsole.log('Property of that name not defined', this.id, child, this);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tchild.setPropertyType(this.constructor._propertyTypesByName[child.name]);\n\t\t\t}\n\t\t\tassert(this._properties[child.propertyType.name] === undefined, 'Property already added');\n\t\t\tthis._properties[child.propertyType.name] = child;\n\t\t}\n\t\treturn this;\n\t}\n\tcreatePropertyHash() {\n\t\treturn this.getChildren('prp').map(property => '' + property._value).join(',');\n\t}\n\tdelete() {\n\t\tif (!super.delete()) return false;\n\t\tthis._properties = {};\n\t\treturn true;\n\t}\n\t// idx is optional\n\tdeleteChild(child, idx) {\n\t\tassert(child.threeLetterType !== 'prp', 'Can not delete just one Property child.');\n\t\tsuper.deleteChild(child, idx);\n\t\treturn this;\n\t}\n}\n\nPropertyOwner.defineProperties = function(Class, propertyTypes) {\n\tClass._propertyTypes = propertyTypes;\n\tClass._propertyTypesByName = {};\n\tpropertyTypes.forEach(propertyType => {\n\t\tconst propertyTypeName = propertyType.name;\n\t\tassert(Class.prototype[propertyTypeName] === undefined, 'Property name ' + propertyTypeName + ' clashes');\n\t\tClass._propertyTypesByName[propertyTypeName] = propertyType;\n\t\tObject.defineProperty(Class.prototype, propertyTypeName, {\n\t\t\tget() {\n\t\t\t\treturn this._properties[propertyTypeName].value;\n\t\t\t},\n\t\t\tset(value) {\n\t\t\t\tthis._properties[propertyTypeName].value = value;\n\t\t\t}\n\t\t});\n\t});\n};\n","var HASH = '#'.charCodeAt(0);\nvar DOT = '.'.charCodeAt(0);\n\nvar TAG_NAME = 0;\nvar ID = 1;\nvar CLASS_NAME = 2;\n\nvar parseQuery = function (query) {\n  var tag = null;\n  var id = null;\n  var className = null;\n  var mode = TAG_NAME;\n  var offset = 0;\n\n  for (var i = 0; i <= query.length; i++) {\n    var char = query.charCodeAt(i);\n    var isHash = char === HASH;\n    var isDot = char === DOT;\n    var isEnd = !char;\n\n    if (isHash || isDot || isEnd) {\n      if (mode === TAG_NAME) {\n        if (i === 0) {\n          tag = 'div';\n        } else {\n          tag = query.substring(offset, i);\n        }\n      } else if (mode === ID) {\n        id = query.substring(offset, i);\n      } else {\n        if (className) {\n          className += ' ' + query.substring(offset, i);\n        } else {\n          className = query.substring(offset, i);\n        }\n      }\n\n      if (isHash) {\n        mode = ID;\n      } else if (isDot) {\n        mode = CLASS_NAME;\n      }\n\n      offset = i + 1;\n    }\n  }\n\n  return { tag: tag, id: id, className: className };\n};\n\nvar createElement = function (query, ns) {\n  var ref = parseQuery(query);\n  var tag = ref.tag;\n  var id = ref.id;\n  var className = ref.className;\n  var element = ns ? document.createElementNS(ns, tag) : document.createElement(tag);\n\n  if (id) {\n    element.id = id;\n  }\n\n  if (className) {\n    if (ns) {\n      element.setAttribute('class', className);\n    } else {\n      element.className = className;\n    }\n  }\n\n  return element;\n};\n\nvar unmount = function (parent, child) {\n  var parentEl = getEl(parent);\n  var childEl = getEl(child);\n\n  if (child === childEl && childEl.__redom_view) {\n    // try to look up the view if not provided\n    child = childEl.__redom_view;\n  }\n\n  if (childEl.parentNode) {\n    doUnmount(child, childEl, parentEl);\n\n    parentEl.removeChild(childEl);\n  }\n\n  return child;\n};\n\nvar doUnmount = function (child, childEl, parentEl) {\n  var hooks = childEl.__redom_lifecycle;\n\n  if (hooksAreEmpty(hooks)) {\n    childEl.__redom_mounted = false;\n    return;\n  }\n\n  var traverse = parentEl;\n\n  if (childEl.__redom_mounted) {\n    trigger(childEl, 'onunmount');\n  }\n\n  while (traverse) {\n    var parentHooks = traverse.__redom_lifecycle || {};\n\n    for (var hook in hooks) {\n      if (parentHooks[hook]) {\n        parentHooks[hook] -= hooks[hook];\n      }\n    }\n\n    if (hooksAreEmpty(parentHooks)) {\n      traverse.__redom_lifecycle = null;\n    }\n\n    traverse = traverse.parentNode;\n  }\n};\n\nvar hooksAreEmpty = function (hooks) {\n  if (hooks == null) {\n    return true;\n  }\n  for (var key in hooks) {\n    if (hooks[key]) {\n      return false;\n    }\n  }\n  return true;\n};\n\nvar hookNames = ['onmount', 'onunmount'];\nvar shadowRootAvailable = typeof window !== 'undefined' && 'ShadowRoot' in window;\n\nvar mount = function (parent, child, before) {\n  var parentEl = getEl(parent);\n  var childEl = getEl(child);\n\n  if (child === childEl && childEl.__redom_view) {\n    // try to look up the view if not provided\n    child = childEl.__redom_view;\n  }\n\n  if (child !== childEl) {\n    childEl.__redom_view = child;\n  }\n\n  var wasMounted = childEl.__redom_mounted;\n  var oldParent = childEl.parentNode;\n\n  if (wasMounted && (oldParent !== parentEl)) {\n    doUnmount(child, childEl, oldParent);\n  }\n\n  if (before != null) {\n    parentEl.insertBefore(childEl, getEl(before));\n  } else {\n    parentEl.appendChild(childEl);\n  }\n\n  doMount(child, childEl, parentEl, oldParent);\n\n  return child;\n};\n\nvar doMount = function (child, childEl, parentEl, oldParent) {\n  var hooks = childEl.__redom_lifecycle || (childEl.__redom_lifecycle = {});\n  var remount = (parentEl === oldParent);\n  var hooksFound = false;\n\n  for (var i = 0; i < hookNames.length; i++) {\n    var hookName = hookNames[i];\n\n    if (!remount && (child !== childEl) && (hookName in child)) {\n      hooks[hookName] = (hooks[hookName] || 0) + 1;\n    }\n    if (hooks[hookName]) {\n      hooksFound = true;\n    }\n  }\n\n  if (!hooksFound) {\n    childEl.__redom_mounted = true;\n    return;\n  }\n\n  var traverse = parentEl;\n  var triggered = false;\n\n  if (remount || (!triggered && (traverse && traverse.__redom_mounted))) {\n    trigger(childEl, remount ? 'onremount' : 'onmount');\n    triggered = true;\n  }\n\n  if (remount) {\n    return;\n  }\n\n  while (traverse) {\n    var parent = traverse.parentNode;\n    var parentHooks = traverse.__redom_lifecycle || (traverse.__redom_lifecycle = {});\n\n    for (var hook in hooks) {\n      parentHooks[hook] = (parentHooks[hook] || 0) + hooks[hook];\n    }\n\n    if (!triggered && (traverse === document || (shadowRootAvailable && (traverse instanceof window.ShadowRoot)) || (parent && parent.__redom_mounted))) {\n      trigger(traverse, remount ? 'onremount' : 'onmount');\n      triggered = true;\n    }\n\n    traverse = parent;\n  }\n};\n\nvar trigger = function (el, eventName) {\n  if (eventName === 'onmount') {\n    el.__redom_mounted = true;\n  } else if (eventName === 'onunmount') {\n    el.__redom_mounted = false;\n  }\n\n  var hooks = el.__redom_lifecycle;\n\n  if (!hooks) {\n    return;\n  }\n\n  var view = el.__redom_view;\n  var hookCount = 0;\n\n  view && view[eventName] && view[eventName]();\n\n  for (var hook in hooks) {\n    if (hook) {\n      hookCount++;\n    }\n  }\n\n  if (hookCount) {\n    var traverse = el.firstChild;\n\n    while (traverse) {\n      var next = traverse.nextSibling;\n\n      trigger(traverse, eventName);\n\n      traverse = next;\n    }\n  }\n};\n\nvar setStyle = function (view, arg1, arg2) {\n  var el = getEl(view);\n\n  if (arg2 !== undefined) {\n    el.style[arg1] = arg2;\n  } else if (isString(arg1)) {\n    el.setAttribute('style', arg1);\n  } else {\n    for (var key in arg1) {\n      setStyle(el, key, arg1[key]);\n    }\n  }\n};\n\n/* global SVGElement */\n\nvar xlinkns = 'http://www.w3.org/1999/xlink';\n\nvar setAttr = function (view, arg1, arg2) {\n  var el = getEl(view);\n  var isSVG = el instanceof SVGElement;\n\n  if (arg2 !== undefined) {\n    if (arg1 === 'style') {\n      setStyle(el, arg2);\n    } else if (isSVG && isFunction(arg2)) {\n      el[arg1] = arg2;\n    } else if (arg1 === 'dataset') {\n      setData(el, arg2);\n    } else if (!isSVG && (arg1 in el || isFunction(arg2))) {\n      el[arg1] = arg2;\n    } else {\n      if (isSVG && (arg1 === 'xlink')) {\n        setXlink(el, arg2);\n        return;\n      }\n      el.setAttribute(arg1, arg2);\n    }\n  } else {\n    for (var key in arg1) {\n      setAttr(el, key, arg1[key]);\n    }\n  }\n};\n\nfunction setXlink (el, obj) {\n  for (var key in obj) {\n    el.setAttributeNS(xlinkns, key, obj[key]);\n  }\n}\n\nfunction setData (el, obj) {\n  for (var key in obj) {\n    el.dataset[key] = obj[key];\n  }\n}\n\nvar text = function (str) { return document.createTextNode((str != null) ? str : ''); };\n\nvar parseArguments = function (element, args) {\n  for (var i = 0; i < args.length; i++) {\n    var arg = args[i];\n\n    if (arg !== 0 && !arg) {\n      continue;\n    }\n\n    // support middleware\n    if (typeof arg === 'function') {\n      arg(element);\n    } else if (isString(arg) || isNumber(arg)) {\n      element.appendChild(text(arg));\n    } else if (isNode(getEl(arg))) {\n      mount(element, arg);\n    } else if (arg.length) {\n      parseArguments(element, arg);\n    } else if (typeof arg === 'object') {\n      setAttr(element, arg);\n    }\n  }\n};\n\nvar ensureEl = function (parent) { return isString(parent) ? html(parent) : getEl(parent); };\nvar getEl = function (parent) { return (parent.nodeType && parent) || (!parent.el && parent) || getEl(parent.el); };\n\nvar isString = function (a) { return typeof a === 'string'; };\nvar isNumber = function (a) { return typeof a === 'number'; };\nvar isFunction = function (a) { return typeof a === 'function'; };\n\nvar isNode = function (a) { return a && a.nodeType; };\n\nvar htmlCache = {};\n\nvar memoizeHTML = function (query) { return htmlCache[query] || (htmlCache[query] = createElement(query)); };\n\nvar html = function (query) {\n  var args = [], len = arguments.length - 1;\n  while ( len-- > 0 ) args[ len ] = arguments[ len + 1 ];\n\n  var element;\n\n  if (isString(query)) {\n    element = memoizeHTML(query).cloneNode(false);\n  } else if (isNode(query)) {\n    element = query.cloneNode(false);\n  } else {\n    throw new Error('At least one argument required');\n  }\n\n  parseArguments(element, args);\n\n  return element;\n};\n\nhtml.extend = function (query) {\n  var args = [], len = arguments.length - 1;\n  while ( len-- > 0 ) args[ len ] = arguments[ len + 1 ];\n\n  var clone = memoizeHTML(query);\n\n  return html.bind.apply(html, [ this, clone ].concat( args ));\n};\n\nvar el = html;\nvar h = html;\n\nvar setChildren = function (parent) {\n  var children = [], len = arguments.length - 1;\n  while ( len-- > 0 ) children[ len ] = arguments[ len + 1 ];\n\n  var parentEl = getEl(parent);\n  var current = traverse(parent, children, parentEl.firstChild);\n\n  while (current) {\n    var next = current.nextSibling;\n\n    unmount(parent, current);\n\n    current = next;\n  }\n};\n\nfunction traverse (parent, children, _current) {\n  var current = _current;\n\n  for (var i = 0; i < children.length; i++) {\n    var child = children[i];\n\n    if (!child) {\n      continue;\n    }\n\n    var childEl = getEl(child);\n\n    if (childEl === current) {\n      current = current.nextSibling;\n      continue;\n    }\n\n    if (isNode(childEl)) {\n      mount(parent, child, current);\n      continue;\n    }\n\n    if (child.length != null) {\n      current = traverse(parent, child, current);\n    }\n  }\n\n  return current;\n}\n\nvar propKey = function (key) { return function (item) { return item[key]; }; };\n\nvar listPool = function (View, key, initData) {\n  return new ListPool(View, key, initData);\n};\n\nvar ListPool = function ListPool (View, key, initData) {\n  this.View = View;\n  this.initData = initData;\n  this.oldLookup = {};\n  this.lookup = {};\n  this.oldViews = [];\n  this.views = [];\n\n  if (key != null) {\n    this.lookup = {};\n    this.key = isFunction(key) ? key : propKey(key);\n  }\n};\nListPool.prototype.update = function update (data, context) {\n  var ref = this;\n    var View = ref.View;\n    var key = ref.key;\n    var initData = ref.initData;\n  var keySet = key != null;\n\n  var oldLookup = this.lookup;\n  var newLookup = {};\n\n  var newViews = new Array(data.length);\n  var oldViews = this.views;\n\n  for (var i = 0; i < data.length; i++) {\n    var item = data[i];\n    var view = (void 0);\n\n    if (keySet) {\n      var id = key(item);\n      view = oldLookup[id] || new View(initData, item, i, data);\n      newLookup[id] = view;\n      view.__redom_id = id;\n    } else {\n      view = oldViews[i] || new View(initData, item, i, data);\n    }\n    view.update && view.update(item, i, data, context);\n\n    var el = getEl(view.el);\n    el.__redom_view = view;\n    newViews[i] = view;\n  }\n\n  this.oldViews = oldViews;\n  this.views = newViews;\n\n  this.oldLookup = oldLookup;\n  this.lookup = newLookup;\n};\n\nvar list = function (parent, View, key, initData) {\n  return new List(parent, View, key, initData);\n};\n\nvar List = function List (parent, View, key, initData) {\n  this.__redom_list = true;\n  this.View = View;\n  this.initData = initData;\n  this.views = [];\n  this.pool = new ListPool(View, key, initData);\n  this.el = ensureEl(parent);\n  this.keySet = key != null;\n};\nList.prototype.update = function update (data, context) {\n    var this$1 = this;\n    if ( data === void 0 ) data = [];\n\n  var ref = this;\n    var keySet = ref.keySet;\n  var oldViews = this.views;\n  var oldLookup = keySet && this.lookup;\n\n  this.pool.update(data, context);\n  var ref$1 = this.pool;\n    var views = ref$1.views;\n    var lookup = ref$1.lookup;\n\n  if (keySet) {\n    for (var i = 0; i < oldViews.length; i++) {\n      var id = oldViews[i].__redom_id;\n      if (!(id in lookup)) {\n        unmount(this$1, oldLookup[id]);\n      }\n    }\n  }\n\n  setChildren(this, views);\n\n  if (keySet) {\n    this.lookup = lookup;\n  }\n  this.views = views;\n};\n\nList.extend = function (parent, View, key, initData) {\n  return List.bind(List, parent, View, key, initData);\n};\n\nlist.extend = List.extend;\n\n/* global Node */\n\nvar place = function (View, initData) {\n  return new Place(View, initData);\n};\n\nvar Place = function Place (View, initData) {\n  this.el = text('');\n  this.visible = false;\n  this.view = null;\n  this._placeholder = this.el;\n  if (View instanceof Node) {\n    this._el = View;\n  } else {\n    this._View = View;\n  }\n  this._initData = initData;\n};\nPlace.prototype.update = function update (visible, data) {\n  var placeholder = this._placeholder;\n  var parentNode = this.el.parentNode;\n\n  if (visible) {\n    if (!this.visible) {\n      if (this._el) {\n        mount(parentNode, this._el, placeholder);\n        unmount(parentNode, placeholder);\n        this.el = this._el;\n        this.visible = visible;\n        return;\n      }\n      var View = this._View;\n      var view = new View(this._initData);\n\n      this.el = getEl(view);\n      this.view = view;\n\n      mount(parentNode, view, placeholder);\n      unmount(parentNode, placeholder);\n    }\n    this.view && this.view.update && this.view.update(data);\n  } else {\n    if (this.visible) {\n      if (this._el) {\n        mount(parentNode, placeholder, this._el);\n        unmount(parentNode, this._el);\n        this.el = placeholder;\n        this.visible = visible;\n        return;\n      }\n      mount(parentNode, placeholder, this.view);\n      unmount(parentNode, this.view);\n\n      this.el = placeholder;\n      this.view = null;\n    }\n  }\n  this.visible = visible;\n};\n\nvar router = function (parent, Views, initData) {\n  return new Router(parent, Views, initData);\n};\n\nvar Router = function Router (parent, Views, initData) {\n  this.el = ensureEl(parent);\n  this.Views = Views;\n  this.initData = initData;\n};\nRouter.prototype.update = function update (route, data) {\n  if (route !== this.route) {\n    var Views = this.Views;\n    var View = Views[route];\n\n    this.route = route;\n    this.view = View && new View(this.initData, data);\n\n    setChildren(this.el, [ this.view ]);\n  }\n  this.view && this.view.update && this.view.update(data, route);\n};\n\nvar ns = 'http://www.w3.org/2000/svg';\n\nvar svgCache = {};\n\nvar memoizeSVG = function (query) { return svgCache[query] || (svgCache[query] = createElement(query, ns)); };\n\nvar svg = function (query) {\n  var args = [], len = arguments.length - 1;\n  while ( len-- > 0 ) args[ len ] = arguments[ len + 1 ];\n\n  var element;\n\n  if (isString(query)) {\n    element = memoizeSVG(query).cloneNode(false);\n  } else if (isNode(query)) {\n    element = query.cloneNode(false);\n  } else {\n    throw new Error('At least one argument required');\n  }\n\n  parseArguments(element, args);\n\n  return element;\n};\n\nsvg.extend = function (query) {\n  var clone = memoizeSVG(query);\n\n  return svg.bind(this, clone);\n};\n\nsvg.ns = ns;\n\nvar s = svg;\n\nexport { el, h, html, list, List, listPool, ListPool, mount, unmount, place, Place, router, Router, setAttr, setStyle, setChildren, s, svg, text };\n","import {el, mount} from 'redom';\n\nexport function stickyNonModalErrorPopup(text) {\n\tdocument.body.style.filter = 'contrast(70%) brightness(130%) saturate(200%) sepia(40%) hue-rotate(300deg)';\n\t\n\tlet popup = el('div', text, {\n\t\tstyle: {\n\t\t\t'position': 'fixed',\n\t\t\t'display': 'inline-block',\n\t\t\t'max-width': '600%',\n\t\t\t'top': '20%',\n\t\t\t'width': '100%',\n\t\t\t'padding': '40px 10%',\n\t\t\t'font-size': '20px',\n\t\t\t'z-index': '100000',\n\t\t\t'color': 'white',\n\t\t\t'background': '#0c0c0c',\n\t\t\t'text-align': 'center',\n\t\t\t'user-select': 'auto !important',\n\t\t\t'box-sizing': 'border-box'\n\t\t}\n\t});\n\t\n\tmount(document.body, popup);\n}\n\nwindow.sticky = stickyNonModalErrorPopup;\n","import { isClient } from '../util/environment';\n\nlet PIXI;\n\nif (isClient) {\n\tPIXI = window.PIXI;\n\tPIXI.ticker.shared.stop();\n}\n\nexport default PIXI;\n\nlet renderer = null; // Only one PIXI renderer supported for now\n\nexport function getRenderer(canvas) {\n\t/*\n\treturn {\n\t\trender: () => {},\n\t\tresize: () => {}\n\t};\n\t*/\n\t\n\tif (!renderer) {\n\t\trenderer = PIXI.autoDetectRenderer({\n\t\t\tview: canvas,\n\t\t\tautoResize: true,\n\t\t\tantialias: true\n\t\t});\n\n\t\t// Interaction plugin uses ticker that runs in the background. Destroy it to save CPU.\n\t\tif (renderer.plugins.interaction) // if interaction is left out from pixi build, interaction is no defined\n\t\t\trenderer.plugins.interaction.destroy();\n\t}\n\t\n\treturn renderer;\n}\n\nexport function sortDisplayObjects(container) {\n\tcontainer.children.sort(sortFunc);\n}\nfunction sortFunc(a, b) {\n\tif (a.y < b.y)\n\t\treturn -1;\n\telse if (a.y > b.y)\n\t\treturn 1;\n\telse\n\t\treturn 0;\n}\n\nlet texturesAndAnchors = {};\nexport function resetTexturesAndAnchors() {\n\tfor (let textureAndAnchor in texturesAndAnchors) {\n\t\ttextureAndAnchor.texture.destroy();\n\t}\n\ttexturesAndAnchors = {};\n}\nexport function getHashedTextureAndAnchor(hash) {\n\treturn texturesAndAnchors[hash];\n}\nexport function generateTextureAndAnchor(graphicsObject, hash) {\n\tif (!texturesAndAnchors[hash]) {\n\t\tlet bounds = graphicsObject.getLocalBounds();\n\t\tlet anchor = {\n\t\t\tx: -bounds.x / bounds.width,\n\t\t\ty: -bounds.y / bounds.height\n\t\t};\n\t\ttexturesAndAnchors[hash] = {\n\t\t\ttexture: renderer.generateTexture(graphicsObject, PIXI.SCALE_MODES.LINEAR, 2),\n\t\t\tanchor\n\t\t};\n\t}\n\treturn texturesAndAnchors[hash];\n}\n","import events from '../util/events';\nimport PIXI from '../features/graphics';\n\nfunction createCanvas() {\n\tconst RESOLUTION = 10;\n\tvar canvas = document.createElement('canvas');\n\tcanvas.width  = 1;\n\tcanvas.height = RESOLUTION;\n\tvar ctx = canvas.getContext('2d');\n\tvar gradient = ctx.createLinearGradient(0, 0, 0, RESOLUTION * 0.8);\n\t// gradient.addColorStop(0, \"#5886c8\");\n\t// gradient.addColorStop(1, \"#9eb6d5\");\n\tgradient.addColorStop(0, \"#5c77ff\");\n\tgradient.addColorStop(1, \"#90c9f6\");\n\tctx.fillStyle = gradient;\n\tctx.fillRect(0, 0, 1, RESOLUTION);\n\treturn canvas;\n}\n\nevents.listen('scene load level', scene => {\n\tlet gradientCanvas = createCanvas();\n\tlet sprite = new PIXI.Sprite(PIXI.Texture.fromCanvas(gradientCanvas));\n\tscene.backgroundGradient = sprite;\n\tupdateSceneBackgroundGradient(scene);\n\tscene.layers.static.addChild(sprite);\n});\n\nevents.listen('scene unload level', scene => {\n\tdelete scene.backgroundGradient;\n});\n\nevents.listen('canvas resize', scene => {\n\tupdateSceneBackgroundGradient(scene);\n});\n\nfunction updateSceneBackgroundGradient(scene) {\n\tif (!scene.canvas || !scene.backgroundGradient)\n\t\treturn;\n\t\n\tscene.backgroundGradient.width = scene.canvas.width;\n\tscene.backgroundGradient.height = scene.canvas.height;\n};\n","// @flow\n\nimport Serializable from './serializable'\nimport { addChange, changeType, setChangeOrigin } from './serializableManager';\nimport Prototype from './prototype'\nimport assert from '../util/assert'\nimport PropertyOwner, { Prop } from './propertyOwner';\nimport {stickyNonModalErrorPopup} from '../util/popup'\nimport '../modules';\n\nlet propertyTypes = [\n\tProp('name', 'No name', Prop.string)\n];\n\nlet game = null; // only one game at the time\nexport { game };\n\nlet isClient = typeof window !== 'undefined';\n\nexport default class Game extends PropertyOwner {\n\tconstructor(predefinedId) {\n\t\tif (game)\n\t\t\tconsole.error('Only one game allowed.');\n\t\t\n\t\t/*\n\t\tif (isClient) {\n\t\t\tif (game) {\n\t\t\t\ttry {\n\t\t\t\t\tgame.delete();\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.warn('Deleting old game failed', e);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t*/\n\t\t\n\t\tsuper(...arguments);\n\t\t\n\t\tif (isClient) {\n\t\t\tgame = this;\n\t\t}\n\n\t\tsetTimeout(() => {\n\t\t\tgameCreateListeners.forEach(listener => listener(game));\n\t\t}, 1);\n\t}\n\tinitWithChildren() {\n\t\tsuper.initWithChildren(...arguments);\n\t\taddChange(changeType.addSerializableToTree, this);\n\t}\n\tdelete() {\n\t\taddChange(changeType.deleteSerializable, this);\n\t\tif (!super.delete()) return false;\n\t\t\n\t\tif (game === this)\n\t\t\tgame = null;\n\n\t\tstickyNonModalErrorPopup('Game deleted');\n\t\t\n\t\treturn true;\n\t}\n}\nPropertyOwner.defineProperties(Game, propertyTypes);\n\nGame.prototype.isRoot = true;\n\n\n\nSerializable.registerSerializable(Game, 'gam', json => {\n\tif (json.c) {\n\t\tjson.c.sort((a, b) => {\n\t\t\tif (a.id.startsWith('prt') || a.id.startsWith('pfa'))\n\t\t\t\treturn -1;\n\t\t\telse\n\t\t\t\treturn 1;\n\t\t});\n\t}\n\treturn new Game(json.id);\n});\n\nlet gameCreateListeners = [];\nexport function listenGameCreation(listener: (object) => void) {\n\tgameCreateListeners.push(listener);\n\t\n\tconsole.log('real ts');\n\n\tif (game)\n\t\tlistener(game);\n}\n\n\n// jee\n\n\n","import assert from '../util/assert';\nimport { isClient } from '../util/environment';\n\nlet p2;\nif (isClient)\n\tp2 = window.p2;\nelse\n\tp2 = require('../src/external/p2');\n\nexport default p2;\n\nexport function createWorld(owner, options) {\n\tassert(!owner._p2World);\n\towner._p2World = new p2.World({\n\t\tgravity: [0, 9.81]\n\t\t// gravity: [0, 0]\n\t});\n\n\t// Stress test says that Body sleeping performs better than Island sleeping when idling.\n\towner._p2World.sleepMode = p2.World.BODY_SLEEPING;\n}\n// const MAX_PHYSICS_DT = 0.2;\nconst PHYSICS_DT = 1 / 60;\nexport function updateWorld(owner, dt) {\n\towner._p2World.step(PHYSICS_DT, dt, 5);\n\t// owner._p2World.step(dt, dt, 10);\n}\nexport function deleteWorld(owner) {\n\tif (owner._p2World)\n\t\towner._p2World.clear()\n\tdelete owner._p2World;\n\tdelete owner._p2Materials;\n}\nexport function getWorld(owner) {\n\treturn owner._p2World;\n}\nexport function addBody(owner, body) {\n\towner._p2World.addBody(body);\n}\nexport function deleteBody(owner, body) {\n\towner._p2World.removeBody(body);\n}\n\n// export function addContactMaterial(owner, A, B, options) {\n// \towner._p2World.addContactMaterial(new p2.ContactMaterial(A, B, options));\n// }\n\nconst defaultMaterialOptions = {\n\tfriction: 0.3,\n\trestitution: 0,\n\tstiffness: 1e6, // Hardness of the contact. Less stiffness will make the objects penetrate more, and will make the contact act more like a spring than a contact force.\n\trelaxation: 4, // Original: 3. Small number makes bounce. Big number makes object stay inside another object.\n\tfrictionStiffness: 1e6, // Stiffness of the resulting friction force. For most cases, the value of this property should be a large number. I cannot think of any case where you would want less frictionStiffness.\n\tfrictionRelaxation: 4, // Relaxation of the resulting friction force. The default value should be good for most simulations.\n\tsurfaceVelocity: 0 // Will add surface velocity to this material. If bodyA rests on top if bodyB, and the surface velocity is positive, bodyA will slide to the right.\n};\n\nexport function createMaterial(owner, options) {\n\tif (!owner._p2Materials)\n\t\towner._p2Materials = {};\n\tlet materials = owner._p2Materials;\n\toptions = Object.assign({}, defaultMaterialOptions, options);\n\tlet hash = [\n\t\toptions.friction,\n\t\toptions.restitution,\n\t\toptions.stiffness,\n\t\toptions.relaxation,\n\t\toptions.frictionStiffness,\n\t\toptions.frictionRelaxation,\n\t\toptions.surfaceVelocity\n\t].join(';');\n\t\n\tif (materials[hash])\n\t\treturn materials[hash];\n\t\n\tlet material = new p2.Material();\n\tmaterial.options = options;\n\tmaterials[hash] = material;\n\t\n\t// TODO: When physics entities are edited, new materials are created.\n\t// Should somehow remove old unused materials and contact materials.\n\t\n\tfor (var h in materials) {\n\t\tlet m = materials[h];\n\t\tlet o1 = material.options;\n\t\tlet o2 = m.options;\n\t\tlet contactMaterial = new p2.ContactMaterial(material, m, {\n\t\t\tfriction:\t\t\t\tMath.min(o1.friction, o2.friction),\n\t\t\trestitution:\t\t\tMath.max(o1.restitution, o2.restitution), // If one is bouncy and other is not, collision is bouncy.\n\t\t\tstiffness:\t\t\t\tMath.min(o1.stiffness, o2.stiffness),\n\t\t\trelaxation:\t\t\t\t(o1.relaxation + o2.relaxation) / 2,\n\t\t\tfrictionStiffness:\t\tMath.min(o1.frictionStiffness, o2.frictionStiffness),\n\t\t\tfrictionRelaxation:\t\t(o1.frictionRelaxation + o2.frictionRelaxation) / 2,\n\t\t\tsurfaceVelocity:\t\tMath.max(o1.surfaceVelocity, o2.surfaceVelocity)\n\t\t});\n\t\towner._p2World.addContactMaterial(contactMaterial);\n\t}\n\t\n\treturn material;\n}\n","import Vector from '../util/vector';\n\nexport function keyPressed(key) {\n\treturn keys[key] || false;\n}\n\nexport function listenKeyDown(handler) {\n\tkeyDownListeners.push(handler);\n\treturn () => keyDownListeners.splice(keyDownListeners.indexOf(handler), 1);\n}\nexport function listenKeyUp(handler) {\n\tkeyUpListeners.push(handler);\n\treturn () => keyUpListeners.splice(keyUpListeners.indexOf(handler), 1);\n}\n\nexport const key = {\n\tleft: 37,\n\tright: 39,\n\tup: 38,\n\tdown: 40,\n\tctrl: 17,\n\tappleLeft: 91,\n\tappleRight: 93,\n\talt: 18,\n\tshift: 16,\n\tspace: 32,\n\ta: 65,\n\tb: 66,\n\tc: 67,\n\td: 68,\n\te: 69,\n\tf: 70,\n\tg: 71,\n\th: 72,\n\ti: 73,\n\tj: 74,\n\tk: 75,\n\tl: 76,\n\tm: 77,\n\tn: 78,\n\to: 79,\n\tp: 80,\n\tq: 81,\n\tr: 82,\n\ts: 83,\n\tt: 84,\n\tu: 85,\n\tv: 86,\n\tw: 87,\n\tx: 88,\n\ty: 89,\n\tz: 90,\n\t'0': 48,\n\t'1': 49,\n\t'2': 50,\n\t'3': 51,\n\t'4': 52,\n\t'5': 53,\n\t'6': 54,\n\t'7': 55,\n\t'8': 56,\n\t'9': 57,\n\tbackspace: 8,\n\tenter: 13,\n\tesc: 27,\n\tplus: 187,\n\tminus: 189,\n\tquestionMark: 191\n};\n\nexport function listenMouseMove(element, handler)Â {\n\telement.addEventListener('mousemove', event => {\n\t\tlet x = event.pageX;\n\t\tlet y = event.pageY;\n\t\tlet el = element;\n\t\twhile( el != null ) {\n\t\t\tx -= el.offsetLeft;\n\t\t\ty -= el.offsetTop;\n\t\t\tel = el.offsetParent;\n\t\t}\n\t\t\n\t\telement._mx = x;\n\t\telement._my = y;\n\t\thandler && handler(new Vector(x, y));\n\t});\n\treturn () => element.removeEventListener('mousemove', handler);\n}\n// Requires listenMouseMove on the same element to get the mouse position\nexport function listenMouseDown(element, handler) {\n\telement.addEventListener('mousedown', event => {\n\t\tif (typeof element._mx === 'number')\n\t\t\thandler(new Vector(element._mx, element._my));\n\t\telse\n\t\t\thandler();\n\t});\n\treturn () => element.removeEventListener('mousedown', handler);\n}\n// Requires listenMouseMove on the same element to get the mouse position\nexport function listenMouseUp(element, handler) {\n\t// listen document body because many times mouse is accidentally dragged outside of element\n\tdocument.body.addEventListener('mouseup', event => {\n\t\tif (typeof element._mx === 'number')\n\t\t\thandler(new Vector(element._mx, element._my));\n\t\telse\n\t\t\thandler();\n\t});\n\treturn () => element.removeEventListener('mouseup', handler);\n}\n\n////////////////////////////////////\n\n\nlet keys = {};\nlet keyDownListeners = [];\nlet keyUpListeners = [];\n\n\nif (typeof window !== 'undefined') {\n\n\twindow.onkeydown = event => {\n\t\tlet keyCode = event.which || event.keyCode;\n\n\t\tif (document.activeElement.nodeName.toLowerCase() == \"input\" && keyCode !== key.esc)\n\t\t\treturn;\n\t\t\n\t\tif (!keys[keyCode]) {\n\t\t\tkeys[keyCode] = true;\n\t\t\tkeyDownListeners.forEach(l => l(keyCode));\n\t\t}\n\t\t\n\t\t// console.log(keyCode);\n\t};\n\twindow.onkeyup = event => {\n\t\tlet key = event.which || event.keyCode;\n\t\tkeys[key] = false;\n\t\tkeyUpListeners.forEach(l => l(key));\n\t};\n}\n\nexport function simulateKeyEvent(eventName, keyCode) {\n\tif (eventName === 'keydown') {\n\t\twindow.onkeydown({\n\t\t\tkeyCode\n\t\t});\n\t} else if (eventName === 'keyup') {\n\t\twindow.onkeyup({\n\t\t\tkeyCode\n\t\t});\n\t}\n}\n","import Serializable from './serializable';\nimport assert from '../util/assert';\nimport { game } from './game';\nimport { addChange, changeType, setChangeOrigin } from './serializableManager';\nimport { createWorld, deleteWorld, updateWorld } from '../features/physics';\nimport { listenMouseMove, listenMouseDown, listenMouseUp, listenKeyDown, key, keyPressed } from '../util/input';\nimport { default as PIXI, getRenderer, sortDisplayObjects } from '../features/graphics';\nimport * as performanceTool from '../util/performance';\nimport Vector from '../util/vector';\nimport events from \"../util/events\";\n\nlet scene = null;\nexport { scene };\n\nconst physicsOptions = {\n\tenableSleeping: true\n};\n\nexport default class Scene extends Serializable {\n\tconstructor(predefinedId = false) {\n\t\tsuper(predefinedId);\n\n\t\tif (scene) {\n\t\t\ttry {\n\t\t\t\tscene.delete();\n\t\t\t} catch (e) {\n\t\t\t\tconsole.warn('Deleting old scene failed', e);\n\t\t\t}\n\t\t}\n\t\tscene = this;\n\t\twindow.scene = this;\n\n\t\tthis.canvas = document.querySelector('canvas.openEditPlayCanvas');\n\t\tthis.renderer = getRenderer(this.canvas);\n\n\t\tthis.mouseListeners = [\n\t\t\tlistenMouseMove(this.canvas, mousePosition => this.dispatch('onMouseMove', mousePosition)),\n\t\t\tlistenMouseDown(this.canvas, mousePosition => this.dispatch('onMouseDown', mousePosition)),\n\t\t\tlistenMouseUp(this.canvas, mousePosition => this.dispatch('onMouseUp', mousePosition))\n\t\t];\n\n\t\taddChange(changeType.addSerializableToTree, this);\n\n\t\tsceneCreateListeners.forEach(listener => listener());\n\t}\n\tmakeUpAName() {\n\t\tif (this.level)\n\t\t\treturn this.level.makeUpAName();\n\t\telse\n\t\t\treturn 'Scene';\n\t}\n\n\tloadLevel(level) {\n\t\tthis.level = level;\n\n\t\tthis.stage = new PIXI.Container();\n\t\tthis.cameraPosition = new Vector(0, 0);\n\t\tthis.cameraZoom = 1;\n\n\t\tlet self = this;\n\t\tfunction createLayer(parent = self.stage) {\n\t\t\tlet layer = new PIXI.Container();\n\t\t\tparent.addChild(layer);\n\t\t\treturn layer;\n\t\t}\n\t\tthis.layers = {\n\t\t\tstatic: createLayer(), // doesn't move when camera does\n\t\t\tbackground: createLayer(), // moves a little when camera does\n\t\t\tmove: createLayer(), // moves with camera\n\t\t\tui: createLayer() // doesn't move, is on front\n\t\t};\n\t\tthis.layers.behind = createLayer(this.layers.move);\n\t\tthis.layers.main = createLayer(this.layers.move);\n\t\tthis.layers.front = createLayer(this.layers.move);\n\n\t\t// this.bloom = new PIXI.filters.AdvancedBloomFilter();\n\t\t// this.layers.move.filters = [this.bloom];\n\n\t\t// To make component based entity search fast:\n\t\tthis.components = new Map(); // componentName -> Set of components\n\n\t\tthis.animationFrameId = null;\n\t\tthis.playing = false;\n\t\tthis.time = 0;\n\t\tthis.won = false;\n\n\t\tcreateWorld(this, physicsOptions);\n\n\t\tevents.dispatch('scene load level before entities', scene, level);\n\n\t\tthis.level.getChildren('epr').map(epr => epr.createEntity(this));\n\n\t\tevents.dispatch('scene load level', scene, level);\n\n\t\t// this.draw();\n\t}\n\tunloadLevel() {\n\t\tlet level = this.level;\n\t\tthis.level = null;\n\n\t\tthis.pause();\n\n\t\tthis.deleteChildren();\n\n\t\tif (this.stage)\n\t\t\tthis.stage.destroy();\n\t\tthis.stage = null;\n\n\t\tthis.layers = null;\n\n\t\tthis.components.clear();\n\n\t\tdeleteWorld(this);\n\n\t\tevents.dispatch('scene unload level', scene, level);\n\t}\n\n\tsetCameraPositionToPlayer() {\n\t\tlet pos = new Vector(0, 0);\n\t\tlet count = 0;\n\t\tthis.getComponents('CharacterController').forEach(characterController => {\n\t\t\tif (characterController._rootType) {\n\t\t\t\tpos.add(characterController.Transform.position);\n\t\t\t\tcount++;\n\t\t\t}\n\t\t});\n\t\tif (count > 0) {\n\t\t\tthis.cameraPosition.set(pos.divideScalar(count));\n\t\t}\n\t}\n\n\tupdateCamera() {\n\t\tif (this.playing) {\n\t\t\tthis.setCameraPositionToPlayer();\n\t\t}\n\t\t// pivot is camera top left corner position\n\t\tthis.layers.move.pivot.set(this.cameraPosition.x - this.canvas.width / 2 / this.cameraZoom, this.cameraPosition.y - this.canvas.height / 2 / this.cameraZoom);\n\t\tthis.layers.move.scale.set(this.cameraZoom, this.cameraZoom);\n\t}\n\n\twin() {\n\t\tthis.won = true;\n\t}\n\n\tanimFrame() {\n\t\tthis.animationFrameId = null;\n\t\tif (!this._alive || !this.playing) return;\n\n\t\tlet timeInMilliseconds = performance.now();\n\t\tlet t = 0.001 * timeInMilliseconds;\n\t\tlet dt = t - this._prevUpdate;\n\n\t\tperformanceTool.setFrameTime(dt);\n\n\t\tif (dt > 0.05)\n\t\t\tdt = 0.05;\n\t\tthis._prevUpdate = t;\n\t\tthis.time += dt;\n\n\t\tsetChangeOrigin(this);\n\n\t\t// Update logic\n\t\tperformanceTool.start('Component updates');\n\t\tthis.dispatch('onUpdate', dt, this.time);\n\t\tperformanceTool.stop('Component updates');\n\n\t\t// Update physics\n\t\tperformanceTool.start('Physics');\n\t\tupdateWorld(this, dt, timeInMilliseconds);\n\t\tperformanceTool.stop('Physics');\n\n\t\t// Update graphics\n\t\tperformanceTool.start('Draw');\n\t\tthis.draw();\n\t\tperformanceTool.stop('Draw');\n\n\t\tif (this.won) {\n\t\t\tthis.pause();\n\t\t\tthis.time = 0;\n\t\t\tgame.dispatch('levelCompleted');\n\t\t\tthis.reset();\n\t\t}\n\n\t\tthis.requestAnimFrame();\n\t}\n\n\trequestAnimFrame() {\n\t\tlet callback = () => this.animFrame();\n\t\tif (window.requestAnimationFrame)\n\t\t\tthis.animationFrameId = window.requestAnimationFrame(callback);\n\t\telse\n\t\t\tthis.animationFrameId = setTimeout(callback, 16);\n\t}\n\n\tdraw() {\n\t\tthis.updateCamera();\n\n\t\t[this.layers.behind, this.layers.main, this.layers.front].forEach(sortDisplayObjects);\n\n\t\tthis.renderer.render(this.stage, null, false);\n\n\t\tevents.dispatch('scene draw', scene);\n\t\tperformanceTool.eventHappened('Draws');\n\t}\n\n\tisInInitialState() {\n\t\treturn !this.playing && this.time === 0;\n\t}\n\n\treset() {\n\t\tif (!this._alive)\n\t\t\treturn; // scene has been replaced by another one\n\n\t\tthis.resetting = true;\n\n\t\tlet level = this.level;\n\t\tthis.unloadLevel();\n\n\t\tif (level)\n\t\t\tthis.loadLevel(level);\n\n\t\t// this.draw(); // we might be doing ok even without draw.\n\t\t// player mode starts mainloop and editor may want to control the drawing more.\n\n\t\tdelete this.resetting;\n\n\t\tthis.dispatch('reset');\n\t}\n\n\tpause() {\n\t\tif (!this.playing) return;\n\n\t\tthis.playing = false;\n\t\tif (this.animationFrameId) {\n\t\t\tif (window.requestAnimationFrame)\n\t\t\t\twindow.cancelAnimationFrame(this.animationFrameId);\n\t\t\telse\n\t\t\t\tclearTimeout(this.animationFrameId);\n\t\t}\n\t\tthis.animationFrameId = null;\n\n\t\tthis.dispatch('pause');\n\t}\n\n\tplay() {\n\t\tif (this.playing) return;\n\n\t\tthis._prevUpdate = 0.001 * performance.now();\n\t\tthis.playing = true;\n\n\t\tthis.requestAnimFrame();\n\n\t\tif (this.time === 0)\n\t\t\tthis.dispatch('onStart');\n\n\t\tthis.dispatch('play');\n\t}\n\n\tdelete() {\n\t\tif (!super.delete()) return false;\n\n\t\tthis.unloadLevel();\n\n\t\tif (scene === this)\n\t\t\tscene = null;\n\n\t\tif (this.mouseListeners) {\n\t\t\tthis.mouseListeners.forEach(listener => listener());\n\t\t\tthis.mouseListeners = null;\n\t\t}\n\n\t\tthis.renderer = null; // Do not call renderer.destroy(). Same renderer is used by all scenes for now.\n\n\t\treturn true;\n\t}\n\n\t// To make component based entity search fast:\n\taddComponent(component) {\n\t\tlet set = this.components.get(component.constructor.componentName);\n\t\tif (!set) {\n\t\t\tset = new Set();\n\t\t\tthis.components.set(component.constructor.componentName, set);\n\t\t}\n\t\tset.add(component);\n\t}\n\n\tremoveComponent(component) {\n\t\tlet set = this.components.get(component.constructor.componentName);\n\t\tassert(set);\n\t\tassert(set.delete(component));\n\t}\n\n\tgetComponents(componentName) {\n\t\treturn this.components.get(componentName) || new Set;\n\t}\n\n\tmouseToWorld(mousePosition) {\n\t\treturn new Vector(\n\t\t\tthis.layers.move.pivot.x + mousePosition.x / this.cameraZoom,\n\t\t\tthis.layers.move.pivot.y + mousePosition.y / this.cameraZoom\n\t\t);\n\t}\n\n\tsetZoom(zoomLevel) {\n\t\tif (zoomLevel)\n\t\t\tthis.cameraZoom = zoomLevel;\n\t\tthis.dispatch('zoomChange', this.cameraZoom);\n\t}\n}\nScene.prototype.isRoot = true;\n\nSerializable.registerSerializable(Scene, 'sce');\n\nlet sceneCreateListeners = [];\nexport function listenSceneCreation(listener) {\n\tsceneCreateListeners.push(listener);\n\n\tif (scene)\n\t\tlistener();\n}\n","import Serializable, { createStringId } from './serializable';\nimport assert from '../util/assert';\nimport { componentClasses, Component } from './component';\nimport { isClient } from '../util/environment';\n\nexport default class ComponentData extends Serializable {\n\tconstructor(componentClassName, predefinedId = false, predefinedComponentId = false) {\n\t\tsuper(predefinedId);\n\t\tthis.name = componentClassName;\n\t\tthis.componentClass = componentClasses.get(this.name);\n\t\tassert(this.componentClass, 'Component class not defined: ' + componentClassName);\n\t\tif (!this.componentClass.allowMultiple)\n\t\t\tpredefinedComponentId = '_' + componentClassName;\n\t\tthis.componentId = predefinedComponentId || createStringId('cid', 10); // what will be the id of component created from this componentData\n\t}\n\tmakeUpAName() {\n\t\treturn this.name;\n\t}\n\taddChild(child) {\n\t\tif (child.threeLetterType === 'prp') {\n\t\t\tif (!child.propertyType) {\n\t\t\t\tif (!this.componentClass._propertyTypesByName[child.name]) {\n\t\t\t\t\tif (isClient)\n\t\t\t\t\t\tconsole.log('Property of that name not defined', this.id, child, this);\n\t\t\t\t\telse\n\t\t\t\t\t\tconsole.log('Property of that name not defined', this.id, this.name, child.name);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tchild.setPropertyType(this.componentClass._propertyTypesByName[child.name]);\n\t\t\t}\n\t\t}\n\t\tsuper.addChild(child);\n\t\treturn this;\n\t};\n\tclone(options) {\n\t\tlet newComponentId = (options && options.cloneComponentId) ? this.componentId : false;\n\t\tlet obj = new ComponentData(this.name, false, newComponentId);\n\t\tlet children = [];\n\t\tthis.forEachChild(null, child => {\n\t\t\tchildren.push(child.clone());\n\t\t});\n\t\tobj.initWithChildren(children);\n\t\tthis._state |= Serializable.STATE_CLONE;\n\t\treturn obj;\n\t}\n\ttoJSON() {\n\t\treturn Object.assign(super.toJSON(), {\n\t\t\tcid: this.componentId,\n\t\t\tn: this.name\n\t\t});\n\t}\n\t/*\n\tReturns a list of Properties.\n\tThose which don't have an id are temporary properties generated from parents.\n\tDon't set _depth.\n\t */\n\tgetInheritedProperties(_depth = 0) {\n\t\tlet properties = {};\n\n\t\t// properties from parent\n\t\tlet parentComponentData = this.getParentComponentData();\n\t\tif (parentComponentData)\n\t\t\tparentComponentData.getInheritedProperties(_depth + 1).forEach(prop => properties[prop.name] = prop);\n\t\t\n\t\t// properties from this. override properties of parents\n\t\tthis.getChildren('prp').forEach(prop => {\n\t\t\tif (_depth === 0)\n\t\t\t\tproperties[prop.name] = prop;\n\t\t\telse\n\t\t\t\tproperties[prop.name] = prop.clone(true);\n\t\t});\n\t\t\n\t\t// fill from propertyType\n\t\tif (_depth === 0) {\n\t\t\treturn this.componentClass._propertyTypes.map(propertyType => {\n\t\t\t\treturn properties[propertyType.name] || propertyType.createProperty({\n\t\t\t\t\tskipSerializableRegistering: true\n\t\t\t\t});\n\t\t\t});\n\t\t} else {\n\t\t\treturn Object.keys(properties).map(key => properties[key]);\n\t\t}\n\t}\n\tgetParentComponentData() {\n\t\tif (!this._parent) return null;\n\t\tlet parentPrototype = this._parent.getParentPrototype();\n\t\twhile (parentPrototype) {\n\t\t\tlet parentComponentData = parentPrototype.findChild('cda', componentData => componentData.componentId === this.componentId);\n\t\t\tif (parentComponentData)\n\t\t\t\treturn parentComponentData;\n\t\t\telse\n\t\t\t\tparentPrototype = parentPrototype.getParentPrototype();\n\t\t}\n\t\treturn null;\n\t}\n\tgetPropertyOrCreate(name) {\n\t\tlet property = this.findChild('prp', prp => prp.name === name);\n\t\tif (!property) {\n\t\t\tproperty = this.componentClass._propertyTypesByName[name].createProperty();\n\t\t\tthis.addChild(property);\n\t\t}\n\t\treturn property;\n\t}\n\tgetProperty(name) {\n\t\treturn this.findChild('prp', prp => prp.name === name);\n\t}\n\tsetValue(propertyName, value) {\n\t\tthis.getPropertyOrCreate(propertyName).value = value;\n\t\treturn this;\n\t}\n\tgetValue(name) {\n\t\tlet property = this.getProperty(name);\n\t\tif (property)\n\t\t\treturn property.value;\n\t\tlet parent = this.getParentComponentData();\n\t\t\n\t\tif (parent)\n\t\t\treturn parent.getValue(name);\n\t\t\n\t\treturn this.componentClass._propertyTypesByName[name].initialValue;\n\t}\n\tcreateComponent() {\n\t\tlet properties = this.getInheritedProperties();\n\t\tlet values = {};\n\t\tproperties.forEach(prop => {\n\t\t\tvalues[prop.name] = prop.value;\n\t\t});\n\t\tlet component = Component.create(this.name, values);\n\t\tcomponent._componentId = this.componentId;\n\t\treturn component;\n\t}\n}\nSerializable.registerSerializable(ComponentData, 'cda', json => {\n\treturn new ComponentData(json.n, json.id, json.cid);\n});\n","import Serializable from './serializable';\nimport assert from '../util/assert';\nimport Property from './property';\nimport PropertyOwner from './propertyOwner';\nimport { scene } from './scene';\nimport { game } from './game';\nexport { default as Prop } from './propertyType';\nexport let componentClasses = new Map();\nimport ComponentData from './componentData';\nimport * as performance from '../util/performance';\n\nconst eventListeners = [\n\t'onUpdate'\n\t,'onStart'\n];\n\n// Object of a component, see _componentExample.js\nexport class Component extends PropertyOwner {\n\tconstructor(predefinedId = false) {\n\t\tsuper(predefinedId);\n\t\tthis._componentId = null; // Creator will fill this\n\t\tthis.scene = scene;\n\t\tthis.game = game;\n\t\tthis._listenRemoveFunctions = [];\n\t\tthis.entity = null;\n\t}\n\tmakeUpAName() {\n\t\treturn self.constructor.componentName;\n\t}\n\tdelete() {\n\t\t// Component.delete never returns false because entity doesn't have components as children\n\t\tthis._parent = null;\n\t\tthis.entity = null;\n\t\tsuper.delete();\n\t\treturn true;\n\t}\n\t_addEventListener(functionName) {\n\t\tlet func = this[functionName];\n\t\tlet self = this;\n\t\tlet performanceName = 'Component: ' + self.constructor.componentName;\n\t\tthis._listenRemoveFunctions.push(this.scene.listen(functionName, function() {\n\t\t\t// @ifndef OPTIMIZE\n\t\t\tperformance.start(performanceName);\n\t\t\t// @endif\n\t\t\t\n\t\t\tfunc.apply(self, arguments);\n\t\t\t\n\t\t\t// @ifndef OPTIMIZE\n\t\t\tperformance.stop(performanceName);\n\t\t\t// @endif\n\t\t}));\n\t}\n\t// In preInit you can init the component with stuff that other components might want to use in init function\n\t// In preInit you can not trust that other components have been inited in any way\n\t_preInit() {\n\t\tthis.constructor.requirements.forEach(r => {\n\t\t\tthis[r] = this.entity.getComponent(r);\n\t\t\tassert(this[r], `${this.constructor.componentName} requires component ${r} but it is not found`);\n\t\t});\n\n\t\tthis.forEachChild('com', c => c._preInit());\n\n\t\tfor (let i = 0; i < eventListeners.length; ++i) {\n\t\t\tif (typeof this[eventListeners[i]] === 'function')\n\t\t\t\tthis._addEventListener(eventListeners[i]);\n\t\t}\n\t\t\n\t\tif (this.constructor.componentName !== 'Transform' && this.scene)\n\t\t\tthis.scene.addComponent(this);\n\t\t\n\t\ttry {\n\t\t\tif (typeof this.preInit === 'function')\n\t\t\t\tthis.preInit();\n\t\t} catch(e) {\n\t\t\tconsole.error(this.entity, this.constructor.componentName, 'preInit', e);\n\t\t}\n\t}\n\t// In preInit you can access other components and know that their preInit is done.\n\t_init() {\n\t\tthis.forEachChild('com', c => c._init());\n\t\ttry {\n\t\t\tif (typeof this.init === 'function')\n\t\t\t\tthis.init();\n\t\t} catch(e) {\n\t\t\tconsole.error(this.entity, this.constructor.componentName, 'init', e);\n\t\t}\n\t}\n\t_sleep() {\n\t\ttry {\n\t\t\tif (typeof this.sleep === 'function')\n\t\t\t\tthis.sleep();\n\t\t} catch(e) {\n\t\t\tconsole.error(this.entity, this.constructor.componentName, 'sleep', e);\n\t\t}\n\n\t\tif (this.constructor.componentName !== 'Transform' && this.scene)\n\t\t\tthis.scene.removeComponent(this);\n\t\t\n\t\tthis.forEachChild('com', c => c._sleep());\n\t\t\n\t\tthis._listenRemoveFunctions.forEach(f => f());\n\t\tthis._listenRemoveFunctions.length = 0;\n\t}\n\tlistenProperty(component, propertyName, callback) {\n\t\tthis._listenRemoveFunctions.push(component._properties[propertyName].listen('change', callback));\n\t}\n\tcreateComponentData() {\n\t\tlet componentName = this.constructor.componentName;\n\t\tlet propertyTypes = this.constructor._propertyTypes;\n\t\tlet componentData = new ComponentData(componentName);\n\t\tlet children = [];\n\t\tpropertyTypes.forEach(pt => {\n\t\t\tchildren.push(pt.createProperty({\n\t\t\t\tvalue: this[pt.name]\n\t\t\t}));\n\t\t});\n\t\tcomponentData.initWithChildren(children);\n\t\treturn componentData;\n\t}\n\ttoJSON() {\n\t\treturn Object.assign(super.toJSON(), {\n\t\t\tn: this.constructor.componentName,\n\t\t\tcid: this._componentId\n\t\t});\n\t}\n}\nComponent.create = function(name, values = {}) {\n\tlet componentClass = componentClasses.get(name);\n\tassert(componentClass);\n\tlet component = new componentClass();\n\tcomponent.initWithPropertyValues(values);\n\treturn component;\n};\nComponent.createWithInheritedComponentData = function(inheritedComponentData) {\n\tlet component = new inheritedComponentData.componentClass;\n\tcomponent._componentId = inheritedComponentData.componentId;\n\tlet properties = inheritedComponentData.properties.map(p => p.clone());\n\tcomponent.initWithChildren(properties);\n\treturn component;\n};\n\nComponent.reservedPropertyNames = new Set(['id', 'constructor', 'delete', 'children', 'entity', 'env', 'init', 'preInit', 'sleep', 'toJSON', 'fromJSON']);\nComponent.reservedPrototypeMembers = new Set(['id', 'children', 'entity', 'env', '_preInit', '_init', '_sleep', '_forEachChildComponent', '_properties', '_componentData', 'toJSON', 'fromJSON']);\nComponent.register = function({\n\tname = '', // required\n\tdescription = '',\n\tcategory = 'Other',\n\ticon = 'fa-puzzle-piece', // in editor\n\tcolor = '', // in editor\n\tproperties = [],\n\trequirements = ['Transform'],\n\tchildren = [],\n\tparentClass = Component,\n\tprototype = {},\n\tallowMultiple = true,\n\trequiesInitWhenEntityIsEdited = false\n}) {\n\tassert(name, 'Component must have a name.');\n\tassert(name[0] >= 'A' && name[0] <= 'Z', 'Component name must start with capital letter.');\n\tassert(!componentClasses.has(name), 'Duplicate component class ' + name);\n\tObject.keys(prototype).forEach(k => {\n\t\tif (Component.reservedPrototypeMembers.has(k))\n\t\t\tassert(false, 'Component prototype can not have a reserved member: ' + k);\n\t});\n\t\n\tlet constructorFunction = prototype.constructor;\n\tlet deleteFunction = prototype.delete;\n\tdelete prototype.constructor;\n\tdelete prototype.delete;\n\tclass Com extends parentClass {\n\t\tconstructor() {\n\t\t\tsuper(...arguments);\n\t\t\tif (constructorFunction)\n\t\t\t\tconstructorFunction.call(this);\n\t\t}\n\t\tdelete() {\n\t\t\tif (!super.delete()) return false;\n\t\t\t\n\t\t\tif (deleteFunction)\n\t\t\t\tdeleteFunction.call(this);\n\t\t\t\n\t\t\treturn true;\n\t\t}\n\t}\n\tproperties.forEach(p => {\n\t\tassert(!Component.reservedPropertyNames.has(p.name), 'Can not have property called ' + p.name);\n\t});\n\tPropertyOwner.defineProperties(Com, properties); // properties means propertyTypes here\n\tCom.componentName = name;\n\tCom.category = category;\n\tif (requirements.indexOf('Transform') < 0) requirements.push('Transform');\n\tCom.requirements = requirements;\n\tCom.children = children;\n\tCom.description = description;\n\tCom.allowMultiple = allowMultiple;\n\tCom.icon = icon;\n\t\n\tlet num = name.split('').reduce((prev, curr) => prev + curr.charCodeAt(0), 0);\n\tCom.color = color || `hsla(${ num % 360 }, 40%, 60%, 1)`;\n\n\tprototype._name = name;\n\tObject.assign(Com.prototype, prototype);\n\tcomponentClasses.set(Com.componentName, Com);\n\treturn Com;\n};\n\nSerializable.registerSerializable(Component, 'com', json => {\n\tlet component = new (componentClasses.get(json.n))(json.id);\n\tcomponent._componentId = json.cid || null;\n\treturn component;\n});\n","import Serializable from './serializable';\nimport assert from '../util/assert';\nimport * as performanceTool from '../util/performance';\n\nconst ALIVE_ERROR = 'entity is already dead';\n\nexport default class Entity extends Serializable {\n\tconstructor(predefinedId = false) {\n\t\tsuper(predefinedId);\n\t\tthis.components = new Map(); // name -> array\n\t\tthis.sleeping = false;\n\t\tthis.prototype = null; // should be set immediately after constructor\n\t\tthis.localMaster = true; // set false if entity is controlled over the net\n\n\t\tperformanceTool.eventHappened('Create object');\n\t}\n\n\tmakeUpAName() {\n\t\tif (this.prototype) {\n\t\t\treturn this.prototype.makeUpAName();\n\t\t} else {\n\t\t\treturn 'Entity';\n\t\t}\n\t}\n\n\t// Get the first component of given name\n\tgetComponent(name) {\n\t\tassert(this._alive, ALIVE_ERROR);\n\t\tlet components = this.components.get(name);\n\t\tif (components !== undefined)\n\t\t\treturn components[0];\n\t\telse\n\t\t\treturn null;\n\t}\n\n\t// Get all components with given name\n\tgetComponents(name) {\n\t\tassert(this._alive, ALIVE_ERROR);\n\t\treturn this.components.get(name) || [];\n\t}\n\n\tgetListOfAllComponents() {\n\t\tlet components = [];\n\t\tthis.components.forEach((value, key) => {\n\t\t\tcomponents.push(...value);\n\t\t});\n\t\treturn components;\n\t}\n\n\tclone() {\n\t\tlet entity = new Entity();\n\t\tentity.prototype = this.prototype.clone();\n\t\tentity.sleeping = this.sleeping;\n\t\tlet components = [];\n\t\tthis.components.forEach((value, key) => {\n\t\t\tcomponents.push(...value.map(c => c.clone()));\n\t\t});\n\t\tentity.addComponents(components);\n\t\treturn entity;\n\t}\n\n\t/*\n\tAdds multiple components as an array to this Entity.\n\tInitializes components after all components are added.\n\t*/\n\taddComponents(components, { fullInit = true } = {}) {\n\t\tassert(this._alive, ALIVE_ERROR);\n\t\tassert(Array.isArray(components), 'Parameter is not an array.');\n\n\t\tif (Entity.ENTITY_CREATION_DEBUGGING) console.log('add components for', this.makeUpAName());\n\n\t\tfor (let i = 0; i < components.length; i++) {\n\t\t\tlet component = components[i];\n\t\t\tlet componentList = this.components.get(component._name) || this.components.set(component._name, []).get(component._name);\n\t\t\tcomponentList.push(component);\n\t\t\tcomponent.entity = this;\n\t\t\tcomponent._parent = this;\n\t\t\tcomponent.setRootType(this._rootType);\n\t\t}\n\n\t\tif (!this.sleeping) {\n\t\t\tEntity.preInitComponents(components);\n\t\t\tif (fullInit)\n\t\t\t\tEntity.initComponents(components);\n\t\t}\n\t\treturn this;\n\t}\n\n\tstatic preInitComponents(components) {\n\t\tif (Entity.ENTITY_CREATION_DEBUGGING)  console.log('preInit components for', components[0].entity.makeUpAName());\n\t\tfor (let i = 0; i < components.length; i++)\n\t\t\tcomponents[i]._preInit();\n\t}\n\t\n\tstatic initComponents(components) {\n\t\tif (Entity.ENTITY_CREATION_DEBUGGING)  console.log(`init ${components.length} components for`, components[0].entity.makeUpAName());\n\t\tfor (let i = 0; i < components.length; i++)\n\t\t\tcomponents[i]._init();\n\t}\n\n\tstatic makeComponentsSleep(components) {\n\t\tfor (let i = 0; i < components.length; i++)\n\t\t\tcomponents[i]._sleep();\n\t}\n\n\tstatic deleteComponents(components) {\n\t\tfor (let i = 0; i < components.length; i++)\n\t\t\tcomponents[i].delete();\n\t}\n\n\tsleep() {\n\t\tassert(this._alive, ALIVE_ERROR);\n\t\tif (this.sleeping) return false;\n\n\t\tthis.components.forEach((value, key) => Entity.makeComponentsSleep(value));\n\n\t\tthis.sleeping = true;\n\t\treturn true;\n\t}\n\n\twakeUp() {\n\t\tassert(this._alive, ALIVE_ERROR);\n\t\tif (!this.sleeping) return false;\n\t\t\n\t\tthis.components.forEach((value, key) => Entity.preInitComponents(value));\n\t\tthis.components.forEach((value, key) => Entity.initComponents(value));\n\n\t\tthis.sleeping = false;\n\t\treturn true;\n\t}\n\n\tdelete() {\n\t\tassert(this._alive, ALIVE_ERROR);\n\t\tthis.sleep();\n\t\tif (!super.delete()) return false;\n\n\t\tthis.components.forEach((value, key) => Entity.deleteComponents(value));\n\t\tthis.components.clear();\n\n\t\tperformanceTool.eventHappened('Destroy object');\n\n\t\treturn true;\n\t}\n\n\tdeleteComponent(component) {\n\t\tlet array = this.getComponents(component.constructor.componentName);\n\t\tlet idx = array.indexOf(component);\n\t\tassert(idx >= 0);\n\t\tif (!this.sleeping)\n\t\t\tcomponent._sleep();\n\t\tcomponent.delete();\n\t\tarray.splice(idx, 1);\n\t\treturn this;\n\t}\n\n\tsetRootType(rootType) {\n\t\tif (this._rootType === rootType)\n\t\t\treturn;\n\n\t\tif (Entity.ENTITY_CREATION_DEBUGGING) console.log('entity added to tree', this.makeUpAName());\n\t\t\n\t\tsuper.setRootType(rootType);\n\t\t\n\t\tlet i;\n\t\tthis.components.forEach((value, key) => {\n\t\t\tfor (i = 0; i < value.length; ++i) {\n\t\t\t\tvalue[i].setRootType(rootType);\n\t\t\t}\n\t\t});\n\t}\n\n\ttoJSON() {\n\t\tassert(this._alive, ALIVE_ERROR);\n\n\t\tlet components = [];\n\t\tthis.components.forEach(compArray => {\n\t\t\tcompArray.forEach(comp => {\n\t\t\t\tcomponents.push(comp.toJSON());\n\t\t\t});\n\t\t});\n\n\t\treturn Object.assign(super.toJSON(), {\n\t\t\tc: components, // overwrite children. earlier this was named 'comp'\n\t\t\tproto: this.prototype.id\n\t\t});\n\t}\n}\nObject.defineProperty(Entity.prototype, 'position', {\n\tget() {\n\t\treturn this.getComponent('Transform').position;\n\t},\n\tset(position) {\n\t\tthis.getComponent('Transform').position = position;\n\t}\n});\n\nSerializable.registerSerializable(Entity, 'ent', json => {\n\tif (Entity.ENTITY_CREATION_DEBUGGING) console.log('creating entity from json', json);\n\tlet entity = new Entity(json.id);\n\tentity.prototype = getSerializable(json.proto);\n\tif (Entity.ENTITY_CREATION_DEBUGGING) console.log('created entity from json', entity);\n\tif (json.comp) {\n\t\tentity.addComponents((json.c || json.comp).map(Serializable.fromJSON));\n\t}\n\treturn entity;\n});\n\nEntity.ENTITY_CREATION_DEBUGGING = false;\n","import Serializable from './serializable';\nimport assert from '../util/assert';\nimport { getSerializable } from './serializableManager';\nimport Prop from './propertyType';\nimport PropertyOwner from './propertyOwner';\nimport ComponentData from './componentData';\nimport Entity from './entity';\nimport { game } from './game';\nimport { Component } from './component';\nimport events from \"../util/events\";\n\nlet propertyTypes = [\n\tProp('name', 'No name', Prop.string)\n];\n\nexport default class Prototype extends PropertyOwner {\n\tconstructor()Â {\n\t\tsuper(...arguments);\n\t\t\n\t\tthis.previouslyCreatedEntity = null;\n\t}\n\t\n\tmakeUpAName() {\n\t\treturn this.name || 'Prototype';\n\t}\n\t\n\taddChild(child) {\n\t\tif (child.threeLetterType === 'cda' && !child.componentClass.allowMultiple)\n\t\t\tassert(this.findChild('cda', cda => cda.componentId === child.componentId) === null, `Can't have multiple ${child.name} components. See Component.allowMultiple`);\n\t\tsuper.addChild(child);\n\t}\n\tgetParentPrototype() {\n\t\treturn this._parent && this._parent.threeLetterType === 'prt' ? this._parent : null;\n\t}\n\t\n\t/*\n\tfilter filters component datas\n\t\n\tReturns JSON:\n\t[\n\t\t{\n\t\t\townComponent: false, // component of a parent prototype\n\t\t\tcomponentClass: [object Object],\n\t\t\tcomponentId: <componentId>,\n\t\t\tthreeLetterType: 'icd',\n\t \t\tgeneratedForPrototype: <this>,\n\t\t\tproperties: [\n\t\t\t\t{ id missing }\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t ownComponentData: <ComponentData> || null, // null if this prototype has 0 properties defined\n\t\t\t componentClass: [object Object],\n\t\t\t componentId: <componentId>,\n\t\t\t threeLetterType: 'icd',\n\t\t\t generatedForPrototype: <this>,\n\t\t\t properties: [\n\t\t\t \t{ id found if own property } // some properties might be from parent prototypes and thus missing id\n\t\t\t ]\n\t\t }\n\t]\n\t */\n\tgetInheritedComponentDatas(filter = null) {\n\t\tlet data = getDataFromPrototype(this, this, filter);\n\t\tlet array = Object.keys(data).map(key => data[key]);\n\t\tlet inheritedComponentData;\n\t\tfor (let i = 0; i < array.length; ++i) {\n\t\t\tinheritedComponentData = array[i];\n\t\t\tinheritedComponentData.properties = inheritedComponentData.componentClass._propertyTypes.map(propertyType => {\n\t\t\t\treturn inheritedComponentData.propertyHash[propertyType.name]\n\t\t\t\t\t|| propertyType.createProperty({ skipSerializableRegistering: true });\n\t\t\t});\n\t\t\tdelete inheritedComponentData.propertyHash;\n\t\t}\n\n\t\treturn array.sort(sortInheritedComponentDatas);\n\t}\n\t\n\tcreateAndAddPropertyForComponentData(inheritedComponentData, propertyName, propertyValue) {\n\t\tlet propertyType = inheritedComponentData.componentClass._propertyTypesByName[propertyName];\n\t\tassert(propertyType, 'Invalid propertyName', propertyName, inheritedComponentData);\n\t\tlet componentData = this.findChild('cda', componentData => componentData.componentId === inheritedComponentData.componentId);\n\t\tlet componentDataIsNew = false;\n\t\tif (!componentData) {\n\t\t\tconsole.log('no component data. create one', this, inheritedComponentData);\n\t\t\tcomponentData = new ComponentData(inheritedComponentData.componentClass.componentName, false, inheritedComponentData.componentId);\n\t\t\tcomponentDataIsNew = true;\n\t\t}\n\t\tlet property = componentData.findChild('prp', property => property.name === propertyName);\n\t\tif (property) {\n\t\t\tproperty.value = propertyValue;\n\t\t\treturn property;\n\t\t}\n\n\t\tproperty = propertyType.createProperty({\n\t\t\tvalue: propertyValue,\n\t\t});\n\t\tcomponentData.addChild(property);\n\t\t\n\t\tif (componentDataIsNew)\n\t\t\tthis.addChild(componentData);\n\t\t\n\t\treturn property;\n\t}\n\t\n\tfindComponentDataByComponentId(componentId, alsoFindFromParents = false) {\n\t\tlet child = this.findChild('cda', componentData => componentData.componentId === componentId);\n\t\tif (child)\n\t\t\treturn child;\n\t\tif (alsoFindFromParents) {\n\t\t\tlet parent = this.getParentPrototype();\n\t\t\tif (parent)\n\t\t\t\treturn parent.findComponentDataByComponentId(componentId, alsoFindFromParents);\n\t\t}\n\t\treturn null;\n\t}\n\t\n\tgetOwnComponentDataOrInherit(componentId) {\n\t\tlet componentData = this.findComponentDataByComponentId(componentId, false);\n\t\tif (!componentData) {\n\t\t\tlet inheritedComponentData = this.findComponentDataByComponentId(componentId, true);\n\t\t\tif (!inheritedComponentData)\n\t\t\t\treturn null;\n\t\t\t\n\t\t\tcomponentData = new ComponentData(inheritedComponentData.name, false, componentId);\n\t\t\tthis.addChild(componentData);\n\t\t}\n\t\treturn componentData\n\t}\n\t\n\tfindOwnProperty(componentId, propertyName) {\n\t\tlet componentData = this.findComponentDataByComponentId(componentId);\n\t\tif (componentData) {\n\t\t\treturn componentData.getProperty(propertyName);\n\t\t}\n\t\treturn null;\n\t}\n\t\n\t// Parent is needed so that we can init children knowing who is the parent\n\tcreateEntity(parent, _skipNewEntityEvent = false) {\n\t\tlet entity = new Entity();\n\t\t\n\t\tlet inheritedComponentDatas = this.getInheritedComponentDatas();\n\t\tlet components = inheritedComponentDatas.map(Component.createWithInheritedComponentData);\n\t\tentity.addComponents(components, { fullInit: false }); // Only do preInit\n\t\t\n\t\tentity.prototype = this;\n\t\t\n\t\tif (parent)\n\t\t\tparent.addChild(entity);\n\n\t\tif (Entity.ENTITY_CREATION_DEBUGGING) console.log('create entity', this.makeUpAName());\n\t\t\n\t\tthis.forEachChild('epr', epr => epr.createEntity(entity, true));\n\t\t// let childEntityPrototypes = this.getChildren('epr');\n\t\t// childEntityPrototypes.forEach(epr => epr.createEntity(entity));\n\t\t\n\t\t// Components have only been preinited. Lets call the init now.\n\t\tEntity.initComponents(components);\n\t\t\n\t\tthis.previouslyCreatedEntity = entity;\n\t\t\n\t\tif (!_skipNewEntityEvent)\n\t\t\tevents.dispatch('new entity created', entity);\n\t\t\n\t\treturn entity;\n\t}\n\t\n\tgetValue(componentId, propertyName) {\n\t\tlet componentData = this.findComponentDataByComponentId(componentId, true);\n\t\tif (componentData)\n\t\t\treturn componentData.getValue(propertyName);\n\t\telse\n\t\t\treturn undefined;\n\t}\n\t\n\tcountEntityPrototypes(findParents = false) {\n\t\tif (this.threeLetterType !== 'prt')\n\t\t\treturn 0;\n\t\t\n\t\tlet count = 0;\n\t\tlet levels = game.getChildren('lvl');\n\t\tfor (let i = levels.length-1; i >= 0; i--) {\n\t\t\tlet entityPrototypes = levels[i].getChildren('epr');\n\t\t\tfor (let j = entityPrototypes.length-1; j >= 0; j--) {\n\t\t\t\tif (entityPrototypes[j].prototype === this)\n\t\t\t\t\tcount++;\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (findParents)\n\t\t\tthis.forEachChild('prt', prt => count += prt.countEntityPrototypes(true));\n\t\t\n\t\treturn count;\n\t}\n\t\n\tdelete() {\n\t\tthis._gameRoot = this._gameRoot || this.getRoot();\n\t\tif (!super.delete()) return false;\n\t\tif (this.threeLetterType === 'prt' && this._gameRoot.threeLetterType === 'gam') {\n\t\t\tthis._gameRoot.forEachChild('lvl', lvl => {\n\t\t\t\tlet items = lvl.getChildren('epr');\n\t\t\t\tfor (let i = items.length-1; i >= 0; i--) {\n\t\t\t\t\tif (items[i].prototype === this) {\n\t\t\t\t\t\tlvl.deleteChild(items[i], i);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tthis.previouslyCreatedEntity = null;\n\t\treturn true;\n\t}\n}\nPropertyOwner.defineProperties(Prototype, propertyTypes);\n\nPrototype.create = function(name) {\n\treturn new Prototype().initWithPropertyValues({ name: name });\n};\n\nSerializable.registerSerializable(Prototype, 'prt');\n\nfunction getDataFromPrototype(prototype, originalPrototype, filter, _depth = 0) {\n\tlet data;\n\n\tlet parentPrototype = prototype.getParentPrototype();\n\tif (parentPrototype)\n\t\tdata = getDataFromPrototype(parentPrototype, originalPrototype, filter, _depth + 1);\n\telse\n\t\tdata = {}; // Top level\n\t\n\tlet componentDatas = prototype.getChildren('cda');\n\tif (filter)\n\t\tcomponentDatas = componentDatas.filter(filter);\n\tlet componentData;\n\tfor (let i = 0; i < componentDatas.length; ++i) {\n\t\tcomponentData = componentDatas[i];\n\n\t\tif (!data[componentData.componentId]) {\n\t\t\t// Most parent version of this componentId\n\t\t\tdata[componentData.componentId] = {\n\t\t\t\t// ownComponent = true if the original prototype is the first one introducing this componentId\n\t\t\t\townComponentData: null, // will be given value if the original prototype has this componentId\n\t\t\t\tcomponentClass: componentData.componentClass,\n\t\t\t\tcomponentId: componentData.componentId,\n\t\t\t\tpropertyHash: {},\n\t\t\t\tthreeLetterType: 'icd',\n\t\t\t\tgeneratedForPrototype: originalPrototype,\n\t\t\t};\n\t\t}\n\t\t\n\t\tif (_depth === 0) {\n\t\t\tdata[componentData.componentId].ownComponentData = componentData;\n\t\t}\n\t\t\n\t\tlet propertyHash = data[componentData.componentId].propertyHash;\n\t\t\n\t\tlet properties = componentData.getChildren('prp');\n\t\tlet property;\n\t\tfor (let j = 0; j < properties.length; ++j) {\n\t\t\tproperty = properties[j];\n\t\t\t// Newest version of a property always overrides old property\n\t\t\tpropertyHash[property.name] = _depth === 0 ? property : property.clone(true);\n\t\t}\n\t};\n\n\treturn data;\n}\n\nfunction sortInheritedComponentDatas(a, b) {\n\treturn a.componentClass.componentName.localeCompare(b.componentClass.componentName);\n}\n","import Prototype from './prototype';\nimport Property from './property';\nimport Serializable from './serializable';\nimport { getSerializable } from './serializableManager';\nimport { Prop, componentClasses } from './component';\nimport ComponentData from './componentData';\nimport assert from '../util/assert';\nimport Vector from '../util/vector';\n\n// EntityPrototype is a prototype that always has one Transform ComponentData and optionally other ComponentDatas also.\n// Entities are created based on EntityPrototypes\nexport default class EntityPrototype extends Prototype {\n\tconstructor(predefinedId = false) {\n\t\tsuper(...arguments);\n\t\t// this._parent is level, not prototype. We need a link to parent-prototype.\n\t\tthis.prototype = null;\n\t}\n\n\tmakeUpAName() {\n\t\tlet nameProperty = this.findChild('prp', property => property.name === 'name');\n\t\tif (nameProperty && nameProperty.value)\n\t\t\treturn nameProperty.value;\n\t\telse if (this.prototype)\n\t\t\treturn this.prototype.makeUpAName();\n\t\telse\n\t\t\treturn 'EntityPrototype';\n\t}\n\n\tgetTransform() {\n\t\treturn this.findChild('cda', cda => cda.name === 'Transform');\n\t}\n\tgetParentPrototype() {\n\t\treturn this.prototype || null;\n\t}\n\tclone() {\n\t\tlet obj = new EntityPrototype();\n\t\tobj.prototype = this.prototype;\n\t\tlet id = obj.id;\n\t\tlet children = [];\n\t\tthis.forEachChild(null, child => {\n\t\t\tif (child.threeLetterType === 'prp' && child.name === 'name') {\n\t\t\t\tlet property = new Property({\n\t\t\t\t\tvalue: child.propertyType.type.clone(child.value),\n\t\t\t\t\tname: child.name,\n\t\t\t\t\tpropertyType: this.propertyType,\n\t\t\t\t\tpredefinedId: id + '_n'\n\t\t\t\t});\n\t\t\t\tchildren.push(property);\n\t\t\t} else if (child.threeLetterType === 'cda' && child.name === 'Transform') {\n\t\t\t\tlet transform = new ComponentData('Transform', id + '_t');\n\n\t\t\t\t// Transform component data always has a position\n\t\t\t\tlet position = transform.componentClass._propertyTypesByName.position.createProperty({\n\t\t\t\t\tvalue: child.findChild('prp', prp => prp.name === 'position').value,\n\t\t\t\t\tpredefinedId: id + '_p'\n\t\t\t\t});\n\t\t\t\ttransform.addChild(position);\n\n\t\t\t\tlet oldScaleProperty = child.findChild('prp', prp => prp.name === 'scale');\n\t\t\t\tif (oldScaleProperty) {\n\t\t\t\t\tlet scale = transform.componentClass._propertyTypesByName.scale.createProperty({\n\t\t\t\t\t\tvalue: oldScaleProperty.value,\n\t\t\t\t\t\tpredefinedId: id + '_s'\n\t\t\t\t\t});\n\t\t\t\t\ttransform.addChild(scale);\n\t\t\t\t}\n\n\t\t\t\tlet oldAngleProperty = child.findChild('prp', prp => prp.name === 'angle');\n\t\t\t\tif (oldAngleProperty) {\n\t\t\t\t\tlet angle = transform.componentClass._propertyTypesByName.angle.createProperty({\n\t\t\t\t\t\tvalue: oldAngleProperty.value,\n\t\t\t\t\t\tpredefinedId: id + '_a'\n\t\t\t\t\t});\n\t\t\t\t\ttransform.addChild(angle);\n\t\t\t\t}\n\n\t\t\t\tchildren.push(transform);\n\t\t\t} else if (child.threeLetterType === 'cda') {\n\t\t\t\tchildren.push(child.clone({ cloneComponentId: true }));\n\t\t\t} else {\n\t\t\t\tchildren.push(child.clone());\n\t\t\t}\n\t\t});\n\t\tobj.initWithChildren(children);\n\t\tthis._state |= Serializable.STATE_CLONE;\n\t\treturn obj;\n\t}\n\n\ttoJSON() {\n\t\t/*\n\t\tlet json = super.toJSON();\n\t\tjson.t = this.prototype.id;\n\t\treturn json;\n\t\t*/\n\n\t\t// Below optimization reduces size 88%. child id's have to be generated based on this.id\n\n\t\tlet Transform = this.getTransform();\n\t\tlet json = {\n\t\t\tid: this.id\n\t\t};\n\t\tif (this.prototype)\n\t\t\tjson.t = this.prototype.id; // might be prototype or prefab or may not exist. .t as in type\n\n\t\tlet childArrays = [];\n\t\tthis._children.forEach(child => {\n\t\t\tchildArrays.push(child);\n\t\t});\n\t\tlet children = [].concat(...childArrays).filter(child => {\n\t\t\treturn child !== Transform && child !== this._properties.name;\n\t\t});\n\t\tif (children.length > 0)\n\t\t\tjson.c = children.map(child => child.toJSON());\n\n\t\tlet floatToJSON = Prop.float().toJSON;\n\t\tlet handleProperty = prp => {\n\t\t\tif (prp.name === 'name') {\n\t\t\t\tif (prp.value)\n\t\t\t\t\tjson.n = prp.value;\n\t\t\t} else if (prp.name === 'position') {\n\t\t\t\tjson.p = prp.type.toJSON(prp.value);\n\t\t\t} else if (prp.name === 'scale') {\n\t\t\t\tif (!prp.value.isEqualTo(new Vector(1, 1))) {\n\t\t\t\t\tjson.s = prp.type.toJSON(prp.value);\n\t\t\t\t}\n\t\t\t} else if (prp.name === 'angle') {\n\t\t\t\tif (prp.value !== 0)\n\t\t\t\t\tjson.a = floatToJSON(prp.value);\n\t\t\t}\n\t\t};\n\t\thandleProperty(this._properties.name);\n\n\t\tTransform.getChildren('prp').forEach(handleProperty);\n\t\treturn json;\n\t}\n\tspawnEntityToScene(scene, position) {\n\t\tif (!scene)\n\t\t\treturn;\n\n\t\tif (position) {\n\t\t\tthis.getTransform().getPropertyOrCreate('position').value = position;\n\t\t}\n\n\t\tthis.createEntity(scene);\n\t}\n\n\t// Optimize this away\n\tsetRootType(rootType) {\n\t\tif (this._rootType === rootType)\n\t\t\treturn;\n\t\tassert(this.getTransform(), 'EntityPrototype must have a Transform');\n\t\tsuper.setRootType(rootType);\n\t}\n}\nObject.defineProperty(EntityPrototype.prototype, 'position', {\n\tget() {\n\t\treturn this.getTransform().findChild('prp', prp => prp.name === 'position').value;\n\t},\n\tset(position) {\n\t\treturn this.getTransform().findChild('prp', prp => prp.name === 'position').value = position;\n\t}\n});\n\n// If Transform or Transform.position is missing, they are added.\nEntityPrototype.createFromPrototype = function (prototype) {\n\tlet entityPrototype = new EntityPrototype();\n\tentityPrototype.prototype = prototype;\n\tlet id = entityPrototype.id;\n\n\tlet prototypeTransform = prototype.findChild('cda', cda => cda.name === 'Transform');\n\tlet fromPrefab = prototype.threeLetterType === 'pfa';\n\n\tif (!fromPrefab && prototypeTransform)\n\t\tassert(false, 'Prototype (prt) can not have a Transform component');\n\n\tif (fromPrefab && !prototypeTransform)\n\t\tassert(false, 'Prefab (pfa) must have a Transform component');\n\n\tlet name = createEntityPrototypeNameProperty(id);\n\tlet transform = createEntityPrototypeTransform(id);\n\n\tif (fromPrefab && prototypeTransform) {\n\t\t// No point to copy the position\n\t\t// transform.setValue('position', prototypeTransform.getValue('position'));\n\t\ttransform.setValue('scale', prototypeTransform.getValue('scale'));\n\t\ttransform.setValue('angle', prototypeTransform.getValue('angle'));\n\t}\n\n\tentityPrototype.initWithChildren([name, transform]);\n\n\t// @ifndef OPTIMIZE\n\tassert(entityPrototype.getTransform(), 'EntityPrototype must have a Transform');\n\t// @endif\n\n\treturn entityPrototype;\n};\n\nfunction createEntityPrototypeNameProperty(entityPrototypeId, name = '') {\n\treturn EntityPrototype._propertyTypesByName.name.createProperty({\n\t\tvalue: name,\n\t\tpredefinedId: entityPrototypeId + '_n'\n\t});\n}\n\nfunction createEntityPrototypeTransform(entityPrototypeId) {\n\tlet transform = new ComponentData('Transform', entityPrototypeId + '_t');\n\n\tlet position = transform.componentClass._propertyTypesByName.position.createProperty({\n\t\tvalue: new Vector(0, 0),\n\t\tpredefinedId: entityPrototypeId + '_p'\n\t});\n\ttransform.addChild(position);\n\n\tlet scale = transform.componentClass._propertyTypesByName.scale.createProperty({\n\t\tvalue: new Vector(1, 1),\n\t\tpredefinedId: entityPrototypeId + '_s'\n\t});\n\ttransform.addChild(scale);\n\n\tlet angle = transform.componentClass._propertyTypesByName.angle.createProperty({\n\t\tvalue: 0,\n\t\tpredefinedId: entityPrototypeId + '_a'\n\t});\n\ttransform.addChild(angle);\n\n\treturn transform;\n}\n\nEntityPrototype.create = function (name = 'Empty', position = new Vector(0, 0)) {\n\tlet entityPrototype = new EntityPrototype();\n\tlet transform = createEntityPrototypeTransform(entityPrototype.id);\n\ttransform.setValue('position', position);\n\n\tlet nameProperty = createEntityPrototypeNameProperty(entityPrototype.id, name);\n\n\tentityPrototype.initWithChildren([nameProperty, transform]);\n\treturn entityPrototype;\n}\n\nSerializable.registerSerializable(EntityPrototype, 'epr', json => {\n\tlet entityPrototype = new EntityPrototype(json.id);\n\tentityPrototype.prototype = json.t ? getSerializable(json.t) : null;\n\n\t// assert(!json.t || entityPrototype.prototype, `Prototype or Prefab ${json.t} not found`); // .t as in type\n\tif (json.t && !entityPrototype.prototype)\n\t\tconsole.warn(`EntityPrototype thougt it had a prototype or prefab ${json.t} but it was not found.`);\n\n\tlet nameId = json.id + '_n';\n\tlet transformId = json.id + '_t';\n\tlet positionId = json.id + '_p';\n\tlet scaleId = json.id + '_s';\n\tlet angleId = json.id + '_a';\n\n\tlet name = Prototype._propertyTypesByName.name.createProperty({\n\t\tvalue: json.n === undefined ? '' : json.n,\n\t\tpredefinedId: nameId\n\t});\n\n\tlet transformData = new ComponentData('Transform', transformId);\n\tlet transformClass = componentClasses.get('Transform');\n\n\tlet position = transformClass._propertyTypesByName.position.createProperty({\n\t\tvalue: Vector.fromObject(json.p), // in the future, everything will be using p instead of x and y.\n\t\tpredefinedId: positionId\n\t});\n\ttransformData.addChild(position);\n\n\tlet scale = transformClass._propertyTypesByName.scale.createProperty({\n\t\tvalue: json.s && Vector.fromObject(json.s) || new Vector(1, 1),\n\t\tpredefinedId: scaleId\n\t});\n\ttransformData.addChild(scale);\n\n\tlet angle = transformClass._propertyTypesByName.angle.createProperty({\n\t\tvalue: json.a || 0,\n\t\tpredefinedId: angleId\n\t});\n\ttransformData.addChild(angle);\n\n\tentityPrototype.initWithChildren([name, transformData]);\n\n\treturn entityPrototype;\n});\n","import Prototype from './prototype';\nimport Property from './property';\nimport Serializable from './serializable';\nimport { getSerializable } from './serializableManager';\nimport { Prop, componentClasses } from './component';\nimport ComponentData from './componentData';\nimport assert from '../util/assert';\nimport Vector from '../util/vector';\nimport EntityPrototype from \"./entityPrototype\";\n\n// Prefab is an EntityPrototype that has been saved to a prefab.\nexport default class Prefab extends Prototype {\n\tconstructor(predefinedId = false) {\n\t\tsuper(...arguments);\n\t}\n\n\tmakeUpAName() {\n\t\tlet nameProperty = this.findChild('prp', property => property.name === 'name');\n\t\treturn nameProperty && nameProperty.value || 'Prefab';\n\t}\n\n\tcreateEntity() {\n\t\treturn EntityPrototype.createFromPrototype(this).createEntity();\n\t}\n\n\tgetParentPrototype() {\n\t\treturn null;\n\t}\n\n\t// Do not use EntityPrototype optimization\n\t// This is only needed if Prefab would extend EntityPrototype instead of Prototype\n\t// toJSON() {\n\t// \treturn Serializable.prototype.toJSON.apply(this, arguments);\n\t// }\n\n\t// This is only needed if Prefab would extend EntityPrototype instead of Prototype\n\t// clone() {\n\t// \treturn Serializable.prototype.clone.apply(this, arguments);\n\t// }\n}\n\n/*\nfilter filters component datas\n\nReturns JSON:\n[\n\t{\n\t\townComponent: false, // component of a parent prototype\n\t\tcomponentClass: [object Object],\n\t\tcomponentId: <componentId>,\n\t\tthreeLetterType: 'icd',\n\t\t generatedForPrototype: <this>,\n\t\tproperties: [\n\t\t\t{ id missing }\n\t\t]\n\t},\n\t{\n\t\t ownComponentData: <ComponentData> || null, // null if this prototype has 0 properties defined\n\t\t componentClass: [object Object],\n\t\t componentId: <componentId>,\n\t\t threeLetterType: 'icd',\n\t\t generatedForPrototype: <this>,\n\t\t properties: [\n\t\t\t { id found if own property } // some properties might be from parent prototypes and thus missing id\n\t\t ]\n\t }\n]\n */\n\n\n\n\n// Meant for entityPrototypes, but works theoretically for prototypes\nPrefab.createFromPrototype = function(prototype) {\n\tlet inheritedComponentDatas = prototype.getInheritedComponentDatas();\n\tlet children = inheritedComponentDatas.map(icd => {\n\t\treturn new ComponentData(icd.componentClass.componentName, null, icd.componentId)\n\t\t\t.initWithChildren(icd.properties.map(prp => prp.clone()));\n\t});\n\t\n\tchildren.push(prototype._properties.name.clone());\n\t\n\tlet prefab = new Prefab().initWithChildren(children);\n\t\n\t// Don't just prototype.makeUpAName() because it might give you \"Prototype\" or \"EntityPrototype\". Checking them would be a hack.\n\tprefab.name = prototype.name || prototype.prototype && prototype.prototype.makeUpAName() || 'Prefab';\n\treturn prefab;\n};\n\nSerializable.registerSerializable(Prefab, 'pfa');\n","import Serializable from './serializable';\nimport PropertyOwner, { Prop } from '../core/propertyOwner';\nimport Scene, { scene } from './scene';\nimport events from \"../util/events\";\n\nlet propertyTypes = [\n\tProp('name', 'No name', Prop.string)\n];\n\nexport default class Level extends PropertyOwner {\n\tconstructor(predefinedId) {\n\t\tsuper(...arguments);\n\t}\n\tcreateScene(predefinedSceneObject = false) {\n\t\tif (!predefinedSceneObject)\n\t\t\tnew Scene();\n\t\t\n\t\tscene.loadLevel(this);\n\t\t\n\t\treturn scene;\n\t}\n\tisEmpty() {\n\t\treturn this.getChildren('epr').length === 0;\n\t}\n\t\n\t/*\n\tOPTIMIZATION DOES NOT WORK, YET\n\ttoJSON() {\n\t\tlet json = super.toJSON();\n\t\tconsole.log('before', json);\n\t\tif (json.c) {\n\t\t\tlet prototypeIds = new Set();\n\t\t\tjson.c.forEach(child => {\n\t\t\t\tconsole.log('child', child);\n\t\t\t\tprototypeIds.add(child.p);\n\t\t\t});\n\t\t\t\n\t\t\tlet prototypeIdToNum = {};\n\t\t\tlet prototypeIdArray = [];\n\t\t\tlet num = 0;\n\t\t\tprototypeIds.forEach(key => {\n\t\t\t\tprototypeIdArray[num] = key;\n\t\t\t\tprototypeIdToNum[key] = num++;\n\t\t\t});\n\n\t\t\tjson.c.forEach(child => {\n\t\t\t\tchild.p = prototypeIdToNum[child.p] || child.p;\n\t\t\t});\n\t\t\t\n\t\t\tjson.p = prototypeIdArray;\n\n\t\t\tconsole.log(json, prototypeIds, prototypeIdToNum, prototypeIdArray);\n\t\t}\n\t\treturn json;\n\t}\n\t*/\n}\nPropertyOwner.defineProperties(Level, propertyTypes);\n\nSerializable.registerSerializable(Level, 'lvl');\n","import { Component, Prop } from '../core/component';\nimport Vector from '../util/vector';\nimport {default as PIXI} from '../features/graphics';\n\nComponent.register({\n\tname: 'Transform',\n\ticon: 'fa-dot-circle-o',\n\tallowMultiple: false,\n\tproperties: [\n\t\tProp('position', new Vector(0, 0), Prop.vector),\n\t\tProp('scale', new Vector(1, 1), Prop.vector),\n\t\tProp('angle', 0, Prop.float, Prop.float.modulo(0, Math.PI * 2), Prop.flagDegreesInEditor)\n\t],\n\tprototype: {\n\t\tconstructor() {\n\t\t\tthis.layer = this.scene.layers.main;\n\t\t},\n\t\tpreInit() {\n\t\t\tthis.container = new PIXI.Container();\n\t\t\tthis.container._debug = this.entity.makeUpAName() + ' ' + this.name;\n\t\t\tthis.container.position.set(this.position.x, this.position.y);\n\t\t\tthis.container.scale.set(this.scale.x, this.scale.y);\n\t\t\tthis.container.rotation = this.angle;\n\t\t},\n\t\tinit() {\n\t\t\tlet parentTransform = this.getParentTransform();\n\t\t\tif (parentTransform) {\n\t\t\t\tparentTransform.container.addChild(this.container);\n\t\t\t\tparentTransform.listen('globalTransformChanged', () => {\n\t\t\t\t\tthis.dispatch('globalTransformChanged', this);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthis.layer.addChild(this.container);\n\t\t\t}\n\t\t\t\n\t\t\t// Optimize this. Shouldn't be called multiple times per frame.\n\t\t\tlet change = () => {\n\t\t\t\tthis.dispatch('globalTransformChanged', this);\n\t\t\t};\n\n\t\t\tthis.listenProperty(this, 'position', position => {\n\t\t\t\tthis.container.position.set(position.x, position.y);\n\t\t\t\tchange();\n\t\t\t});\n\t\t\tthis.listenProperty(this, 'angle', angle => {\n\t\t\t\tthis.container.rotation = angle;\n\t\t\t\tchange();\n\t\t\t});\n\t\t\tthis.listenProperty(this, 'scale', scale => {\n\t\t\t\tthis.container.scale.set(scale.x, scale.y);\n\t\t\t\tchange();\n\t\t\t});\n\t\t\t// change();\n\t\t},\n\t\tgetParentTransform() {\n\t\t\tif (this.parentTransform !== undefined)\n\t\t\t\treturn this.parentTransform;\n\t\t\t\n\t\t\tlet parentEntity = this.entity.getParent();\n\t\t\tif (parentEntity && parentEntity.threeLetterType === 'ent')\n\t\t\t\tthis.parentTransform = parentEntity.getComponent('Transform');\n\t\t\telse\n\t\t\t\tthis.parentTransform = null;\n\t\t\t\n\t\t\treturn this.parentTransform;\n\t\t},\n\t\tgetGlobalPosition() {\n\t\t\treturn Vector.fromObject(this.layer.toLocal(zeroPoint, this.container, tempPoint));\n\t\t},\n\t\tgetGlobalAngle() {\n\t\t\tlet angle = this.angle;\n\t\t\tlet parent = this.getParentTransform();\n\t\t\twhile (parent) {\n\t\t\t\tangle += parent.angle;\n\t\t\t\tparent = parent.getParentTransform();\n\t\t\t}\n\t\t\treturn angle;\n\t\t},\n\t\tsetGlobalPosition(position) {\n\t\t\tthis.position = position.set(this.container.parent.toLocal(position, this.layer, tempPoint));\n\t\t},\n\t\tsleep() {\n\t\t\tthis.container.destroy();\n\t\t\tthis.container = null;\n\t\t\t\n\t\t\tdelete this.parentTransform;\n\t\t}\n\t\t\n\t}\n});\n\nlet zeroPoint = new PIXI.Point();\nlet tempPoint = new PIXI.Point();\n","import { Component, Prop } from '../core/component';\nimport Vector from '../util/vector';\n\nComponent.register({\n\tname: 'TransformVariance',\n\tcategory: 'Logic',\n\tdescription: `Adds random factor to object's transform/orientation.`,\n\ticon: 'fa-dot-circle-o',\n\tallowMultiple: false,\n\tproperties: [\n\t\tProp('positionVariance', new Vector(0, 0), Prop.vector),\n\t\tProp('scaleVariance', new Vector(0, 0), Prop.vector),\n\t\tProp('angleVariance', 0, Prop.float, Prop.float.range(0, Math.PI), Prop.flagDegreesInEditor)\n\t],\n\tprototype: {\n\t\tonStart() {\n\t\t\tif (!this.positionVariance.isZero())\n\t\t\t\tthis.Transform.position = this.Transform.position.add(this.positionVariance.clone().multiplyScalar(-1 + 2 * Math.random()));\n\n\t\t\tif (!this.scaleVariance.isZero())\n\t\t\t\tthis.Transform.scale = this.Transform.scale.add(this.scaleVariance.clone().multiplyScalar(Math.random()));\n\t\t\t\n\t\t\tif (this.angleVariance)\n\t\t\t\tthis.Transform.angle += this.angleVariance * (-1 + 2 * Math.random());\n\t\t}\n\t}\n});\n","import {Component, Prop} from '../core/component';\nimport Vector from '../util/vector';\nimport {Color} from '../util/color';\nimport {default as PIXI, generateTextureAndAnchor, getHashedTextureAndAnchor} from '../features/graphics';\n\nComponent.register({\n\tname: 'Shape',\n\tcategory: 'Graphics',\n\ticon: 'fa-stop',\n\tallowMultiple: true,\n\tdescription: 'Draws shape on the screen.',\n\tproperties: [\n\t\tProp('type', 'rectangle', Prop.enum, Prop.enum.values('rectangle', 'circle', 'convex')),\n\t\tProp('radius', 20, Prop.float, Prop.visibleIf('type', ['circle', 'convex'])),\n\t\tProp('size', new Vector(20, 20), Prop.vector, Prop.visibleIf('type', 'rectangle')),\n\t\tProp('points', 3, Prop.int, Prop.int.range(3, 16), Prop.visibleIf('type', 'convex')),\n\t\tProp('topPointDistance', 0.5, Prop.float, Prop.float.range(0.001, 1), Prop.visibleIf('type', 'convex'), 'Only works with at most 8 points'), // Value 0\n\t\tProp('fillColor', new Color(222, 222, 222), Prop.color),\n\t\tProp('borderColor', new Color(255, 255, 255), Prop.color),\n\t\tProp('borderWidth', 1, Prop.float, Prop.float.range(0, 30))\n\t],\n\tprototype: {\n\t\tinit() {\n\t\t\tthis.initSprite();\n\n\t\t\tthis.Transform.listen('globalTransformChanged', transform => {\n\t\t\t\t/*\n\t\t\t\tthis.sprite.x = transform.globalPosition.x;\n\t\t\t\tthis.sprite.y = transform.globalPosition.y;\n\t\t\t\t\n\t\t\t\t// rotation setter function has a function call. lets optimize.\n\t\t\t\tif (this.sprite.rotation !== transform.globalAngle)\n\t\t\t\t\tthis.sprite.rotation = transform.globalAngle;\n\t\t\t\t\n\t\t\t\tthis.sprite.scale.set(transform.globalScale.x, transform.globalScale.y);\n\t\t\t\t*/\n\t\t\t});\n\t\t\t\n\t\t\t/*\n\t\t\tthis.listenProperty(this.Transform, 'position', position => {\n\t\t\t\tthis.sprite.x = position.x;\n\t\t\t\tthis.sprite.y = position.y;\n\t\t\t});\n\n\t\t\tthis.listenProperty(this.Transform, 'angle', angle => {\n\t\t\t\tthis.sprite.rotation = angle;\n\t\t\t});\n\t\t\t*/\n\n\t\t\tlet redrawGraphics = () => {\n\t\t\t\tthis.updateTexture();\n\t\t\t};\n\t\t\t\n\t\t\t// this.listenProperty(this.Transform, 'scale', redrawGraphics);\n\t\t\t\n\t\t\tlet propertiesThatRequireRedraw = [\n\t\t\t\t'type',\n\t\t\t\t'radius',\n\t\t\t\t'size',\n\t\t\t\t'fillColor',\n\t\t\t\t'borderColor',\n\t\t\t\t'borderWidth',\n\t\t\t\t'points',\n\t\t\t\t'topPointDistance'\n\t\t\t];\n\n\t\t\tpropertiesThatRequireRedraw.forEach(propName => {\n\t\t\t\tthis.listenProperty(this, propName, redrawGraphics);\n\t\t\t});\n\t\t},\n\t\tinitSprite() {\n\t\t\tlet textureAndAnchor = this.getTextureAndAnchor();\n\t\t\tthis.sprite = new PIXI.Sprite(textureAndAnchor.texture);\n\t\t\tthis.sprite.anchor.set(textureAndAnchor.anchor.x, textureAndAnchor.anchor.y);\n\n\t\t\tthis.Transform.container.addChild(this.sprite);\n\t\t},\n\t\tupdateTexture() {\n\t\t\tlet textureAndAnchor = this.getTextureAndAnchor();\n\t\t\tthis.sprite.texture = textureAndAnchor.texture;\n\t\t\tthis.sprite.anchor.set(textureAndAnchor.anchor.x, textureAndAnchor.anchor.y);\n\t\t},\n\t\tgetTextureAndAnchor() {\n\t\t\tlet hash = this.createPropertyHash();// + this.Transform.scale;\n\t\t\tlet textureAndAnchor = getHashedTextureAndAnchor(hash);\n\t\t\t\n\t\t\tif (!textureAndAnchor) {\n\t\t\t\tlet graphics = this.createGraphics();\n\t\t\t\ttextureAndAnchor = generateTextureAndAnchor(graphics, hash);\n\t\t\t\tgraphics.destroy();\n\t\t\t}\n\t\t\treturn textureAndAnchor;\n\t\t},\n\t\tcreateGraphics() {\n\t\t\tlet scale = new Vector(1, 1);// this.Transform.scale;\n\t\t\tlet graphics = new PIXI.Graphics();\n\t\t\t\n\t\t\tif (this.type === 'rectangle') {\n\t\t\t\tlet\n\t\t\t\t\tx = -this.size.x / 2 * scale.x,\n\t\t\t\t\ty = -this.size.y / 2 * scale.y,\n\t\t\t\t\tw = this.size.x * scale.x,\n\t\t\t\t\th = this.size.y * scale.y;\n\n\t\t\t\tgraphics.lineStyle(this.borderWidth, this.borderColor.toHexNumber(), 1);\n\t\t\t\tgraphics.beginFill(this.fillColor.toHexNumber());\n\t\t\t\tgraphics.drawRect(x, y, w, h);\n\t\t\t\tgraphics.endFill();\n\t\t\t} else if (this.type === 'circle') {\n\t\t\t\tlet averageScale = (scale.x + scale.y) / 2;\n\t\t\t\t\n\t\t\t\tgraphics.lineStyle(this.borderWidth, this.borderColor.toHexNumber(), 1);\n\t\t\t\tgraphics.beginFill(this.fillColor.toHexNumber());\n\t\t\t\tgraphics.drawCircle(0, 0, this.radius * averageScale);\n\t\t\t\tgraphics.endFill();\n\t\t\t} else if (this.type === 'convex') {\n\t\t\t\tlet path = this.getConvexPoints(PIXI.Point, false);\n\t\t\t\tpath.push(path[0]); // Close the path\n\t\t\t\t\n\t\t\t\tgraphics.lineStyle(this.borderWidth, this.borderColor.toHexNumber(), 1);\n\t\t\t\tgraphics.beginFill(this.fillColor.toHexNumber());\n\t\t\t\tgraphics.drawPolygon(path);\n\t\t\t\tgraphics.endFill();\n\t\t\t}\n\t\t\t\n\t\t\treturn graphics;\n\t\t},\n\t\tgetConvexPoints(vectorClass = Vector, takeScaleIntoAccount = true) {\n\t\t\tconst centerAngle = Math.PI * 2 / this.points;\n\t\t\tconst isNotEventPolygon = this.topPointDistance !== 0.5 && this.points <= 8;\n\t\t\t\n\t\t\tlet minDistanceMultiplier;\n\t\t\tlet maxDistanceMultiplier;\n\t\t\tif (isNotEventPolygon) {\n\t\t\t\tconst segmentAngle = Math.PI - centerAngle;\n\t\t\t\tconst unitSegmentLength = 2 * Math.sin(centerAngle / 2);\n\t\t\t\tconst defaultMinDistanceMultiplier = 1 - unitSegmentLength * Math.cos(segmentAngle / 2);\n\n\t\t\t\tif (this.points === 3) {\n\t\t\t\t\tminDistanceMultiplier = 0.2;\n\t\t\t\t\tmaxDistanceMultiplier = 5;\n\t\t\t\t} else if (this.points === 8) {\n\t\t\t\t\tminDistanceMultiplier = defaultMinDistanceMultiplier;\n\t\t\t\t\tmaxDistanceMultiplier = 3;\n\t\t\t\t} else {\n\t\t\t\t\tminDistanceMultiplier = defaultMinDistanceMultiplier;\n\t\t\t\t\tmaxDistanceMultiplier = 5;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet path = [];\n\n\t\t\tlet currentAngle = 0;\n\t\t\tfor (let i = 0; i < this.points; ++i) {\n\t\t\t\tlet x = Math.sin(currentAngle) * this.radius;\n\t\t\t\tlet y = Math.cos(currentAngle) * this.radius;\n\n\t\t\t\tif (isNotEventPolygon && i === 0) {\n\t\t\t\t\tif (this.topPointDistance > 0.5) {\n\t\t\t\t\t\ty *= 1 + (this.topPointDistance - 0.5) * (maxDistanceMultiplier - 1);\n\t\t\t\t\t} else {\n\t\t\t\t\t\ty *= 2 * this.topPointDistance * (1 - minDistanceMultiplier) + minDistanceMultiplier;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tpath.push(new vectorClass(x, -y));\n\t\t\t\tcurrentAngle += centerAngle;\n\t\t\t}\n\t\t\tif (isNotEventPolygon) {\n\t\t\t\t// put weight to center\n\t\t\t\tlet averageY = path.reduce((prev, curr) => prev + curr.y, 0) / this.points;\n\t\t\t\tpath.forEach(p => p.y -= averageY);\n\t\t\t}\n\n\t\t\tif (takeScaleIntoAccount) {\n\t\t\t\tconst scale = this.Transform.scale;\n\t\t\t\tif (scale.x !== 1 || scale.y !== 1) {\n\t\t\t\t\tpath.forEach(p => {\n\t\t\t\t\t\tp.x *= scale.x;\n\t\t\t\t\t\tp.y *= scale.y;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn path;\n\t\t},\n\t\tsleep() {\n\t\t\tthis.sprite.destroy();\n\t\t\tthis.sprite = null;\n\t\t}\n\t}\n});\n","import {Component, Prop} from '../core/component';\nimport Vector from '../util/vector';\nimport {Color} from '../util/color';\nimport {default as PIXI, generateTextureAndAnchor, getHashedTextureAndAnchor} from '../features/graphics';\n\nComponent.register({\n\tname: 'Sprite',\n\tcategory: 'Graphics',\n\ticon: 'fa-stop',\n\tallowMultiple: true,\n\tdescription: 'Draws a sprite on the screen.',\n\tproperties: [\n\t],\n\tprototype: {\n\t\tinit() {\n\t\t\tthis.initSprite();\n\n\t\t\tthis.listenProperty(this.Transform, 'position', position => {\n\t\t\t\t// this.sprite.x = position.x;\n\t\t\t\t// this.sprite.y = position.y;\n\t\t\t});\n\n\t\t\tthis.listenProperty(this.Transform, 'angle', angle => {\n\t\t\t\t// this.sprite.rotation = angle;\n\t\t\t});\n\n\t\t\tthis.listenProperty(this.Transform, 'scale', scale => {\n\t\t\t\t// this.sprite.scale.x = scale.x;\n\t\t\t\t// this.sprite.scale.y = scale.y;\n\t\t\t});\n\t\t},\n\t\tinitSprite() {\n\t\t\tthis.sprite = PIXI.Sprite.fromImage('/img/sprite.png');\n\t\t\tthis.sprite.anchor.set(0.5, 0.5);\n\t\t\t\n\t\t\tlet T = this.Transform;\n\n\t\t\t// this.sprite.x = T.position.x;\n\t\t\t// this.sprite.y = T.position.y;\n\t\t\t// this.sprite.rotation = T.angle;\n\t\t\t// this.sprite.scale.x = T.scale.x;\n\t\t\t// this.sprite.scale.y = T.scale.y;\n\n\t\t\tthis.scene.layers.main.addChild(this.sprite);\n\t\t},\n\t\tsleep() {\n\t\t\tthis.sprite.destroy();\n\t\t\tthis.sprite = null;\n\t\t}\n\t}\n});\n","import { Component, Prop } from '../core/component';\nimport EntityPrototype from '../core/entityPrototype';\n\nComponent.register({\n\tname: 'Spawner',\n\tcategory: 'Logic',\n\tdescription: 'Spawns types to world.',\n\tproperties: [\n\t\tProp('typeName', '', Prop.string),\n\t\tProp('trigger', 'start', Prop.enum, Prop.enum.values('start', 'interval')),\n\t\tProp('interval', 10, Prop.float, Prop.float.range(0.1, 1000000), Prop.visibleIf('trigger', 'interval'), 'Interval in seconds')\n\t],\n\tprototype: {\n\t\tconstructor() {\n\t\t\tthis.lastSpawn = 0;\n\t\t},\n\t\tinit() {\n\t\t\tthis.lastSpawn = this.scene.time;\n\t\t},\n\t\tonStart() {\n\t\t\tif (this.trigger === 'start')\n\t\t\t\tthis.spawn();\n\t\t},\n\t\tonUpdate() {\n\t\t\tif (this.scene.time > this.lastSpawn + this.interval)\n\t\t\t\tthis.spawn();\n\t\t},\n\t\tonDrawHelper(context) {\n\t\t\tlet size = 30;\n\t\t\tlet\n\t\t\t\tx = this.Transform.position.x - size * this.Transform.scale.x/2,\n\t\t\t\ty = this.Transform.position.y - size * this.Transform.scale.y/2,\n\t\t\t\tw = size * this.Transform.scale.x,\n\t\t\t\th = size * this.Transform.scale.y;\n\t\t\tcontext.save();\n\t\t\tcontext.fillStyle = 'blue';\n\t\t\tcontext.strokeStyle = 'white';\n\t\t\tcontext.lineWidth = 1;\n\t\t\tcontext.font = '40px FontAwesome';\n\t\t\tcontext.textAlign = 'center';\n\t\t\tcontext.fillText('\\uF21D', this.Transform.position.x + 2, this.Transform.position.y);\n\t\t\tcontext.strokeText('\\uf21d', this.Transform.position.x + 2, this.Transform.position.y);\n\t\t\t\n\t\t\tcontext.restore();\n\t\t},\n\t\tspawn() {\n\t\t\tlet prototype = this.game.findChild('prt', prt => prt.name === this.typeName, true);\n\t\t\tif (!prototype)\n\t\t\t\treturn;\n\n\t\t\tlet entityPrototype = EntityPrototype.createFromPrototype(prototype);\n\t\t\tentityPrototype.spawnEntityToScene(this.scene, this.Transform.position);\n\t\t\tentityPrototype.delete();\n\t\t\tthis.lastSpawn = this.scene.time;\n\t\t}\n\t}\n});\n","import { Component, Prop } from '../core/component';\nimport Vector from '../util/vector';\n\nComponent.register({\n\tname: 'Trigger',\n\tdescription: 'When _ then _.',\n\tcategory: 'Logic',\n\tallowMultiple: true,\n\tproperties: [\n\t\tProp('trigger', 'playerComesNear', Prop.enum, Prop.enum.values('playerComesNear')),\n\t\tProp('radius', 40, Prop.float, Prop.float.range(0, 1000), Prop.visibleIf('trigger', 'playerComesNear')),\n\t\tProp('action', 'win', Prop.enum, Prop.enum.values('win'))\n\t],\n\tprototype: {\n\t\tpreInit() {\n\t\t\tthis.storeProp = `__Trigger_${this._componentId}`;\n\t\t},\n\t\tonUpdate() {\n\t\t\tif (this.trigger === 'playerComesNear') {\n\t\t\t\tlet componentSet = this.scene.getComponents('CharacterController');\n\t\t\t\tlet entities = [];\n\t\t\t\tcomponentSet.forEach(c => entities.push(c.entity));\t\n\t\t\t\tlet distSq = this.radius * this.radius;\n\t\t\t\tlet pos = this.Transform.position;\n\t\t\t\tfor (let i = 0; i < entities.length; ++i) {\n\t\t\t\t\tif (entities[i].position.distanceSq(pos) < distSq) {\n\t\t\t\t\t\tif (!entities[i][this.storeProp] && this.launchTrigger(entities[i]) !== false)\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tentities[i][this.storeProp] = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tentities[i][this.storeProp] = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t\n\t\t// Return false if other triggers should not be checked\n\t\t// Note: check this return false logic. Looks weird.\n\t\tlaunchTrigger(entity) {\n\t\t\tif (this.action === 'win') {\n\t\t\t\tthis.scene.win();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t}\n});\n","import { Component, Prop } from '../core/component';\nimport Vector from '../util/vector';\nimport p2, { addBody, deleteBody, createMaterial, getWorld } from '../features/physics';\nimport assert from '../util/assert';\n\nconst PHYSICS_SCALE = 1/50;\nexport { PHYSICS_SCALE };\nconst PHYSICS_SCALE_INV = 1/PHYSICS_SCALE;\n\nconst DENSITY_SCALE = 3/10;\n\nconst type = {\n\tdynamic: p2.Body.DYNAMIC,\n\tkinematic: p2.Body.KINEMATIC,\n\tstatic: p2.Body.STATIC\n};\n\nconst SLEEPING = p2.Body.SLEEPING;\nconst STATIC = p2.Body.STATIC;\n\nComponent.register({\n\tname: 'Physics',\n\tcategory: 'Dynamics',\n\tdescription: 'Forms physical rules for <span style=\"color: #84ce84;\">Shapes</span>.',\n\ticon: 'fa-stop',\n\tallowMultiple: false,\n\tproperties: [\n\t\tProp('type', 'dynamic', Prop.enum, Prop.enum.values('dynamic', 'static')),\n\t\tProp('density', 1, Prop.float, Prop.float.range(0, 100), Prop.visibleIf('type', 'dynamic')),\n\t\tProp('drag', 0.1, Prop.float, Prop.float.range(0, 1), Prop.visibleIf('type', 'dynamic')),\n\t\tProp('rotationalDrag', 0.1, Prop.float, Prop.float.range(0, 1), Prop.visibleIf('type', 'dynamic')),\n\t\tProp('bounciness', 0, Prop.float, Prop.float.range(0, 1)),\n\t\tProp('friction', 0.1, Prop.float, Prop.float.range(0, 1))\n\t],\n\trequirements: [\n\t\t'Shape'\n\t],\n\trequiesInitWhenEntityIsEdited: true,\n\tprototype: {\n\t\tinited: false,\n\t\tinit() {\n\t\t\tthis.inited = true;\n\t\t\tlet update = callback => {\n\t\t\t\treturn value => {\n\t\t\t\t\tif (!this.updatingOthers && this.body) {\n\t\t\t\t\t\tcallback(value);\n\t\t\t\t\t\tif (this.type === 'dynamic')\n\t\t\t\t\t\t\tthis.body.wakeUp();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tlet Shapes = this.entity.getComponents('Shape');\n\t\t\tconst shapePropertiesThatShouldUpdateShape = [\n\t\t\t\t'type',\n\t\t\t\t'size',\n\t\t\t\t'radius',\n\t\t\t\t'points',\n\t\t\t\t'topPointDistance'\n\t\t\t];\n\t\t\tfor (let i = 0; i < Shapes.length; ++i) {\n\t\t\t\tshapePropertiesThatShouldUpdateShape.forEach(property => {\n\t\t\t\t\tthis.listenProperty(Shapes[i], property, update(() => this.updateShape()));\t\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.listenProperty(this.Transform, 'position', update(position => {\n\t\t\t\tthis.body.position = position.toArray().map(x => x * PHYSICS_SCALE);\n\t\t\t\tthis.body.updateAABB();\n\t\t\t}));\n\t\t\tthis.listenProperty(this.Transform, 'angle', update(angle => {\n\t\t\t\tthis.body.angle = angle;\n\t\t\t\tthis.body.updateAABB();\n\t\t\t}));\n\t\t\tthis.listenProperty(this.Transform, 'scale', update(scale => this.updateShape()));\n\t\t\tthis.listenProperty(this, 'density', update(density => {\n\t\t\t\tthis.body.setDensity(density * DENSITY_SCALE);\n\t\t\t}));\n\t\t\tthis.listenProperty(this, 'friction', update(friction => this.updateMaterial()));\n\t\t\tthis.listenProperty(this, 'drag', update(drag => this.body.damping = drag));\n\t\t\tthis.listenProperty(this, 'rotationalDrag', update(rotationalDrag => {\n\t\t\t\tthis.body.angularDamping = rotationalDrag > 0.98 ? 1 : rotationalDrag;\n\t\t\t\tthis.body.fixedRotation = rotationalDrag === 1;\n\t\t\t\tthis.body.updateMassProperties();\n\t\t\t}));\n\t\t\tthis.listenProperty(this, 'type', update(type => {\n\t\t\t\tthis.body.type = type[this.type];\n\t\t\t\tthis.entity.sleep();\n\t\t\t\tthis.entity.wakeUp();\n\t\t\t}));\n\t\t\tthis.listenProperty(this, 'bounciness', update(bounciness => this.updateMaterial()));\n\n\t\t\tif (this._rootType)\n\t\t\t\tthis.createBody();\n\t\t},\n\t\tcreateBody() {\n\t\t\tassert(!this.body);\n\t\t\t\n\t\t\tthis.body = new p2.Body({\n\t\t\t\ttype: type[this.type],\n\t\t\t\tposition: [this.Transform.position.x * PHYSICS_SCALE, this.Transform.position.y * PHYSICS_SCALE],\n\t\t\t\tangle: this.Transform.angle,\n\t\t\t\tvelocity: [0, 0],\n\t\t\t\tangularVelocity: 0,\n\t\t\t\tsleepTimeLimit: 0.6,\n\t\t\t\tsleepSpeedLimit: 0.3,\n\t\t\t\tdamping: this.drag,\n\t\t\t\tangularDamping: this.rotationalDrag > 0.98 ? 1 : this.rotationalDrag,\n\t\t\t\tfixedRotation: this.rotationalDrag === 1\n\t\t\t});\n\t\t\tthis.updateShape();\n\n\t\t\tthis.body.entity = this.entity;\n\t\t\t\n\t\t\taddBody(this.scene, this.body);\n\t\t},\n\t\tupdateShape() {\n\t\t\tif (this.body.shapes.length > 0) {\n\t\t\t\t// We update instead of create.\n\t\t\t\t// Should remove existing shapes\n\t\t\t\t\n\t\t\t\t// The library does not support updating shapes during the step.\n\t\t\t\tlet world = getWorld(this.scene);\n\t\t\t\tassert(!world.stepping);\n\t\t\t\t\n\t\t\t\tlet shapes = this.body.shapes;\n\t\t\t\tfor (let i = 0; i < shapes.length; ++i) {\n\t\t\t\t\tshapes[i].body = null;\n\t\t\t\t}\n\t\t\t\tshapes.length = 0;\n\t\t\t}\n\n\t\t\tlet Shapes = this.entity.getComponents('Shape');\n\t\t\tlet scale = this.Transform.scale;\n\n\t\t\tShapes.forEach(Shape => {\n\t\t\t\tlet shape;\n\t\t\t\t\n\t\t\t\tif (Shape.type === 'rectangle') {\n\t\t\t\t\tshape = new p2.Box({\n\t\t\t\t\t\twidth: Shape.size.x * PHYSICS_SCALE * scale.x,\n\t\t\t\t\t\theight: Shape.size.y * PHYSICS_SCALE * scale.y\n\t\t\t\t\t});\n\t\t\t\t} else if (Shape.type === 'circle') {\n\t\t\t\t\tlet averageScale = (scale.x + scale.y) / 2;\n\t\t\t\t\t\n\t\t\t\t\tshape = new p2.Circle({\n\t\t\t\t\t\tradius: Shape.radius * PHYSICS_SCALE * averageScale\n\t\t\t\t\t});\n\t\t\t\t} else if (Shape.type === 'convex') {\n\t\t\t\t\tshape = new p2.Convex({\n\t\t\t\t\t\tvertices: Shape.getConvexPoints().map(p => ([p.x * PHYSICS_SCALE, p.y * PHYSICS_SCALE]))\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (shape)\n\t\t\t\t\tthis.body.addShape(shape);\n\t\t\t});\n\t\t\t\n\t\t\tthis.updateMass();\n\t\t\tthis.updateMaterial();\n\t\t},\n\t\tupdateMaterial()Â {\n\t\t\tlet material = createMaterial(this.scene, {\n\t\t\t\tfriction: this.friction,\n\t\t\t\trestitution: this.bounciness,\n\t\t\t\t// stiffness: 1e6,\n\t\t\t\t// relaxation: 4,\n\t\t\t\t// frictionStiffness: 1e6,\n\t\t\t\t// frictionRelaxation: 4,\n\t\t\t\t// surfaceVelocity: 0\n\t\t\t});\n\t\t\tthis.body.shapes.forEach(s => s.material = material);\n\t\t},\n\t\tupdateMass() {\n\t\t\tif (this.type === 'dynamic')\n\t\t\t\tthis.body.setDensity(this.density * DENSITY_SCALE);\n\t\t},\n\t\tsetRootType(rootType) {\n\t\t\tif (rootType) {\n\t\t\t\tif (this.inited)\n\t\t\t\t\tthis.createBody();\n\t\t\t}\n\t\t\treturn Component.prototype.setRootType.call(this, rootType);\n\t\t},\n\t\tonUpdate() {\n\t\t\tlet b = this.body;\n\t\t\tif (!b || b.sleepState === SLEEPING || b.type === STATIC)\n\t\t\t\treturn;\n\t\t\t\n\t\t\tthis.updatingOthers = true;\n\t\t\t\n\t\t\tlet newPos = new Vector(b.position[0] * PHYSICS_SCALE_INV, b.position[1] * PHYSICS_SCALE_INV);\n\t\t\tif (!this.Transform.position.isEqualTo(newPos))\n\t\t\t\tthis.Transform.position = newPos;\n\t\t\t\n\t\t\tif (this.Transform.angle !== b.angle)\n\t\t\t\tthis.Transform.angle = b.angle;\n\t\t\t\n\t\t\tthis.updatingOthers = false;\n\t\t},\n\t\tsleep() {\n\t\t\tif (this.body) {\n\t\t\t\tdeleteBody(this.scene, this.body);\n\t\t\t\tthis.body = null;\n\t\t\t}\n\t\t\tthis.inited = false;\n\t\t},\n\t\tgetMass() {\n\t\t\treturn this.body.mass;\n\t\t},\n\t\tapplyForce(forceVector) {\n\t\t\tthis.body.applyForce(forceVector.toArray());\n\t\t\tthis.body.wakeUp();\n\t\t},\n\t\tsetAngularForce(force) {\n\t\t\tthis.body.angularForce = force;\n\t\t\tthis.body.wakeUp();\n\t\t}\n\t}\n});\n","import { Component, Prop } from '../core/component';\n\n// Export so that other components can have this component as parent\nexport default Component.register({\n\tname: 'Lifetime',\n\tdescription: 'Set the object to be destroyed after a time period',\n\tcategory: 'Logic', // You can also make up new categories.\n\ticon: 'fa-bars', // Font Awesome id\n\trequirements: ['Transform'], // These shared components are autofilled. Error if component is not found.\n\tproperties: [\n\t\tProp('lifetime', 3, Prop.float, Prop.float.range(0.01, 1000), 'Life time seconds')\n\t],\n\tparentClass: Component,\n\tprototype: {\n\t\tonUpdate() {\n\t\t\tlet lifetime = this.scene.time - this.startTime;\n\t\t\tif (lifetime >= this.lifetime) {\n\t\t\t\tif (this.entity)\n\t\t\t\t\tthis.entity.delete();\n\t\t\t}\n\t\t},\n\t\tinit() {\n\t\t\tthis.startTime = this.scene.time;\n\t\t}\n\t}\n});\n","import {Component, Prop} from '../core/component';\nimport Vector from '../util/vector';\nimport {Color} from '../util/color';\nimport {default as PIXI, generateTextureAndAnchor, getHashedTextureAndAnchor} from '../features/graphics';\nimport { isClient } from '../util/environment';\n\nimport { PHYSICS_SCALE } from './Physics';\n\nComponent.register({\n\tname: 'Particles',\n\tcategory: 'Graphics',\n\tdescription: 'Particle engine gives eye candy.',\n\tallowMultiple: true,\n\tproperties: [\n\t\tProp('startColor', new Color('#68c07f'), Prop.color),\n\t\tProp('endColor', new Color('#59abc0'), Prop.color),\n\t\tProp('alpha', 1, Prop.float, Prop.float.range(0, 1)),\n\t\tProp('particleSize', 10, Prop.float, Prop.float.range(1, 100)),\n\t\tProp('particleCount', 30, Prop.int, Prop.int.range(0, 10000)),\n\t\tProp('particleLifetime', 1, Prop.float, Prop.float.range(0.1, 10), 'in seconds'),\n\t\tProp('particleHardness', 0.2, Prop.float, Prop.float.range(0, 1)),\n\t\tProp('blendMode', 'add', Prop.enum, Prop.enum.values('add', 'normal')),\n\t\tProp('spawnType', 'circle', Prop.enum, Prop.enum.values('circle', 'rectangle')),\n\t\tProp('spawnRadius', 20, Prop.float, Prop.float.range(0, 1000), Prop.visibleIf('spawnType', 'circle')),\n\t\tProp('spawnRandom', 0.5, Prop.float, Prop.float.range(0, 1), Prop.visibleIf('spawnType', 'circle')),\n\t\tProp('spawnRect', new Vector(50, 50), Prop.vector, Prop.visibleIf('spawnType', 'rectangle')),\n\t\tProp('speedToOutside', 50, Prop.float, Prop.float.range(-1000, 1000), Prop.visibleIf('spawnType', 'circle')),\n\t\tProp('speed', new Vector(0, 0), Prop.vector),\n\t\tProp('speedRandom', 0, Prop.float, Prop.float.range(0, 1000), 'Max random velocity to random direction'),\n\t\tProp('acceleration', new Vector(0, 0), Prop.vector),\n\t\tProp('globalCoordinates', true, Prop.bool),\n\t\tProp('followObject', 0.4, Prop.float, Prop.float.range(0, 1), Prop.visibleIf('globalCoordinates', true))\n\t],\n\tprototype: {\n\t\tinit() {\n\t\t\t//ParticleContainer does not work properly!\n\t\t\t\n\t\t\t// maxSize < 40 will crash\n\t\t\t// With many Particle-components with few particles, this is deadly-expensive.\n\t\t\t// And also crashes now and then with low maxValue.\n\t\t\t// this.container = new PIXI.particles.ParticleContainer(5000, {\n\t\t\t// \tposition: true,\n\t\t\t// \talpha: true,\n\t\t\t// \tscale: false,\n\t\t\t// \trotation: false,\n\t\t\t// \tuvs: false\n\t\t\t// });\n\t\t\t\n\n\t\t\t// Use normal container instead\n\t\t\tthis.container = new PIXI.Container();\n\t\t\t\n\t\t\t// Texture\n\t\t\tthis.updateTexture();\n\t\t\t['particleSize', 'particleHardness', 'alpha'].forEach(propertyName => {\n\t\t\t\tthis.listenProperty(this, propertyName, () => {\n\t\t\t\t\tthis.updateTexture();\n\t\t\t\t});\t\t\t\t\n\t\t\t});\n\t\t\t\n\t\t\t// Blend mode\n\t\t\tthis.listenProperty(this, 'blendMode', blendMode => {\n\t\t\t\tif (!this.particles)\n\t\t\t\t\treturn;\n\t\t\t\t\n\t\t\t\tthis.particles.forEach(p => {\n\t\t\t\t\tif (p.sprite)\n\t\t\t\t\t\tp.sprite.blendMode = blendModes[blendMode];\n\t\t\t\t});\n\t\t\t});\n\t\t\t\n\t\t\tthis.scene.layers.main.addChild(this.container);\n\t\t\t\n\t\t\tthis.initParticles();\n\t\t\t['particleLifetime', 'particleCount'].forEach(propertyName => {\n\t\t\t\tthis.listenProperty(this, propertyName, () => {\n\t\t\t\t\tthis.initParticles();\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tthis.updateGlobalCoordinatesProperty();\n\t\t\tthis.listenProperty(this, 'globalCoordinates', () => {\n\t\t\t\tthis.updateGlobalCoordinatesProperty();\n\t\t\t});\n\t\t\t\n\t\t\tthis.Physics = this.entity.getComponent('Physics');\n\t\t},\n\t\t\n\t\tupdateGlobalCoordinatesProperty() {\n\t\t\tif (this.positionListener) {\n\t\t\t\tthis.positionListener();\n\t\t\t\tthis.positionListener = null;\n\t\t\t}\n\t\t\tif (this.globalCoordinates) {\n\t\t\t\tthis.particles.forEach(p => {\n\t\t\t\t\tif (p.sprite) {\n\t\t\t\t\t\tp.sprite.x += this.container.position.x;\n\t\t\t\t\t\tp.sprite.y += this.container.position.y;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthis.container.position.set(0, 0);\n\t\t\t} else {\n\t\t\t\tthis.positionListener = this.Transform._properties.position.listen('change', position => {\n\t\t\t\t\tthis.container.position.set(position.x, position.y);\n\t\t\t\t});\n\t\t\t\tthis.container.position.set(this.Transform.position.x, this.Transform.position.y);\n\n\t\t\t\tthis.particles.forEach(p => {\n\t\t\t\t\tif (p.sprite) {\n\t\t\t\t\t\tp.sprite.x -= this.container.position.x;\n\t\t\t\t\t\tp.sprite.y -= this.container.position.y;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\t\n\t\tupdateTexture() {\n\t\t\tthis.texture = getParticleTexture(this.particleSize, this.particleHardness * 0.9, {r: 255, g: 255, b: 255, a: this.alpha});\n\t\t\t// this.container.baseTexture = this.texture;\n\t\t\tif (this.particles) {\n\t\t\t\tthis.particles.forEach(p => {\n\t\t\t\t\tif (p.sprite)\n\t\t\t\t\t\tp.sprite.texture = this.texture;\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\t\n\t\tinitParticles() {\n\t\t\tif (this.particles) {\n\t\t\t\tthis.particles.forEach(p => {\n\t\t\t\t\tif (p.sprite)\n\t\t\t\t\t\tp.sprite.destroy();\n\t\t\t\t});\n\t\t\t}\n\t\t\tthis.particles = [];\n\t\t\tlet interval = this.particleLifetime / this.particleCount;\n\t\t\tlet firstBirth = this.scene.time + Math.random() * interval;\n\t\t\tfor (let i = 0; i < this.particleCount; ++i) {\n\t\t\t\tthis.particles.push({\n\t\t\t\t\talive: false,\n\t\t\t\t\tnextBirth: firstBirth + i * interval\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\t\n\t\tresetParticle(p) {\n\t\t\t\n\t\t\tp.vx = this.speed.x;\n\t\t\tp.vy = this.speed.y;\n\t\t\tif (this.speedRandom > 0) {\n\t\t\t\tlet randomSpeed = this.speedRandom * Math.random();\n\t\t\t\tlet randomAngle = Math.random() * Math.PI * 2;\n\t\t\t\tp.vx += Math.sin(randomAngle) * randomSpeed;\n\t\t\t\tp.vy += Math.cos(randomAngle) * randomSpeed;\n\t\t\t}\n\n\t\t\t// Calculate starting position\n\t\t\tif (this.spawnType === 'circle') {\n\t\t\t\tlet r = this.spawnRadius;\n\t\t\t\tif (this.spawnRandom > 0) {\n\t\t\t\t\tr = this.spawnRandom * Math.random() * r + (1 - this.spawnRandom) * r;\n\t\t\t\t}\n\t\t\t\tlet angle = Math.random() * Math.PI * 2;\n\t\t\t\tp.sprite.x = Math.cos(angle) * r;\n\t\t\t\tp.sprite.y = Math.sin(angle) * r;\n\t\t\t\tif (this.speedToOutside !== 0) {\n\t\t\t\t\tp.vx += Math.cos(angle) * this.speedToOutside;\n\t\t\t\t\tp.vy += Math.sin(angle) * this.speedToOutside;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Rectangle\n\t\t\t\tp.sprite.x = -this.spawnRect.x / 2 + Math.random() * this.spawnRect.x;\n\t\t\t\tp.sprite.y = -this.spawnRect.y / 2 + Math.random() * this.spawnRect.y;\n\t\t\t}\n\t\t\t\n\t\t\tp.age = this.scene.time - p.nextBirth;\n\t\t\tp.nextBirth += this.particleLifetime;\n\n\t\t\tif (this.globalCoordinates) {\n\t\t\t\tp.sprite.x += this.Transform.position.x;\n\t\t\t\tp.sprite.y += this.Transform.position.y;\n\t\t\t\t\n\t\t\t\tif (this.Physics && this.Physics.body) {\n\t\t\t\t\tlet vel = this.Physics.body.velocity;\n\t\t\t\t\tp.vx = p.vx + this.followObject * vel[0] / PHYSICS_SCALE;\n\t\t\t\t\tp.vy = p.vy + this.followObject * vel[1] / PHYSICS_SCALE;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t\n\t\tonUpdate(dt, t) {\n\t\t\tconst particleLifetime = this.particleLifetime;\n\t\t\tconst invParticleLifetime = 1 / particleLifetime;\n\t\t\tconst particles = this.particles;\n\t\t\tconst accelerationX = this.acceleration.x * dt;\n\t\t\tconst accelerationY = this.acceleration.y * dt;\n\t\t\t\n\t\t\t// Fast color interpolation\n\t\t\tconst startColor = this.startColor;\n\t\t\tconst endColor = this.endColor;\n\t\t\tfunction colorLerp(lerp) {\n\t\t\t\tlet startMultiplier = 1 - lerp;\n\t\t\t\tlet r = (startColor.r * startMultiplier + endColor.r * lerp) | 0; // to int\n\t\t\t\tlet g = (startColor.g * startMultiplier + endColor.g * lerp) | 0;\n\t\t\t\tlet b = (startColor.b * startMultiplier + endColor.b * lerp) | 0;\n\t\t\t\treturn 65536 * r + 256 * g + b;\n\t\t\t}\n\t\t\t\n\t\t\tlet sprite, \n\t\t\t\tspritePos,\n\t\t\t\tscale,\n\t\t\t\tlerp,\n\t\t\t\tp\n\t\t\t;\n\t\t\t\n\t\t\tfor (let i = 0; i < this.particleCount; i++) {\n\t\t\t\tp = particles[i];\n\t\t\t\t\n\t\t\t\tif (!p.alive) {\n\t\t\t\t\t// Not alive\n\t\t\t\t\tif (t >= p.nextBirth) {\n\t\t\t\t\t\t// The birth!\n\t\t\t\t\t\tp.sprite = new PIXI.Sprite(this.texture);\n\t\t\t\t\t\tp.sprite.blendMode = blendModes[this.blendMode];\n\t\t\t\t\t\tp.sprite.anchor.set(0.5, 0.5);\n\t\t\t\t\t\tp.alive = true;\n\t\t\t\t\t\tthis.resetParticle(p);\n\t\t\t\t\t\tthis.container.addChild(p.sprite);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// Is alive\n\n\t\t\t\tsprite = p.sprite;\n\t\t\t\tspritePos = sprite.transform.position;\n\t\t\t\t\n\t\t\t\tp.age += dt;\n\t\t\t\tlerp = p.age * invParticleLifetime;\n\t\t\t\tif (lerp >= 1) {\n\t\t\t\t\tthis.resetParticle(p);\n\t\t\t\t\tlerp = p.age * invParticleLifetime;\n\t\t\t\t} else {\n\t\t\t\t\tp.vx += accelerationX;\n\t\t\t\t\tp.vy += accelerationY;\n\t\t\t\t\tspritePos.x += p.vx * dt;\n\t\t\t\t\tspritePos.y += p.vy * dt;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tsprite.tint = colorLerp(lerp);\n\t\t\t\t\n\t\t\t\tsprite.alpha = alphaLerp(lerp);\n\t\t\t\t\n\t\t\t\tscale = scaleLerp(lerp);\n\t\t\t\tsprite.scale.set(scale, scale);\n\n\t\t\t}\n\t\t},\n\t\t\n\t\tsleep() {\n\t\t\tthis.particles = null;\n\t\t\t\n\t\t\tthis.container.destroy();\n\t\t\tthis.container = null;\n\n\t\t\tif (this.positionListener) {\n\t\t\t\tthis.positionListener();\n\t\t\t\tthis.positionListener = null;\n\t\t\t}\n\t\t\t\n\t\t\t// do not destroy textures. we can reuse them.\n\t\t}\n\t}\n});\n\nfunction alphaLerp(lerp) {\n\tif (lerp > 0.5) {\n\t\treturn (1 - lerp) / 0.5;\n\t} else if (lerp > 0.2) {\n\t\treturn 1;\n\t} else {\n\t\treturn lerp * 5;\n\t}\n}\n\nfunction scaleLerp(lerp) {\n\tif (lerp > 0.5) {\n\t\treturn 1;\n\t} else {\n\t\treturn 0.5 + lerp;\n\t}\n}\n\nconst blendModes = {\n\tadd: isClient ? PIXI.BLEND_MODES.ADD : 0,\n\tnormal: isClient ? PIXI.BLEND_MODES.NORMAL: 0\n};\n\nlet textureCache = {};\n\n// size: pixels\n// gradientHardness: 0..1\nfunction getParticleTexture(size, gradientHardness = 0, rgb = {r: 255, g: 255, b: 255, a: 1}) {\n\tlet hash = `${size}-${gradientHardness}-${rgb.r}-${rgb.g}-${rgb.b}-${rgb.a}`;\n\tif (!textureCache[hash]) {\n\t\tlet canvas = document.createElement('canvas');\n\t\tcanvas.width = size;\n\t\tcanvas.height = size;\n\t\tlet context = canvas.getContext('2d');\n\t\tvar gradient = context.createRadialGradient(\n\t\t\tsize * 0.5,\n\t\t\tsize * 0.5,\n\t\t\tsize * 0.5 * (gradientHardness), // inner r\n\t\t\tsize * 0.5,\n\t\t\tsize * 0.5,\n\t\t\tsize * 0.5 // outer r\n\t\t);\n\t\tgradient.addColorStop(0, `rgba(${rgb.r}, ${rgb.g}, ${rgb.b}, ${rgb.a})`);\n\t\tgradient.addColorStop(1, `rgba(${rgb.r}, ${rgb.g}, ${rgb.b}, 0)`);\n\t\tcontext.fillStyle = gradient;\n\t\tcontext.fillRect(0, 0, size, size);\n\t\ttextureCache[hash] = PIXI.Texture.fromCanvas(canvas);\n\t}\n\treturn textureCache[hash];\n}\n","export function removeTheDeadFromArray(array) {\n\tfor (let i = array.length - 1; i >= 0; --i) {\n\t\tif (array[i]._alive === false)\n\t\t\tarray.splice(i, 1);\n\t}\n}\n\nexport function absLimit(value, absMax) {\n\tif (value > absMax)\n\t\treturn absMax;\n\telse if (value < -absMax)\n\t\treturn -absMax;\n\telse\n\t\treturn value;\n}\n","import { Component, Prop } from '../core/component';\nimport { key, keyPressed, listenKeyDown } from '../util/input';\nimport assert from '../util/assert'\nimport Vector from '../util/vector';\nimport { getWorld, default as p2 } from '../features/physics';\nimport {PHYSICS_SCALE} from './Physics'\nimport { absLimit } from '../util/algorithm';\n\nconst JUMP_SAFE_DELAY = 0.1; // seconds\n\nComponent.register({\n\tname: 'CharacterController',\n\tdescription: 'Lets user control the object.',\n\tcategory: 'Dynamics',\n\tallowMultiple: false,\n\tproperties: [\n\t\tProp('type', 'player', Prop.enum, Prop.enum.values('player', 'AI')),\n\t\tProp('keyboardControls', 'arrows or WASD', Prop.enum, Prop.enum.values('arrows', 'WASD', 'arrows or WASD')),\n\t\tProp('controlType', 'jumper', Prop.enum, Prop.enum.values('jumper', 'top down'/*, 'space ship'*/)),\n\t\tProp('jumpSpeed', 300, Prop.float, Prop.float.range(0, 1000), Prop.visibleIf('controlType', 'jumper')),\n\t\tProp('jumpAddedToVelocity', 0.4, Prop.float, Prop.float.range(0, 1), Prop.visibleIf('controlType', 'jumper'), '1 means that jump speed is added to y velocity when object has y velocity.'),\n\t\tProp('breakInTheAir', true, Prop.bool, Prop.visibleIf('controlType', 'jumper')),\n\t\tProp('speed', 200, Prop.float, Prop.float.range(0, 1000)),\n\t\tProp('acceleration', 2000, Prop.float, Prop.float.range(0, 10000)),\n\t\tProp('breaking', 2000, Prop.float, Prop.float.range(0, 10000))\n\t],\n\tprototype: {\n\t\tinit() {\n\t\t\tthis.Physics = this.entity.getComponent('Physics');\n\n\t\t\tthis.lastJumpTime = 0;\n\n\t\t\tthis.keyListener = listenKeyDown(keyCode => {\n\t\t\t\tif (this.controlType !== 'jumper' || !this.scene.playing)\n\t\t\t\t\treturn;\n\t\t\t\t\n\t\t\t\tif (this.keyboardControls === 'arrows') {\n\t\t\t\t\tif (keyCode === key.up)\n\t\t\t\t\t\tthis.jump();\n\t\t\t\t} else if (this.keyboardControls === 'WASD') {\n\t\t\t\t\tif (keyCode === key.w)\n\t\t\t\t\t\tthis.jump();\n\t\t\t\t} else if (this.keyboardControls === 'arrows or WASD') {\n\t\t\t\t\tif (keyCode === key.up || keyCode === key.w)\n\t\t\t\t\t\tthis.jump();\n\t\t\t\t} else {\n\t\t\t\t\tassert(false, 'Invalid CharacterController.keyboardControls');\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tsleep() {\n\t\t\tif (this.keyListener) {\n\t\t\t\tthis.keyListener();\n\t\t\t\tthis.keyListener = null;\n\t\t\t}\n\t\t},\n\t\tgetInput() {\n\t\t\tif (this.keyboardControls === 'arrows') {\n\t\t\t\treturn {\n\t\t\t\t\tup: keyPressed(key.up),\n\t\t\t\t\tdown: keyPressed(key.down),\n\t\t\t\t\tleft: keyPressed(key.left),\n\t\t\t\t\tright: keyPressed(key.right)\n\t\t\t\t};\n\t\t\t} else if (this.keyboardControls === 'WASD') {\n\t\t\t\treturn {\n\t\t\t\t\tup: keyPressed(key.w),\n\t\t\t\t\tdown: keyPressed(key.s),\n\t\t\t\t\tleft: keyPressed(key.a),\n\t\t\t\t\tright: keyPressed(key.d)\n\t\t\t\t};\n\t\t\t} else if (this.keyboardControls === 'arrows or WASD') {\n\t\t\t\treturn {\n\t\t\t\t\tup: keyPressed(key.up) || keyPressed(key.w),\n\t\t\t\t\tdown: keyPressed(key.down) || keyPressed(key.s),\n\t\t\t\t\tleft: keyPressed(key.left) || keyPressed(key.a),\n\t\t\t\t\tright: keyPressed(key.right) || keyPressed(key.d)\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tassert(false, 'Invalid CharacterController.keyboardControls');\n\t\t\t}\n\t\t},\n\t\tonUpdate(dt, t) {\n\t\t\tlet { up, down, left, right } = this.getInput();\n\t\t\t\n\t\t\tlet dx = 0,\n\t\t\t\tdy = 0;\n\t\t\t\n\t\t\tif (right) dx++;\n\t\t\tif (left) dx--;\n\t\t\tif (up) dy--;\n\t\t\tif (down) dy++;\n\t\t\t\n\t\t\tif (this.controlType === 'top down') {\n\t\t\t\tthis.moveTopDown(dx, dy, dt);\n\t\t\t} else if (this.controlType === 'jumper') {\n\t\t\t\tthis.moveJumper(dx, dy, dt);\n\t\t\t}\n\t\t},\n\t\t// dx and dy between [-1, 1]\n\t\tmoveTopDown(dx, dy, dt) {\n\t\t\tif (!this.Physics) {\n\t\t\t\tif (dx !== 0 || dy !== 0) {\n\t\t\t\t\tlet Transform = this.Transform;\n\t\t\t\t\tlet p = Transform.position;\n\t\t\t\t\tlet delta = this.speed * dt;\n\t\t\t\t\tTransform.position = new Vector(p.x + dx * delta, p.y + dy * delta);\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this.Physics.body)\n\t\t\t\treturn;\n\t\t\t\n\t\t\t// Physics based\n\t\t\t// #############\n\n\t\t\tlet bodyVelocity = this.Physics.body.velocity;\n\n\t\t\tbodyVelocity[0] = absLimit(this.calculateNewVelocity(bodyVelocity[0] / PHYSICS_SCALE, dx, dt), this.speed) * PHYSICS_SCALE;\n\t\t\tbodyVelocity[1] = absLimit(this.calculateNewVelocity(bodyVelocity[1] / PHYSICS_SCALE, dy, dt), this.speed) * PHYSICS_SCALE;\n\t\t},\n\t\tmoveJumper(dx, dy, dt) {\n\t\t\tif (!this.Physics || !this.Physics.body)\n\t\t\t\treturn false;\n\t\t\t\n\t\t\tlet bodyVelocity = this.Physics.body.velocity;\n\n\t\t\tbodyVelocity[0] = this.calculateNewVelocity(bodyVelocity[0] / PHYSICS_SCALE, dx, dt) * PHYSICS_SCALE;\n\t\t},\n\t\tjump() {\n\t\t\tif (this.scene.time > this.lastJumpTime + JUMP_SAFE_DELAY && this.checkIfCanJump()) {\n\t\t\t\tthis.lastJumpTime = this.scene.time;\n\t\t\t\t\n\t\t\t\tlet bodyVelocity = this.Physics.body.velocity;\n\t\t\t\tif (bodyVelocity[1] > 0) {\n\t\t\t\t\t// going down\n\t\t\t\t\tbodyVelocity[1] = -this.jumpSpeed * PHYSICS_SCALE;\n\t\t\t\t} else {\n\t\t\t\t\t// going up\n\t\t\t\t\tlet velocityVector = Vector.fromArray(bodyVelocity);\n\n\t\t\t\t\tlet contactEquations = getWorld(this.scene).narrowphase.contactEquations;\n\t\t\t\t\tlet body = this.Physics.body;\n\t\t\t\t\t\n\t\t\t\t\tfor (let i = contactEquations.length - 1; i >= 0; --i) {\n\t\t\t\t\t\tlet contact = contactEquations[i];\n\t\t\t\t\t\tif (contact.bodyA === body || contact.bodyB === body) {\n\t\t\t\t\t\t\tlet normal = Vector.fromArray(contact.normalA);\n\t\t\t\t\t\t\tif (contact.bodyB === body)\n\t\t\t\t\t\t\t\tnormal.multiplyScalar(-1);\n\t\t\t\t\t\t\tlet dotProduct = velocityVector.dot(normal);\n\t\t\t\t\t\t\tif (dotProduct < 0) {\n\t\t\t\t\t\t\t\t// character is moving away from the contact. could be caused by physics engine.\n\t\t\t\t\t\t\t\tvelocityVector.subtract(normal.multiplyScalar(dotProduct));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tbodyVelocity[1] = velocityVector.y * this.jumpAddedToVelocity - this.jumpSpeed * PHYSICS_SCALE;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tcheckIfCanJump() {\n\t\t\tif (!this.Physics || this.controlType !== 'jumper')\n\t\t\t\treturn false;\n\t\t\t\n\t\t\tlet contactEquations = getWorld(this.scene).narrowphase.contactEquations;\n\t\t\tlet body = this.Physics.body;\n\t\t\t\n\t\t\tif (!body)\n\t\t\t\treturn false;\n\t\t\t\n\t\t\tif (body.sleepState === p2.Body.SLEEPING)\n\t\t\t\treturn true;\n\t\t\t\n\t\t\tfor (let i = contactEquations.length - 1; i >= 0; --i) {\n\t\t\t\tlet contact = contactEquations[i];\n\t\t\t\tif (contact.bodyA === body || contact.bodyB === body) {\n\t\t\t\t\tlet normalY = contact.normalA[1];\n\t\t\t\t\tif (contact.bodyB === body)\n\t\t\t\t\t\tnormalY *= -1;\n\t\t\t\t\tif (normalY > 0.5)\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\treturn false;\n\t\t},\n\t\tcalculateNewVelocity(velocity, input, dt) {\n\t\t\tif (input !== 0) {\n\t\t\t\tif (velocity >= this.speed && input > 0) {\n\t\t\t\t\t// don't do anything\n\t\t\t\t} else if (velocity <= -this.speed && input < 0) {\n\t\t\t\t\t// don't do anything\n\t\t\t\t} else {\n\t\t\t\t\t// do something\n\t\t\t\t\tvelocity += input * this.acceleration * dt;\n\n\t\t\t\t\tif (input < 0 && velocity < -this.speed)\n\t\t\t\t\t\tvelocity = -this.speed;\n\n\t\t\t\t\tif (input > 0 && velocity > this.speed)\n\t\t\t\t\t\tvelocity = this.speed;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (velocity !== 0 && (this.controlType !== 'jumper' || this.breakInTheAir || this.checkIfCanJump())) {\n\t\t\t\t\tlet absVel = Math.abs(velocity);\n\t\t\t\t\tabsVel -= this.breaking * dt;\n\t\t\t\t\tif (absVel < 0)\n\t\t\t\t\t\tabsVel = 0;\n\n\t\t\t\t\tif (velocity > 0)\n\t\t\t\t\t\tvelocity = absVel;\n\t\t\t\t\telse\n\t\t\t\t\t\tvelocity = -absVel;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn velocity;\n\t\t}\n\t}\n});\n","/*\n milliseconds: how often callback can be called\n callbackLimitMode:\n \t- instant: if it has been quiet, call callback() instantly\n \t- soon: if it has been quiet, call callback() instantly after current code loop\n \t- next: if it has been quiet, call callback() after waiting milliseconds.\n \t\n When calling the callback, limitMode can be overridden: func(callLimitMode);\n */\nexport function limit(milliseconds, callbackLimitMode = 'soon', callback) {\n\tif (!['instant', 'soon', 'next'].includes(callbackLimitMode))\n\t\tthrow new Error('Invalid callbackLimitMode');\n\t\n\tlet queueTimeout = null; // non-null when call is in queue\n\tlet lastCall = 0; // last time when callback was called\n\t\n\tfunction callCallback() {\n\t\tlastCall = Date.now();\n\t\tqueueTimeout = null;\n\t\tcallback();\n\t}\n\tfunction callCallbackWithDelay(delayMilliseconds) {\n\t\tqueueTimeout = setTimeout(callCallback, delayMilliseconds);\n\t}\n\t\n\treturn function(callLimitMode) {\n\t\tif (queueTimeout)\n\t\t\treturn;\n\t\t\n\t\tlet timeToNextPossibleCall = lastCall + milliseconds - Date.now();\n\t\tif (timeToNextPossibleCall > 0) {\n\t\t\tcallCallbackWithDelay(timeToNextPossibleCall);\n\t\t} else {\n\t\t\tlet mode = callLimitMode || callbackLimitMode;\n\t\t\tif (mode === 'instant')\n\t\t\t\tcallCallback();\n\t\t\telse if (mode === 'soon')\n\t\t\t\tcallCallbackWithDelay(0)\n\t\t\telse if (mode === 'next')\n\t\t\t\tcallCallbackWithDelay(milliseconds)\n\t\t}\n\t}\n}\n","import {\n\taddChangeListener,\n\tpackChange,\n\tunpackChange,\n\texecuteChange,\n\texecuteExternal,\n\tchangeType\n} from './serializableManager'\nimport Serializable from './serializable';\nimport {game} from './game';\nimport {limit} from '../util/callLimiter';\nimport {stickyNonModalErrorPopup} from \"../util/popup\";\nimport events from '../util/events';\n\nlet options = {\n\tcontext: null, // 'play' or 'edit'. This is communicated to server. Doesn't affect client.\n\tserverToClientEnabled: true,\n\tclientToServerEnabled: false \n};\n\nexport function configureNetSync(_options) {\n\toptions = Object.assign(options, _options);\n}\n\nlet changes = [];\nlet valueChanges = {}; // id => change\n\nfunction isInSceneTree(change) {\n\treturn change.reference._rootType === 'sce';\n}\n\nfunction getQueryVariable(variable) {\n\tvar query = window.location.search.substring(1);\n\tvar vars = query.split('&');\n\tfor (var i = 0; i < vars.length; i++) {\n\t\tvar pair = vars[i].split('=');\n\t\tif (decodeURIComponent(pair[0]) == variable) {\n\t\t\treturn decodeURIComponent(pair[1]);\n\t\t}\n\t}\n\tconsole.log('Query variable %s not found', variable);\n}\n\nfunction changeReceivedOverNet(packedChanges) {\n\tif (!options.serverToClientEnabled)\n\t\treturn;\n\tpackedChanges.forEach(change => {\n\t\tchange = unpackChange(change);\n\t\tif (change) {\n\t\t\texecuteChange(change);\n\t\t}\n\t});\n}\nfunction gameReceivedOverNet(gameData)Â {\n\tconsole.log('receive gameData', gameData);\n\tif (!gameData)\n\t\treturn console.error('Game data was not received');\n\ttry {\n\t\texecuteExternal(() => {\n\t\t\tSerializable.fromJSON(gameData);\n\t\t});\n\t\tlocalStorage.openEditPlayGameId = gameData.id;\n\t\t// location.replace(`${location.origin}${location.pathname}?gameId=${gameData.id}`);\n\t\thistory.replaceState({}, null, `?gameId=${gameData.id}`);\n\t} catch(e) {\n\t\tconsole.error('Game is corrupt.', e);\n\t\tstickyNonModalErrorPopup('Game is corrupt.');\n\t}\n}\n\naddChangeListener(change => {\n\tif (change.external || !options.clientToServerEnabled)\n\t\treturn; // Don't send a change that you have received.\n\n\tif (isInSceneTree(change)) // Don't sync scene\n\t\treturn;\n\n\tif (change.type === changeType.setPropertyValue) {\n\t\tlet duplicateChange = valueChanges[change.id];\n\t\tif (duplicateChange) {\n\t\t\tchanges.splice(changes.indexOf(duplicateChange), 1);\n\t\t}\n\t\tvalueChanges[change.id] = change;\n\t}\n\tchanges.push(change);\n\t\n\tif (sendChanges)\n\t\tsendChanges();\n});\n\nfunction parseSocketMessage(message) {\n\tlet type = message.split(' ')[0];\n\tlet body = message.substring(type.length + 1);\n\tif (body.length > 0)\n\t\tbody = JSON.parse(body);\n\n\tconsole.log('parseSocketMessage', type, body);\n\t\n\treturn {\n\t\ttype,\n\t\tbody\n\t};\n}\n\nfunction sendSocketMessage(eventName, data) {\n\tif (!socket)\n\t\treturn console.log('Could not send', eventName);\n\t\n\tif (eventName)\n\t\tsocket.emit(eventName, data);\n\telse\n\t\tsocket.emit(data);\n}\n\nlet listeners = {\n\tdata(result) {\n\t\tlet {profile, gameData, editAccess} = result;\n\t\tlocalStorage.openEditPlayUserId = profile.id;\n\t\tlocalStorage.openEditPlayUserToken = profile.userToken;\n\t\t\n\t\tif (!editAccess) {\n\t\t\tevents.dispatch('noEditAccess');\n\t\t}\n\t\t\n\t\tdelete profile.userToken;\n\t\twindow.user = profile;\n\t\t\n\t\tgameReceivedOverNet(gameData);\n\t},\n\tidentifyYourself() {\n\t\tif (game) \n\t\t\treturn location.reload();\n\n\t\tlet gameId = getQueryVariable('gameId') || localStorage.openEditPlayGameId;\n\t\tlet userId = localStorage.openEditPlayUserId; // if doesn't exist, server will create one\n\t\tlet userToken = localStorage.openEditPlayUserToken; // if doesn't exist, server will create one\n\t\tlet context = options.context;\n\t\tsendSocketMessage('identify', {userId, userToken, gameId, context});\n\t},\n\terrorMessage(result) {\n\t\tlet {message, isFatal, data} = result;\n\t\tconsole.error(`Server sent ${isFatal ? 'FATAL ERROR' : 'error'}:`, message, data);\n\t\tif (isFatal) {\n\t\t\tstickyNonModalErrorPopup(message);\n\t\t\t// document.body.textContent = message;\n\t\t}\n\t}\n};\n\nlet sendChanges = limit(200, 'soon', () => {\n\tif (!socket || changes.length === 0 || !options.clientToServerEnabled)\n\t\treturn;\n\t\n\tlet packedChanges = changes.map(packChange);\n\tchanges.length = 0;\n\tvalueChanges = {};\n\tconsole.log('send change', packedChanges);\n\tsendSocketMessage('', packedChanges);\n});\n\nlet socket;\nfunction connect() {\n\tif (!window.io) {\n\t\treturn console.error('socket.io not defined after window load.');\n\t}\n\t\n\tsocket = new io();\n\twindow.s = socket;\n\tsocket.on('connect', () => {\n\t\tsocket.onevent = packet => {\n\t\t\tlet param1 = packet.data[0];\n\t\t\tif (typeof param1 === 'string') {\n\t\t\t\tlisteners[param1](packet.data[1]);\n\t\t\t} else {\n\t\t\t\t// Optimized change-event\n\t\t\t\tchangeReceivedOverNet(param1);\n\t\t\t}\n\t\t};\n\t\tsocket.on('disconnect', () => {\n\t\t\tconsole.warn('Disconnected!');\n\t\t\tstickyNonModalErrorPopup('Disconnected!');\n\t\t\toptions.serverToClientEnabled = false;\n\t\t\toptions.clientToServerEnabled = false;\n\t\t});\n\t});\n}\nwindow.addEventListener('load', connect);\n","import { el, list, mount } from 'redom';\nimport events, { dispatch, listen } from '../../util/events';\nimport { setOption, getOption } from '../editor';\nimport * as performance from '../../util/performance';\n\nexport default class ModuleContainer {\n\tconstructor(moduleContainerName = 'unknownClass.anotherClass', packButtonIcon = 'fa-chevron-left') {\n\t\tthis.modules = [];\n\t\tthis.packButtonEnabled = !!packButtonIcon;\n\t\tthis.el = el(`div.moduleContainer.packable.${moduleContainerName}`,\n\t\t\tthis.packButton = packButtonIcon && el(`i.packButton.button.iconButton.fa.${packButtonIcon}`),\n\t\t\tthis.tabs = list('div.tabs.select-none', ModuleTab),\n\t\t\tthis.moduleElements = el('div.moduleElements')\n\t\t);\n\t\t\n\t\tif (packButtonIcon) {\n\t\t\tlet packId = 'moduleContainerPacked_' + moduleContainerName;\n\t\t\tif (getOption(packId)) {\n\t\t\t\tthis.el.classList.add('packed');\n\t\t\t}\n\t\t\t\t\n\t\t\tthis.el.onclick = () => {\n\t\t\t\tsetOption(packId, '');\n\t\t\t\tevents.dispatch('layoutResize');\n\t\t\t\tthis.el.classList.contains('packed') && this.el.classList.remove('packed');\n\t\t\t\tthis.update();\n\t\t\t\treturn;\n\t\t\t};\n\t\t\tthis.packButton.onclick = e => {\n\t\t\t\tthis.el.classList.add('packed');\n\t\t\t\tevents.dispatch('layoutResize');\n\t\t\t\tsetOption(packId, 'true');\n\t\t\t\te.stopPropagation();\n\t\t\t\treturn false;\n\t\t\t};\n\t\t}\n\n\t\tevents.listen('registerModule_' + moduleContainerName.split('.')[0], (moduleClass, editor) => {\n\t\t\tlet module = new moduleClass(editor);\n\t\t\tmodule.el.classList.add('module-' + module.id);\n\t\t\tmodule.moduleContainer = this;\n\t\t\tthis.modules.push(module);\n\t\t\tthis.el.classList.remove('noModules');\n\t\t\tif (this.modules.length !== 1) {\n\t\t\t\tmodule._hide();\n\t\t\t}\n\t\t\tmount(this.moduleElements, module.el);\n\t\t\tthis._updateTabs();\n\t\t});\n\n\t\tlisten(this, 'moduleClicked', module => {\n\t\t\tthis.activateModule(module);\n\t\t});\n\t\t\n\t\tthis._updateTabs();\n\t}\n\tupdate() {\n\t\tthis.modules.forEach(m => {\n\t\t\tlet performanceName = 'Editor: ' + m.id[0].toUpperCase() + m.id.substring(1);\n\t\t\tperformance.start(performanceName);\n\t\t\tif (m.update() !== false) {\n\t\t\t\tthis._enableModule(m);\n\t\t\t} else\n\t\t\t\tthis._disableModule(m);\n\t\t\tperformance.stop(performanceName);\n\t\t});\n\t\tthis._updateTabs();\n\t}\n\t_updateTabs() {\n\t\tif (!this.tabs) return;\n\t\t\n\t\tthis.tabs.update(this.modules);\n\t\t\n\t\tif (!this.packButtonEnabled && this.modules.length <= 1)\n\t\t\tthis.tabs.el.style.display = 'none';\n\t\telse\n\t\t\tthis.tabs.el.style.display = 'block';\n\t\t\n\t\tlet noModules = !this.modules.find(m => m._enabled);\n\t\tthis.el.classList.toggle('noModules', noModules);\n\t}\n\tactivateModule(module, unpackModuleView = true, ...args) {\n\t\tif (unpackModuleView) {\n\t\t\tthis.el.classList.remove('packed');\n\t\t\tevents.dispatch('layoutResize');\n\t\t}\n\t\tthis._activateModule(module, args);\n\t}\n\tactivateOneOfModules(modules, unpackModuleView = true, ...args) {\n\t\tif (unpackModuleView) {\n\t\t\tthis.el.classList.remove('packed');\n\t\t\tevents.dispatch('layoutResize');\n\t\t}\n\n\t\tfor (let i = 0; i < this.modules.length; ++i) {\n\t\t\tlet m = this.modules[i];\n\t\t\tif (m._selected && modules.indexOf(m) >= 0)\n\t\t\t\treturn; // Already selected\n\t\t}\n\t\t\n\t\tfor (let i = 0; i < this.modules.length; ++i) {\n\t\t\tlet m = this.modules[i];\n\t\t\tif (m._enabled && modules.indexOf(m) >= 0)\n\t\t\t\treturn this.activateModule(m, unpackModuleView, ...args);\n\t\t}\n\t}\n\t_activateModule(module, args) {\n\t\tthis.modules.forEach(m => {\n\t\t\tif (m !== module) {\n\t\t\t\tm._hide();\n\t\t\t}\n\t\t});\n\t\tmodule._enabled = true;\n\t\tmodule._show();\n\t\tthis._updateTabs();\n\t\tmodule.update();\n\t\tmodule.activate(...args);\n\t}\n\t_enableModule(module) {\n\t\tif (!module._enabled) {\n\t\t\tmodule._enabled = true;\n\t\t\tlet selectedModule = this.modules.find(m => m._selected);\n\t\t\tif (!selectedModule)\n\t\t\t\tthis._activateModule(module);\n\t\t\tthis._updateTabs();\n\t\t}\n\t}\n\t_disableModule(module) {\n\t\tif (module._enabled) {\n\t\t\tmodule._enabled = false;\n\t\t\tif (module._selected) {\n\t\t\t\tmodule._selected = false;\n\t\t\t\tlet enabledModule = this.modules.find(m => m._enabled);\n\t\t\t\tif (enabledModule)\n\t\t\t\t\tthis._activateModule(enabledModule);\n\t\t\t}\n\t\t\tmodule._hide();\n\t\t\tthis._updateTabs();\n\t\t}\n\t}\n\tisPacked() {\n\t\treturn this.el.classList.contains('packed');\n\t}\n}\n\nclass ModuleTab {\n\tconstructor() {\n\t\tthis.el = el('span.moduleTab.button');\n\t\tthis.module = null;\n\t\tthis.el.onclick = () => {\n\t\t\tdispatch(this, 'moduleClicked', this.module);\n\t\t};\n\t}\n\tupdate(module) {\n\t\tif (this.module === module && this._sel === module._selected && this._ena === module._enabled)\n\t\t\treturn;\n\t\t\n\t\tthis.el.setAttribute('moduleid', module.id);\n\t\t\n\t\tthis.module = module;\n\t\tif (this.el.innerHTML !== module.name)\n\t\t\tthis.el.innerHTML = module.name;\n\t\t\n\t\tthis._sel = module._selected;\n\t\tthis._ena = module._enabled;\n\t\t\n\t\tthis.el.classList.toggle('moduleSelected', module._selected);\n\t\tthis.el.classList.toggle('moduleEnabled', module._enabled);\n\t}\n}\n","import { el, list, mount } from 'redom';\nimport ModuleContainer from './moduleContainer';\n\nexport default class Layout {\n\tconstructor() {\n\t\tthis.moduleContainers = [];\n\t\tlet addContainer = (...args) => {\n\t\t\tlet container = new ModuleContainer(...args);\n\t\t\tthis.moduleContainers.push(container);\n\t\t\treturn container;\n\t\t};\n\t\tthis.el = el('div.editorLayout',\n\t\t\tel('div.nonRight',\n\t\t\t\taddContainer('top', null),\n\t\t\t\tel('div.bottomLeft',\n\t\t\t\t\taddContainer('left', 'fa-chevron-left'),\n\t\t\t\t\tel('div.middle',\n\t\t\t\t\t\taddContainer('center', null),\n\t\t\t\t\t\taddContainer('bottom', 'fa-chevron-down')\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t),\n\t\t\taddContainer('right', 'fa-chevron-right')\n\t\t);\n\t}\n\tupdate() {\n\t\tthis.moduleContainers.forEach(mc => mc.update());\n\t}\n}\n","import { el, list, mount } from 'redom';\nimport events from '../../util/events';\n\nlet moduleIdToModule = {};\n\nexport default class Module {\n\tconstructor() {\n\t\tthis.type = 'module';\n\t\tthis.name = this.name || 'Module';\n\t\tthis.id = this.id || 'module';\n\t\tif (arguments.length > 0)\n\t\t\tthis.el = el('div.module', ...arguments);\n\t\telse\n\t\t\tthis.el = el('div.module');\n\t\tthis._selected = true;\n\t\tthis._enabled = true;\n\t\t\n\t\t// Timeout so that module constructor has time to set this.id after calling super.\n\t\tsetTimeout(() => {\n\t\t\tmoduleIdToModule[this.id] = this;\n\t\t});\n\t}\n\t// Called when this module is opened. Other modules can call Module.activateModule('Module', ...args);\n\tactivate() {\n\t}\n\t// Called when changes happen. return false to hide from ui\n\tupdate() {\n\t}\n\t_show() {\n\t\tthis.el.classList.remove('hidden');\n\t\tthis._selected = true;\n\t\tthis._enabled = true;\n\t}\n\t_hide() {\n\t\tthis.el.classList.add('hidden');\n\t\tthis._selected = false;\n\t}\n}\n//arguments: moduleName, unpackModuleView=true, ...args \nModule.activateModule = function(moduleId, unpackModuleView=true, ...args) {\n\tmoduleIdToModule[moduleId].moduleContainer.activateModule(moduleIdToModule[moduleId], unpackModuleView, ...args);\n};\n// Modules must be in same moduleContainer\nModule.activateOneOfModules = function(moduleIds, unpackModuleView=true, ...args) {\n\tmoduleIdToModule[moduleIds[0]].moduleContainer.activateOneOfModules(moduleIds.map(mId => moduleIdToModule[mId]), unpackModuleView, ...args);\n};\nModule.packModuleContainer = function(moduleContainerName) {\n\tdocument.querySelectorAll(`.moduleContainer.${moduleContainerName}`)[0].classList.add('packed');\n};\nModule.unpackModuleContainer = function(moduleContainerName) {\n\tdocument.querySelectorAll(`.moduleContainer.${moduleContainerName}`)[0].classList.remove('packed');\n};\n\n// moduleContainerName = left | middle | right | bottom\nModule.register = function(moduleClass, moduleContainerName) {\n\tregisterPromise = registerPromise.then(() => {\n\t\tevents.dispatch('registerModule_' + moduleContainerName, moduleClass);\n\t});\n};\n\n\nlet registerPromise = new Promise(function(resolve) {\n\tevents.listen('registerModules', function() {\n\t\tregisterPromise.then(() => {\n\t\t\tevents.dispatch('modulesRegistered');\n\t\t});\n\t\tresolve();\n\t});\n});\n","import { el, list, mount } from 'redom';\nimport Module from './module';\nimport { editor, changeSelectedTool, selectedToolName, modulesRegisteredPromise } from '../editor';\nimport events from '../../util/events';\nimport {listenSceneCreation, scene} from '../../core/scene';\nimport {listenKeyDown, key} from \"../../util/input\";\n\nexport class TopBarModule extends Module {\n\tconstructor() {\n\t\tsuper(\n\t\t\tthis.logo = el('img.logo.button.iconButton.select-none', { src: '/img/logo_graphics.png' }),\n\t\t\tthis.buttons = el('div.buttonContainer.select-none'),\n\t\t\tthis.controlButtons = el('div.topButtonGroup.topSceneControlButtons'),\n\t\t\tthis.toolSelectionButtons = el('div.topButtonGroup.topToolSelectionButtons')\n\t\t);\n\t\tthis.id = 'topbar';\n\t\tthis.name = 'TopBar'; // not visible\n\t\tthis.keyboardShortcuts = {}; // key.x -> func\n\n\t\tthis.logo.onclick = () => {\n\t\t\tlocation.href = '/';\n\t\t};\n\n\t\tlistenKeyDown(keyCode => {\n\t\t\tthis.keyboardShortcuts[keyCode] && this.keyboardShortcuts[keyCode]();\n\t\t});\n\t\t\n\t\tthis.initControlButtons();\n\t\tthis.initToolSelectionButtons();\n\t}\n\t\n\taddKeyboardShortcut(key, buttonOrCallback) {\n\t\tif (typeof buttonOrCallback === 'function') {\n\t\t\tthis.keyboardShortcuts[key] = buttonOrCallback;\n\t\t} else {\n\t\t\tthis.keyboardShortcuts[key] = () => buttonOrCallback.callback(buttonOrCallback.el);\n\t\t}\n\t}\n\t\n\tinitControlButtons() {\n\t\tlet playButtonData = {\n\t\t\ttitle: 'Play (P)',\n\t\t\ticon: 'fa-play',\n\t\t\ttype: 'play',\n\t\t\tcallback: () => events.dispatch('play')\n\t\t};\n\t\tlet pauseButtonData = {\n\t\t\ttitle: 'Pause (P)',\n\t\t\ticon: 'fa-pause',\n\t\t\ttype: 'pause',\n\t\t\tcallback: () => events.dispatch('pause')\n\t\t};\n\n\t\tlet playButton = new SceneControlButton(playButtonData);\n\t\tlet stopButton = new SceneControlButton({\n\t\t\ttitle: 'Reset (R)',\n\t\t\ticon: 'fa-stop',\n\t\t\ttype: 'reset',\n\t\t\tcallback: () => events.dispatch('reset')\n\t\t});\n\n\t\tconst updateButtons = () => {\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (scene.playing)\n\t\t\t\t\tplayButton.update(pauseButtonData);\n\t\t\t\telse\n\t\t\t\t\tplayButton.update(playButtonData);\n\n\t\t\t\tlet paused = !scene.playing && !scene.isInInitialState();\n\t\t\t\tthis.controlButtons.classList.toggle('topSceneControlButtonsPaused', paused);\n\t\t\t}, 0);\n\t\t};\n\n\t\tthis.addKeyboardShortcut(key.p, playButton);\n\t\tthis.addKeyboardShortcut(key.r, stopButton);\n\t\t\n\t\tlistenSceneCreation(() => {\n\t\t\tscene.listen('reset', updateButtons);\n\t\t\tscene.listen('play', updateButtons);\n\t\t\tscene.listen('pause', updateButtons);\n\t\t});\n\n\t\tmount(this.controlButtons, playButton);\n\t\tmount(this.controlButtons, stopButton);\n\t}\n\t\n\tinitToolSelectionButtons() {\n\t\tconst createCallback = (callback) => {\n\t\t\treturn (element) => {\n\t\t\t\tthis.toolSelectionButtons.querySelectorAll('.topSceneControlButton').forEach(button => {\n\t\t\t\t\tbutton.classList.remove('selected');\n\t\t\t\t});\n\t\t\t\telement.classList.add('selected');\n\t\t\t\tcallback && callback();\n\t\t\t}\n\t\t};\n\t\tlet tools = {\n\t\t\tglobalMoveTool: new SceneControlButton({\n\t\t\t\ttitle: 'Global move tool (1)',\n\t\t\t\ticon: 'fa-arrows',\n\t\t\t\tcallback: createCallback(() => {\n\t\t\t\t\tchangeSelectedTool('globalMoveTool');\n\t\t\t\t})\n\t\t\t}),\n\t\t\tlocalMoveTool: new SceneControlButton({\n\t\t\t\ttitle: 'Local move tool (2)',\n\t\t\t\ticon: 'fa-arrows-alt',\n\t\t\t\tcallback: createCallback(() => {\n\t\t\t\t\tchangeSelectedTool('localMoveTool');\n\t\t\t\t})\n\t\t\t}),\n\t\t\tmultiTool: new SceneControlButton({\n\t\t\t\ttitle: 'Multitool tool (3)',\n\t\t\t\ticon: 'fa-dot-circle-o',\n\t\t\t\tcallback: createCallback(() => {\n\t\t\t\t\tchangeSelectedTool('multiTool');\n\t\t\t\t})\n\t\t\t})\n\t\t};\n\n\t\tthis.addKeyboardShortcut(key[1], tools.globalMoveTool);\n\t\tthis.addKeyboardShortcut(key[2], tools.localMoveTool);\n\t\tthis.addKeyboardShortcut(key[3], tools.multiTool);\n\t\t\n\t\tmount(this.toolSelectionButtons, tools.globalMoveTool);\n\t\tmount(this.toolSelectionButtons, tools.localMoveTool);\n\t\tmount(this.toolSelectionButtons, tools.multiTool);\n\n\t\ttools[selectedToolName].click();\n\t\t// this.multipurposeTool.click(); // if you change the default tool, scene.js must also be changed\n\t}\n}\nModule.register(TopBarModule, 'top');\n\nclass SceneControlButton {\n\tconstructor(data) {\n\t\tthis.el = el('div.button.topSceneControlButton', {\n\t\t\tonclick: () => this.click()\n\t\t});\n\t\tthis.update(data);\n\t}\n\tupdate(data) {\n\t\tthis.el.setAttribute('title', data.title || '');\n\t\tthis.el.setAttribute('controlButtonType', data.type || '');\n\t\tthis.el.innerHTML = '';\n\t\tthis.callback = data.callback;\n\t\tmount(this.el, el(`i.fa.${data.icon}`));\n\t}\n\tclick() {\n\t\tthis.callback && this.callback(this.el);\n\t}\n}\n\nexport class TopButton {\n\tconstructor({\n\t\ttext = 'Button',\n\t\tcallback,\n\t\ticonClass = 'fa-circle',\n\t\tpriority = 1\n\t} = {}) {\n\t\tthis.priority = priority || 0;\n\t\tthis.callback = callback;\n\t\tthis.el = el('div.button.topIconTextButton',\n\t\t\tel('div.topIconTextButtonContent',\n\t\t\t\tthis.icon = el(`i.fa.${iconClass}`),\n\t\t\t\tthis.text = el('span', text)\n\t\t\t)\n\t\t);\n\t\tthis.el.onclick = () => {\n\t\t\tthis.click();\n\t\t};\n\n\t\tmodulesRegisteredPromise.then(() => {\n\t\t\tevents.dispatch('addTopButtonToTopBar', this);\n\t\t});\n\t}\n\tclick() {\n\t\tif (this.callback) {\n\t\t\tthis.callback(this);\n\t\t}\n\t}\n}\n","import { scene } from '../../core/scene';\nimport { editor } from '../editor';\nimport { changeType } from '../../core/serializableManager';\nimport assert from '../../util/assert';\nimport Vector from '../../util/vector';\nimport { centerWidgetRadius } from '../widget/widget'\nimport {filterChildren} from \"../../core/serializable\";\nimport {Component} from \"../../core/component\";\n\nlet radius = 10;\n\nexport function shouldSyncLevelAndScene() {\n\treturn scene && scene.isInInitialState() && editor.selectedLevel;\n}\n\nfunction setEntityPropertyValue(entity, componentName, componentId, sourceProperty) {\n\tlet component = entity.getComponents(componentName)\n\t.filter(c => c._componentId === componentId)[0];\n\n\tif (component)\n\t\tcomponent._properties[sourceProperty.name].value = sourceProperty.value;\n}\n\nfunction getAffectedEntities(prototypeOrEntityPrototype, prototypeFilter = null) {\n\tif (prototypeOrEntityPrototype.threeLetterType === 'epr') {\n\t\t// EntityPrototype\n\t\t\n\t\tlet entity = prototypeOrEntityPrototype.previouslyCreatedEntity;\n\t\tif (entity && entity._alive)\n\t\t\treturn [entity];\n\t\telse\n\t\t\treturn [];\n\t}\n\t\n\t// Prototype\n\t\n\tlet affectedPrototypes = new Set();\n\n\tfunction goThroughChildren(prototype) {\n\t\tprototype.getChildren('prt').forEach(proto => {\n\t\t\tif (typeof prototypeFilter === 'function') {\n\t\t\t\tif (prototypeFilter(proto))Â {\n\t\t\t\t\taffectedPrototypes.add(proto);\n\t\t\t\t\tgoThroughChildren(proto);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\taffectedPrototypes.add(proto);\n\t\t\t\tgoThroughChildren(proto);\n\t\t\t}\n\t\t});\n\t}\n\n\taffectedPrototypes.add(prototypeOrEntityPrototype);\n\tgoThroughChildren(prototypeOrEntityPrototype);\n\n\tlet entities = scene.level.getChildren('epr').filter(epr => {\n\t\treturn affectedPrototypes.has(epr.prototype)\n\t\t\t&& (!prototypeFilter || prototypeFilter(epr));\n\t}).map(epr => epr.previouslyCreatedEntity).filter(ent => ent && ent._alive);\n\treturn entities;\n}\n\n// Call setChangeOrigin(this) before calling this\nexport function syncAChangeBetweenSceneAndLevel(change) {\n\tif (!scene || !scene.level) return;\n\t\n\tif (!shouldSyncLevelAndScene())\n\t\treturn;\n\n\tif (change.type === 'editorSelection')\n\t\treturn;\n\t\n\tlet ref = change.reference;\n\tassert(ref && ref._rootType);\n\t\n\tlet threeLetterType = ref && ref.threeLetterType || null;\n\tif (ref._rootType !== 'gam')\n\t\treturn;\n\t\n\tif (change.type === changeType.addSerializableToTree) {\n\t\tif (threeLetterType === 'epr') {\n\t\t\tlet epr = ref;\n\t\t\tif (epr.findParent('lvl') === editor.selectedLevel)\n\t\t\t\tepr.createEntity(scene);\n\t\t} else if (threeLetterType === 'cda') {\n\t\t\tlet parent = ref.getParent();\n\t\t\tlet entities;\n\t\t\tif (parent.threeLetterType === 'prt') {\n\t\t\t\tentities = getAffectedEntities(parent);\n\t\t\t} else {\n\t\t\t\t// epr\n\t\t\t\tentities = [parent.previouslyCreatedEntity].filter(ent => ent && ent._alive);\n\t\t\t}\n\t\t\t\n\t\t\tentities.forEach(entity => {\n\t\t\t\t\n\t\t\t\tlet oldComponent = entity.getComponents(ref.name).find(com => com._componentId === ref.componentId);\n\t\t\t\tif (oldComponent)\n\t\t\t\t\tentity.deleteComponent(oldComponent);\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tlet proto = entity.prototype;\n\t\t\t\tlet componentData = proto.findComponentDataByComponentId(ref.componentId, true);\n\t\t\t\tif (componentData) {\n\t\t\t\t\tlet component = componentData.createComponent();\n\t\t\t\t\tentity.addComponents([component]);\n\t\t\t\t}\n\t\t\t});\n\t\t} else if (threeLetterType === 'prp') {\n\t\t\tlet property = ref;\n\t\t\tlet componentData = property.findParent('cda');\n\t\t\tlet prototype = componentData.getParent();\n\t\t\tlet entities = getAffectedEntities(prototype);\n\t\t\tentities.forEach(entity => {\n\t\t\t\tlet epr = entity.prototype;\n\t\t\t\tlet value = epr.getValue(componentData.componentId, property.name);\n\t\t\t\tlet component = entity.getComponents(componentData.name).find(com => com._componentId === componentData.componentId);\n\t\t\t\tcomponent._properties[property.name].value = value;\n\t\t\t})\n\t\t}\n\t} else if (change.type === changeType.setPropertyValue) {\n\t\tlet property = ref;\n\t\tlet cda = property.findParent('cda');\n\t\tif (!cda)\n\t\t\treturn;\n\t\tlet prototype = cda.getParent();\n\t\tif (prototype.threeLetterType === 'epr') {\n\t\t\t// EntityPrototype\n\t\t\t\n\t\t\tif (prototype.previouslyCreatedEntity) {\n\t\t\t\tsetEntityPropertyValue(prototype.previouslyCreatedEntity, cda.name, cda.componentId, property);\n\t\t\t}\n\t\t} else {\n\t\t\t// Prototype\n\t\t\t\n\t\t\tlet entities = getAffectedEntities(prototype, prt => prt.findOwnProperty(cda.componentId, property.name) === null);\n\n\t\t\tentities.forEach(ent => {\n\t\t\t\tsetEntityPropertyValue(ent, cda.name, cda.componentId, property);\n\t\t\t});\n\t\t}\n\t} else if (change.type === changeType.deleteAllChildren) {\n\t\tif (threeLetterType === 'cda') {\n\t\t\tlet componentData = ref;\n\t\t\tlet prototype = componentData.getParent();\n\t\t\tlet entities = getAffectedEntities(prototype);\n\t\t\tentities.forEach(entity => {\n\t\t\t\tlet epr = entity.prototype;\n\t\t\t\tlet oldComponent = entity.getComponents(componentData.name).find(com => com._componentId === componentData.componentId);\n\t\t\t\tentity.deleteComponent(oldComponent);\n\n\t\t\t\tlet inheritedComponentDatas = epr.getInheritedComponentDatas();\n\t\t\t\tlet icd = inheritedComponentDatas.find(i => i.componentId === componentData.componentId);\n\t\t\t\tif (icd) {\n\t\t\t\t\tlet newComponent = Component.createWithInheritedComponentData(icd);\n\t\t\t\t\tentity.addComponents([newComponent]);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t} else if (change.type === changeType.deleteSerializable) {\n\t\tif (threeLetterType === 'epr') {\n\t\t\tlet epr = ref;\n\t\t\tif (epr.previouslyCreatedEntity)\n\t\t\t\tepr.previouslyCreatedEntity.delete();\n\t\t} else if (threeLetterType === 'prp') {\n\t\t\tlet property = ref;\n\t\t\tlet componentData = property.findParent('cda');\n\t\t\tlet prototype = componentData.getParent();\n\t\t\tlet entities = getAffectedEntities(prototype);\n\t\t\tentities.forEach(ent => {\n\t\t\t\tlet epr = ent.prototype;\n\t\t\t\tlet cda = epr.findComponentDataByComponentId(componentData.componentId, true);\n\t\t\t\tlet componentClass = cda.componentClass;\n\t\t\t\tlet valueProperty = cda.getProperty(property.name);\n\t\t\t\tlet value;\n\t\t\t\tif (valueProperty === property) {\n\t\t\t\t\tcda = cda.getParentComponentData();\n\t\t\t\t\tif (cda)\n\t\t\t\t\t\tvalue = cda.getValue(property.name);\n\t\t\t\t\telse\n\t\t\t\t\t\tvalue = componentClass._propertyTypesByName[property.name].initialValue;\n\t\t\t\t} else if (valueProperty) {\n\t\t\t\t\tvalue = valueProperty.value;\n\t\t\t\t} else {\n\t\t\t\t\tvalue = componentClass._propertyTypesByName[property.name].initialValue;\n\t\t\t\t}\n\t\t\t\tlet component = ent.getComponents(componentData.name).find(com => com._componentId === componentData.componentId);\n\t\t\t\tif (component)\n\t\t\t\t\tcomponent._properties[property.name].value = value;\n\t\t\t});\n\t\t} else if (threeLetterType === 'cda') {\n\t\t\tlet componentData = ref;\n\t\t\tlet prototype = componentData.getParent();\n\t\t\tlet entities = getAffectedEntities(prototype);\n\t\t\tentities.forEach(entity => {\n\t\t\t\tlet epr = entity.prototype;\n\t\t\t\tlet oldComponent = entity.getComponents(componentData.name).find(com => com._componentId === componentData.componentId);\n\t\t\t\tentity.deleteComponent(oldComponent);\n\t\t\t\t\n\t\t\t\tlet inheritedComponentDatas = epr.getInheritedComponentDatas(cda => cda !== componentData);\n\t\t\t\tlet icd = inheritedComponentDatas.find(i => i.componentId === componentData.componentId);\n\t\t\t\tif (icd) {\n\t\t\t\t\tlet newComponent = Component.createWithInheritedComponentData(icd);\n\t\t\t\t\tentity.addComponents([newComponent]);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t// If Prototype is deleted, all entity prototypes are also deleted so we can ignore Prototype here\n\t} else if (change.type === changeType.move) {\n\t\t\n\t}\t\n}\n\nexport function copyEntitiesToScene(entities) {\n\tif (scene) {\n\t\tif (shouldSyncLevelAndScene()) {\n\t\t\tlet entityPrototypes = entities.map(entity => {\n\t\t\t\tlet epr = entity.prototype.clone();\n\t\t\t\tepr.position = entity.position;\n\t\t\t\treturn epr;\n\t\t\t});\n\t\t\teditor.selectedLevel.addChildren(entityPrototypes);\n\t\t\treturn entityPrototypes.map(epr => epr.createEntity(scene));\n\t\t} else {\n\t\t\tlet newEntities = entities.map(e => e.clone());\n\t\t\tscene.addChildren(newEntities);\n\t\t\treturn newEntities;\n\t\t}\n\t}\n\treturn null;\n}\n\nexport function getWidgetUnderMouse(mousePos) {\n\tlet nearestWidget = null;\n\tlet nearestDistanceSq = Infinity;\n\t\n\tfunction testWidget(widget) {\n\t\tif (!widget.isMouseInWidget(mousePos))\n\t\t\treturn;\n\t\t\n\t\tlet distSq = mousePos.distanceSq(widget);\n\t\tif (distSq < nearestDistanceSq) {\n\t\t\tnearestDistanceSq = distSq;\n\t\t\tnearestWidget = widget;\n\t\t}\n\t}\n\t\n\tscene.getComponents('EditorWidget').forEach(editorWidget => {\n\t\tif (editorWidget.selected) {\n\t\t\teditorWidget.widgets.forEach(testWidget);\n\t\t} else {\n\t\t\ttestWidget(editorWidget.position);\n\t\t}\n\t});\n\t\n\treturn nearestWidget;\n}\nexport function getEntitiesInSelection(start, end)Â {\n\tlet entities = [];\n\t\n\tlet minX = Math.min(start.x, end.x);\n\tlet maxX = Math.max(start.x, end.x);\n\tlet minY = Math.min(start.y, end.y);\n\tlet maxY = Math.max(start.y, end.y);\n\t\n\tscene.forEachChild('ent', ent => {\n\t\tlet p = ent.getComponent('EditorWidget').positionHelper;\n\t\tif (p.x < minX) return;\n\t\tif (p.x > maxX) return;\n\t\tif (p.y < minY) return;\n\t\tif (p.y > maxY) return;\n\t\tentities.push(ent);\n\t}, true);\n\t\n\treturn entities;\n}\n\nexport function copyTransformPropertiesFromEntitiesToEntityPrototypes(entities) {\n\tif (shouldSyncLevelAndScene()) {\n\t\tentities.forEach(e => {\n\t\t\tlet entityPrototypeTransform = e.prototype.getTransform();\n\t\t\tlet entityTransform = e.getComponent('Transform');\n\t\t\t\n\t\t\tconsole.log('ny mentiin')\n\n\t\t\tsetOrCreateTransformDataPropertyValue(entityPrototypeTransform, entityTransform, 'position', '_p', (a, b) => a.isEqualTo(b));\n\t\t\tsetOrCreateTransformDataPropertyValue(entityPrototypeTransform, entityTransform, 'scale', '_s', (a, b) => a.isEqualTo(b));\n\t\t\tsetOrCreateTransformDataPropertyValue(entityPrototypeTransform, entityTransform, 'angle', '_a', (a, b) => a === b);\n\t\t\t\n\t\t\t/*\n\t\t\tlet position = entityPrototypeTransform.getProperty('position');\n\t\t\tif (position) {\n\t\t\t\tif (!position.value.isEqualTo(entityTransform.position))\n\t\t\t\t\tposition.value = entityTransform.position;\n\t\t\t} else {\n\t\t\t\tposition = transform.componentClass._propertyTypesByName.position.createProperty({\n\t\t\t\t\tvalue: entityTransform.position,\n\t\t\t\t\tpredefinedId: entityPrototypeTransform.id + '_p'\n\t\t\t\t});\n\t\t\t\tentityPrototypeTransform.addChild(position);\n\t\t\t}\n\t\t\t\n\t\t\tlet scale = entityPrototypeTransform.findChild('prp', prp => prp.name === 'scale');\n\t\t\tif (!scale.value.isEqualTo(entityTransform.scale))\n\t\t\t\tscale.value = entityTransform.scale;\n\t\t\t\n\t\t\tlet angle = entityPrototypeTransform.findChild('prp', prp => prp.name === 'angle');\n\t\t\tif (angle.value !== entityTransform.angle)\n\t\t\t\tangle.value = entityTransform.angle;\n\t\t\t\t*/\n\t\t});\n\t}\n}\nexport function setOrCreateTransformDataPropertyValue(transformComponentData, transform, propertyName = 'position', idPostfix = '_p', valueCompareFunc = (a, b) => a === b) {\n\tlet property = transformComponentData.getProperty(propertyName);\n\tif (property) {\n\t\tif (!valueCompareFunc(property.value, transform[propertyName])) {\n\t\t\tproperty.value = transform[propertyName];\n\t\t\tconsole.log('updated', propertyName, 'to', transform[propertyName]);\n\t\t}\n\t} else {\n\t\tproperty = transformComponentData.componentClass._propertyTypesByName[propertyName].createProperty({\n\t\t\tvalue: transform[propertyName],\n\t\t\tpredefinedId: transformComponentData.getParent().id + idPostfix\n\t\t});\n\t\ttransformComponentData.addChild(property);\n\t\tconsole.log('created', propertyName, 'valued', transform[propertyName]);\n\t}\n}\n\nexport function moveEntities(entities, change) {\n\tif (entities.length === 0)\n\t\treturn;\n\n\tentities.forEach(entity => {\n\t\tlet transform = entity.getComponent('Transform');\n\t\ttransform.position = transform.position.add(change);\n\t});\n}\n\nexport function setEntityPositions(entities, position) {\n\tif (entities.length === 0)\n\t\treturn;\n\t\n\tlet averagePosition = new Vector();\n\n\tentities.forEach(entity => {\n\t\taveragePosition.add(entity.position);\n\t});\n\t\n\taveragePosition.divideScalar(entities.length);\n\t\n\tlet change = averagePosition.multiplyScalar(-1).add(position);\n\t\n\tentities.forEach(entity => {\n\t\tentity.position = entity.position.add(change);\n\t});\n}\n\nexport function deleteEntities(entities) {\n\tentities = filterChildren(entities);\n\tif (shouldSyncLevelAndScene()) {\n\t\tentities.forEach(e => e.prototype.delete());\n\t}\n\tentities.forEach(e => e.delete());\n}\n\nexport function entityModifiedInEditor(entity, change) {\n\tif (!entity || entity.threeLetterType !== 'ent' || !change || change.type !== changeType.setPropertyValue)\n\t\treturn;\n\t\n\tif (shouldSyncLevelAndScene()) {\n\t\tlet entityPrototype = entity.prototype;\n\t\tconsole.log('before', entityPrototype);\n\t\tlet property = change.reference;\n\t\tlet component = property.getParent();\n\t\tlet changeComponentId = component._componentId;\n\t\tlet changePropertyName = change.reference.name;\n\t\tlet componentData = entityPrototype.getOwnComponentDataOrInherit(changeComponentId);\n\t\tconsole.log('componentData', componentData);\n\t\tlet entityPrototypeProperty = componentData.getPropertyOrCreate(changePropertyName);\n\t\tconsole.log('entityPrototypeProperty', entityPrototypeProperty);\n\t\tentityPrototypeProperty.value = property.value;\n\t\tconsole.log('after', entityPrototype);\n\t}\n\tentity.dispatch('changedInEditor', change);\n}\n\nexport function setEntitiesInSelectionArea(entities, inSelectionArea) {\n\tentities.forEach(entity => {\n\t\tlet editorWidget = entity.getComponent('EditorWidget');\n\t\teditorWidget.inSelectionArea = inSelectionArea;\n\t\teditorWidget.position.updateVisibility();\n\t});\n}\n","import { game } from '../core/game'\nimport { editor } from './editor'\nimport { scene } from '../core/scene'\nimport Vector from '../util/vector'\nimport { serializables } from '../core/serializableManager'\nimport Serializable from '../core/serializable'\n\nclass Help {\n\tget game() {\n\t\treturn game;\n\t}\n\tget editor() {\n\t\treturn editor;\n\t}\n\tget level() {\n\t\treturn editor.selectedLevel;\n\t}\n\tget scene() {\n\t\treturn scene;\n\t}\n\tget entities() {\n\t\treturn scene.getChildren('ent');\n\t}\n\tget world() {\n\t\treturn scene._p2World;\n\t}\n\tget Vector() {\n\t\treturn Vector;\n\t}\n\tget serializables() {\n\t\treturn serializables;\n\t}\n\tget serializablesArray() {\n\t\treturn Object.keys(serializables).map(k => serializables[k]);\n\t}\n\tget selectedEntity() {\n\t\tif (this.sceneModule && this.sceneModule.selectedEntities.length > 0)\n\t\t\treturn this.sceneModule.selectedEntities[0];\n\t}\n\tcopyGame() {\n\t\tlet prototypes = game.getChildren('prt').map(prt => prt.toJSON());\n\t\tlet levels = game.getChildren('lvl').map(lvl => lvl.toJSON());\n\t\treturn JSON.stringify([].concat(prototypes, levels));\n\t}\n\tpasteGame(data) {\n\t\tgame.getChildren('lvl').forEach(lvl => lvl.delete());\n\t\tgame.getChildren('prt').forEach(prt => prt.delete());\n\t\t\n\t\tlet children = JSON.parse(data).map(Serializable.fromJSON);\n\t\tgame.addChildren(children);\n\t}\n}\n\nlet help = new Help;\nexport { help };\nwindow.help = help;\n","/*\nWidget is the smallest little thing in editor scene that user can interact and edit entities in the scene.\n */\n\nimport Vector from '../../util/vector';\nimport PIXI from '../../features/graphics';\nimport { scene } from '../../core/scene'\n\nexport let defaultWidgetRadius = 5;\nexport let centerWidgetRadius = 10;\nexport let defaultWidgetDistance = 30;\n\nexport default class Widget {\n\tconstructor(options) {\n\t\tthis.x = options.x || 0;\n\t\tthis.y = options.y || 0;\n\t\tthis.r = options.r || defaultWidgetRadius;\n\t\tthis.hovering = false;\n\t\tthis.component = options.component;\n\t\tthis.relativePosition = options.relativePosition || new Vector(0, 0);\n\t\tthis.graphics = null;\n\t}\n\tonDrag(mousePosition, mousePositionChange, affectedEntities) {\n\t\tconsole.log('Widget dragged');\n\t}\n\tupdatePosition() {\n\t\tlet T = this.component.Transform;\n\t\tlet pos = this.relativePosition.clone().rotate(T.getGlobalAngle()).add(T.getGlobalPosition());\n\t\tthis.x = pos.x;\n\t\tthis.y = pos.y;\n\t\t\n\t\tif (this.graphics) {\n\t\t\tthis.graphics.x = this.x;\n\t\t\tthis.graphics.y = this.y;\n\t\t}\n\t}\n\t\n\t// Optimized for many function calls\n\tisMouseInWidget(mousePosition) {\n\t\tlet r = this.r / scene.cameraZoom;\n\t\t\n\t\tif (mousePosition.x >= this.x - r\n\t\t\t&& mousePosition.x <= this.x + r\n\t\t\t&& mousePosition.y >= this.y - r\n\t\t\t&& mousePosition.y <= this.y + r) {\n\t\t\tif (mousePosition.distanceSq(this) <= r * r) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\t\n\tcreateGraphics() {\n\t\tlet graphics = new PIXI.Graphics();\n\t\t\n\t\tgraphics.lineStyle(2, 0x000000, 1);\n\t\tgraphics.drawCircle(1, 1, this.r);\n\n\t\tgraphics.lineStyle(2, 0xFFFFFF, 1);\n\t\tgraphics.drawCircle(0, 0, this.r);\n\t\t\n\t\treturn graphics;\n\t}\n\t\n\tinit() {\n\t\tthis.graphics = this.createGraphics();\n\t\tthis.updatePosition();\n\t\tthis.updateVisibility();\n\t\tthis.component.scene.positionHelperLayer.addChild(this.graphics);\n\n\t\tlet invZoom = 1 / scene.cameraZoom;\n\t\tthis.graphics.scale.set(invZoom, invZoom);\n\t}\n\t\n\tsleep() {\n\t\tif (this.graphics) {\n\t\t\tthis.graphics.destroy();\n\t\t\tthis.graphics = null;\n\t\t}\n\t}\n\t\n\tdelete() {\n\t\tthis.sleep();\n\t\tthis.component = null;\n\t\tthis.relativePosition = null;\n\t}\n\t\n\tupdateVisibility() {\n\t\tif (this.graphics) {\n\t\t\tif (this.hovering) {\n\t\t\t\tthis.graphics.alpha = 1;\n\t\t\t} else {\n\t\t\t\tthis.graphics.alpha = 0.5;\n\t\t\t}\n\t\t}\n\t}\n\t\n\thover() {\n\t\tthis.hovering = true;\n\t\tthis.updateVisibility();\n\t}\n\tunhover() {\n\t\tthis.hovering = false;\n\t\tif (this.component) // if alive\n\t\t\tthis.updateVisibility();\n\t}\n}\n","import { default as Widget, defaultWidgetDistance, centerWidgetRadius } from './widget';\nimport Vector from '../../util/vector';\nimport { keyPressed, key } from '../../util/input';\nimport { scene } from '../../core/scene'\nimport assert from \"../../util/assert\";\n\nconst SHIFT_STEPS = 16;\n\nexport default class AngleWidget extends Widget {\n\tconstructor(component) {\n\t\tsuper({\n\t\t\tcomponent,\n\t\t\trelativePosition: new Vector(-defaultWidgetDistance, 0)\n\t\t});\n\t}\n\n\tonDrag(mousePosition, mousePositionChange, affectedEntities) {\n\t\t// Master entity is the entity whose widget we are dragging.\n\t\t// If parent and child entity are selected and we are dragging child widget, masterEntity is the parent.\n\t\tlet masterEntity = this.component.entity;\n\t\twhile (!affectedEntities.find(ent => ent === masterEntity)) {\n\t\t\tmasterEntity = masterEntity.getParent();\n\t\t\tif (!masterEntity || masterEntity.threeLetterType !== 'ent') {\n\t\t\t\tassert('Master entity not found when editing angle of entity.');\n\t\t\t}\n\t\t}\n\t\t\n\t\tlet T = masterEntity.getComponent('Transform');\n\t\tlet entityPosition = T.getGlobalPosition();\n\t\t\n\t\tlet relativeMousePosition = mousePosition.clone().subtract(entityPosition);\n\t\tlet relativeWidgetPosition = new Vector(this.x, this.y).subtract(entityPosition);\n\n\t\tlet oldAngle = T.getGlobalAngle();\n\t\tlet mouseAngle = Math.PI + relativeMousePosition.horizontalAngle();\n\t\tlet widgetAngle = Math.PI + relativeWidgetPosition.horizontalAngle();\n\t\t\n\t\tlet newAngle = oldAngle + (mouseAngle - widgetAngle);\n\t\tif (newAngle < 0)\n\t\t\tnewAngle += Math.PI * 2;\n\t\t\n\t\tif (keyPressed(key.shift)) {\n\t\t\tnewAngle += Math.PI / SHIFT_STEPS;\n\t\t\tnewAngle -= newAngle % (Math.PI / SHIFT_STEPS * 2);\n\t\t}\n\t\tlet angleDifference = newAngle - oldAngle;\n\t\t\n\t\taffectedEntities.forEach(entity => {\n\t\t\tlet Transform = entity.getComponent('Transform');\n\t\t\tTransform.angle = Transform.angle + angleDifference;\n\t\t});\n\t}\n\n\tupdatePosition() {\n\t\tlet T = this.component.Transform;\n\t\tlet globalAngle = T.getGlobalAngle();\n\t\tlet globalPosition = T.getGlobalPosition();\n\t\tlet pos = this.relativePosition.clone().multiplyScalar(1 / scene.cameraZoom).rotate(globalAngle).add(globalPosition);\n\t\tthis.x = pos.x;\n\t\tthis.y = pos.y;\n\n\t\tif (this.graphics) {\n\t\t\tthis.graphics.position.copy(globalPosition);\n\t\t\tthis.graphics.rotation = globalAngle;\n\t\t}\n\t}\n\t\n\tcreateGraphics() {\n\t\tlet tail = this.relativePosition.clone().setLength(centerWidgetRadius);\n\t\tlet head = this.relativePosition.clone().setLength(defaultWidgetDistance - this.r);\n\t\t\n\t\tlet graphics = new PIXI.Graphics();\n\n\t\tgraphics.lineStyle(2, 0x000000, 1);\n\t\tgraphics.moveTo(tail.x + 1, tail.y + 1);\n\t\tgraphics.lineTo(head.x + 1, head.y + 1);\n\t\tgraphics.lineStyle(0);\n\t\t\n\t\tgraphics.beginFill(0x000000, 1);\n\t\tgraphics.drawCircle(this.relativePosition.x + 1, this.relativePosition.y + 1, this.r);\n\t\tgraphics.endFill();\n\t\t\n\t\tgraphics.lineStyle(2, 0xFFFFFF, 1);\n\t\tgraphics.moveTo(tail.x, tail.y);\n\t\tgraphics.lineTo(head.x, head.y);\n\t\tgraphics.lineStyle(0);\n\t\t\n\t\tgraphics.beginFill(0xFFFFFF, 1);\n\t\tgraphics.drawCircle(this.relativePosition.x, this.relativePosition.y, this.r);\n\t\tgraphics.endFill();\n\n\t\treturn graphics;\n\t}\n}\n","import { default as Widget, centerWidgetRadius } from './widget';\n\nexport default class PositionWidget extends Widget {\n\tconstructor(component) {\n\t\tsuper({\n\t\t\tr: centerWidgetRadius,\n\t\t\tcomponent\n\t\t});\n\t}\n\tonDrag(mousePosition, mousePositionChange, affectedEntities) {\n\t\taffectedEntities.forEach(entity => {\n\t\t\tlet transform = entity.getComponent('Transform');\n\t\t\tlet globalPosition = transform.getGlobalPosition();\n\t\t\tglobalPosition.add(mousePositionChange);\n\t\t\ttransform.setGlobalPosition(globalPosition);\n\t\t});\n\t}\n\n\tupdateVisibility() {\n\t\tif (this.component.selected) {\n\t\t\tif (this.hovering) {\n\t\t\t\tthis.graphics.alpha = 1;\n\t\t\t} else {\n\t\t\t\tthis.graphics.alpha = 0.5;\n\t\t\t}\n\t\t} else {\n\t\t\tif (this.hovering || this.component.inSelectionArea) {\n\t\t\t\tthis.graphics.alpha = 0.5;\n\t\t\t} else {\n\t\t\t\tthis.graphics.alpha = 0;\n\t\t\t}\n\t\t}\n\t}\n}\n","import {default as Widget, defaultWidgetDistance, centerWidgetRadius} from './widget';\nimport Vector from '../../util/vector';\nimport { scene } from '../../core/scene'\n\nconst MIN_SCALE = 0.1;\n\nexport default class ScaleWidget extends Widget {\n\tconstructor(component, scaleX, scaleY) {\n\t\tsuper({\n\t\t\tcomponent,\n\t\t\trelativePosition: new Vector(scaleX, -scaleY).multiplyScalar(defaultWidgetDistance)\n\t\t});\n\t}\n\n\tupdatePosition() {\n\t\tlet T = this.component.Transform;\n\t\tlet globalAngle = T.getGlobalAngle();\n\t\tlet globalPosition = T.getGlobalPosition();\n\t\t\n\t\tlet pos = this.relativePosition.clone().multiplyScalar(1 / scene.cameraZoom).rotate(globalAngle).add(globalPosition);\n\t\tthis.x = pos.x;\n\t\tthis.y = pos.y;\n\n\t\tif (this.graphics) {\n\t\t\tthis.graphics.position.copy(globalPosition);\n\t\t\tthis.graphics.rotation = globalAngle;\n\t\t}\n\t}\n\n\tcreateGraphics() {\n\t\tconst RECT_SIDE = this.r * 1.9;\n\t\tlet lineStart = this.relativePosition.clone().setLength(centerWidgetRadius);\n\t\tlet lineEnd = this.relativePosition.clone().setLength(this.relativePosition.length() * (1 - RECT_SIDE/2 / defaultWidgetDistance) * 1.01); // Yes, 1.01 looks better\n\n\t\tlet graphics = new PIXI.Graphics();\n\n\t\tgraphics.lineStyle(2, 0x000000, 1);\n\t\tgraphics.moveTo(lineEnd.x + 1, lineEnd.y + 1);\n\t\tgraphics.lineTo(lineStart.x + 1, lineStart.y + 1);\n\t\tgraphics.lineStyle(0, 0x000000, 1);\n\t\t\n\t\tgraphics.beginFill(0x000000, 1);\n\t\tgraphics.drawRect(this.relativePosition.x - RECT_SIDE/2 + 1, this.relativePosition.y - RECT_SIDE/2 + 1, RECT_SIDE, RECT_SIDE);\n\t\tgraphics.endFill();\n\n\t\tgraphics.lineStyle(2, 0xFFFFFF, 1);\n\t\tgraphics.moveTo(lineEnd.x, lineEnd.y);\n\t\tgraphics.lineTo(lineStart.x, lineStart.y);\n\t\tgraphics.lineStyle(0, 0x000000, 1);\n\n\t\tgraphics.beginFill(0xFFFFFF, 1);\n\t\tgraphics.drawRect(this.relativePosition.x - RECT_SIDE/2, this.relativePosition.y - RECT_SIDE/2, RECT_SIDE, RECT_SIDE);\n\t\tgraphics.endFill();\n\t\t\n\t\treturn graphics;\n\t}\n\n\tonDrag(mousePosition, mousePositionChange, affectedEntities) {\n\t\t// Master entity is the entity whose widget we are dragging.\n\t\t// If parent and child entity are selected and we are dragging child widget, masterEntity is the parent.\n\t\tlet masterEntity = this.component.entity;\n\t\twhile (!affectedEntities.find(ent => ent === masterEntity)) {\n\t\t\tmasterEntity = masterEntity.getParent();\n\t\t\tif (!masterEntity || masterEntity.threeLetterType !== 'ent') {\n\t\t\t\tassert('Master entity not found when editing angle of entity.');\n\t\t\t}\n\t\t}\n\n\t\tlet entityGlobalPosition = masterEntity.getComponent('Transform').getGlobalPosition();\n\t\t\n\t\tlet oldMousePosition = mousePosition.clone().subtract(mousePositionChange);\n\t\tlet widgetPosition = Vector.fromObject(this);\n\n\t\tlet relativeWidgetPosition = widgetPosition.clone().subtract(entityGlobalPosition);\n\t\tlet relativeMousePosition = mousePosition.clone().subtract(entityGlobalPosition);\n\t\tlet relativeOldMousePosition = oldMousePosition.subtract(entityGlobalPosition);\n\n\t\tlet mousePositionValue = relativeWidgetPosition.dot(relativeMousePosition) / relativeWidgetPosition.lengthSq();\n\t\tlet oldMousePositionValue = relativeWidgetPosition.dot(relativeOldMousePosition) / relativeWidgetPosition.lengthSq();\n\n\t\tlet change = mousePositionValue - oldMousePositionValue;\n\n\t\tlet changeDirection = this.relativePosition.clone().multiply(new Vector(1, -1)).normalize();\n\n\t\tlet changeVector = new Vector(1, 1).add(changeDirection.multiplyScalar(change / Math.max(1, Math.pow(mousePositionValue, 1))));\n\n\t\taffectedEntities.forEach(entity => {\n\t\t\tlet Transform = entity.getComponent('Transform');\n\t\t\tlet newScale = Transform.scale.clone().multiply(changeVector);\n\t\t\tif (newScale.x < MIN_SCALE)\n\t\t\t\tnewScale.x = MIN_SCALE;\n\t\t\tif (newScale.y < MIN_SCALE)\n\t\t\t\tnewScale.y = MIN_SCALE;\n\t\t\tTransform.scale = newScale;\n\t\t});\n\t}\n\n}\n","import {default as Widget, defaultWidgetDistance, centerWidgetRadius} from './widget';\nimport Vector from '../../util/vector';\nimport {scene} from '../../core/scene'\n\nconst MIN_SCALE = 0.1;\n\nexport default class MoveWidget extends Widget {\n\tconstructor(component, directionX, directionY, globalCoordinates) {\n\t\tsuper({\n\t\t\tcomponent,\n\t\t\trelativePosition: new Vector(directionX, -directionY).multiplyScalar(defaultWidgetDistance)\n\t\t});\n\t\tthis.globalCoordinates = globalCoordinates;\n\t}\n\n\tupdatePosition() {\n\t\tlet T = this.component.Transform;\n\t\tlet globalAngle = T.getGlobalAngle();\n\t\tlet globalPosition = T.getGlobalPosition();\n\t\t\n\t\tlet pos = this.relativePosition.clone().multiplyScalar(1 / scene.cameraZoom).rotate(this.globalCoordinates ? 0 : globalAngle).add(globalPosition);\n\t\tthis.x = pos.x;\n\t\tthis.y = pos.y;\n\n\t\tif (this.graphics) {\n\t\t\tthis.graphics.position.copy(globalPosition);\n\t\t\tif (!this.globalCoordinates)\n\t\t\t\tthis.graphics.rotation = globalAngle;\n\t\t}\n\t}\n\n\tcreateGraphics() {\n\t\tconst ARROW_SIZE = 1.2;\n\t\t\n\t\tlet arrowTail = this.relativePosition.clone().setLength(centerWidgetRadius);\n\t\tlet arrowHead = this.relativePosition.clone().setLength(this.relativePosition.length() + this.r * ARROW_SIZE);\n\t\tlet arrowHeadBack = this.relativePosition.clone().setLength(this.relativePosition.length() - this.r * 0.5 * ARROW_SIZE);\n\t\tlet arrowWing = this.relativePosition.clone().setLength(this.r * ARROW_SIZE).multiplyScalar(-1);\n\t\tlet arrowWing1 = arrowWing.clone().rotate(1).add(this.relativePosition);\n\t\tlet arrowWing2 = arrowWing.clone().rotate(-1).add(this.relativePosition);\n\n\t\tlet graphics = new PIXI.Graphics();\n\t\t\n\t\tlet arrowPoints = [arrowHead, arrowWing1, arrowWing2];\n\t\t\n\t\tgraphics.lineStyle(2, 0x000000, 1);\n\t\tgraphics.moveTo(arrowHeadBack.x + 1, arrowHeadBack.y + 1);\n\t\tgraphics.lineTo(arrowTail.x + 1, arrowTail.y + 1);\n\t\tgraphics.lineStyle(0, 0x000000, 1);\n\n\t\tgraphics.beginFill(0x000000, 1);\n\t\tgraphics.drawPolygon(arrowPoints.map(vec => new PIXI.Point(vec.x + 1, vec.y + 1)));\n\t\tgraphics.endFill();\n\n\t\tgraphics.lineStyle(2, 0xFFFFFF, 1);\n\t\tgraphics.moveTo(arrowHeadBack.x, arrowHeadBack.y);\n\t\tgraphics.lineTo(arrowTail.x, arrowTail.y);\n\t\tgraphics.lineStyle(0, 0x000000, 1);\n\n\t\tgraphics.beginFill(0xFFFFFF, 1);\n\t\tgraphics.drawPolygon(arrowPoints.map(vec => new PIXI.Point(vec.x, vec.y)));\n\t\tgraphics.endFill();\n\t\t\n\t\treturn graphics;\n\t}\n\n\tonDrag(mousePosition, mousePositionChange, affectedEntities) {\n\t\t// Master entity is the entity whose widget we are dragging.\n\t\t// If parent and child entity are selected and we are dragging child widget, masterEntity is the parent.\n\t\tlet masterEntity = this.component.entity;\n\t\twhile (!affectedEntities.find(ent => ent === masterEntity)) {\n\t\t\tmasterEntity = masterEntity.getParent();\n\t\t\tif (!masterEntity || masterEntity.threeLetterType !== 'ent') {\n\t\t\t\tassert('Master entity not found when editing angle of entity.');\n\t\t\t}\n\t\t}\n\t\t\n\t\tlet rotatedRelativePosition = this.relativePosition.clone();\n\t\tif (!this.globalCoordinates)\n\t\t\trotatedRelativePosition.rotate(masterEntity.getComponent('Transform').getGlobalAngle());\n\t\t\n\t\tlet moveVector = mousePositionChange.getProjectionOn(rotatedRelativePosition);\n\t\taffectedEntities.forEach(entity => {\n\t\t\tlet Transform = entity.getComponent('Transform');\n\t\t\tTransform.setGlobalPosition(Transform.getGlobalPosition().add(moveVector));\n\t\t});\n\t}\n}\n","import {Component, Prop} from '../../core/component';\nimport Widget from '../widget/widget';\nimport AngleWidget from '../widget/angleWidget';\nimport PositionWidget from '../widget/positionWidget';\nimport ScaleWidget from '../widget/scaleWidget';\nimport MoveWidget from '../widget/moveWidget';\nimport events from \"../../util/events\";\nimport {selectedToolName} from \"../editor\";\n\nlet primaryColor = 'white';\nlet hoverColor = 'yellow';\nlet secondaryColor = 'rgb(200, 200, 200)';\nlet radius = 10;\nlet smallR = 5;\nlet widgetDistance = 30;\nlet squared2 = Math.sqrt(2);\nlet aabbSize = widgetDistance + smallR;\n\n/*\nHow mouse interaction works?\n\nHovering:\n- Scene module: find widgetUnderMouse, call widgetUnderMouse.hover() and widgetUnderMouse.unhover()\n\nSelection:\n- Scene module: if widgetUnderMouse is clicked, call editorWidget.select() and editorWidget.deselect()\n\nDragging:\n- Scene module: entitiesToEdit.onDrag()\n\n */\n\n// Export so that other components can have this component as parent\nexport default Component.register({\n\tname: 'EditorWidget',\n\tcategory: 'Editor', // You can also make up new categories.\n\ticon: 'fa-bars', // Font Awesome id\n\tproperties: [\n\t\t// Prop('selected', false, Prop.bool)\n\t],\n\tprototype: {\n\t\tselected: false, // this entity is selected in editor -> all widgets are visible\n\t\tactiveWidget: null, // widget being dragged\n\t\twidgets: null, // All 5 widgets are always here\n\t\tmouseOnWidget: null, // If mouse is hovering on a visible widget,\n\t\tinSelectionArea: false,\n\n\t\t// Widgets\n\t\txScale: null,\n\t\tyScale: null,\n\t\tscale: null,\n\t\tangle: null,\n\t\tposition: null,\n\n\t\tlisteners: null,\n\n\t\tpositionHelper: null,\n\n\t\tconstructor() {\n\t\t\t// this.createWidgets();\n\t\t\t\n\t\t\t\n\t\t\t// this.widgets = [\n\t\t\t// \tthis.position = new PositionWidget(this),\n\t\t\t// \tthis.xScale = new ScaleWidget(this, 1, 0),\n\t\t\t// \tthis.yScale = new ScaleWidget(this, 0, 1),\n\t\t\t// \tthis.scale = new ScaleWidget(this, 1, 1),\n\t\t\t// \tthis.angle = new AngleWidget(this)\n\t\t\t// ];\n\t\t\t// return;\n\t\t\t\n\t\t\tthis.createWidgets();\n\t\t\tevents.listen('selectedToolChanged', () => {\n\t\t\t\tthis.createWidgets();\n\t\t\t});\n\t\t},\n\t\tcreateWidgets() {\n\t\t\tlet positionWasInited = this.position && this.position.graphics;\n\t\t\t\n\t\t\tif (this.widgets) {\n\t\t\t\tthis.widgets.forEach(widget => widget.delete());\n\t\t\t\tthis.widgets = null;\n\t\t\t\tthis.position = null;\n\t\t\t}\n\t\t\t\n\t\t\tif (selectedToolName === 'multiTool') {\n\t\t\t\tthis.widgets = [\n\t\t\t\t\tthis.position = new PositionWidget(this),\n\t\t\t\t\tnew ScaleWidget(this, 1, 0),\n\t\t\t\t\tnew ScaleWidget(this, 0, 1),\n\t\t\t\t\tnew ScaleWidget(this, 1, 1),\n\t\t\t\t\tnew AngleWidget(this)\n\t\t\t\t];\n\t\t\t} else if (selectedToolName === 'globalMoveTool') {\n\t\t\t\tthis.widgets = [\n\t\t\t\t\tthis.position = new PositionWidget(this),\n\t\t\t\t\tnew MoveWidget(this, 1, 0, 1),\n\t\t\t\t\tnew MoveWidget(this, 0, 1, 1)\n\t\t\t\t];\n\t\t\t} else if (selectedToolName === 'localMoveTool') {\n\t\t\t\tthis.widgets = [\n\t\t\t\t\tthis.position = new PositionWidget(this),\n\t\t\t\t\tnew MoveWidget(this, 1, 0, 0),\n\t\t\t\t\tnew MoveWidget(this, 0, 1, 0),\n\t\t\t\t\tnew AngleWidget(this)\n\t\t\t\t];\n\t\t\t} else {\n\t\t\t\tthrow new Error('selectedToolName invalid: ' + selectedToolName);\n\t\t\t}\n\t\t\t\n\t\t\tif (this.entity && !this.entity.sleeping) {\n\t\t\t\tif (positionWasInited)\n\t\t\t\t\tthis.position.init();\n\t\t\t\t\n\t\t\t\tif (this.selected) {\n\t\t\t\t\tthis.deselect();\n\t\t\t\t\tthis.select();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tselect() {\n\t\t\tif (!this.selected) {\n\t\t\t\tthis.selected = true;\n\t\t\t\t\n\t\t\t\t// Skip position widget\n\t\t\t\tfor (let i = 1; i < this.widgets.length; ++i) {\n\t\t\t\t\tthis.widgets[i].init();\n\t\t\t\t}\n\t\t\t\tfor (let i = 0; i < this.widgets.length; ++i) {\n\t\t\t\t\tthis.widgets[i].updateVisibility();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tdeselect() {\n\t\t\tif (this.selected) {\n\t\t\t\tthis.selected = false;\n\t\t\t\tfor (let i = 1; i < this.widgets.length; ++i) {\n\t\t\t\t\tthis.widgets[i].sleep();\n\t\t\t\t}\n\t\t\t\tfor (let i = 0; i < this.widgets.length; ++i) {\n\t\t\t\t\tthis.widgets[i].updateVisibility();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tupdateWidgets() {\n\t\t\tfor (let i = 0; i < this.widgets.length; ++i) {\n\t\t\t\tthis.widgets[i].updatePosition();\n\t\t\t}\n\t\t},\n\t\tinit() {\n\t\t\tthis.listeners = [];\n\t\t\t\n\t\t\tlet positionListener = () => {\n\t\t\t\tif (this.scene.playing) {\n\t\t\t\t\tthis.requiresWidgetUpdate = true;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.positionHelper.position.copy(this.Transform.getGlobalPosition());\n\n\t\t\t\tthis.updateWidgets();\n\t\t\t};\n\t\t\tlet angleListener = () => {\n\t\t\t\tif (this.scene.playing) {\n\t\t\t\t\tthis.requiresWidgetUpdate = true;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.updateWidgets();\n\t\t\t};\n\n\t\t\tthis.listenProperty(this.Transform, 'position', positionListener);\n\t\t\tthis.listenProperty(this.Transform, 'angle', angleListener);\n\t\t\tthis.listeners.push(this.Transform.listen('globalTransformChanged', positionListener));\n\n\t\t\tthis.listeners.push(this.scene.listen('pause', () => {\n\t\t\t\tif (this.requiresWidgetUpdate) {\n\t\t\t\t\tthis.positionHelper.position.copy(this.Transform.getGlobalPosition());\n\t\t\t\t\tthis.updateWidgets();\n\t\t\t\t\tthis.requiresWidgetUpdate = false;\n\t\t\t\t}\n\t\t\t}));\n\t\t\t\n\t\t\t\n\t\t\tif (this.position)\n\t\t\t\tthis.position.init();\n\n\t\t\tthis.positionHelper = new PIXI.Graphics();\n\t\t\tthis.positionHelper.beginFill(0xFFFFFF);\n\t\t\tthis.positionHelper.drawCircle(0, 0, 2.7);\n\t\t\tthis.positionHelper.endFill();\n\t\t\tthis.positionHelper.beginFill(0x000000);\n\t\t\tthis.positionHelper.drawCircle(0, 0, 1.3);\n\t\t\tthis.positionHelper.endFill();\n\t\t\tthis.positionHelper.position.copy(this.Transform.getGlobalPosition());\n\t\t\tthis.scene.positionHelperLayer.addChild(this.positionHelper);\n\n\t\t\tthis.listeners.push(this.scene.listen('zoomChange', () => this.updateZoomLevel()));\n\t\t\tthis.updateZoomLevel();\n\n\t\t\tthis.updateWidgets();\n\t\t},\n\n\t\tupdateZoomLevel() {\n\t\t\tlet invZoom = 1 / this.scene.cameraZoom;\n\t\t\tthis.positionHelper.scale.set(invZoom, invZoom);\n\n\t\t\tthis.widgets.forEach(w => {\n\t\t\t\tw.graphics && w.graphics.scale.set(invZoom, invZoom);\n\t\t\t});\n\n\t\t\tthis.updateWidgets();\n\t\t},\n\n\t\tsleep() {\n\t\t\t// this.selected = true; // Didn't know why this should be set to true\n\t\t\tthis.widgets.forEach(widget => {\n\t\t\t\twidget.sleep();\n\t\t\t});\n\n\t\t\tthis.listeners.forEach(listener => listener());\n\t\t\tthis.listeners = null;\n\n\t\t\tthis.positionHelper.destroy();\n\t\t\tthis.positionHelper = null;\n\t\t},\n\t\tdelete() {\n\t\t\tthis.widgets.forEach(widget => {\n\t\t\t\twidget.delete();\n\t\t\t});\n\t\t\tthis.widgets.length = 0;\n\t\t\tthis.position = null;\n\t\t}\n\t}\n});\n","import {el, list, mount} from 'redom';\nimport Module from './module';\nimport events, {dispatch, listen} from '../../util/events';\nimport {\n\tlistenMouseMove,\n\tlistenMouseDown,\n\tlistenMouseUp,\n\tlistenKeyDown,\n\tlistenKeyUp,\n\tkey,\n\tkeyPressed\n} from '../../util/input';\nimport Scene, {scene} from '../../core/scene';\nimport {game} from '../../core/game';\nimport EntityPrototype from '../../core/entityPrototype';\nimport ComponentData from '../../core/componentData';\nimport assert from '../../util/assert';\nimport Entity from '../../core/entity';\nimport {Component} from '../../core/component';\nimport {editor} from '../editor';\nimport {changeType, setChangeOrigin} from '../../core/serializableManager';\nimport * as sceneEdit from '../util/sceneEditUtil';\nimport Vector from '../../util/vector';\nimport {removeTheDeadFromArray, absLimit} from '../../util/algorithm';\nimport {help} from '../help';\nimport PIXI from '../../features/graphics';\nimport * as performanceTool from '../../util/performance';\nimport {enableAllChanges, filterSceneChanges, disableAllChanges} from '../../core/property';\n\nimport '../components/EditorWidget';\nimport {filterChildren} from \"../../core/serializable\";\nimport {limit} from \"../../util/callLimiter\";\n\nconst MOVEMENT_KEYS = [key.w, key.a, key.s, key.d, key.up, key.left, key.down, key.right, key.plus, key.minus, key.questionMark, key.q, key.e];\nconst MIN_ZOOM = 0.1;\nconst MAX_ZOOM = 10;\n\nclass SceneModule extends Module {\n\tconstructor() {\n\t\tlet canvas,\n\t\t\thomeButton,\n\t\t\tglobeButton,\n\t\t\tcopyButton,\n\t\t\tdeleteButton,\n\t\t\tsceneContextButtons;\n\n\t\tlet disableMouseDown = e => {\n\t\t\te.returnValue = false;\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t\treturn false;\n\t\t};\n\n\t\tsuper(\n\t\t\tcanvas = el('canvas.openEditPlayCanvas.select-none', {\n\t\t\t\t// width and height will be fixed after loading\n\t\t\t\twidth: 0,\n\t\t\t\theight: 0\n\t\t\t}),\n\t\t\tel('div.pauseInfo', `Paused. Editing objects will not affect the level.`),\n\t\t\tel('i.fa.fa-pause.pauseInfo.topLeft'),\n\t\t\tel('i.fa.fa-pause.pauseInfo.topRight'),\n\t\t\tel('i.fa.fa-pause.pauseInfo.bottomLeft'),\n\t\t\tel('i.fa.fa-pause.pauseInfo.bottomRight'),\n\t\t\tel('div.sceneEditorSideBarButtons',\n\t\t\t\tel('i.fa.fa-arrows.iconButton.button.movement', {\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\talert('Move in editor with arrow keys or WASD');\n\t\t\t\t\t},\n\t\t\t\t\ttitle: 'Move in editor with arrow keys or WASD'\n\t\t\t\t}),\n\t\t\t\tel('i.fa.fa-plus-circle.iconButton.button.zoomIn', {\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tif (!scene) return;\n\t\t\t\t\t\tscene.setZoom(Math.min(MAX_ZOOM, scene.cameraZoom * 1.4));\n\t\t\t\t\t\tthis.cameraPositionOrZoomUpdated();\n\t\t\t\t\t\tthis.draw();\n\t\t\t\t\t},\n\t\t\t\t\ttitle: 'Zoom in (+)'\n\t\t\t\t}),\n\t\t\t\tel('i.fa.fa-minus-circle.iconButton.button.zoomOut', {\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tif (!scene) return;\n\t\t\t\t\t\tscene.setZoom(Math.max(MIN_ZOOM, scene.cameraZoom / 1.4));\n\t\t\t\t\t\tthis.cameraPositionOrZoomUpdated();\n\t\t\t\t\t\tthis.draw();\n\t\t\t\t\t},\n\t\t\t\t\ttitle: 'Zoom out (-)'\n\t\t\t\t}),\n\t\t\t\tglobeButton = el('i.fa.fa-globe.iconButton.button', {\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tif (!scene) return;\n\n\t\t\t\t\t\tlet bounds = scene.layers.move.getLocalBounds();\n\n\t\t\t\t\t\tscene.cameraPosition.setScalars(\n\t\t\t\t\t\t\tbounds.x + bounds.width / 2,\n\t\t\t\t\t\t\tbounds.y + bounds.height / 2\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tlet maxXZoom = this.canvas.width / bounds.width;\n\t\t\t\t\t\tlet maxYZoom = this.canvas.height / bounds.height;\n\t\t\t\t\t\tscene.setZoom(Math.min(Math.min(maxXZoom, maxYZoom) * 0.9, 1));\n\t\t\t\t\t\tthis.cameraPositionOrZoomUpdated();\n\n\t\t\t\t\t\tthis.draw();\n\t\t\t\t\t},\n\t\t\t\t\ttitle: 'Zoom to globe (G)'\n\t\t\t\t}),\n\t\t\t\thomeButton = el('i.fa.fa-home.iconButton.button', {\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tif (!scene) return;\n\t\t\t\t\t\tscene.cameraPosition.setScalars(0, 0); // If there are no players\n\t\t\t\t\t\tscene.setCameraPositionToPlayer();\n\t\t\t\t\t\tscene.setZoom(1);\n\t\t\t\t\t\tthis.cameraPositionOrZoomUpdated();\n\t\t\t\t\t\tthis.draw();\n\t\t\t\t\t},\n\t\t\t\t\ttitle: 'Go home to player or to default start position (H)'\n\t\t\t\t}),\n\t\t\t\tsceneContextButtons = el('div.sceneContextButtons',\n\t\t\t\t\tcopyButton = el('i.fa.fa-copy.iconButton.button', {\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tif (this.selectedEntities.length > 0) {\n\t\t\t\t\t\t\t\tthis.deleteNewEntities();\n\t\t\t\t\t\t\t\tthis.newEntities.push(...this.selectedEntities.map(e => e.clone()));\n\t\t\t\t\t\t\t\tthis.copyEntities(this.newEntities);\n\t\t\t\t\t\t\t\tthis.clearSelectedEntities();\n\t\t\t\t\t\t\t\tsceneEdit.setEntityPositions(this.newEntities, this.previousMousePosInWorldCoordinates);\n\t\t\t\t\t\t\t\tthis.draw();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonmousedown: disableMouseDown,\n\t\t\t\t\t\ttitle: 'Copy selected objects (C)'\n\t\t\t\t\t}),\n\t\t\t\t\tdeleteButton = el('i.fa.fa-trash.iconButton.button', {\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tsceneEdit.deleteEntities(this.selectedEntities);\n\t\t\t\t\t\t\tthis.clearState();\n\t\t\t\t\t\t\tthis.draw();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonmousedown: disableMouseDown,\n\t\t\t\t\t\ttitle: 'Delete selected objects (Backspace)'\n\t\t\t\t\t})\n\t\t\t\t)\n\t\t\t)\n\t\t);\n\t\tthis.el.classList.add('hideScenePauseInformation');\n\t\tthis.canvas = canvas;\n\t\tthis.homeButton = homeButton;\n\t\tthis.globeButton = globeButton;\n\t\tthis.copyButton = copyButton;\n\t\tthis.deleteButton = deleteButton;\n\t\tthis.sceneContextButtons = sceneContextButtons;\n\n\t\tevents.listen('locate serializable', serializable => {\n\t\t\tif (serializable.threeLetterType === 'epr') {\n\t\t\t\tlet entityPrototype = serializable;\n\t\t\t\tif (entityPrototype.previouslyCreatedEntity) {\n\t\t\t\t\tlet globalPosition = entityPrototype.previouslyCreatedEntity.getComponent('Transform').getGlobalPosition();\n\t\t\t\t\tthis.goToLocation(globalPosition);\n\t\t\t\t} else {\n\t\t\t\t\tthis.goToLocation(entityPrototype.position);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tevents.listen('selectedToolChanged', () => {\n\t\t\tif (this.widgetUnderMouse) {\n\t\t\t\tthis.widgetUnderMouse.unhover();\n\t\t\t\tthis.widgetUnderMouse = null;\n\t\t\t}\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.draw();\n\t\t\t}, 0);\n\t\t});\n\n\t\tlet fixAspectRatio = () => this.fixAspectRatio();\n\n\t\twindow.addEventListener(\"resize\", fixAspectRatio);\n\t\tevents.listen('layoutResize', () => {\n\t\t\tsetTimeout(fixAspectRatio, 500);\n\t\t});\n\t\tsetTimeout(fixAspectRatio, 0);\n\n\t\tthis.id = 'scene';\n\t\tthis.name = 'Scene';\n\n\t\tObject.defineProperty(help, 'sceneModule', {\n\t\t\tget: () => this\n\t\t});\n\n\t\t/*\n\t\t loadedPromise.then(() => {\n\t\t if (editor.selectedLevel)\n\t\t editor.selectedLevel.createScene();\n\t\t else\n\t\t this.drawNoLevel();\n\t\t });\n\t\t */\n\n\t\tthis.copiedEntities = []; // Press 'v' to clone these to newEntities. copiedEntities are sleeping.\n\t\tthis.newEntities = []; // New entities are not in tree. This is the only link to them and their entityPrototype.\n\t\tthis.widgetUnderMouse = null; // Link to a widget (not EditorWidget but widget that EditorWidget contains)\n\t\tthis.previousMousePosInWorldCoordinates = null;\n\t\tthis.previousMousePosInMouseCoordinates = null;\n\n\t\tthis.entitiesToEdit = []; // A widget is editing these entities when mouse is held down.\n\t\tthis.selectedEntities = [];\n\n\t\tthis.editorCameraPosition = new Vector(0, 0);\n\t\tthis.editorCameraZoom = 1;\n\n\t\tthis.selectionStart = null;\n\t\tthis.selectionEnd = null;\n\t\tthis.selectionArea = null;\n\t\tthis.entitiesInSelection = [];\n\n\t\tevents.listen('reset', () => {\n\t\t\tsetChangeOrigin(this);\n\t\t\tthis.stopAndReset();\n\n\t\t\tif (scene.editorLayer)\n\t\t\t\tscene.editorLayer.visible = true;\n\t\t});\n\n\t\tevents.listen('play', () => {\n\t\t\tif (!scene || !scene.level)\n\t\t\t\treturn;\n\n\t\t\tsetChangeOrigin(this);\n\t\t\tthis.clearState();\n\n\t\t\tif (scene.isInInitialState())\n\t\t\t\tscene.setZoom(1);\n\n\t\t\tscene.editorLayer.visible = false;\n\t\t\tscene.play();\n\t\t\tthis.playingModeChanged();\n\t\t\tthis.updatePropertyChangeCreationFilter();\n\t\t});\n\n\t\tevents.listen('pause', () => {\n\t\t\tif (!scene || !scene.level)\n\t\t\t\treturn;\n\n\t\t\tsetChangeOrigin(this);\n\t\t\tthis.clearState();\n\n\t\t\tif (scene.isInInitialState())\n\t\t\t\tscene.setZoom(1);\n\n\t\t\tscene.editorLayer.visible = true;\n\t\t\tscene.pause();\n\n\t\t\tthis.draw();\n\t\t\tthis.playingModeChanged();\n\t\t\tthis.updatePropertyChangeCreationFilter();\n\t\t});\n\t\t/*\n\t\t\t\tthis.primaryButton = new TopButton({\n\t\t\t\t\ttext: el('span', el('u', 'P'), 'lay'),\n\t\t\t\t\ticonClass: 'fa-play',\n\t\t\t\t\tcallback: btn => {\n\t\t\t\t\t\tif (!scene || !scene.level)\n\t\t\t\t\t\t\treturn;\n\t\t\n\t\t\t\t\t\tsetChangeOrigin(this);\n\t\t\n\t\t\t\t\t\t// this.makeSureSceneHasEditorLayer();\n\t\t\n\t\t\t\t\t\tthis.clearState();\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (scene.isInInitialState())\n\t\t\t\t\t\t\tscene.setZoom(1);\n\t\t\n\t\t\t\t\t\tif (scene.playing) {\n\t\t\t\t\t\t\tscene.editorLayer.visible = true;\n\t\t\t\t\t\t\tscene.pause();\n\t\t\t\t\t\t\tthis.draw();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tscene.editorLayer.visible = false;\n\t\t\t\t\t\t\tscene.play();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.playingModeChanged();\n\t\t\t\t\t\tthis.updatePropertyChangeCreationFilter();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthis.stopButton = new TopButton({\n\t\t\t\t\ttext: el('span', el('u', 'R'), 'eset'),\n\t\t\t\t\ticonClass: 'fa-stop',\n\t\t\t\t\tcallback: btn => {\n\t\t\t\t\t\tsetChangeOrigin(this);\n\t\t\t\t\t\tthis.stopAndReset();\n\t\t\n\t\t\t\t\t\tif (scene.editorLayer)\n\t\t\t\t\t\t\tscene.editorLayer.visible = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\t*/\n\n\t\tgame.listen('levelCompleted', () => {\n\t\t\tthis.playingModeChanged();\n\t\t\tthis.draw();\n\t\t});\n\n\t\tevents.listen('setLevel', lvl => {\n\t\t\tif (lvl)\n\t\t\t\tlvl.createScene(false);\n\t\t\telse if (scene) {\n\t\t\t\tscene.delete();\n\t\t\t}\n\n\t\t\tthis.playingModeChanged();\n\n\t\t\tthis.clearState();\n\t\t\tthis.draw();\n\t\t});\n\n\t\tevents.listen('scene load level before entities', (scene, level) => {\n\t\t\tassert(!scene.editorLayer, 'editorLayer should not be there');\n\n\t\t\tscene.editorLayer = new PIXI.Container();\n\t\t\tscene.layers.move.addChild(scene.editorLayer);\n\n\t\t\tscene.widgetLayer = new PIXI.Container();\n\t\t\tscene.positionHelperLayer = new PIXI.Container();\n\t\t\tscene.selectionLayer = new PIXI.Container();\n\n\t\t\tscene.editorLayer.addChild(\n\t\t\t\tscene.widgetLayer,\n\t\t\t\tscene.positionHelperLayer,\n\t\t\t\tscene.selectionLayer\n\t\t\t);\n\t\t});\n\t\tevents.listen('scene unload level', (scene, level) => {\n\t\t\tassert(scene.editorLayer, 'editorLayer should be there');\n\t\t\tdelete scene.editorLayer; // No need to destroy. Scene does it already.\n\t\t});\n\n\t\t// Change in serializable tree\n\t\tevents.listen('prototypeClicked', prototype => {\n\t\t\tif (!scene)\n\t\t\t\treturn;\n\n\t\t\tperformanceTool.start('Editor: Scene');\n\n\t\t\tthis.clearState();\n\n\t\t\t/*\n\t\t\t let entityPrototype = EntityPrototype.createFromPrototype(prototype, []);\n\t\t\t entityPrototype.position = new Vector(this.canvas.width/2, this.canvas.height/2);\n\t\t\t let newEntity = entityPrototype.createEntity(this);\n\t\t\t this.newEntities.push(newEntity);\n\t\t\t */\n\n\t\t\tthis.draw();\n\n\t\t\tperformanceTool.stop('Editor: Scene');\n\t\t});\n\t\t\n\t\tevents.listen('new entity created', entity => {\n\t\t\tlet handleEntity = entity => {\n\t\t\t\tentity.addComponents([\n\t\t\t\t\tComponent.create('EditorWidget')\n\t\t\t\t]);\n\t\t\t\tlet transform = entity.getComponent('Transform');\n\t\t\t\ttransform._properties.position.listen('change', position => {\n\t\t\t\t\tif (sceneEdit.shouldSyncLevelAndScene()) {\n\t\t\t\t\t\tlet entityPrototype = entity.prototype;\n\t\t\t\t\t\tlet entityPrototypeTransform = entityPrototype.getTransform();\n\t\t\t\t\t\tsceneEdit.setOrCreateTransformDataPropertyValue(entityPrototypeTransform, transform, 'position', '_p', (a, b) => a.isEqualTo(b));\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\ttransform._properties.scale.listen('change', scale => {\n\t\t\t\t\tif (sceneEdit.shouldSyncLevelAndScene()) {\n\t\t\t\t\t\tlet entityPrototype = entity.prototype;\n\t\t\t\t\t\tlet entityPrototypeTransform = entityPrototype.getTransform();\n\t\t\t\t\t\tsceneEdit.setOrCreateTransformDataPropertyValue(entityPrototypeTransform, transform, 'scale', '_s', (a, b) => a.isEqualTo(b));\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\ttransform._properties.angle.listen('change', angle => {\n\t\t\t\t\tif (sceneEdit.shouldSyncLevelAndScene()) {\n\t\t\t\t\t\tlet entityPrototype = entity.prototype;\n\t\t\t\t\t\tlet entityPrototypeTransform = entityPrototype.getTransform();\n\t\t\t\t\t\tsceneEdit.setOrCreateTransformDataPropertyValue(entityPrototypeTransform, transform, 'angle', '_a', (a, b) => a === b);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t};\n\n\t\t\thandleEntity(entity);\n\t\t\tentity.forEachChild('ent', handleEntity, true);\n\t\t});\n\n\t\tevents.listen('change', change => {\n\t\t\tperformanceTool.start('Editor: Scene');\n\n\t\t\tif (change.type === 'editorSelection') {\n\t\t\t\tthis.updatePropertyChangeCreationFilter();\n\t\t\t\tif (change.reference.type === 'epr') {\n\t\t\t\t\tthis.clearSelectedEntities();\n\t\t\t\t\tlet idSet = new Set(change.reference.items.map(item => item.id));\n\t\t\t\t\tlet entities = [];\n\t\t\t\t\tscene.forEachChild('ent', ent => {\n\t\t\t\t\t\tif (idSet.has(ent.prototype.id)) {\n\t\t\t\t\t\t\tentities.push(ent);\n\t\t\t\t\t\t}\n\t\t\t\t\t}, true);\n\t\t\t\t\tthis.selectEntities(entities);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (scene && scene.resetting)\n\t\t\t\treturn performanceTool.stop('Editor: Scene');\n\n\t\t\t// console.log('sceneModule change', change);\n\t\t\tif (change.origin !== this) {\n\t\t\t\tsetChangeOrigin(this);\n\t\t\t\tsceneEdit.syncAChangeBetweenSceneAndLevel(change);\n\t\t\t\tthis.draw();\n\t\t\t}\n\t\t\tperformanceTool.stop('Editor: Scene');\n\t\t});\n\n\t\tthis.zoomInButtonPressed = false;\n\n\t\tlistenKeyDown(k => {\n\t\t\tif (!scene)\n\t\t\t\treturn;\n\n\t\t\tsetChangeOrigin(this);\n\t\t\tif (k === key.esc) {\n\t\t\t\tthis.clearState();\n\t\t\t\tthis.draw();\n\t\t\t} else if (k === key.backspace) {\n\t\t\t\tthis.deleteButton.click();\n\t\t\t} else if (k === key.c) {\n\t\t\t\tthis.copyButton.click();\n\t\t\t} else if (k === key.v) {\n\t\t\t\tthis.pasteEntities();\n\t\t\t\tthis.draw();\n\t\t\t} else if (scene) {\n\t\t\t\t// Scene controls\n\t\t\t\tif (k === key['0']) {\n\t\t\t\t\tscene.setZoom(1);\n\t\t\t\t\tthis.cameraPositionOrZoomUpdated();\n\t\t\t\t\tthis.draw();\n\t\t\t\t} else if (MOVEMENT_KEYS.includes(k)) {\n\t\t\t\t\tif (k === key.plus || k === key.questionMark || k === key.e)\n\t\t\t\t\t\tthis.zoomInButtonPressed = true;\n\n\t\t\t\t\tthis.startListeningMovementInput();\n\t\t\t\t} else if (!scene.playing) {\n\t\t\t\t\tif (k === key.g) {\n\t\t\t\t\t\tthis.globeButton.click();\n\t\t\t\t\t} else if (k === key.h) {\n\t\t\t\t\t\tthis.homeButton.click();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tlistenKeyUp(k => {\n\t\t\tif (k === key.plus || k === key.questionMark || k === key.e)\n\t\t\t\tthis.zoomInButtonPressed = false;\n\t\t});\n\n\t\tlistenMouseMove(this.el, this.onMouseMove.bind(this));\n\t\tlistenMouseDown(this.el, mousePos => {\n\t\t\tif (!scene || !mousePos || scene.playing) // !mousePos if mouse has not moved since refresh\n\t\t\t\treturn;\n\n\t\t\t// this.makeSureSceneHasEditorLayer();\n\n\t\t\tmousePos = scene.mouseToWorld(mousePos);\n\n\t\t\tsetChangeOrigin(this);\n\n\t\t\tif (this.newEntities.length > 0)\n\t\t\t\tsceneEdit.copyEntitiesToScene(this.newEntities);\n\t\t\telse if (this.widgetUnderMouse) {\n\t\t\t\tif (this.selectedEntities.indexOf(this.widgetUnderMouse.component.entity) < 0) {\n\t\t\t\t\tif (!keyPressed(key.shift))\n\t\t\t\t\t\tthis.clearSelectedEntities();\n\t\t\t\t\tthis.selectedEntities.push(this.widgetUnderMouse.component.entity);\n\t\t\t\t\tthis.widgetUnderMouse.component.select();\n\t\t\t\t}\n\t\t\t\tthis.entitiesToEdit.push(...this.selectedEntities);\n\t\t\t\tthis.selectSelectedEntitiesInEditor();\n\t\t\t} else {\n\t\t\t\tthis.clearSelectedEntities();\n\t\t\t\tthis.selectionStart = mousePos;\n\t\t\t\tthis.selectionEnd = mousePos.clone();\n\t\t\t\tthis.destroySelectionArea();\n\t\t\t\tthis.selectionArea = new PIXI.Graphics();\n\t\t\t\tscene.selectionLayer.addChild(this.selectionArea);\n\t\t\t}\n\n\t\t\tthis.updateSceneContextButtonVisibility();\n\n\t\t\tthis.draw();\n\t\t});\n\t\tlistenMouseUp(this.el, (/*mousePos*/) => {\n\t\t\tif (!scene)\n\t\t\t\treturn;\n\t\t\t// mousePos = scene.mouseToWorld(mousePos);\n\n\t\t\tthis.selectionStart = null;\n\t\t\tthis.selectionEnd = null;\n\t\t\tthis.destroySelectionArea();\n\t\t\tthis.entitiesToEdit.length = 0;\n\n\t\t\tif (this.entitiesInSelection.length > 0) {\n\t\t\t\tthis.selectEntities(this.entitiesInSelection);\n\t\t\t\t/*\n\t\t\t\tthis.selectedEntities.push(...this.entitiesInSelection);\n\t\t\t\tthis.entitiesInSelection.forEach(entity => {\n\t\t\t\t\tentity.getComponent('EditorWidget').select();\n\t\t\t\t});\n\t\t\t\t*/\n\n\t\t\t\tsceneEdit.setEntitiesInSelectionArea(this.entitiesInSelection, false);\n\t\t\t\tthis.entitiesInSelection.length = 0;\n\t\t\t\tthis.selectSelectedEntitiesInEditor();\n\t\t\t}\n\n\t\t\tthis.updateSceneContextButtonVisibility();\n\n\t\t\tthis.draw();\n\t\t});\n\n\t\tevents.listen('dragPrefabsStarted', prefabs => {\n\t\t\tthis.newEntities = prefabs.map(pfa => pfa.createEntity());\n\t\t});\n\t\tevents.listen('dragPrototypeStarted', prototypes => {\n\t\t\tlet entityPrototypes = prototypes.map(prototype => {\n\t\t\t\tlet entityPrototype = EntityPrototype.createFromPrototype(prototype, []);\n\t\t\t\t// entityPrototype.position = this.previousMousePosInWorldCoordinates;\n\t\t\t\treturn entityPrototype;\n\t\t\t});\n\n\t\t\t// editor.selectedLevel.addChildren(entityPrototypes);\n\t\t\tthis.newEntities = entityPrototypes.map(epr => epr.createEntity());\n\t\t});\n\t\tlet entityDragEnd = () => {\n\t\t\tlet entitiesInSelection = sceneEdit.copyEntitiesToScene(this.newEntities) || [];\n\t\t\tthis.clearState();\n\t\t\tthis.selectEntities(entitiesInSelection);\n\t\t\tthis.selectSelectedEntitiesInEditor();\n\t\t\tthis.updateSceneContextButtonVisibility();\n\n\t\t\tthis.draw();\n\t\t};\n\t\tevents.listen('dragPrototypeToCanvas', entityDragEnd);\n\t\tevents.listen('dragPrefabsToScene', entityDragEnd);\n\t\t\n\t\tevents.listen('dragPrototypeToNonCanvas', () => {\n\t\t\tthis.clearState();\n\t\t});\n\t\tevents.listen('dragPrefabsToNonScene', () => {\n\t\t\tthis.clearState();\n\t\t});\n\t}\n\n\t// mousePos is optional. returns true if scene has been drawn\n\tonMouseMove(mouseCoordinatePosition) {\n\t\tif (!scene || !mouseCoordinatePosition && !this.previousMousePosInMouseCoordinates)\n\t\t\treturn false;\n\n\t\tperformanceTool.start('Editor: Scene');\n\n\t\tlet mousePos = scene.mouseToWorld(mouseCoordinatePosition || this.previousMousePosInMouseCoordinates);\n\n\t\tif (mouseCoordinatePosition)\n\t\t\tthis.previousMousePosInMouseCoordinates = mouseCoordinatePosition;\n\n\t\tlet needsDraw = false;\n\n\t\tsetChangeOrigin(this);\n\t\tlet change = this.previousMousePosInWorldCoordinates ? mousePos.clone().subtract(this.previousMousePosInWorldCoordinates) : mousePos;\n\t\tif (this.entitiesToEdit.length > 0 && this.widgetUnderMouse) {\n\t\t\t// Editing entities with a widget\n\t\t\tthis.widgetUnderMouse.onDrag(mousePos, change, filterChildren(this.entitiesToEdit));\n\t\t\t// Sync is done with listeners now\n\t\t\t// sceneEdit.copyTransformPropertiesFromEntitiesToEntityPrototypes(this.entitiesToEdit);\n\t\t\tneedsDraw = true;\n\t\t} else {\n\t\t\tif (this.widgetUnderMouse) {\n\t\t\t\tthis.widgetUnderMouse.unhover();\n\t\t\t\tthis.widgetUnderMouse = null;\n\t\t\t\tneedsDraw = true;\n\t\t\t}\n\t\t\tif (this.newEntities.length > 0) {\n\t\t\t\tsceneEdit.setEntityPositions(this.newEntities, mousePos); // these are not in scene\n\t\t\t\tneedsDraw = true;\n\t\t\t}\n\t\t\tif (scene) {\n\t\t\t\tif (!scene.playing && this.newEntities.length === 0 && !this.selectionEnd) {\n\t\t\t\t\tthis.widgetUnderMouse = sceneEdit.getWidgetUnderMouse(mousePos);\n\t\t\t\t\tif (this.widgetUnderMouse) {\n\t\t\t\t\t\tthis.widgetUnderMouse.hover();\n\t\t\t\t\t\tneedsDraw = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (this.selectionEnd) {\n\t\t\tthis.selectionEnd.add(change);\n\t\t\tthis.redrawSelectionArea();\n\n\t\t\tif (this.entitiesInSelection.length > 0) {\n\t\t\t\tsceneEdit.setEntitiesInSelectionArea(this.entitiesInSelection, false);\n\t\t\t}\n\t\t\tthis.entitiesInSelection = sceneEdit.getEntitiesInSelection(this.selectionStart, this.selectionEnd);\n\t\t\tsceneEdit.setEntitiesInSelectionArea(this.entitiesInSelection, true);\n\n\t\t\tneedsDraw = true;\n\t\t}\n\n\t\tthis.previousMousePosInWorldCoordinates = mousePos;\n\n\t\tif (needsDraw)\n\t\t\tthis.draw();\n\n\t\tperformanceTool.stop('Editor: Scene');\n\t\t\n\t\treturn needsDraw;\n\t}\n\n\tredrawSelectionArea() {\n\t\tthis.selectionArea.clear();\n\t\tthis.selectionArea.lineStyle(2, 0xFFFFFF, 0.7);\n\t\tthis.selectionArea.beginFill(0xFFFFFF, 0.3);\n\t\tthis.selectionArea.drawRect(\n\t\t\tthis.selectionStart.x,\n\t\t\tthis.selectionStart.y,\n\t\t\tthis.selectionEnd.x - this.selectionStart.x,\n\t\t\tthis.selectionEnd.y - this.selectionStart.y\n\t\t);\n\n\t\tthis.selectionArea.endFill();\n\t}\n\n\tstartListeningMovementInput() {\n\t\t// clearTimeout(this.movementInputTimeout);\n\t\twindow.cancelAnimationFrame(this.requestAnimationFrameId);\n\n\t\tconst cameraPositionSpeed = 300;\n\t\tconst cameraZoomSpeed = 0.8;\n\t\tlet lastTime = performance.now();\n\n\t\tconst update = () => {\n\t\t\tif (!scene)\n\t\t\t\treturn;\n\n\t\t\tlet currentTime = performance.now();\n\t\t\tlet dt = (currentTime - lastTime) / 1000;\n\t\t\tlastTime = currentTime;\n\n\t\t\tlet dx = 0,\n\t\t\t\tdy = 0,\n\t\t\t\tdz = 0;\n\n\t\t\tif (keyPressed(key.up) || keyPressed(key.w)) dy -= 1;\n\t\t\tif (keyPressed(key.down) || keyPressed(key.s)) dy += 1;\n\t\t\tif (keyPressed(key.left) || keyPressed(key.a)) dx -= 1;\n\t\t\tif (keyPressed(key.right) || keyPressed(key.d)) dx += 1;\n\t\t\tif (this.zoomInButtonPressed) dz += 1;\n\t\t\tif (keyPressed(key.minus) || keyPressed(key.q)) dz -= 1;\n\n\t\t\tif (dx === 0 && dy === 0 && dz === 0) {\n\t\t\t\tif (!MOVEMENT_KEYS.find(keyPressed))\n\t\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\tlet speed = 1;\n\t\t\t\tif (keyPressed(key.shift))\n\t\t\t\t\tspeed *= 3;\n\n\t\t\t\tlet cameraMovementSpeed = speed * cameraPositionSpeed * dt / scene.cameraZoom;\n\t\t\t\tscene.cameraPosition.x = absLimit(scene.cameraPosition.x + dx * cameraMovementSpeed, 5000);\n\t\t\t\tscene.cameraPosition.y = absLimit(scene.cameraPosition.y + dy * cameraMovementSpeed, 5000);\n\n\n\t\t\t\tif (dz !== 0) {\n\t\t\t\t\tlet zoomMultiplier = 1 + speed * cameraZoomSpeed * dt;\n\n\t\t\t\t\tif (dz > 0)\n\t\t\t\t\t\tscene.setZoom(Math.min(MAX_ZOOM, scene.cameraZoom * zoomMultiplier));\n\t\t\t\t\telse if (dz < 0)\n\t\t\t\t\t\tscene.setZoom(Math.max(MIN_ZOOM, scene.cameraZoom / zoomMultiplier));\n\t\t\t\t}\n\n\t\t\t\tthis.cameraPositionOrZoomUpdated();\n\t\t\t\tscene.updateCamera();\n\n\t\t\t\tlet drawHappened = this.onMouseMove();\n\n\t\t\t\tif (!drawHappened)\n\t\t\t\t\tthis.draw();\n\t\t\t}\n\n\t\t\tthis.requestAnimationFrameId = requestAnimationFrame(update);\n\t\t\t// this.movementInputTimeout = setTimeout(update, 17);\n\t\t};\n\n\t\tif (scene && !scene.playing) {\n\t\t\tupdate();\n\t\t}\n\t}\n\n\tgoToLocation(vector) {\n\t\tscene.cameraPosition.set(vector);\n\t\tthis.cameraPositionOrZoomUpdated();\n\t\tscene.updateCamera();\n\t\tthis.onMouseMove();\n\t\tthis.draw();\n\t}\n\n\tcameraPositionOrZoomUpdated() {\n\t\tif (scene && scene.isInInitialState()) {\n\t\t\tthis.editorCameraPosition = scene.cameraPosition.clone();\n\t\t\tthis.editorCameraZoom = scene.cameraZoom;\n\t\t}\n\t}\n\n\tupdate() {\n\t\tthis.draw();\n\t}\n\n\tplayingModeChanged() {\n\t\tif (!scene) {\n\t\t\tthis.el.classList.add('noScene');\n\t\t\tthis.el.classList.remove('playing', 'hideScenePauseInformation');\n\t\t\treturn;\n\t\t}\n\n\t\tlet isInitialState = scene.isInInitialState();\n\n\t\tthis.el.classList.toggle('isInitialState', isInitialState);\n\n\t\tif (scene.playing) {\n\t\t\tthis.el.classList.remove('noScene');\n\t\t\tthis.el.classList.add('hideScenePauseInformation', 'playing');\n\t\t} else {\n\t\t\tthis.el.classList.remove('noScene', 'playing');\n\t\t\tthis.el.classList.toggle('hideScenePauseInformation', isInitialState);\n\t\t}\n\t}\n\n\tfixAspectRatio() {\n\t\tif (scene && this.canvas) {\n\t\t\tlet change = false;\n\t\t\tif (this.canvas.width !== this.canvas.parentElement.offsetWidth && this.canvas.parentElement.offsetWidth\n\t\t\t|| this.canvas.height !== this.canvas.parentElement.offsetHeight && this.canvas.parentElement.offsetHeight) {\n\t\t\t\t\n\t\t\t\t// Here you can tweak the game resolution in editor.\n\t\t\t\t// scene.renderer.resize(this.canvas.parentElement.offsetWidth / 2, this.canvas.parentElement.offsetHeight / 2);\n\t\t\t\tlet width = this.canvas.parentElement.offsetWidth;\n\t\t\t\tlet height = this.canvas.parentElement.offsetHeight;\n\n\t\t\t\t// Here you can change the resolution of the canvas\n\t\t\t\tlet pixels = width * height;\n\t\t\t\tlet quality = 1;\n\t\t\t\t\n\t\t\t\t/*\n\t\t\t\tThis doesn't work. Mouse position gets messed up.\n\t\t\t\tconst MAX_PIXELS = 1000 * 600;\n\t\t\t\tif (pixels > MAX_PIXELS) {\n\t\t\t\t\tquality = Math.sqrt(MAX_PIXELS / pixels);\n\t\t\t\t}\n\t\t\t\t*/\n\t\t\t\t\n\t\t\t\tscene.renderer.resize(width * quality, height * quality);\n\t\t\t\t\n\t\t\t\tchange = true;\n\t\t\t}\n\n\t\t\t// scene.renderer.resize(this.canvas.width, this.canvas.height);\n\n\t\t\tif (change) {\n\t\t\t\tevents.dispatch('canvas resize', scene);\n\t\t\t\tthis.draw();\n\t\t\t}\n\t\t}\n\t}\n\n\tdraw() {\n\t\tif (scene) {\n\t\t\tif (!scene.playing) {\n\t\t\t\tthis.filterDeadSelection();\n\t\t\t\tmakeADrawRequest();\n\t\t\t}\n\t\t} else {\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (game.getChildren('lvl').length === 0) {\n\t\t\t\t\tsetChangeOrigin(this);\n\t\t\t\t\tevents.dispatch('createBlankLevel');\n\t\t\t\t}\n\t\t\t}, 500)\n\t\t}\n\t}\n\n\tdrawNoLevel() {\n\t\t/*\n\t\t this.canvas.width = this.canvas.width;\n\t\t let context = this.canvas.getContext('2d');\n\t\t context.font = '20px arial';\n\t\t context.fillStyle = 'white';\n\t\t context.fillText('No level selected', 20, 35);\n\t\t */\n\t}\n\n\tdrawEmptyLevel() {\n\t\t/*\n\t\t let context = this.canvas.getContext('2d');\n\t\t context.font = '20px arial';\n\t\t context.fillStyle = 'white';\n\t\t context.fillText('Empty level. Click a type and place it here.', 20, 35);\n\t\t */\n\t}\n\n\tselectEntities(entities) {\n\t\tthis.clearSelectedEntities();\n\t\tthis.selectedEntities.push(...entities);\n\t\tthis.selectedEntities.forEach(entity => {\n\t\t\tentity.getComponent('EditorWidget').select();\n\t\t});\n\t}\n\n\tclearSelectedEntities() {\n\t\tthis.selectedEntities.forEach(entity => {\n\t\t\tif (entity._alive)\n\t\t\t\tentity.getComponent('EditorWidget').deselect();\n\t\t});\n\t\tthis.selectedEntities.length = 0;\n\n\t\tthis.updateSceneContextButtonVisibility();\n\t}\n\n\tclearState() {\n\t\tthis.deleteNewEntities();\n\n\t\tif (this.widgetUnderMouse)\n\t\t\tthis.widgetUnderMouse.unhover();\n\t\tthis.widgetUnderMouse = null;\n\t\tthis.clearSelectedEntities();\n\t\tthis.entitiesToEdit.length = 0;\n\n\t\tthis.selectionStart = null;\n\t\tthis.selectionEnd = null;\n\t}\n\n\tdeleteNewEntities() {\n\t\tthis.newEntities.forEach(e => {\n\t\t\te.prototype.delete();\n\t\t\te.delete();\n\t\t});\n\t\tthis.newEntities.length = 0;\n\t}\n\n\tselectSelectedEntitiesInEditor() {\n\t\tif (sceneEdit.shouldSyncLevelAndScene()) {\n\t\t\teditor.select(this.selectedEntities.map(ent => ent.prototype), this);\n\t\t\tModule.activateOneOfModules(['type', 'object'], false);\n\t\t} else {\n\t\t\teditor.select(this.selectedEntities, this);\n\t\t\tModule.activateOneOfModules(['object'], false);\n\t\t}\n\t}\n\n\tstopAndReset() {\n\t\tthis.clearState();\n\t\tif (editor.selection.type === 'ent') {\n\t\t\teditor.select(editor.selection.items.map(ent => ent.prototype.prototype), this);\n\t\t}\n\t\tif (scene) {\n\t\t\tscene.reset();\n\t\t\tscene.cameraPosition = this.editorCameraPosition.clone();\n\t\t\tscene.setZoom(this.editorCameraZoom);\n\t\t\t// scene.updateCamera(); // this is called before every scene.draw. no need to do it here.\n\t\t}\n\t\tthis.playingModeChanged();\n\t\t// this.draw(); // scene.reset() already does drawing.\n\n\t\tthis.updatePropertyChangeCreationFilter();\n\t}\n\n\tfilterDeadSelection() {\n\t\tremoveTheDeadFromArray(this.selectedEntities);\n\t\tremoveTheDeadFromArray(this.entitiesToEdit);\n\n\t\tfor (let i = this.newEntities.length - 1; i >= 0; --i) {\n\t\t\tlet prototypeOfEntityPrototype = this.newEntities[i].prototype.prototype;\n\t\t\tif (prototypeOfEntityPrototype && prototypeOfEntityPrototype.threeLetterType === 'prt' && prototypeOfEntityPrototype._alive === false) {\n\t\t\t\tlet entity = this.newEntities.splice(i, 1)[0];\n\t\t\t\tentity.prototype.delete();\n\t\t\t\tentity.delete();\n\t\t\t}\n\t\t}\n\t}\n\n\tupdatePropertyChangeCreationFilter() {\n\t\tif (!scene)\n\t\t\treturn;\n\n\t\tif (scene.isInInitialState()) {\n\t\t\tenableAllChanges();\n\t\t} else if (editor.selection.type === 'ent') {\n\t\t\tfilterSceneChanges(property => {\n\t\t\t\tlet selectedEntities = editor.selection.items;\n\t\t\t\treturn !!property.findParent('ent', serializable => selectedEntities.includes(serializable));\n\t\t\t});\n\t\t} else {\n\t\t\tdisableAllChanges();\n\t\t}\n\t}\n\n\tupdateSceneContextButtonVisibility() {\n\t\tif (this.selectedEntities.length > 0)\n\t\t\tthis.sceneContextButtons.classList.remove('hidden');\n\t\telse\n\t\t\tthis.sceneContextButtons.classList.add('hidden');\n\t}\n\n\tcopyEntities(entities) {\n\t\tthis.copiedEntities.forEach(entity => entity.delete());\n\t\tthis.copiedEntities.length = [];\n\t\tthis.copiedEntities.push(...entities.map(entity => entity.clone()));\n\t\tthis.copiedEntities.forEach(entity => entity.sleep());\n\t}\n\n\tpasteEntities() {\n\t\tthis.deleteNewEntities();\n\t\tthis.newEntities.push(...this.copiedEntities.map(entity => entity.clone()));\n\t\tthis.newEntities.forEach(entity => entity.wakeUp());\n\n\t\tif (this.previousMousePosInWorldCoordinates)\n\t\t\tsceneEdit.setEntityPositions(this.newEntities, this.previousMousePosInWorldCoordinates);\n\t}\n\n\tdestroySelectionArea() {\n\t\tif (!this.selectionArea)\n\t\t\treturn;\n\t\tthis.selectionArea.destroy();\n\t\tthis.selectionArea = null;\n\t}\n}\n\nModule.register(SceneModule, 'center');\n\nlet makeADrawRequest = limit(15, 'soon', () => scene && scene.draw());\n","import { el, list, mount } from 'redom';\nimport Module from './module';\nimport events from '../../util/events';\nimport Prototype from '../../core/prototype';\nimport { getSerializable, changeType, setChangeOrigin } from '../../core/serializableManager';\nimport assert from '../../util/assert';\nimport { editor } from '../editor';\nimport * as performance from '../../util/performance';\n\nclass Types extends Module {\n\tconstructor() {\n\t\tsuper(\n\t\t\tthis.addButton = el('span.addTypeButton.button.fa.fa-plus'),\n\t\t\tthis.search = el('input'),\n\t\t\tthis.searchIcon = el('i.fa.fa-search.searchIcon'),\n\t\t\tthis.jstree = el('div'),\n\t\t\tthis.helperText = el('div.typesDragHelper',\n\t\t\t\tel('i.fa.fa-long-arrow-right'),\n\t\t\t\t'Drag',\n\t\t\t\tel('i.fa.fa-long-arrow-right')\n\t\t\t)\n\t\t);\n\t\tthis.id = 'types';\n\t\tthis.name = 'Types';\n\n\t\tthis.addButton.onclick = () => {\n\t\t\tsetChangeOrigin(this);\n\t\t\tlet prototype = Prototype.create(' New type');\n\t\t\teditor.game.addChild(prototype);\n\t\t\teditor.select(prototype);\n\t\t\tsetTimeout(() => {\n\t\t\t\tModule.activateModule('type', true, 'focusOnProperty', 'name');\n\t\t\t}, 100);\n\t\t};\n\t\t\n\t\tlet searchTimeout = false;\n\t\tthis.search.addEventListener('keyup', () => {\n\t\t\tif (searchTimeout)\n\t\t\t\tclearTimeout(searchTimeout);\n\n\t\t\tsearchTimeout = setTimeout(() => {\n\t\t\t\t$(this.jstree).jstree().search(this.search.value.trim());\n\t\t\t}, 200);\n\t\t});\n\t\t\n\t\tthis.externalChange = false;\n\n\t\tevents.listen('change', change => {\n\t\t\tif (change.reference._rootType === 'sce')\n\t\t\t\treturn;\n\t\t\t\n\t\t\tlet jstree = $(this.jstree).jstree(true);\n\t\t\tif (!jstree)\n\t\t\t\treturn;\n\n\t\t\tperformance.start('Editor: Types');\n\t\t\t\n\t\t\tthis.externalChange = true;\n\t\t\t\n\t\t\tif (change.reference.threeLetterType === 'prt') {\n\t\t\t\tif (change.type === changeType.addSerializableToTree) {\n\t\t\t\t\tlet parent = change.parent;\n\t\t\t\t\tlet parentNode;\n\t\t\t\t\tif (parent.threeLetterType === 'gam')\n\t\t\t\t\t\tparentNode = '#';\n\t\t\t\t\telse\n\t\t\t\t\t\tparentNode = jstree.get_node(parent.id);\n\n\t\t\t\t\tjstree.create_node(parentNode, {\n\t\t\t\t\t\ttext: change.reference.getChildren('prp')[0].value,\n\t\t\t\t\t\tid: change.reference.id\n\t\t\t\t\t});\n\t\t\t\t} else\n\t\t\t\t\tthis.dirty = true; // prototypes added, removed, moved or something\n\t\t\t} else if (change.type === changeType.setPropertyValue) {\n\t\t\t\tlet propParent = change.reference._parent;\n\t\t\t\tif (propParent && propParent.threeLetterType === 'prt') {\n\t\t\t\t\tlet node = jstree.get_node(propParent.id);\n\t\t\t\t\tjstree.rename_node(node, change.value);\n\t\t\t\t}\n\t\t\t} else if (change.type === 'editorSelection') {\n\t\t\t\tif (change.origin != this) {\n\t\t\t\t\tlet node;\n\t\t\t\t\t\n\t\t\t\t\tif (change.reference.type === 'prt') {\n\t\t\t\t\t\tnode = jstree.get_node(change.reference.items[0].id);\n\t\t\t\t\t} else if (change.reference.type === 'epr') {\n\t\t\t\t\t\tlet possiblyPrototype = change.reference.items[0].getParentPrototype();\n\t\t\t\t\t\tif (possiblyPrototype)\n\t\t\t\t\t\t\tnode = jstree.get_node(possiblyPrototype.id);\n\t\t\t\t\t} else if (change.reference.type === 'ent') {\n\t\t\t\t\t\tlet possiblyPrototype = change.reference.items[0].prototype.getParentPrototype();\n\t\t\t\t\t\tif (possiblyPrototype)\n\t\t\t\t\t\t\tnode = jstree.get_node(possiblyPrototype.id);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (node) {\n\t\t\t\t\t\tjstree.deselect_all();\n\t\t\t\t\t\tjstree.select_node(node);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.externalChange = false;\n\n\t\t\tperformance.stop('Editor: Types');\n\t\t});\n\t}\n\tupdate() {\n\t\tif (this.skipUpdate) return;\n\t\tif (!this.jstreeInited)\n\t\t\tthis.dirty = true;\n\n\t\tif (!this.dirty) return;\n\t\t\n\t\t\n\t\tlet data = [];\n\t\teditor.game.forEachChild('prt', prototype => {\n\t\t\tlet parent = prototype.getParent();\n\t\t\tdata.push({\n\t\t\t\ttext: prototype.name,\n\t\t\t\tid: prototype.id,\n\t\t\t\tparent: parent.threeLetterType === 'prt' ? parent.id : '#'\n\t\t\t});\n\t\t}, true);\n\n\t\tthis.addButton.classList.toggle('clickMeEffect', data.length === 0);\n\t\tthis.helperText.classList.toggle('hidden', data.length === 0);\n\t\t\n\t\tif (!this.jstreeInited) {\n\t\t\t$(this.jstree).attr('id', 'types-jstree').on('changed.jstree', (e, data) => {\n\t\t\t\tlet noPrototypes = editor.game.getChildren('prt').length === 0;\n\t\t\t\tthis.addButton.classList.toggle('clickMeEffect', noPrototypes);\n\t\t\t\tthis.helperText.classList.toggle('hidden', noPrototypes);\n\t\t\t\t\n\t\t\t\tif (this.externalChange || data.selected.length === 0)\n\t\t\t\t\treturn;\n\t\t\t\t\n\t\t\t\t// selection changed\n\t\t\t\tlet prototypes = data.selected.map(getSerializable);\n\t\t\t\teditor.select(prototypes, this);\n\t\t\t\tModule.activateModule('type', false);\n\t\t\t\tif (prototypes.length === 1)\n\t\t\t\t\tevents.dispatch('prototypeClicked', prototypes[0]);\n\t\t\t\t\n\t\t\t}).on('loaded.jstree refresh.jstree', () => {\n\t\t\t\tlet jstree = $(this.jstree).jstree(true);\n\t\t\t\t// let selNode = jstree.get_node('prtF21ZLL0vsLdQI5z');\n\t\t\t\t// console.log(jstree, selNode);\n\t\t\t\tif (editor.selection.type === 'none') {\n\t\t\t\t\t//jstree.select_node();\n\t\t\t\t}\n\t\t\t\tif (editor.selection.type === 'prt') {\n\t\t\t\t\t// jstree.select_node(editor.selection.items.map(i => i.id));\n\t\t\t\t}\n\t\t\t}).jstree({\n\t\t\t\tcore: {\n\t\t\t\t\tcheck_callback: true,\n\t\t\t\t\tdata,\n\t\t\t\t\tforce_text: true\n\t\t\t\t},\n\t\t\t\tplugins: ['types', 'dnd', 'sort', 'search'/*, 'state'*/],\n\t\t\t\ttypes: {\n\t\t\t\t\tdefault: {\n\t\t\t\t\t\ticon: 'fa fa-book'\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tsort: function (a, b) {\n\t\t\t\t\treturn this.get_text(a).toLowerCase() > this.get_text(b).toLowerCase() ? 1 : -1;\n\t\t\t\t},\n\t\t\t\tdnd: {\n\t\t\t\t\tcopy: false // jstree makes it way too hard to copy multiple prototypes\n\t\t\t\t},\n\t\t\t\tsearch: {\n\t\t\t\t\tfuzzy: true,\n\t\t\t\t\tshow_only_matches: true,\n\t\t\t\t\tshow_only_matches_children: true,\n\t\t\t\t\tclose_opened_onclear: false\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.jstreeInited = true;\n\t\t} else {\n\t\t\t$(this.jstree).jstree(true).settings.core.data = data;\n\t\t\t$(this.jstree).jstree('refresh');\n\t\t}\n\t\t$(this.jstree).data('typesModule', this);\n\n\t\tthis.dirty = false;\n\t}\n}\n\n\n$(document).on('dnd_start.vakata', function (e, data) {\n\tif (data.data.nodes.find(node => !node.startsWith('prt')))\n\t\treturn;\n\t\n\tlet nodeObjects = data.data.nodes.map(getSerializable);\n\tevents.dispatch('dragPrototypeStarted', nodeObjects);\n});\n\n\n// This doesn't work. types.js should use treeView.js instead. objects.js has done this the right way.\n// $(document).on('dnd_move.vakata', function (e, data) {\n// \tif (data.data.nodes.find(node => !node.startsWith('prt')))\n// \t\treturn;\n//\t\n// \tsetTimeout(() => {\n// \t\tif (data.event.target.nodeName === 'CANVAS') {\n// \t\t\tdata.helper.find('.jstree-icon').css({\n// \t\t\t\tvisibility: 'hidden'\n// \t\t\t});\n// \t\t} else {\n// \t\t\tdata.helper.find('.jstree-icon').css({\n// \t\t\t\tvisibility: 'visible'\n// \t\t\t});\n// \t\t}\n// \t}, 5);\n// });\n\n$(document).on('dnd_stop.vakata', function (e, data) {\n\tif (data.data.nodes.find(node => !node.startsWith('prt')))\n\t\treturn;\n\t\n\tconsole.log('data', data);\n\tconsole.log('e', e)\n\tlet jstree = $('#types-jstree').jstree(true);\n\t// let typesModule = $('#types-jstree').data('typesModule');\n\t\n\tconsole.log('data.event.target.nodeName', data.event.target.nodeName)\n\t\n\tsetTimeout(function () {\n\t\t// Now the nodes have moved in the DOM.\n\n\t\tif (data.event.target.nodeName === 'CANVAS') {\n\t\t\t// Drag entity to scene\n\t\t\tlet nodeObjects = data.data.nodes.map(getSerializable);\n\t\t\tevents.dispatch('dragPrototypeToCanvas', nodeObjects);\n\t\t} else {\n\t\t\t// Drag prototype in types view\n\t\t\t\n\t\t\tlet node = jstree.get_node(data.data.obj);\n\t\t\tif (!node)\n\t\t\t\treturn;\n\t\t\tlet nodes = data.data.nodes; // these prototypes will move\n\t\t\tlet newParent;\n\t\t\tif (node.parent === '#')\n\t\t\t\tnewParent = editor.game;\n\t\t\telse\n\t\t\t\tnewParent = getSerializable(node.parent);\n\n\t\t\tlet nodeObjects = nodes.map(getSerializable);\n\t\t\tnodeObjects.forEach(assert);\n\t\t\tnodeObjects.forEach(prototype => {\n\t\t\t\tsetChangeOrigin(jstree);\n\t\t\t\tprototype.move(newParent);\n\t\t\t});\n\n\t\t\tevents.dispatch('dragPrototypeToNonCanvas', nodeObjects);\n\n\t\t\t// console.log('dnd stopped from', nodes, 'to', newParent);\n\t\t}\n\t}, 0);\n});\n\n\nModule.register(Types, 'left');\n","export class DragAndDropEvent {\n\tconstructor(idList, targetElement, state) {\n\t\tthis.state = state;\n\t\tthis.idList = idList;\n\t\tthis.targetElement = targetElement; // the drop target target\n\n\t\tthis.type = null;\n\t\tlet types = Array.from(new Set(this.idList.map(id => id.substring(0, 3))));\n\t\tif (types.length === 0)\n\t\t\tthis.type = 'none';\n\t\telse if (types.length === 1)\n\t\t\tthis.type = types[0];\n\t\telse\n\t\t\tthis.type = 'mixed';\n\t}\n}\n\nexport class DragAndDropStartEvent extends DragAndDropEvent {\n\tconstructor(idList, targetElement) {\n\t\tsuper(idList, targetElement, 'start');\n\t}\n}\n\nexport class DragAndDropMoveEvent extends DragAndDropEvent {\n\tconstructor(idList, targetElement, helper) {\n\t\tsuper(idList, targetElement, 'move');\n\t\tthis.helper = helper;\n\t}\n\thideValidationIndicator() {\n\t\tthis.helper.find('.jstree-icon').css({\n\t\t\tvisibility: 'hidden'\n\t\t});\n\t}\n}\n\nexport class DragAndDropStopEvent extends DragAndDropEvent {\n\tconstructor(idList, targetElement) {\n\t\tsuper(idList, targetElement, 'stop');\n\t}\n}\n","import {el, list, mount} from 'redom';\nimport events from \"../../util/events\";\nimport {DragAndDropMoveEvent, DragAndDropStartEvent, DragAndDropStopEvent} from \"../util/dragAndDrop\";\n\nexport default class TreeView {\n\tconstructor(options) {\n\t\tthis.options = Object.assign({\n\t\t\tid: '',\n\t\t\tdefaultIcon: 'fa fa-book',\n\t\t\tselectionChangedCallback: null,\n\t\t\tmoveCallback: null, // if many items are moved, this is called many times\n\t\t\tdoubleClickCallback: null\n\t\t}, options);\n\n\t\tif (!this.options.id)\n\t\t\tthrow new Error('Id missing');\n\n\t\tthis.el = el('div.treeView');\n\n\t\tlet jstree = $(this.el).attr('id', this.options.id).on('move_node.jstree', (e, data) => {\n\t\t\tlet serializableId = data.node.id;\n\t\t\tlet parentId = data.parent;\n\t\t\tthis.options.moveCallback && this.options.moveCallback(serializableId, parentId);\n\t\t}).on('changed.jstree', (e, data) => {\n\t\t\tthis.options.selectionChangedCallback && data.selected.length > 0 && this.options.selectionChangedCallback(data.selected);\n\t\t}).jstree({\n\t\t\tcore: {\n\t\t\t\tcheck_callback: true,\n\t\t\t\tdata: [],\n\t\t\t\tforce_text: true\n\t\t\t},\n\t\t\tplugins: ['types', 'dnd', 'sort', 'search'/*, 'state'*/],\n\t\t\ttypes: {\n\t\t\t\tdefault: {\n\t\t\t\t\ticon: this.options.defaultIcon\n\t\t\t\t}\n\t\t\t},\n\t\t\tsort: function (a, b) {\n\t\t\t\treturn this.get_text(a).toLowerCase() > this.get_text(b).toLowerCase() ? 1 : -1;\n\t\t\t},\n\t\t\tdnd: {\n\t\t\t\tcopy: false // jstree makes it way too hard to copy multiple prototypes\n\t\t\t},\n\t\t\tsearch: {\n\t\t\t\tfuzzy: true,\n\t\t\t\tshow_only_matches: true,\n\t\t\t\tshow_only_matches_children: true,\n\t\t\t\tclose_opened_onclear: false\n\t\t\t}\n\t\t});\n\t\t\n\t\tif (this.options.doubleClickCallback) {\n\t\t\tjstree.bind(\"dblclick.jstree\", (event) => {\n\t\t\t\tvar element = $(event.target).closest(\"li\")[0];\n\t\t\t\tthis.options.doubleClickCallback(element.id);\n\t\t\t});\n\t\t}\n\t}\n\n\tcreateNode(id, text, parent) {\n\t\t$(this.el).jstree().create_node(parent || '#', { id, text }, 'last');\n\t}\n\tdeleteNode(id) {\n\t\tlet jstree = $(this.el).jstree(true);\n\t\tjstree.delete_node(jstree.get_node(id));\n\t}\n\n\tselect(idOrList) {\n\t\tif (!idOrList)\n\t\t\treturn;\n\n\t\tlet jstree = $(this.el).jstree(true);\n\t\tjstree.deselect_all(true);\n\t\tif (typeof idOrList === 'number')\n\t\t\tidOrList = [idOrList];\n\n\t\tif (idOrList.length > 0) {\n\t\t\tidOrList.forEach(id => {\n\t\t\t\tjstree.select_node(jstree.get_node(id));\n\t\t\t});\n\n\t\t\tlet node = document.getElementById(idOrList[0]);\n\t\t\tif (!node)\n\t\t\t\treturn console.warn(`id ${idOrList[0]} not found from the tree`);\n\t\t\t\n\t\t\tlet module = this.el.parentNode;\n\t\t\twhile (module && !module.classList.contains('module')) {\n\t\t\t\tmodule = module.parentNode;\n\t\t\t}\n\n\t\t\tconst NODE_HEIGHT = 24;\n\t\t\tconst SAFETY_MARGIN = 15;\n\n\t\t\tlet minScroll = node.offsetTop - module.offsetHeight + NODE_HEIGHT + SAFETY_MARGIN;\n\t\t\tlet maxScroll = node.offsetTop - SAFETY_MARGIN;\n\n\t\t\tif (module.scrollTop < minScroll)\n\t\t\t\tmodule.scrollTop = minScroll;\n\t\t\telse if (module.scrollTop > maxScroll)\n\t\t\t\tmodule.scrollTop = maxScroll;\n\t\t}\n\t}\n\n\tsearch(query) {\n\t\t$(this.el).jstree().search(query.trim());\n\t}\n\n\tupdate(data) {\n\t\tlet jstree = $(this.el).jstree(true);\n\t\tjstree.settings.core.data = data;\n\t\tjstree.refresh(true);\n\t}\n}\n\n$(document).on('dnd_start.vakata', function (e, data) {\n\tlet idList = data.data.nodes;\n\tlet targetElement = data.event.target;\n\tlet event = new DragAndDropStartEvent(idList, targetElement);\n\tevents.dispatch('treeView drag start ' + data.data.origin.element[0].id, event);\n});\n\n$(document).on('dnd_move.vakata', function (e, data) {\n\tdata.helper.find('.jstree-icon').css({\n\t\tvisibility: 'visible'\n\t});\n\tlet idList = data.data.nodes;\n\tlet targetElement = data.event.target;\n\tlet event = new DragAndDropMoveEvent(idList, targetElement, data.helper);\n\tevents.dispatch('treeView drag move ' + data.data.origin.element[0].id, event);\n});\n\n$(document).on('dnd_stop.vakata', function (e, data) {\n\tlet idList = data.data.nodes;\n\tlet targetElement = data.event.target;\n\tlet event = new DragAndDropStopEvent(idList, targetElement);\n\tevents.dispatch('treeView drag stop ' + data.data.origin.element[0].id, event);\n});\n","import { el, list, mount } from 'redom';\nimport TreeView from \"../views/treeView\";\nimport Module from './module';\nimport events from \"../../util/events\";\nimport {game} from \"../../core/game\";\nimport {getSerializable} from \"../../core/serializableManager\";\nimport {editor} from \"../editor\";\n\nclass Prefabs extends Module {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.name = 'Prefabs';\n\t\tthis.id = 'prefabs';\n\n\t\tthis.treeView = new TreeView({\n\t\t\tid: 'prefabs-tree',\n\t\t\tselectionChangedCallback: selectedIds => {\n\t\t\t\tlet serializables = selectedIds.map(getSerializable).filter(Boolean);\n\t\t\t\teditor.select(serializables, this);\n\t\t\t\tModule.activateModule('prefab', false);\n\t\t\t},\n\t\t});\n\t\tmount(this.el, this.treeView);\n\t\t\n\t\tevents.listen('treeView drag start prefabs-tree', event => {\n\t\t\tlet prefabs = event.idList.map(getSerializable);\n\t\t\tevents.dispatch('dragPrefabsStarted', prefabs);\n\t\t});\n\t\tevents.listen('treeView drag move prefabs-tree', event => {\n\t\t\tif (event.targetElement.tagName === 'CANVAS' && event.targetElement.classList.contains('openEditPlayCanvas'))\n\t\t\t\tevent.hideValidationIndicator();\n\t\t});\n\t\tevents.listen('treeView drag stop prefabs-tree', event => {\n\t\t\tlet prefabs = event.idList.map(getSerializable);\n\t\t\tif (event.targetElement.tagName === 'CANVAS' && event.targetElement.classList.contains('openEditPlayCanvas'))\n\t\t\t\tevents.dispatch('dragPrefabsToScene', prefabs);\n\t\t\telse\n\t\t\t\tevents.dispatch('dragPrefabsToNonScene', prefabs);\n\t\t});\n\n\t\tthis.dirty = true;\n\t}\n\tactivate() {\n\t\tthis.dirty = true;\n\t}\n\tupdate() {\n\t\tif (!this._selected)\n\t\t\treturn true;\n\n\t\tif (!this.dirty)\n\t\t\treturn true;\n\n\t\tlet data = [];\n\t\tgame.forEachChild('pfa', pfa => {\n\t\t\tdata.push({\n\t\t\t\ttext: pfa.makeUpAName(),\n\t\t\t\tid: pfa.id,\n\t\t\t\tparent: '#'\n\t\t\t});\n\t\t});\n\t\t\n\t\tthis.treeView.update(data);\n\t\tthis.dirty = false;\n\n\t\treturn true;\n\t}\n}\n\nModule.register(Prefabs, 'left');\n","import { el, mount, list } from 'redom';\nimport { listenKeyDown, key } from '../../../util/input';\n\nexport let popupDepth = 0;\n\nexport default class Popup {\n\tconstructor({\n\t\ttitle = 'Undefined popup',\n\t\tcancelCallback = null,\n\t\twidth = null,\n\t\tcontent = el('div.genericCustomContent', 'Undefined content')\n\t}) {\n\t\tthis.el = el('div.popup', {\n\t\t\t\tstyle: {\n\t\t\t\t\t'z-index': 1000 + popupDepth++\n\t\t\t\t}\n\t\t\t},\n\t\t\tnew Layer(this),\n\t\t\tel('div.popupContent',\n\t\t\t\t{\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\twidth\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tthis.text = el('div.popupTitle'),\n\t\t\t\tthis.content = content\n\t\t\t)\n\t\t);\n\t\tthis.depth = popupDepth;\n\t\tthis.text.innerHTML = title;\n\t\tthis.cancelCallback = cancelCallback;\n\t\t\n\t\t\n\t\tthis.keyListener = listenKeyDown(keyChar => {\n\t\t\tif (keyChar === key.esc && this.depth === popupDepth) {\n\t\t\t\tthis.remove();\n\t\t\t}\n\t\t});\n\t\t\n\t\tmount(document.body, this.el);\n\t}\n\tremove() {\n\t\tpopupDepth--;\n\t\tthis.el.parentNode.removeChild(this.el);\n\t\tthis.keyListener();\n\t\tthis.keyListener = null;\n\t}\n}\n\nexport class Button {\n\tconstructor() {\n\t\tthis.el = el('button.button', {onclick: () => {\n\t\t\tthis.callback();\n\t\t}});\n\t}\n\tupdate(button) {\n\t\tlet newClassName = button.class ? `button ${button.class}` : 'button';\n\t\t\n\t\tif (\n\t\t\tthis.el.textContent === button.text\n\t\t\t&& this._prevIcon === button.icon\n\t\t\t&& this.el.className === newClassName\n\t\t\t&& (!button.color || this.el.style['border-color'] === button.color)\n\t\t) {\n\t\t\treturn; // optimize\n\t\t}\n\t\t\n\t\tthis.el.textContent = button.text;\n\t\t\n\t\tthis._prevIcon = button.icon;\n\t\tif (button.icon) {\n\t\t\tlet icon = el('i.fa.' + button.icon);\n\t\t\tif (button.color)\n\t\t\t\ticon.style.color = button.color;\n\t\t\tmount(this.el, icon, this.el.firstChild);\n\t\t}\n\t\tthis.el.className = newClassName;\n\t\tthis.callback = button.callback;\n\t\tif (button.color) {\n\t\t\tthis.el.style['border-color'] = button.color;\n\t\t\tthis.el.style['color'] = button.color;\n\t\t\t// this.el.style['background'] = button.color;\n\t\t}\n\t}\n}\n\nclass Layer {\n\tconstructor(popup) {\n\t\tthis.el = el('div.popupLayer', { onclick: () => {\n\t\t\tpopup.remove();\n\t\t\tpopup.cancelCallback && popup.cancelCallback();\n\t\t} });\n\t}\n}\n","import Popup, { Button, popupDepth } from './Popup';\nimport { el, mount, list } from 'redom';\nimport Entity from \"../../../core/entity\";\nimport EntityPrototype from \"../../../core/entityPrototype\";\nimport { scene } from \"../../../core/scene\";\nimport { copyEntitiesToScene } from \"../../util/sceneEditUtil\";\nimport Vector from '../../../util/vector';\n\nexport default class CreateObject extends Popup {\n\t/*\n\tbuttonOptions:\n\t- text\n\t- color\n\t- icon (fa-plus)\n\t */\n\tconstructor() {\n\t\tsuper({\n\t\t\ttitle: 'Create Object',\n\t\t\twidth: '500px',\n\t\t\tcontent: list('div.confirmationButtons', Button)\n\t\t});\n\n\t\tthis.content.update([{\n\t\t\ttext: 'Empty Object',\n\t\t\tcallback: () => {\n\t\t\t\tlet entityPrototype = EntityPrototype.create('Empty', scene.cameraPosition.clone());\n\t\t\t\tlet entity = entityPrototype.createEntity(null, true);\n\t\t\t\tcopyEntitiesToScene([entity]);\n\n\t\t\t\tthis.remove();\n\t\t\t}\n\t\t}]);\n\t}\n}\n","import { el, list, mount } from 'redom';\nimport Module from './module';\nimport TreeView from \"../views/treeView\";\nimport { editor } from '../editor';\nimport {listenSceneCreation, scene} from '../../core/scene';\nimport {getSerializable, changeType} from \"../../core/serializableManager\";\nimport events from \"../../util/events\";\nimport * as performance from \"../../util/performance\";\nimport CreateObject from \"../views/popup/createObject\";\nimport {game} from \"../../core/game\";\nimport TaskRunner from \"../../util/taskRunner\";\nimport Prefab from \"../../core/prefab\";\nimport Serializable from \"../../core/serializable\";\n\nclass Objects extends Module {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.name = 'Objects';\n\t\tthis.id = 'objects';\n\t\t\n\t\tlet createButton = el('button.button', 'Create', {\n\t\t\tonclick: () => {\n\t\t\t\tnew CreateObject();\n\t\t\t}\n\t\t});\n\t\tmount(this.el, createButton);\n\t\t\n\t\tthis.treeView = new TreeView({\n\t\t\tid: 'objects-tree',\n\t\t\tselectionChangedCallback: selectedIds => {\n\t\t\t\tlet serializables = selectedIds.map(getSerializable).filter(Boolean);\n\t\t\t\teditor.select(serializables, this);\n\t\t\t\tModule.activateModule('object', false);\n\t\t\t},\n\t\t\tmoveCallback: (serializableId, parentId) => {\n\t\t\t\tif (serializableId.substring(0, 3) === 'epr') {\n\t\t\t\t\tlet serializable = getSerializable(serializableId);\n\t\t\t\t\tlet parent = parentId === '#' ? editor.selectedLevel : getSerializable(parentId);\n\t\t\t\t\tserializable.move(parent);\n\t\t\t\t\t/*\n\t\t\t\t\tlet target = event.targetElement;\n\t\t\t\t\twhile (!target.classList.contains('jstree-node')) {\n\t\t\t\t\t\ttarget = target.parentElement;\n\t\t\t\t\t\tif (!target)\n\t\t\t\t\t\t\tthrow new Error('Invalid target', event.targetElement);\n\t\t\t\t\t}\n\t\t\t\t\tconsole.log('target.id', target.id)\n\t\t\t\t\tlet targetSerializable = getSerializable(target.id);\n\n\t\t\t\t\tlet idSet = new Set(event.idList);\n\t\t\t\t\tlet serializables = event.idList.map(getSerializable).filter(serializable => {\n\t\t\t\t\t\tlet parent = serializable.getParent();\n\t\t\t\t\t\twhile (parent) {\n\t\t\t\t\t\t\tif (idSet.has(parent.id))\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\tparent = parent.getParent();\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t});\n\n\t\t\t\t\tconsole.log('move serializables', serializables, 'to', targetSerializable);\n\t\t\t\t\tserializables.forEach(serializable => {\n\t\t\t\t\t\tserializable.move(targetSerializable);\n\t\t\t\t\t});\n\t\t\t\t\tconsole.log('Done!')\n\t\t\t\t\t*/\n\t\t\t\t}\n\t\t\t},\n\t\t\tdoubleClickCallback: serializableId => {\n\t\t\t\tlet serializable = getSerializable(serializableId);\n\t\t\t\tif (serializable)\n\t\t\t\t\tevents.dispatch('locate serializable', serializable);\n\t\t\t\telse\n\t\t\t\t\tthrow new Error(`Locate serializable ${serializableId} not found`);\n\t\t\t}\n\t\t});\n\t\tmount(this.el, this.treeView);\n\t\t\n\t\tevents.listen('treeView drag start objects-tree', event => {\n\t\t});\n\t\tevents.listen('treeView drag move objects-tree', event => {\n\t\t\tif (event.type === 'epr' && event.targetElement.getAttribute('moduleid') === 'prefabs')\n\t\t\t\tevent.hideValidationIndicator();\n\t\t\t// if (event.targetElement.classList.contains('openEditPlayCanvas'))\n\t\t\t// \tevent.hideValidationIndicator();\n\t\t});\n\t\tevents.listen('treeView drag stop objects-tree', event => {\n\t\t\tconsole.log('event', event)\n\t\t\tif (event.type === 'epr' && event.targetElement.getAttribute('moduleid') === 'prefabs') {\n\t\t\t\tlet entityPrototypes = event.idList.map(getSerializable);\n\t\t\t\tentityPrototypes.forEach(epr => {\n\t\t\t\t\tlet prefab = Prefab.createFromPrototype(epr);\n\t\t\t\t\tgame.addChild(prefab);\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn;\n\t\t\tif (event.type === 'epr') {\n\t\t\t\tlet target = event.targetElement;\n\t\t\t\twhile (!target.classList.contains('jstree-node')) {\n\t\t\t\t\ttarget = target.parentElement;\n\t\t\t\t\tif (!target)\n\t\t\t\t\t\tthrow new Error('Invalid target', event.targetElement);\n\t\t\t\t}\n\t\t\t\tconsole.log('target.id', target.id)\n\t\t\t\tlet targetSerializable = getSerializable(target.id);\n\t\t\t\t\n\t\t\t\tlet idSet = new Set(event.idList);\n\t\t\t\tlet serializables = event.idList.map(getSerializable).filter(serializable => {\n\t\t\t\t\tlet parent = serializable.getParent();\n\t\t\t\t\twhile (parent) {\n\t\t\t\t\t\tif (idSet.has(parent.id))\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\tparent = parent.getParent();\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tconsole.log('move serializables', serializables, 'to', targetSerializable);\n\t\t\t\tserializables.forEach(serializable => {\n\t\t\t\t\tserializable.move(targetSerializable);\n\t\t\t\t});\n\t\t\t\tconsole.log('Done!')\n\t\t\t}\n\t\t});\n\t\t\n\t\tthis.dirty = true;\n\t\tthis.treeType = null;\n\t\t\n\t\t// This will be called when play and reset has already happened. After all the \n\t\tlet update = () => {\n\t\t\tthis.dirty = true;\n\t\t\tsetTimeout(() => this.update(), 100);\n\t\t};\n\t\tlistenSceneCreation(() => {\n\t\t\tscene.listen('onStart', update);\n\t\t\tscene.listen('reset', update);\n\t\t});\n\t\t\n\t\t// Set dirty so that every single serializable deletion and addition won't separately update the tree.\n\t\tlet setDirty = () => {\n\t\t\tthis.dirty = true;\n\t\t};\n\t\tevents.listen('play', setDirty, -1);\n\t\tevents.listen('reset', setDirty, -1);\n\t\tgame.listen('levelCompleted', setDirty, -1);\n\t\t\n\t\tlet tasks = [];\n\t\tlet taskTimeout = null;\n\t\t\n\t\tlet addTask = (task) => {\n\t\t\ttasks.push(task);\n\t\t\t\n\t\t\tif (taskTimeout)\n\t\t\t\tclearTimeout(taskTimeout);\n\t\t\t\n\t\t\tif (tasks.length > 1000) {\n\t\t\t\ttasks.length = 0;\n\t\t\t\tthis.dirty = true;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t\tlet delay = scene.playing ? 500 : 50;\n\n\t\t\ttaskTimeout = setTimeout(() => {\n\t\t\t\ttaskTimeout = null;\n\t\t\t\tif (tasks.length < 5) {\n\t\t\t\t\ttasks.forEach(task => task());\n\t\t\t\t} else {\n\t\t\t\t\tthis.dirty = true;\n\t\t\t\t}\n\t\t\t\ttasks.length = 0;\n\t\t\t}, delay);\n\t\t};\n\t\t\n\t\t// events.listen()\n\t\tevents.listen('change', change => {\n\t\t\tif (this.dirty || !this._selected)\n\t\t\t\treturn;\n\t\t\t\n\t\t\tperformance.start('Editor: Objects');\n\t\t\t\n\t\t\tthis.externalChange = true;\n\t\t\t\n\t\t\tlet newTask = null;\n\n\t\t\tif (change.type === changeType.addSerializableToTree) {\n\t\t\t\tif (change.reference.threeLetterType === this.treeType) {\n\t\t\t\t\tlet serializable = change.reference;\n\t\t\t\t\tnewTask = () => {\n\t\t\t\t\t\tthis.treeView.createNode(serializable.id, serializable.makeUpAName(), '#');\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t} else if (change.type === changeType.deleteSerializable) {\n\t\t\t\tif (change.reference.threeLetterType === this.treeType) {\n\t\t\t\t\tlet serializable = change.reference;\n\t\t\t\t\tnewTask = () => {\n\t\t\t\t\t\tthis.treeView.deleteNode(serializable.id);\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t} else if (change.type === 'editorSelection') {\n\t\t\t\tif (change.origin != this) {\n\t\t\t\t\tif (change.reference.type === this.treeType) {\n\t\t\t\t\t\tnewTask = () => {\n\t\t\t\t\t\t\tthis.treeView.select(change.reference.items.map(item => item.id));\n\t\t\t\t\t\t};\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnewTask = () => {\n\t\t\t\t\t\t\tthis.treeView.select(null);\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif (newTask) {\n\t\t\t\taddTask(newTask);\n\t\t\t}\n/*\n\t\t\tif (change.reference.threeLetterType === 'prt') {\n\t\t\t\tif (change.type === changeType.addSerializableToTree) {\n\t\t\t\t\tlet parent = change.parent;\n\t\t\t\t\tlet parentNode;\n\t\t\t\t\tif (parent.threeLetterType === 'gam')\n\t\t\t\t\t\tparentNode = '#';\n\t\t\t\t\telse\n\t\t\t\t\t\tparentNode = jstree.get_node(parent.id);\n\n\t\t\t\t\tjstree.create_node(parentNode, {\n\t\t\t\t\t\ttext: change.reference.getChildren('prp')[0].value,\n\t\t\t\t\t\tid: change.reference.id\n\t\t\t\t\t});\n\t\t\t\t} else\n\t\t\t\t\tthis.dirty = true; // prototypes added, removed, moved or something\n\t\t\t} else if (change.type === changeType.setPropertyValue) {\n\t\t\t\tlet propParent = change.reference._parent;\n\t\t\t\tif (propParent && propParent.threeLetterType === 'prt') {\n\t\t\t\t\tlet node = jstree.get_node(propParent.id);\n\t\t\t\t\tjstree.rename_node(node, change.value);\n\t\t\t\t}\n\t\t\t} else if (change.type === 'editorSelection') {\n\t\t\t\tif (change.origin != this) {\n\t\t\t\t\tif (change.reference.type === 'prt') {\n\t\t\t\t\t\tlet node = jstree.get_node(change.reference.items[0].id);\n\t\t\t\t\t\tjstree.deselect_all();\n\t\t\t\t\t\tjstree.select_node(node);\n\t\t\t\t\t} else if (change.reference.type === 'epr') {\n\t\t\t\t\t\tlet jstree = $(this.jstree).jstree(true);\n\t\t\t\t\t\tlet node = jstree.get_node(change.reference.items[0].getParentPrototype().id);\n\t\t\t\t\t\tjstree.deselect_all();\n\t\t\t\t\t\tjstree.select_node(node);\n\t\t\t\t\t} else if (change.reference.type === 'ent') {\n\t\t\t\t\t\tlet node = jstree.get_node(change.reference.items[0].prototype.getParentPrototype().id);\n\t\t\t\t\t\tjstree.deselect_all();\n\t\t\t\t\t\tjstree.select_node(node);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n*/\n\t\t\tthis.externalChange = false;\n\n\t\t\tperformance.stop('Editor: Objects');\n\t\t});\n\t}\n\tactivate() {\n\t\tthis.dirty = true;\n\t}\n\tupdate() {\n\t\tif (!scene || !editor.selectedLevel)\n\t\t\treturn false;\n\t\t\n\t\tif (!this._selected)\n\t\t\treturn true;\n\t\t\n\t\tlet newTreeType = this.treeType;\n\t\tif (scene.isInInitialState()) {\n\t\t\tnewTreeType = 'epr';\n\t\t} else {\n\t\t\tnewTreeType = 'ent';\n\t\t}\n\t\t\n\t\tif (!this.dirty && newTreeType === this.treeType)\n\t\t\treturn true;\n\t\t\n\t\tthis.treeType = newTreeType;\n\t\t\n\t\tlet data = [];\n\t\tif (this.treeType === 'epr') {\n\t\t\teditor.selectedLevel.forEachChild('epr', epr => {\n\t\t\t\tlet parent = epr.getParent();\n\t\t\t\tdata.push({\n\t\t\t\t\ttext: epr.makeUpAName(),\n\t\t\t\t\tid: epr.id,\n\t\t\t\t\tparent: parent.threeLetterType === 'epr' ? parent.id : '#'\n\t\t\t\t});\n\t\t\t}, true);\n\t\t} else if (this.treeType === 'ent') {\n\t\t\tscene.forEachChild('ent', ent => {\n\t\t\t\tlet parent = ent.getParent();\n\t\t\t\tdata.push({\n\t\t\t\t\ttext: ent.prototype ? ent.prototype.makeUpAName() : 'Object',\n\t\t\t\t\tid: ent.id,\n\t\t\t\t\tparent: parent.threeLetterType === 'ent' ? parent.id : '#'\n\t\t\t\t});\n\t\t\t}, true);\n\t\t}\n\t\tthis.treeView.update(data);\n\t\tthis.dirty = false;\n\t\t\n\t\treturn true;\n\t}\n}\n\nModule.register(Objects, 'left');\n","import {el, list, mount} from 'redom';\nimport Module from './module';\nimport {game} from '../../core/game';\nimport {editor} from '../editor';\nimport Level from '../../core/level';\nimport {Button} from '../views/popup/Popup';\nimport {dispatch, listen} from '../../util/events';\nimport events from \"../../util/events\";\nimport {setChangeOrigin} from \"../../core/serializableManager\";\n\nexport function createNewLevel() {\n\tlet lvl = new Level();\n\n\tlet levelNumber = 1;\n\tlet newLevelName;\n\twhile (true) {\n\t\tnewLevelName = 'Level ' + levelNumber;\n\t\tif (!editor.game.findChild('lvl', lvl => lvl.name === newLevelName, false)) {\n\t\t\tbreak;\n\t\t}\n\t\tlevelNumber++;\n\t}\n\n\tlvl.initWithPropertyValues({\n\t\tname: newLevelName\n\t});\n\teditor.game.addChild(lvl);\n\teditor.setLevel(lvl);\n\n\treturn lvl;\n}\n\nevents.listen('createBlankLevel', createNewLevel);\n\nclass Levels extends Module {\n\tconstructor() {\n\t\tsuper(\n\t\t\tthis.content = el('div',\n\t\t\t\tthis.buttons = list('div.levelSelectorButtons', LevelItem),\n\t\t\t\t'Create: ',\n\t\t\t\tthis.createButton = new Button\n\t\t\t)\n\t\t);\n\t\tthis.name = 'Levels';\n\t\tthis.id = 'levels';\n\n\t\tthis.createButton.update({\n\t\t\ttext: 'New level',\n\t\t\ticon: 'fa-area-chart',\n\t\t\tcallback: () => {\n\t\t\t\tsetChangeOrigin(this);\n\t\t\t\tlet lvl = createNewLevel();\n\t\t\t\teditor.select(lvl, this);\n\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tModule.activateModule('level', true, 'focusOnProperty', 'name');\n\t\t\t\t}, 100);\n\t\t\t}\n\t\t});\n\n\t\tlisten(this.el, 'selectLevel', level => {\n\t\t\teditor.setLevel(level);\n\t\t\teditor.select(level, this);\n\t\t});\n\t\t/*\n\t\t\t\tlisten(this.el, 'deleteLevel', level => {\n\t\t\t\t\tif (level.isEmpty() || confirm('Are you sure you want to delete level: ' + level.name)) {\n\t\t\t\t\t\tsetChangeOrigin(this);\n\t\t\t\t\t\tlevel.delete();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t*/\n\t}\n\n\tupdate() {\n\t\tthis.buttons.update(game.getChildren('lvl'));\n\t}\n}\n\nModule.register(Levels, 'left');\n\nclass LevelItem {\n\tconstructor() {\n\t\tthis.el = el('div.levelItem',\n\t\t\tthis.number = el('span'),\n\t\t\tthis.selectButton = new Button\n\t\t\t//,this.deleteButton = new Button\n\t\t)\n\t}\n\n\tselectClicked() {\n\t\tdispatch(this, 'selectLevel', this.level);\n\t}\n\n\t/*\n\tdeleteClicked() {\n\t\tdispatch(this, 'deleteLevel', this.level);\n\t}\n\t*/\n\tupdate(level, idx) {\n\t\tthis.level = level;\n\t\tthis.number.textContent = (idx + 1) + '.';\n\t\tthis.selectButton.update({\n\t\t\ttext: level.name,\n\t\t\ticon: 'fa-area-chart',\n\t\t\tcallback: () => this.selectClicked()\n\t\t});\n\t\t/*\n\t\tthis.deleteButton.update({\n\t\t\ttext: 'Delete',\n\t\t\tclass: 'dangerButton',\n\t\t\ticon: 'fa-cross',\n\t\t\tcallback: () => this.deleteClicked()\n\t\t});\n\t\t*/\n\t}\n}\n","import { el, list, mount } from 'redom';\nimport Vector from '../../../util/vector';\n\nconst EDITOR_FLOAT_PRECISION = Math.pow(10, 3);\n\n// <dataTypeName>: createFunction(container, oninput, onchange) -> setValueFunction\nlet editors = {};\nexport default editors;\n\neditors.default = editors.string = (container, oninput, onchange, options) => {\n\tlet input = el('input', {\n\t\tplaceholder: options.placeholder || '',\n\t\toninput: () => oninput(input.value),\n\t\tonchange: () => onchange(input.value)\n\t});\n\tmount(container, input);\n\n\treturn val => input.value = val;\n};\n\neditors.float = editors.int = (container, oninput, onchange) => {\n\tlet input = el('input', {\n\t\ttype: 'number',\n\t\toninput: () => oninput(+input.value),\n\t\tonchange: () => onchange(+input.value)\n\t});\n\tmount(container, input);\n\treturn val => input.value = Math.round(val*EDITOR_FLOAT_PRECISION) / EDITOR_FLOAT_PRECISION;\n};\n\neditors.bool = (container, oninput, onchange) => {\n\tlet input = el('input', {\n\t\ttype: 'checkbox',\n\t\tonchange: () => {\n\t\t\tonchange(input.checked);\n\t\t\tlabel.textContent = input.checked ? 'Yes' : 'No';\n\t\t}\n\t});\n\tlet label = el('span');\n\tmount(container, el('label', input, label));\n\treturn val => {\n\t\tinput.checked = val;\n\t\tlabel.textContent = val ? 'Yes' : 'No';\n\t}\n};\n\neditors.vector = (container, oninput, onchange) => {\n\tfunction getValue() {\n\t\treturn new Vector(+xInput.value, +yInput.value);\n\t}\n\tlet xInput = el('input.xInput', {\n\t\ttype: 'number',\n\t\toninput: () => oninput(getValue()),\n\t\tonchange: () => onchange(getValue())\n\t});\n\tlet yInput = el('input', {\n\t\ttype: 'number',\n\t\toninput: () => oninput(getValue()),\n\t\tonchange: () => onchange(getValue())\n\t});\n\tmount(container, el('div', el('span', 'x:'), xInput, el('span', 'y:'), yInput));\n\treturn val => {\n\t\txInput.value = Math.round(val.x*EDITOR_FLOAT_PRECISION) / EDITOR_FLOAT_PRECISION;\n\t\tyInput.value = Math.round(val.y*EDITOR_FLOAT_PRECISION) / EDITOR_FLOAT_PRECISION;\n\t};\n};\n\neditors.enum = (container, oninput, onchange, options) => {\n\tlet select = el('select', ...options.propertyType.validator.parameters.map(p => el('option', p)));\n\tselect.onchange = () => {\n\t\tonchange(select.value);\n\t};\n\tmount(container, select);\n\treturn val => {\n\t\tselect.value = val;\n\t}\n};\n\neditors.color = (container, oninput, onchange) => {\n\tlet input = el('input', {\n\t\ttype: 'color',\n\t\toninput: () => oninput(input.value),\n\t\tonchange: () => onchange(input.value)\n\t});\n\tmount(container, input);\n\treturn val => input.value = val.toHexString();\n};\n","import Popup, { Button, popupDepth } from './Popup';\nimport { el, mount, list } from 'redom';\n\nexport default class Confirmation extends Popup {\n\t/*\n\tbuttonOptions:\n\t- text\n\t- color\n\t- icon (fa-plus)\n\t */\n\tconstructor(question, buttonOptions, callback) {\n\t\tsuper({\n\t\t\ttitle: question,\n\t\t\twidth: '500px',\n\t\t\tcontent: list('div.confirmationButtons', Button)\n\t\t});\n\t\t\n\t\tthis.content.update([{\n\t\t\ttext: 'Cancel',\n\t\t\tcallback: () => this.remove()\n\t\t}, Object.assign({\n\t\t\ttext: 'Confirm'\n\t\t}, buttonOptions, {\n\t\t\tcallback: () => {\n\t\t\t\tcallback();\n\t\t\t\tthis.remove();\n\t\t\t}\n\t\t})]);\n\t\t\n\t\tlet confirmButton = this.content.views[1];\n\t\tconfirmButton.el.focus();\n\t}\n\n\tremove() {\n\t\tsuper.remove();\n\t}\n}\n","import Popup, {Button} from './Popup';\nimport {componentClasses} from '../../../core/component';\nimport ComponentData from '../../../core/componentData';\nimport {list, el} from 'redom';\nimport assert from '../../../util/assert';\nimport {setChangeOrigin} from '../../../core/serializableManager';\nimport Confirmation from './Confirmation';\nimport { dispatch, listen } from '../../../util/events';\n\nconst CATEGORY_ORDER = [\n\t'Common',\n\t'Logic',\n\t'Graphics'\n];\n\nconst HIDDEN_COMPONENTS = ['Transform', 'EditorWidget'];\n\nexport default class ComponentAdder extends Popup {\n\tconstructor(parent) {\n\t\tsuper({\n\t\t\ttitle: 'Add Component',\n\t\t\tcontent: list('div.componentAdderContent', Category, undefined, parent)\n\t\t});\n\n\n\t\tlet componentClassArray = Array.from(componentClasses.values())\n\t\t.filter(cl => !HIDDEN_COMPONENTS.includes(cl.componentName))\n\t\t.sort((a, b) => a.componentName.localeCompare(b.componentName));\n\n\t\tconsole.log('before set', componentClassArray.map(c => c.category))\n\t\tconsole.log('set', new Set(componentClassArray.map(c => c.category)))\n\t\tconsole.log('set array', [...new Set(componentClassArray.map(c => c.category))])\n\n\t\tlet categories = Array.from(new Set(componentClassArray.map(c => c.category))).map(categoryName => ({\n\t\t\tcategoryName,\n\t\t\tcomponents: componentClassArray.filter(c => c.category === categoryName)\n\t\t}));\n\n\t\tcategories.sort((a, b) => {\n\t\t\tlet aIdx = CATEGORY_ORDER.indexOf(a.categoryName);\n\t\t\tlet bIdx = CATEGORY_ORDER.indexOf(b.categoryName);\n\n\t\t\tif (aIdx < 0) aIdx = 999;\n\t\t\tif (bIdx < 0) bIdx = 999;\n\n\t\t\tif (aIdx < bIdx) return -1;\n\t\t\telse return 1;\n\t\t});\n\n\t\tthis.update(categories);\n\t\t\n\t\tlisten(this, 'refresh', () => {\n\t\t\tthis.update(categories);\n\t\t})\n\t}\n\n\tupdate(categories) {\n\t\tthis.content.update(categories);\n\t}\n}\n\nclass Category {\n\tconstructor(parent) {\n\t\tthis.el = el('div.categoryItem',\n\t\t\tthis.name = el('div.categoryName'),\n\t\t\tthis.list = list('div.categoryButtons', ButtonWithDescription)\n\t\t);\n\t\tthis.parent = parent;\n\t}\n\n\taddComponentToParent(componentClass) {\n\t\tsetChangeOrigin(this);\n\n\t\tfunction addComponentDatas(parent, componentNames) {\n\t\t\treturn parent.addChildren(componentNames.map(name => new ComponentData(name)));\n\t\t}\n\n\t\tif (['epr', 'prt'].indexOf(this.parent.threeLetterType) >= 0) {\n\t\t\tlet missingRequirements = getMissingRequirements(this.parent, componentClass.requirements);\n\n\t\t\tif (missingRequirements.length === 0) {\n\t\t\t\taddComponentDatas(this.parent, [componentClass.componentName]);\n\t\t\t\tdispatch(this, 'refresh');\n\t\t\t} else {\n\t\t\t\tnew Confirmation(`<b>${componentClass.componentName}</b> needs these components in order to work: <b>${missingRequirements.join(', ')}</b>`, {\n\t\t\t\t\ttext: `Add all (${missingRequirements.length + 1}) components`,\n\t\t\t\t\tcolor: '#4ba137',\n\t\t\t\t\ticon: 'fa-plus'\n\t\t\t\t}, () => {\n\t\t\t\t\taddComponentDatas(this.parent, missingRequirements.concat(componentClass.componentName));\n\t\t\t\t\tdispatch(this, 'refresh');\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tassert(false);\n\t}\n\n\tupdate(category) {\n\t\tthis.name.textContent = category.categoryName;\n\t\t\n\t\tlet componentCounts = {};\n\t\tthis.parent.forEachChild('cda', cda => {\n\t\t\tif (!componentCounts[cda.name])\n\t\t\t\tcomponentCounts[cda.name] = 0;\n\t\t\tcomponentCounts[cda.name]++;\n\t\t});\n\n\t\tlet componentButtonData = category.components.map(comp => {\n\t\t\tlet disabledReason;\n\t\t\tif (!comp.allowMultiple && this.parent.findChild('cda', cda => cda.name === comp.componentName) !== null) {\n\t\t\t\tdisabledReason = `Only one ${comp.componentName} component is allowed at the time`;\n\t\t\t}\n\t\t\tlet count = componentCounts[comp.componentName];\n\t\t\treturn {\n\t\t\t\ttext: comp.componentName + (count ? ` (${count})` : ''),\n\t\t\t\tdescription: comp.description,\n\t\t\t\tcolor: comp.color,\n\t\t\t\ticon: comp.icon,\n\t\t\t\tdisabledReason,\n\t\t\t\tcallback: () => {\n\t\t\t\t\tif ('activeElement' in document)\n\t\t\t\t\t\tdocument.activeElement.blur();\n\t\t\t\t\t\n\t\t\t\t\tthis.addComponentToParent(comp);\n\t\t\t\t}\n\t\t\t};\n\t\t});\n\n\t\tthis.list.update(componentButtonData);\n\t}\n}\n\nclass ButtonWithDescription {\n\tconstructor() {\n\t\tthis.el = el('div.buttonWithDescription',\n\t\t\tthis.button = new Button(),\n\t\t\tthis.description = el('span.description')\n\t\t);\n\t}\n\n\tupdate(buttonData) {\n\t\tthis.description.innerHTML = buttonData.description;\n\t\tthis.button.el.disabled = buttonData.disabledReason ? 'disabled' : '';\n\t\tthis.button.el.setAttribute('title', buttonData.disabledReason || '');\n\t\tthis.button.update(buttonData);\n\t}\n}\n\nfunction getMissingRequirements(parent, requirements) {\n\tfunction isMissing(componentName) {\n\t\tlet componentData = parent.findChild('cda', componentData => componentData.name === componentName)\n\t\treturn !componentData;\n\t}\n\n\treturn requirements.filter(isMissing).filter(r => r !== 'Transform');\n}\n","import Popup, { Button } from './Popup';\nimport { componentClasses } from '../../../core/component';\nimport ComponentData from '../../../core/componentData';\nimport { list, el } from 'redom';\nimport assert from '../../../util/assert';\nimport { setChangeOrigin } from '../../../core/serializableManager';\nimport { game } from '../../../core/game'\n\nexport default class ObjectMoreButtonContextMenu extends Popup {\n\tconstructor(property) {\n\t\tsuper({\n\t\t\ttitle: 'Object Property: ' + property.name,\n\t\t\twidth: '500px',\n\t\t\tcontent: this.buttons = list('div', Button)\n\t\t});\n\n\t\tlet value = property.value;\n\t\tlet component = property.getParent();\n\t\tlet componentId = component._componentId;\n\t\tlet entityPrototype = component.entity.prototype;\n\t\tlet prototype = entityPrototype.prototype;\n\t\t\n\t\tlet actions = [\n\t\t\t{\n\t\t\t\ttext: 'Copy value to type ' + prototype.name,\n\t\t\t\tcallback: () => {\n\t\t\t\t\tsetChangeOrigin(this);\n\t\t\t\t\tlet componentData = prototype.getOwnComponentDataOrInherit(componentId);\n\t\t\t\t\tif (componentData) {\n\t\t\t\t\t\tlet newProperty = componentData.getPropertyOrCreate(property.name);\n\t\t\t\t\t\tnewProperty.value = property.value;\n\t\t\t\t\t} else {\n\t\t\t\t\t\talert('Error: Component data not found');\n\t\t\t\t\t}\n\t\t\t\t\tthis.remove();\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\ttext: 'Save value for this object',\n\t\t\t\tcallback: () => {\n\t\t\t\t\tsetChangeOrigin(this);\n\n\t\t\t\t\tlet componentData = entityPrototype.getOwnComponentDataOrInherit(componentId);\n\t\t\t\t\tif (componentData) {\n\t\t\t\t\t\tlet newProperty = componentData.getPropertyOrCreate(property.name);\n\t\t\t\t\t\tnewProperty.value = property.value;\n\t\t\t\t\t} else {\n\t\t\t\t\t\talert('Error: Component data not found');\n\t\t\t\t\t}\n\t\t\t\t\tthis.remove();\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\t\n\t\tthis.update(actions);\n\t}\n\tupdate(data) {\n\t\tthis.buttons.update(data);\n\t}\n}\n","export function skipTransitions(element) {\n\treturn;\n\telement.classList.add('skipPropertyEditorTransitions');\n\tsetTimeout(() => {\n\t\telement.classList.remove('skipPropertyEditorTransitions');\n\t}, 10);\n} \n\nexport function parseTextAndNumber(textAndNumber) {\n\tlet endingNumberMatch = textAndNumber.match(/\\d+$/); // ending number\n\tlet num = endingNumberMatch ? parseInt(endingNumberMatch[0]) + 1 : 2;\n\tlet nameWithoutNumber = endingNumberMatch ? textAndNumber.substring(0, textAndNumber.length - endingNumberMatch[0].length) : textAndNumber;\n\t\n\treturn {\n\t\ttext: nameWithoutNumber,\n\t\tnumber: num\n\t};\n}\n","import { el, list, mount } from 'redom';\nimport events, { listen, dispatch } from '../../../util/events';\nimport showPopup from '../popup/Popup';\nimport ComponentData from '../../../core/componentData';\nimport assert from '../../../util/assert';\nimport editors from './propertyEditorTypes';\nimport ComponentAdder from '../popup/componentAdder';\nimport { changeType, setChangeOrigin } from '../../../core/serializableManager';\nimport { Prop } from '../../../core/component';\nimport { setOption, getOption, editor } from '../../editor';\nimport { scene } from '../../../core/scene';\nimport * as sceneEdit from '../../util/sceneEditUtil';\nimport PropertyOwner from '../../../core/propertyOwner';\nimport * as performance from '../../../util/performance'\nimport ObjectMoreButtonContextMenu from '../popup/objectMoreButtonContextMenu'\nimport Confirmation from \"../popup/Confirmation\";\nimport { listenKeyDown, key } from '../../../util/input';\nimport {parseTextAndNumber, skipTransitions} from './util';\n\n/*\nReference: Unbounce\n https://cdn8.webmaster.net/pics/Unbounce2.jpg\n */\n\nexport default class PropertyEditor {\n\tconstructor() {\n\t\tthis.el = el('div.propertyEditor',\n\t\t\tthis.list = list('div.propertyEditorList', Container)\n\t\t);\n\t\tthis.dirty = true;\n\t\tthis.editingProperty = false;\n\t\t\n\t\t// Change in serializable tree\n\t\tevents.listen('change', change => {\n\t\t\tif (change.type === 'editorSelection') {\n\t\t\t\tthis.dirty = true;\n\t\t\t} else if (change.type === changeType.setPropertyValue) {\n\t\t\t\tif (this.item && this.item.hasDescendant(change.reference)) {\n\t\t\t\t\tif (change.origin === this) {\n\t\t\t\t\t\tif (this.item.threeLetterType === 'ent') {\n\t\t\t\t\t\t\tthis.item.dispatch('changedInEditor');\n\t\t\t\t\t\t\tsceneEdit.entityModifiedInEditor(this.item, change);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.dirty = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (change.type === changeType.addSerializableToTree) {\n\t\t\t\tif (change.parent === this.item || this.item && this.item.hasDescendant(change.parent))\n\t\t\t\t\tthis.dirty = true;\n\t\t\t} else if (change.type === changeType.deleteSerializable) {\n\t\t\t\tif (this.item && this.item.hasDescendant(change.reference)) {\n\t\t\t\t\tthis.dirty = true;\n\t\t\t\t}\n\t\t\t} else if (change.type === changeType.deleteAllChildren) {\n\t\t\t\tif (this.item && this.item.hasDescendant(change.reference)) {\n\t\t\t\t\tthis.dirty = true;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t\n\t\tlisten(this, 'makingChanges', () => {\n\t\t\tsetChangeOrigin(this);\n\t\t});\n\t\t\n\t\t// Change in this editor\n\t\tlisten(this, 'markPropertyEditorDirty', () => {\n\t\t\tthis.dirty = true;\n\t\t});\n\t\t\n\t\tlisten(this, 'propertyEditorSelect', items => {\n\t\t\teditor.select(items, this);\n\t\t});\n\n\t\tlistenKeyDown(keyCode => {\n\t\t\tif (keyCode === key.esc) {\n\t\t\t\tif ('activeElement' in document && document.activeElement.tagName === 'INPUT') {\n\t\t\t\t\tdocument.activeElement.blur();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\tupdate(items, threeLetterType) {\n\t\tif (!this.dirty) return;\n\t\tif (!items) return;\n\t\t\n\t\tif (['prt', 'ent', 'epr'].indexOf(threeLetterType) >= 0 && items.length === 1\n\t\t|| items.length === 1 && items[0] instanceof PropertyOwner) {\n\t\t\tthis.item = items[0];\n\t\t\tthis.list.update([this.item]);\n\t\t} else {\n\t\t\tthis.list.update([]);\n\t\t}\n\t\t\n\t\tthis.dirty = false;\n\t}\n}\n\n/*\n\t// item gives you happy\n\t   happy makes you jump\n\t{\n\t\tif (item)\n\t\t\t[happy]\n\t\t\tif happy [then]\n\t\t\t\t[jump]\n\t\t\telse\n\t\tif (lahna)\n\t\t\t}\n*/\n\nclass Container {\n\tconstructor() {\n\t\tthis.el = el('div.container',\n\t\t\tthis.title = el('div.containerTitle',\n\t\t\t\tthis.titleText = el('span.containerTitleText'),\n\t\t\t\tthis.titleIcon = el('i.icon.fa')\n\t\t\t),\n\t\t\tthis.content = el('div.containerContent',\n\t\t\t\tthis.properties = list('div.propertyEditorProperties', Property, null, this.propertyEditor),\n\t\t\t\tthis.containers = list('div', Container, null, this.propertyEditor),\n\t\t\t\tthis.controls = el('div'),\n\t\t\t\tel('i.button.logButton.fa.fa-eye', {\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tconsole.log(this.item);\n\t\t\t\t\t\twindow.item = this.item;\n\t\t\t\t\t\tconsole.log(`you can use variable 'item'`);\n\t\t\t\t\t\tlet element = el('span', ' logged to console');\n\t\t\t\t\t\tmount(this.title, element);\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tthis.title.removeChild(element);\n\t\t\t\t\t\t}, 500);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t)\n\t\t);\n\t\tthis.titleClickedCallback = null;\n\t\tthis.title.onclick = () => {\n\t\t\tthis.titleClickedCallback && this.titleClickedCallback();\n\t\t};\n\t\t\n\t\tlisten(this, 'propertyInherited', (property, view) => {\n\t\t\tif (this.item.threeLetterType !== 'icd') return;\n\t\t\t// this.item is inheritedComponentData\n\t\t\tlet proto = this.item.generatedForPrototype;\n\t\t\tlet newProperty = proto.createAndAddPropertyForComponentData(this.item, property.name, property.value);\n\t\t\tview.update(newProperty);\n\t\t\t// dispatch(this, 'markPropertyEditorDirty');\n\t\t});\n\t}\n\tupdate(state) {\n\t\tlet itemChanged = this.item !== state;\n\t\t\n\t\tif (itemChanged) {\n\t\t\tthis.item = state;\n\t\t\tthis.el.setAttribute('type', this.item.threeLetterType);\n\n\t\t\t// Skip transitions when changing item\n\t\t\tskipTransitions(this.el);\n\t\t}\n\t\t\n\t\tthis.clearControls();\n\t\t\n\t\tthis.titleClickedCallback = null;\n\n\t\tif (this.item.threeLetterType === 'icd') this.updateInheritedComponentData();\n\t\telse if (this.item.threeLetterType === 'ent') this.updateEntity();\n\t\telse if (this.item.threeLetterType === 'com') this.updateComponent();\n\t\telse if (this.item.threeLetterType === 'prt') this.updatePrototype();\n\t\telse if (this.item.threeLetterType === 'epr') this.updateEntityPrototype();\n\t\telse if (this.item.threeLetterType === 'pfa') this.updatePrefab();\n\t\telse if (this.item instanceof PropertyOwner) this.updatePropertyOwner();\n\t}\n\tclearControls() {\n\t\tif (this.controls.innerHTML !== '')\n\t\t\tthis.controls.innerHTML = '';\n\t}\n\tupdatePrototype() {\n\t\tlet inheritedComponentDatas = this.item.getInheritedComponentDatas();\n\t\tthis.containers.update(inheritedComponentDatas);\n\t\tthis.properties.update(this.item.getChildren('prp'));\n\t\t\n\t\tlet addButton;\n\t\tmount(this.controls, addButton = el('button.button', el('i.fa.fa-puzzle-piece'), 'Add Component', {\n\t\t\tonclick: () => {\n\t\t\t\tnew ComponentAdder(this.item);\n\t\t\t}\n\t\t}));\n\t\tif (inheritedComponentDatas.length === 0)\n\t\t\taddButton.classList.add('clickMeEffect');\n\t\t\n\t\tmount(this.controls, el('button.button', el('i.fa.fa-clone'), 'Clone Type', { onclick: () => {\n\t\t\tdispatch(this, 'makingChanges');\n\t\t\tlet clone = this.item.clone();\n\t\t\tlet { text, number } = parseTextAndNumber(clone.name);\n\t\t\tlet nameSuggestion = text + number++;\n\t\t\twhile (this.item.getParent().findChild('prt', prt => prt.name === nameSuggestion)) {\n\t\t\t\tnameSuggestion = text + number++;\n\t\t\t}\n\t\t\tclone.name = nameSuggestion;\n\t\t\tthis.item.getParent().addChild(clone);\n\t\t\tdispatch(this, 'propertyEditorSelect', clone);\n\t\t} }));\n\t\tmount(this.controls, el('button.dangerButton.button', el('i.fa.fa-times'), 'Delete Type', { onclick: () => {\n\t\t\tdispatch(this, 'makingChanges');\n\t\t\tlet entityPrototypeCount = this.item.countEntityPrototypes(true);\n\t\t\tif (entityPrototypeCount) {\n\t\t\t\tif (confirm(`Type ${this.item.name} is used in levels ${entityPrototypeCount} times. Are you sure you want to delete this type and all ${entityPrototypeCount} objects that are using it?`))\n\t\t\t\t\tthis.item.delete();\n\t\t\t} else {\n\t\t\t\tthis.item.delete();\n\t\t\t}\n\t\t\teditor.select();\n\t\t} }));\n\t}\n\tupdateEntityPrototype() {\n\t\tlet inheritedComponentDatas = this.item.getInheritedComponentDatas();\n\t\tthis.containers.update(inheritedComponentDatas);\n\t\tlet properties = this.item.getChildren('prp');\n\t\tproperties.forEach(prop => {\n\t\t\tprop._editorPlaceholder = this.item.makeUpAName();//.prototype.findChild('prp', prp => prp.name === prop.name).value;\n\t\t});\n\t\tthis.properties.update(properties);\n\t\tmount(this.controls, el(`button.button`, el('i.fa.fa-puzzle-piece'), 'Add Component', {\n\t\t\tonclick: () => {\n\t\t\t\tnew ComponentAdder(this.item);\n\t\t\t}\n\t\t}));\n\t}\n\tupdatePrefab() {\n\t\tlet inheritedComponentDatas = this.item.getInheritedComponentDatas();\n\t\tthis.containers.update(inheritedComponentDatas);\n\t\tlet properties = this.item.getChildren('prp');\n\t\tproperties.forEach(prop => {\n\t\t\tprop._editorPlaceholder = this.item.makeUpAName();//.prototype.findChild('prp', prp => prp.name === prop.name).value;\n\t\t});\n\t\tthis.properties.update(properties);\n\t\tmount(this.controls, el(`button.button`, el('i.fa.fa-puzzle-piece'), 'Add Component', {\n\t\t\tonclick: () => {\n\t\t\t\tnew ComponentAdder(this.item);\n\t\t\t}\n\t\t}));\n\t}\n\tupdateInheritedComponentData() {\n\t\tthis.updateComponentKindOfThing(this.item.componentClass);\n\t\t\n\t\tlet packId = 'pack' + this.item.componentClass.componentName;\n\t\tlet packedStatus = getOption(packId);\n\t\tif (packedStatus === 'true') {\n\t\t\tthis.el.classList.add('packed');\n\t\t} else if (packedStatus === 'false') {\n\t\t\tthis.el.classList.remove('packed');\n\t\t} else {\n\t\t\tthis.el.classList.toggle('packed', !this.item.ownComponentData);\n\t\t}\n\t\t\n\t\tthis.titleClickedCallback = () => {\n\t\t\tthis.el.classList.toggle('packed');\n\t\t\tsetOption(packId, this.el.classList.contains('packed') ? 'true' : 'false');\n\t\t};\n\t\t\n\t\tlet parentComponentData = this.item.ownComponentData && this.item.ownComponentData.getParentComponentData();\n\t\tlet hasOwnProperties = false;\n\t\tthis.item.properties.forEach(prop => {\n\t\t\tif (prop.id)\n\t\t\t\thasOwnProperties = true;\n\t\t\tif (prop.propertyType.visibleIf) {\n\t\t\t\tprop._editorVisibleIfTarget = this.item.properties.find(p => p.name === prop.propertyType.visibleIf.propertyName);\n\t\t\t}\n\t\t});\n\t\tthis.properties.update(this.item.properties);\n\t\t\n\t\tif (!this.item.ownComponentData || parentComponentData) {\n\t\t\tmount(this.controls, el('button.button', 'Show Parent', {\n\t\t\t\tonclick: () => {\n\t\t\t\t\tlet componentData = this.item.generatedForPrototype.getParentPrototype().findComponentDataByComponentId(this.item.componentId, true);\n\t\t\t\t\tdispatch(this, 'propertyEditorSelect', componentData.getParent());\n\t\t\t\t\tdispatch(this, 'markPropertyEditorDirty');\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\n\t\tif (this.item.componentClass.componentName === 'Transform'\n\t\t\t&& this.item.generatedForPrototype.threeLetterType === 'epr')\n\t\t\treturn;\n\t\t\n\t\tif (this.item.componentClass.allowMultiple) {\n\t\t\tmount(this.controls, el('button.button', el('i.fa.fa-clone'), 'Clone', {\n\t\t\t\tonclick: () => {\n\t\t\t\t\tdispatch(this, 'makingChanges');\n\t\t\t\t\tif (this.item.ownComponentData) {\n\t\t\t\t\t\tlet clone = this.item.ownComponentData.clone();\n\t\t\t\t\t\tthis.item.generatedForPrototype.addChild(clone);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Is empty component data\n\t\t\t\t\t\tlet componentData = new ComponentData(this.item.componentClass.componentName);\n\t\t\t\t\t\tcomponentData.initWithChildren();\n\t\t\t\t\t\tthis.item.generatedForPrototype.addChild(componentData);\n\t\t\t\t\t}\n\t\t\t\t\tdispatch(this, 'markPropertyEditorDirty');\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\t\tif (hasOwnProperties) {\n\t\t\tmount(this.controls, el('button.dangerButton.button', el('i.fa.fa-refresh'), 'Reset', {\n\t\t\t\tonclick: () => {\n\t\t\t\t\tdispatch(this, 'makingChanges');\n\t\t\t\t\tdispatch(this, 'markPropertyEditorDirty', 'fromReset');\n\t\t\t\t\tif (this.item.ownComponentData.getParentComponentData()) {\n\t\t\t\t\t\tthis.item.ownComponentData.delete();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.item.ownComponentData.deleteChildren();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\t\tif (this.item.ownComponentData && !parentComponentData) {\n\t\t\tmount(this.controls, el('button.dangerButton.button', el('i.fa.fa-times'), 'Delete', {\n\t\t\t\tonclick: () => {\n\t\t\t\t\tlet deleteOperation = () => {\n\t\t\t\t\t\tdispatch(this, 'makingChanges');\n\t\t\t\t\t\tdispatch(this, 'markPropertyEditorDirty');\n\t\t\t\t\t\tthis.item.ownComponentData.delete();\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tlet componentName = this.item.componentClass.componentName;\n\t\t\t\t\tlet parent = this.item.ownComponentData.getParent();\n\t\t\t\t\tlet similarComponent = parent.findChild('cda', cda => cda.name === componentName && cda !== this.item.ownComponentData);\n\t\t\t\t\tif (!similarComponent) {\n\t\t\t\t\t\tlet componentsThatRequire = parent.getChildren('cda').filter(componentData => componentData.componentClass.requirements.includes(componentName));\n\t\t\t\t\t\tif (componentsThatRequire.length > 0) {\n\t\t\t\t\t\t\tnew Confirmation(`<b>${componentName}</b> is needed by: <b>${componentsThatRequire.map(cda => cda.name).join(', ')}</b>`, {\n\t\t\t\t\t\t\t\ttext: `Delete all (${componentsThatRequire.length + 1}) components`,\n\t\t\t\t\t\t\t\tcolor: '#cd4148'\n\t\t\t\t\t\t\t}, () => {\n\t\t\t\t\t\t\t\tdispatch(this, 'makingChanges');\n\t\t\t\t\t\t\t\tdispatch(this, 'markPropertyEditorDirty');\n\t\t\t\t\t\t\t\tcomponentsThatRequire.forEach(cda => {\n\t\t\t\t\t\t\t\t\tcda.delete();\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tthis.item.ownComponentData.delete();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tdispatch(this, 'makingChanges');\n\t\t\t\t\tdispatch(this, 'markPropertyEditorDirty');\n\t\t\t\t\tthis.item.ownComponentData.delete();\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\t}\n\tupdateEntity() {\n\t\tlet entityName = this.item.makeUpAName();\n\t\tif (this.titleText.textContent !== entityName)\n\t\t\tthis.titleText.textContent = entityName;\n\t\tthis.containers.update(this.item.getListOfAllComponents());\n\t\t// this.properties.update(this.item.getChildren('prp'));\n\t}\n\tupdateComponent() {\n\t\tif (this.el.classList.contains('packed'))\n\t\t\tthis.el.classList.remove('packed');\n\n\t\tthis.updateComponentKindOfThing(this.item.constructor);\n\n\t\tlet getChildren = this.item.getChildren('prp');\n\n\t\tthis.properties.update(getChildren);\n\t}\n\tupdateComponentKindOfThing(componentClass) {\n\t\tif (this.titleText.textContent !== componentClass.componentName)\n\t\t\tthis.titleText.textContent = componentClass.componentName;\n\n\t\tlet className = 'icon fa ' + componentClass.icon;\n\t\tif (this.titleIcon.className !== className)\n\t\t\tthis.titleIcon.className = className;\n\t\t\n\t\tif (this.componentClassColorCache !== componentClass.color) {\n\t\t\tthis.componentClassColorCache = componentClass.color;\n\t\t\t\n\t\t\tthis.title.style.color = componentClass.color;\n\t\t\tthis.el.style['border-color'] = componentClass.color;\n\t\t}\n\t\t\n\t\tif (this.title.getAttribute('title') !== componentClass.description)\n\t\t\tthis.title.setAttribute('title', componentClass.description);\n\t}\n\tupdatePropertyOwner() {\n\t\tthis.properties.update(this.item.getChildren('prp'));\n\t}\n}\n\nclass Property {\n\tconstructor() {\n\t\tthis.el = el('div.property', { name: '' },\n\t\t\tthis.name = el('div.nameCell'),\n\t\t\tthis.content = el('div.propertyContent')\n\t\t);\n\t}\n\treset() {\n\t\tlet componentData = this.property.getParent();\n\t\tthis.property.delete();\n\t\tif (componentData._children.size === 0) {\n\t\t\tif (componentData.getParentComponentData())\n\t\t\t\tcomponentData.delete();\n\t\t}\n\t\t\n\t\tdispatch(this, 'markPropertyEditorDirty');\n\t}\n\tfocus() {\n\t\tthis.el.querySelector('input').focus();\n\t}\n\toninput(val) {\n\t\ttry {\n\t\t\tthis.property.propertyType.validator.validate(this.convertFromInputToPropertyValue(val));\n\t\t\tthis.el.removeAttribute('error');\n\t\t} catch(e) {\n\t\t\tthis.el.setAttribute('error', 'true');\n\t\t}\n\t}\n\tonchange(val) {\n\t\tlet originalValue = this.property.value;\n\t\ttry {\n\t\t\tdispatch(this, 'makingChanges');\n\t\t\tthis.property.value = this.property.propertyType.validator.validate(this.convertFromInputToPropertyValue(val));\n\t\t\tif (!this.property.id) {\n\t\t\t\tdispatch(this, 'propertyInherited', this.property);\n\t\t\t}\n\t\t} catch(e) {\n\t\t\t// console.log('Error while changing property value', this.property, this.input.value);\n\t\t\tthis.property.value = originalValue;\n\t\t}\n\t\tthis.setValueFromProperty();\n\t\tthis.el.removeAttribute('error');\n\t}\n\tsetValueFromProperty() {\n\t\tlet val = this.property.value;\n\t\tif (this.property.propertyType.getFlag(Prop.flagDegreesInEditor))\n\t\t\tval = Math.round(val * 180 / Math.PI * 10) / 10;\n\t\tthis.setValue(val);\n\t}\n\tconvertFromInputToPropertyValue(val) {\n\t\tif (this.property.propertyType.getFlag(Prop.flagDegreesInEditor))\n\t\t\treturn val * Math.PI / 180;\n\t\telse\n\t\t\treturn val;\n\t}\n\tupdateVisibleIf() {\n\t\tif (!this.property._editorVisibleIfTarget)\n\t\t\treturn;\n\t\tthis.el.classList.toggle('hidden', !this.property.propertyType.visibleIf.values.includes(this.property._editorVisibleIfTarget.value));\n\t}\n\tupdate(property) {\n\t\t// Optimization\n\t\tif (this.property === property && this._previousValue === property.value)\n\t\t\treturn;\n\t\t\n\t\tconst propertyChanged = this.property !== property;\n\t\tlet keepOldInput = false;\n\t\tif (this.property && this.property.propertyType === property.propertyType && !this.property.id && property.id) {\n\t\t\t// Special case.\n\t\t\tkeepOldInput = true;\n\t\t}\n\t\t\n\t\tthis._previousValue = property.value;\n\t\t\n\t\tif (this.visibleIfListener) {\n\t\t\tthis.visibleIfListener(); // unlisten\n\t\t\tthis.visibleIfListener = null;\n\t\t}\n\t\tthis.property = property;\n\t\tif (propertyChanged) {\n\t\t\tthis.el.setAttribute('name', property.name);\n\t\t\tthis.el.setAttribute('type', property.propertyType.type.name);\n\t\t\tthis.name.textContent = variableNameToPresentableName(property.propertyType.name);\n\t\t\tthis.name.setAttribute('title', `${property.propertyType.name} (${property.propertyType.type.name}) ${property.propertyType.description}`);\n\t\t\tthis.name.style['font-size'] = this.name.textContent.length > 18 ? '0.8rem' : '1rem';\n\t\t\tif (property.propertyType.description) {\n\t\t\t\tmount(this.name, el('span.infoI', 'i'));\n\t\t\t}\n\t\t\t\n\t\t\tif (!keepOldInput) {\n\t\t\t\tthis.content.innerHTML = '';\n\t\t\t\tthis.propertyEditorInstance = editors[this.property.propertyType.type.name] || editors.default;\n\t\t\t\tthis.setValue = this.propertyEditorInstance(this.content, val => this.oninput(val), val => this.onchange(val), {\n\t\t\t\t\tpropertyType: property.propertyType,\n\t\t\t\t\tplaceholder: property._editorPlaceholder\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\tthis.el.classList.toggle('visibleIf', !!property.propertyType.visibleIf);\n\t\t\tthis.el.classList.toggle('ownProperty', !!this.property.id);\n\n\t\t\tif (this.property.id) {\n\t\t\t\tlet parent = this.property.getParent();\n\t\t\t\tif (parent.threeLetterType === 'cda'\n\t\t\t\t\t&& (parent.name !== 'Transform' || parent.getParent().threeLetterType !== 'epr'))\n\t\t\t\t// Can not delete anything from entity prototype transform \n\t\t\t\t{\n\t\t\t\t\tthis.name.style.color = parent.componentClass.color;\n\n\t\t\t\t\tmount(this.content, el('i.fa.fa-times.button.resetButton.iconButton', {\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tdispatch(this, 'makingChanges');\n\t\t\t\t\t\t\tthis.reset();\n\t\t\t\t\t\t}\n\t\t\t\t\t}));\n\t\t\t\t} else if (parent.threeLetterType === 'com') {\n\t\t\t\t\tthis.name.style.color = parent.constructor.color;\n\n\t\t\t\t\tmount(this.content, el('i.fa.fa-ellipsis-v.button.moreButton.iconButton', {\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tnew ObjectMoreButtonContextMenu(this.property);\n\t\t\t\t\t\t}\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t} else\n\t\t\t\tthis.name.style.color = 'inherit';\n\t\t}\n\t\tthis.setValueFromProperty();\n\t\tif (property._editorVisibleIfTarget) {\n\t\t\tthis.updateVisibleIf();\n\t\t\tthis.visibleIfListener = property._editorVisibleIfTarget.listen('change', _ => {\n\t\t\t\tif (!isInDom(this.el)) {\n\t\t\t\t\tthis.visibleIfListener();\n\t\t\t\t\tthis.visibleIfListener = null;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\treturn this.updateVisibleIf()\n\t\t\t});\n\t\t}\n\t}\n}\n\nfunction isInDom(element) {\n\treturn $.contains(document.documentElement, element);\n}\n\nfunction variableNameToPresentableName(propertyName) {\n\tlet name = propertyName.replace(/[A-Z]/g, c => ' ' + c);\n\treturn name[0].toUpperCase() + name.substring(1);\n}\n","import { el, list, mount } from 'redom';\nimport Module from './module';\nimport PropertyEditor from '../views/propertyEditor/propertyEditor';\nimport { editor } from '../editor';\nimport PropertyOwner from '../../core/propertyOwner'\nimport { listenKeyDown, key } from '../../util/input';\n\nclass Type extends Module {\n\tconstructor() {\n\t\tsuper(\n\t\t\tthis.propertyEditor = new PropertyEditor()\n\t\t);\n\t\tthis.id = 'type';\n\t\tthis.name = '<u>T</u>ype';\n\n\t\tlistenKeyDown(k => {\n\t\t\tif (k === key.t && this._enabled) {\n\t\t\t\tModule.activateModule('type', true);\n\t\t\t}\n\t\t});\n\t}\n\tupdate() {\n\t\tif (editor.selection.items.length != 1)\n\t\t\treturn false;\n\n\t\t// if the tab is not visible, do not waste CPU\n\t\tlet skipUpdate = !this._selected || this.moduleContainer.isPacked();\n\t\t\n\t\tif (editor.selection.type === 'prt') {\n\t\t\tif (skipUpdate)\n\t\t\t\treturn;\n\t\t\tthis.propertyEditor.update(editor.selection.items, editor.selection.type);\n\t\t} else if (editor.selection.type === 'ent') {\n\t\t\tif (skipUpdate)\n\t\t\t\treturn;\n\t\t\tthis.propertyEditor.update(editor.selection.items.map(e => e.prototype.prototype), editor.selection.type);\n\t\t} else {\n\t\t\treturn false; // hide\n\t\t}\n\t}\n\tactivate(command, parameter) {\n\t\tif (command === 'focusOnProperty') {\n\t\t\t\n\t\t\tthis.propertyEditor.el.querySelector(`.property[name='${parameter}'] input`).select();\n\t\t\t// console.log(nameProp);\n\t\t}\n\t}\n}\n\nModule.register(Type, 'right');\n","import { el, list, mount } from 'redom';\nimport Module from './module';\nimport PropertyEditor from '../views/propertyEditor/propertyEditor';\nimport { editor } from '../editor';\nimport { scene } from '../../core/scene';\nimport { listenKeyDown, key } from '../../util/input';\n\nclass PrefabModule extends Module {\n\tconstructor() {\n\t\tlet propertyEditor = new PropertyEditor();\n\t\tsuper(propertyEditor);\n\t\tthis.propertyEditor = propertyEditor;\n\t\tthis.id = 'prefab';\n\t\tthis.name = 'Pre<u>f</u>ab';\n\n\t\tlistenKeyDown(k => {\n\t\t\tif (k === key.f && this._enabled) {\n\t\t\t\tModule.activateModule('prefab', true);\n\t\t\t}\n\t\t});\n\t}\n\tupdate() {\n\t\t// return true;\n\t\tif (editor.selection.items.length != 1)\n\t\t\treturn false; // multiedit not supported yet\n\n\t\tif (editor.selection.type === 'pfa') {\n\t\t\tif (!this._selected || this.moduleContainer.isPacked()) {\n\t\t\t\treturn true; // if the tab is not visible, do not waste CPU\n\t\t\t}\n\n\t\t\tthis.propertyEditor.update(editor.selection.items, editor.selection.type);\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\tactivate(command, parameter) {\n\t}\n}\n\nModule.register(PrefabModule, 'right');\n","import { el, list, mount } from 'redom';\nimport Module from './module';\nimport PropertyEditor from '../views/propertyEditor/propertyEditor';\nimport { editor } from '../editor';\nimport { scene } from '../../core/scene';\nimport { listenKeyDown, key } from '../../util/input';\n\nclass ObjectModule extends Module {\n\tconstructor() {\n\t\tlet propertyEditor = new PropertyEditor();\n\t\tsuper(propertyEditor);\n\t\tthis.propertyEditor = propertyEditor;\n\t\tthis.id = 'object';\n\t\tthis.name = '<u>O</u>bject';\n\n\t\tlistenKeyDown(k => {\n\t\t\tif (k === key.o && this._enabled) {\n\t\t\t\tModule.activateModule('object', true);\n\t\t\t}\n\t\t});\n\t}\n\tupdate() {\n\t\tif (editor.selection.items.length != 1)\n\t\t\treturn false; // multiedit not supported yet\n\t\t\n\t\tif (editor.selection.type === 'ent' || editor.selection.type === 'epr') {\n\t\t\tif (!this._selected || this.moduleContainer.isPacked()) {\n\t\t\t\treturn; // if the tab is not visible, do not waste CPU\n\t\t\t}\n\n\t\t\tthis.propertyEditor.update(editor.selection.items, editor.selection.type);\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\tactivate(command, parameter) {\n\t}\n}\n\nModule.register(ObjectModule, 'right');\n","import { el, list, mount } from 'redom';\nimport Module from './module';\nimport PropertyEditor from '../views/propertyEditor/propertyEditor';\nimport { editor } from '../editor';\nimport PropertyOwner from '../../core/propertyOwner'\nimport { setChangeOrigin } from '../../core/serializableManager';\n\nclass Level extends Module {\n\tconstructor() {\n\t\tsuper(\n\t\t\tthis.propertyEditor = new PropertyEditor(),\n\t\t\tthis.deleteButton = el('button.button.dangerButton', 'Delete', {\n\t\t\t\tonclick: () => {\n\t\t\t\t\tif (this.level.isEmpty() || confirm('Are you sure you want to delete level: ' + this.level.name)) {\n\t\t\t\t\t\tsetChangeOrigin(this);\n\t\t\t\t\t\tthis.level.delete();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t);\n\t\tthis.id = 'level';\n\t\tthis.name = 'Level';\n\t}\n\tupdate() {\n\t\tthis.level = null;\n\t\tif (editor.selectedLevel) {\n\t\t\tthis.level = editor.selectedLevel;\n\t\t\tthis.propertyEditor.update([editor.selectedLevel], 'lvl');\n\t\t} else\n\t\t\treturn false;\n\t}\n\tactivate(command, parameter) {\n\t\tif (command === 'focusOnProperty') {\n\t\t\tthis.propertyEditor.el.querySelector(`.property[name='${parameter}'] input`).select();\n\t\t}\n\t}\n}\n\nModule.register(Level, 'right');\n","import { el, list, mount } from 'redom';\nimport Module from './module';\nimport PropertyEditor from '../views/propertyEditor/propertyEditor';\nimport { game } from '../../core/game';\nimport PropertyOwner from '../../core/propertyOwner'\nimport { TopButton } from './topBar'\n\nclass Game extends Module {\n\tconstructor() {\n\t\tsuper(\n\t\t\tthis.propertyEditor = new PropertyEditor(),\n\t\t\tel('button.dangerButton.button', el('i.fa.fa-times'), 'Delete Game', { onclick: () => {\n\t\t\t\tif (confirm(`Delete game '${game.name}'? (Cannot be undone)`)) {\n\t\t\t\t\tgame.delete();\n\t\t\t\t}\n\t\t\t} })\n\t\t);\n\t\tthis.id = 'game';\n\t\tthis.name = 'Game';\n\t}\n\tupdate() {\n\t\tif (game)\n\t\t\tthis.propertyEditor.update([game], 'gam');\n\t\telse\n\t\t\treturn false;\n\t}\n\tactivate(command, parameter) {\n\t\tif (command === 'focusOnProperty') {\n\t\t\tthis.propertyEditor.el.querySelector(`.property[name='${parameter}'] input`).select();\n\t\t}\n\t}\n}\n\nModule.register(Game, 'right');\n","import { el, list, mount } from 'redom';\nimport Module from './module';\nimport events, { dispatch, listen } from '../../util/events';\nimport * as performance from '../../util/performance';\nimport { scene } from '../../core/scene';\n\nclass PerformanceModule extends Module {\n\tconstructor() {\n\t\tlet performanceList;\n\t\tlet fpsMeter;\n\t\tsuper(\n\t\t\tel('div.performanceCPU',\n\t\t\t\tnew PerformanceItem({ name: 'Name', value: 'CPU %' }),\n\t\t\t\tperformanceList = list('div.performanceList', PerformanceItem, 'name')\n\t\t\t),\n\t\t\tfpsMeter = new FPSMeter()\n\t\t);\n\t\t\n\t\tthis.name = 'Performance';\n\t\tthis.id = 'performance';\n\t\t\n\n\t\tperformance.startPerformanceUpdates();\n\t\tevents.listen('performance snapshot', snapshot => {\n\t\t\tif (this.moduleContainer.isPacked())\n\t\t\t\treturn;\n\n\t\t\tperformance.start('Editor: Performance');\n\t\t\tperformanceList.update(snapshot.slice(0, 10).filter(item => item.value > 0.0005));\n\t\t\tperformance.stop('Editor: Performance');\n\t\t});\n\t\t\n\t\tsetInterval(() => {\n\t\t\tif (!scene || !scene.playing || this.moduleContainer.isPacked())\n\t\t\t\treturn;\n\t\t\t\n\t\t\tperformance.start('Editor: Performance');\n\t\t\tfpsMeter.update(performance.getFrameTimes());\n\t\t\tperformance.stop('Editor: Performance');\n\t\t}, 50);\n\t}\n}\nModule.register(PerformanceModule, 'bottom');\n\nclass PerformanceItem {\n    constructor(initItem) {\n        this.el = el('div.performanceItem',\n            this.name = el('span.performanceItemName'),\n\t\t\tthis.value = el('span.performanceItemValue')\n        );\n        \n        if (initItem) {\n        \tthis.name.textContent = initItem.name;\n        \tthis.value.textContent = initItem.value;\n        \t\n        \tthis.el.classList.add('performanceHeader');\n\t\t}\n    }\n    update(snapshotItem) {\n        this.name.textContent = snapshotItem.name;\n        let value = snapshotItem.value * 100;\n        this.value.textContent = value.toFixed(1); // example: 10.0%\n\t\t\n\t\tif (value > 40)\n\t\t\tthis.el.style.color = '#ff7075';\n\t\telse if (value > 10)\n\t\t\tthis.el.style.color = '#ffdab7';\n\t\telse if (value > 0.4)\n\t\t\tthis.el.style.color = '';\n\t\telse\n\t\t\tthis.el.style.color = 'rgba(200, 200, 200, 0.5)';\n    }\n}\n\nclass FPSMeter {\n\tconstructor() {\n\t\tthis.el = el('canvas.fpsMeterCanvas', { width: performance.FRAME_MEMORY_LENGTH, height: 100 });\n\t\tthis.context = this.el.getContext('2d');\n\t}\n\tupdate(fpsData) {\n\t\tthis.el.width = this.el.width; // clear\n\t\t\n\t\tconst c = this.context;\n\t\tlet yPixelsPerSecond = 30 / 16 * 1000;\n\t\tfunction secToY(secs) {\n\t\t\treturn ~~(100 - secs * yPixelsPerSecond) + 0.5;\n\t\t}\n\t\t\n\t\tc.strokeStyle = 'rgba(255, 255, 255, 0.1)';\n\t\tc.beginPath();\n\t\tfor (let i = 60.5; i < performance.FRAME_MEMORY_LENGTH; i += 60) {\n\t\t\tc.moveTo(i, 0);\n\t\t\tc.lineTo(i, 100);\n\t\t}\n\t\tc.moveTo(0, secToY(1 / 60));\n\t\tc.lineTo(performance.FRAME_MEMORY_LENGTH, secToY(1 / 60));\n\t\tc.stroke();\n\t\t\n\t\tconst normalStrokeStyle = '#aaa'; \n\t\tc.strokeStyle = normalStrokeStyle;\n\t\tc.beginPath();\n\t\tc.moveTo(0, secToY(fpsData[0]));\n\t\t\n\t\tfor (let i = 1; i < fpsData.length; ++i) {\n\t\t\tlet secs = fpsData[i];\n\t\t\tif (secs > 1 / 30) {\n\t\t\t\tc.stroke();\n\t\t\t\tc.strokeStyle = '#ff7385';\n\t\t\t\tc.beginPath();\n\t\t\t\tc.moveTo(i-1, secToY(fpsData[i-1]));\n\t\t\t\tc.lineTo(i, secToY(secs));\n\t\t\t\tc.stroke();\n\t\t\t\tc.strokeStyle = normalStrokeStyle;\n\t\t\t\tc.beginPath();\n\t\t\t} else if (secs > 1 / 40) {\n\t\t\t\tc.stroke();\n\t\t\t\tc.strokeStyle = '#ffc5a4';\n\t\t\t\tc.beginPath();\n\t\t\t\tc.moveTo(i-1, secToY(fpsData[i-1]));\n\t\t\t\tc.lineTo(i, secToY(secs));\n\t\t\t\tc.stroke();\n\t\t\t\tc.strokeStyle = normalStrokeStyle;\n\t\t\t\tc.beginPath();\n\t\t\t} else {\n\t\t\t\tc.lineTo(i, secToY(secs));\n\t\t\t}\n\t\t}\n\t\t\n\t\tc.stroke();\n\t}\n}\n","import { el, list, mount } from 'redom';\nimport Module from './module';\nimport events, { dispatch, listen } from '../../util/events';\nimport * as performance from '../../util/performance';\nimport { scene } from '../../core/scene';\n\nclass PerSecond extends Module {\n\tconstructor() {\n\t\tlet counterList;\n\t\tsuper(\n\t\t\tel('div.perSecond',\n\t\t\t\tnew PerSecondItem({ name: 'Name', count: '/ sec' }),\n\t\t\t\tcounterList = list('div.perSecondList', PerSecondItem)\n\t\t\t)\n\t\t);\n\n\t\tthis.name = 'Per second';\n\t\tthis.id = 'perSecond';\n\t\t\n\t\tevents.listen('perSecond snapshot', snapshot => {\n\t\t\tcounterList.update(snapshot);\n\t\t});\n\t}\n}\nModule.register(PerSecond, 'bottom');\n\nclass PerSecondItem {\n\tconstructor(initItem) {\n\t\tthis.el = el('div.perSecondItem',\n\t\t\tthis.name = el('span.perSecondItemName'),\n\t\t\tthis.value = el('span.perSecondItemValue')\n\t\t);\n\t\t\n\t\tif (initItem) {\n\t\t\tthis.update(initItem);\n\t\t\tthis.el.classList.add('perSecondHeader');\n\t\t}\n\t}\n\tupdate(perSecondItem) {\n\t\tthis.name.textContent = perSecondItem.name;\n\t\tthis.value.textContent = perSecondItem.count;\n/*\n\t\tif (value > 40)\n\t\t\tthis.el.style.color = '#ff7075';\n\t\telse if (value > 10)\n\t\t\tthis.el.style.color = '#ffdab7';\n\t\telse if (value > 0.4)\n\t\t\tthis.el.style.color = '';\n\t\telse\n\t\t\tthis.el.style.color = 'rgba(200, 200, 200, 0.5)';\n\t\t\t*/\n\t}\n}\n","\n\nwindow.test = function() {\n};\n","import Popup, {Button, popupDepth} from './Popup';\nimport {el, mount, list, text} from 'redom';\n\nexport default class OKPopup extends Popup {\n\t/*\n\tbuttonOptions:\n\t- text\n\t- color\n\t- icon (fa-plus)\n\t*/\n\tconstructor(title, textContent, buttonOptions, callback) {\n\t\tlet listView;\n\t\tsuper({\n\t\t\ttitle,\n\t\t\twidth: '500px',\n\t\t\tcontent: el('div',\n\t\t\t\tel('div.genericCustomContent', textContent),\n\t\t\t\tlistView = list('div.confirmationButtons', Button)\n\t\t\t),\n\t\t\tcancelCallback: callback\n\t\t});\n\n\t\tlistView.update([Object.assign(\n\t\t\t{\n\t\t\t\ttext: 'OK'\n\t\t\t}, buttonOptions, {\n\t\t\t\tcallback: () => {\n\t\t\t\t\tcallback && callback();\n\t\t\t\t\tthis.remove();\n\t\t\t\t}\n\t\t\t}\n\t\t)]);\n\n\t\tlet okButton = listView.views[0];\n\t\tokButton.el.focus();\n\t}\n\n\tremove() {\n\t\tsuper.remove();\n\t}\n}\n","import events from '../util/events';\nimport Layout from './layout/layout';\n\nimport './module/topBar';\nimport './module/scene';\n\nimport './module/types';\nimport './module/prefabs';\nimport './module/objects';\nimport './module/levels';\n\nimport './module/type';\nimport './module/prefab';\nimport './module/object';\nimport './module/level';\nimport './module/game';\n\nimport './module/performance';\nimport './module/perSecond';\n\nimport {el, list, mount} from 'redom';\nimport {game} from '../core/game';\nimport Serializable from '../core/serializable';\nimport {\n\taddChangeListener,\n\tserializables,\n\texecuteExternal,\n\tsetChangeOrigin,\n\tchangeType\n} from '../core/serializableManager';\nimport assert from '../util/assert';\nimport {configureNetSync} from '../core/net';\nimport './help';\nimport './test';\nimport * as performance from '../util/performance'\nimport {limit} from '../util/callLimiter';\nimport OKPopup from \"./views/popup/OKPopup\";\n\nlet loaded = false;\n\nexport let modulesRegisteredPromise = events.getEventPromise('modulesRegistered');\nexport let loadedPromise = events.getEventPromise('loaded');\nexport let selectedToolName = 'multiTool'; // in top bar\nexport function changeSelectedTool(newToolName) {\n\tif (selectedToolName !== newToolName) {\n\t\tselectedToolName = newToolName;\n\t\tevents.dispatch('selectedToolChanged', newToolName);\n\t}\n}\n\nmodulesRegisteredPromise.then(() => {\n\tloaded = true;\n\tevents.dispatch('loaded');\n});\n\nconfigureNetSync({\n\tserverToClientEnabled: true,\n\tclientToServerEnabled: true,\n\tcontext: 'edit'\n});\n\nloadedPromise.then(() => {\n\teditor.setLevel(game.getChildren('lvl')[0]);\n});\n\nlet editorUpdateLimited = limit(200, 'soon', () => {\n\teditor.update();\n});\n\naddChangeListener(change => {\n\tperformance.start('Editor: General');\n\tevents.dispatch('change', change);\n\tif (change.reference.threeLetterType === 'gam' && change.type === changeType.addSerializableToTree) {\n\t\tlet game = change.reference;\n\t\teditor = new Editor(game);\n\t\tevents.dispatch('registerModules', editor);\n\t}\n\tif (editor) {\n\t\tif (change.reference.threeLetterType === 'lvl' && change.type === changeType.deleteSerializable) {\n\t\t\tif (editor.selectedLevel === change.reference) {\n\t\t\t\teditor.setLevel(null);\n\t\t\t}\n\t\t}\n\t\teditorUpdateLimited();\n\t}\n\tperformance.stop('Editor: General');\n});\n\nexport let editor = null;\n\nclass Editor {\n\tconstructor(game) {\n\t\tassert(game);\n\n\t\tthis.layout = new Layout();\n\n\t\tthis.game = game;\n\t\tthis.selectedLevel = null;\n\n\t\tthis.selection = {\n\t\t\ttype: 'none',\n\t\t\titems: [],\n\t\t\tdirty: true\n\t\t};\n\n\t\tmount(document.body, this.layout);\n\t}\n\n\tsetLevel(level) {\n\t\tif (level && level.threeLetterType === 'lvl')\n\t\t\tthis.selectedLevel = level;\n\t\telse\n\t\t\tthis.selectedLevel = null;\n\n\t\tthis.select([], this);\n\t\tevents.dispatch('setLevel', this.selectedLevel);\n\t}\n\n\tselect(items, origin) {\n\t\tif (!items)\n\t\t\titems = [];\n\t\telse if (!Array.isArray(items))\n\t\t\titems = [items];\n\t\tthis.selection.items = [].concat(items);\n\n\t\tlet types = Array.from(new Set(items.map(i => i.threeLetterType)));\n\t\tif (types.length === 0)\n\t\t\tthis.selection.type = 'none';\n\t\telse if (types.length === 1)\n\t\t\tthis.selection.type = types[0];\n\t\telse\n\t\t\tthis.selection.type = 'mixed';\n\n\t\t// console.log('selectedIds', this.selection)\n\n\t\tevents.dispatch('change', {\n\t\t\ttype: 'editorSelection',\n\t\t\treference: this.selection,\n\t\t\torigin\n\t\t});\n\n\t\t// editorUpdateLimited(); // doesn't work for some reason\n\t\tthis.update();\n\t}\n\n\tupdate() {\n\t\tif (!this.game) return;\n\t\tthis.layout.update();\n\t}\n}\n\nevents.listen('noEditAccess', () => {\n\tloadedPromise.then(() => {\n\t\tdocument.body.classList.add('noEditAccess');\n\t\tnew OKPopup('No edit access',\n\t\t\t`Since you don't have edit access to this game, your changes are not saved. Feel free to play around, though!`\n\t\t);\n\t\t// alert(`No edit access. Your changes won't be saved.`);\n\t});\n\n\tconfigureNetSync({\n\t\tclientToServerEnabled: false,\n\t\tserverToClientEnabled: false\n\t});\n});\n\nlet options = null;\n\nfunction loadOptions() {\n\tif (!options) {\n\t\ttry {\n\t\t\toptions = JSON.parse(localStorage.openEditPlayOptions);\n\t\t} catch (e) {\n\t\t\t// default options\n\t\t\toptions = {\n\t\t\t\tmoduleContainerPacked_bottom: true\n\t\t\t};\n\t\t}\n\t}\n}\n\nexport function setOption(id, stringValue) {\n\tloadOptions();\n\toptions[id] = stringValue;\n\ttry {\n\t\tlocalStorage.openEditPlayOptions = JSON.stringify(options);\n\t} catch (e) {\n\t}\n}\n\nexport function getOption(id) {\n\tloadOptions();\n\treturn options[id];\n}\n"],"names":["listeners","listenerCounter","NUMBER_BIGGER_THAN_LISTENER_COUNT","indexOfListener","performance","assert","this","performanceTool.eventHappened","serializables","getSerializable","arguments","text","PIXI","Prop","isClient","performanceTool.setFrameTime","performanceTool.start","performanceTool.stop","performance.start","performance.stop","propertyTypes","p2","editor","key","sceneEdit.setEntityPositions","sceneEdit.deleteEntities","scene","sceneEdit.shouldSyncLevelAndScene","sceneEdit.setOrCreateTransformDataPropertyValue","sceneEdit.syncAChangeBetweenSceneAndLevel","sceneEdit.copyEntitiesToScene","sceneEdit.setEntitiesInSelectionArea","sceneEdit.getWidgetUnderMouse","sceneEdit.getEntitiesInSelection","sceneEdit.entityModifiedInEditor","Property","Level","Game","performance.startPerformanceUpdates","performance.getFrameTimes","performance.FRAME_MEMORY_LENGTH","game","options"],"mappings":"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"}